<!doctype html>
<html lang="en">
<head>
<title>SQM Visualizer</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" /><script type="text/javascript">
/*
	Edit the configuration options if desired.
*/
var sqmConfig = {
	/*	the title to display */
	title: "SQM Visualizer",
	/*	which twilight type to use when requesting nightly data
		options are 'civil', 'nautical' or 'astronomical' */
	twilightType: 'civil',
	/*	whether higher msas values appear at the bottom of the individual readings chart */
	nightlyAxisDescending: true,
	/*	whether higher msas values appear at the bottom of the best nightly readings chart */
	bestReadingAxisDescening: false,
	/*	set the default display options, all of which can be overridden on a per session basis
		using options in the context (right-click) menu */
	showLegend: true, 				// names of sqm stations
	showKey: true, 					// color coding key
	showBestReading: true,			// display best reading below title
	showLatestReading: false,		// display latest reading at bottom of page
	showStats: false,				// display mean, median, etc
	showBinning: false,				// display the bar chart
	/*	if a reading is below this, it will be ignored */
	badDataCutoff: 10.0,
	/*	best nightly readings will be ignored if there were less than this many readings that night
		this is most useful when filtering by sun moon clouds since it throws out best nightly
		readings for nights which were cloudy or overwhelmingly moon illuminated */
	minReadingsPerNight: 40,
	/*	whether cloudy data and sun moon clouds data should be displayed by default
		set to false to filter on these by default
		note that setting to false runs the risk of no data being displayed even on nights when
		readings were taken */
	showCloudyByDefault: true,
	showSunMoonCloudsByDefault: true,
	/*	whether to use color and transparency to indicate solar and lunar illumination
		and cloudiess */
	colorizeData: true,
	/*	the mean r^2 value below which the sky is considered clear
		points with mean r^2 below this will be drawn opaque if below this value */
	cloudyCutoff: 0.04,
	/*	the mean r^2 value above which the sky is considered extremely cloudy
		points with values above this range will be drawn at 20% opacity
		points between these two values will be drawn at scaled opacity acccordingly */
	cloudyMax: 0.1,
	/*	the solar altitude cutoffs for coloring points from yellow to orange to dark orange */
	sunAltitudeCutoffs: [ -12, -15, -18 ],
	/*	readings when the moon is below the first value in elevation will be considered free
		of interference from the moon
		readings when the moon is above the second value will be considered to be fully effected
		by the moon illumination
		readings with moon altitude in between will be considered to be effected by the moon
		illumination scaled by where in the range the moon's altitude is */
	moonAltitudeCutoffs: [ -10, 30 ],
	/*	readings with moon illumination above this value after compsenating for the moon's
		alittude will be filtered out when filter sun moon clouds is selected */
	moonIlluminationCutoff: 0.1,
	/*	whether to take milky way location into account */
	milkyWay: true,
	/*	galactic latitude cutoff to display and filter out if milkyWay is true */
	milkyWayCutoff: 2.5,
	/*	whether to show the sun, moon, mean r^2, MW information in the popup that appears
		when hovering over a point in the chart (touching a point on mobile)
		
		if working with a large number of stations, setting these to false will make the 
		interface cleaner */
	hoverTextSun: true,
	hoverTextMoon: true,
	hoverTextR2: true,
	hoverTextMW: true,
};
</script>

<!--
SQM Visualizer
(c) 2024 Darren Creutz
---
                    GNU AFFERO GENERAL PUBLIC LICENSE
                       Version 3, 19 November 2007

 Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>
 Everyone is permitted to copy and distribute verbatim copies
 of this license document, but changing it is not allowed.

                            Preamble

  The GNU Affero General Public License is a free, copyleft license for
software and other kinds of works, specifically designed to ensure
cooperation with the community in the case of network server software.

  The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
our General Public Licenses are intended to guarantee your freedom to
share and change all versions of a program--to make sure it remains free
software for all its users.

  When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

  Developers that use our General Public Licenses protect your rights
with two steps: (1) assert copyright on the software, and (2) offer
you this License which gives you legal permission to copy, distribute
and/or modify the software.

  A secondary benefit of defending all users' freedom is that
improvements made in alternate versions of the program, if they
receive widespread use, become available for other developers to
incorporate.  Many developers of free software are heartened and
encouraged by the resulting cooperation.  However, in the case of
software used on network servers, this result may fail to come about.
The GNU General Public License permits making a modified version and
letting the public access it on a server without ever releasing its
source code to the public.

  The GNU Affero General Public License is designed specifically to
ensure that, in such cases, the modified source code becomes available
to the community.  It requires the operator of a network server to
provide the source code of the modified version running there to the
users of that server.  Therefore, public use of a modified version, on
a publicly accessible server, gives the public access to the source
code of the modified version.

  An older license, called the Affero General Public License and
published by Affero, was designed to accomplish similar goals.  This is
a different license, not a version of the Affero GPL, but Affero has
released a new version of the Affero GPL which permits relicensing under
this license.

  The precise terms and conditions for copying, distribution and
modification follow.

                       TERMS AND CONDITIONS

  0. Definitions.

  "This License" refers to version 3 of the GNU Affero General Public License.

  "Copyright" also means copyright-like laws that apply to other kinds of
works, such as semiconductor masks.

  "The Program" refers to any copyrightable work licensed under this
License.  Each licensee is addressed as "you".  "Licensees" and
"recipients" may be individuals or organizations.

  To "modify" a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of an
exact copy.  The resulting work is called a "modified version" of the
earlier work or a work "based on" the earlier work.

  A "covered work" means either the unmodified Program or a work based
on the Program.

  To "propagate" a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

  To "convey" a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user through
a computer network, with no transfer of a copy, is not conveying.

  An interactive user interface displays "Appropriate Legal Notices"
to the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

  1. Source Code.

  The "source code" for a work means the preferred form of the work
for making modifications to it.  "Object code" means any non-source
form of a work.

  A "Standard Interface" means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

  The "System Libraries" of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
"Major Component", in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

  The "Corresponding Source" for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

  The Corresponding Source need not include anything that users
can regenerate automatically from other parts of the Corresponding
Source.

  The Corresponding Source for a work in source code form is that
same work.

  2. Basic Permissions.

  All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

  You may make, run and propagate covered works that you do not
convey, without conditions so long as your license otherwise remains
in force.  You may convey covered works to others for the sole purpose
of having them make modifications exclusively for you, or provide you
with facilities for running those works, provided that you comply with
the terms of this License in conveying all material for which you do
not control copyright.  Those thus making or running the covered works
for you must do so exclusively on your behalf, under your direction
and control, on terms that prohibit them from making any copies of
your copyrighted material outside their relationship with you.

  Conveying under any other circumstances is permitted solely under
the conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

  3. Protecting Users' Legal Rights From Anti-Circumvention Law.

  No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

  When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such circumvention
is effected by exercising rights under this License with respect to
the covered work, and you disclaim any intention to limit operation or
modification of the work as a means of enforcing, against the work's
users, your or third parties' legal rights to forbid circumvention of
technological measures.

  4. Conveying Verbatim Copies.

  You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

  You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

  5. Conveying Modified Source Versions.

  You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these conditions:

    a) The work must carry prominent notices stating that you modified
    it, and giving a relevant date.

    b) The work must carry prominent notices stating that it is
    released under this License and any conditions added under section
    7.  This requirement modifies the requirement in section 4 to
    "keep intact all notices".

    c) You must license the entire work, as a whole, under this
    License to anyone who comes into possession of a copy.  This
    License will therefore apply, along with any applicable section 7
    additional terms, to the whole of the work, and all its parts,
    regardless of how they are packaged.  This License gives no
    permission to license the work in any other way, but it does not
    invalidate such permission if you have separately received it.

    d) If the work has interactive user interfaces, each must display
    Appropriate Legal Notices; however, if the Program has interactive
    interfaces that do not display Appropriate Legal Notices, your
    work need not make them do so.

  A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
"aggregate" if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

  6. Conveying Non-Source Forms.

  You may convey a covered work in object code form under the terms
of sections 4 and 5, provided that you also convey the
machine-readable Corresponding Source under the terms of this License,
in one of these ways:

    a) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by the
    Corresponding Source fixed on a durable physical medium
    customarily used for software interchange.

    b) Convey the object code in, or embodied in, a physical product
    (including a physical distribution medium), accompanied by a
    written offer, valid for at least three years and valid for as
    long as you offer spare parts or customer support for that product
    model, to give anyone who possesses the object code either (1) a
    copy of the Corresponding Source for all the software in the
    product that is covered by this License, on a durable physical
    medium customarily used for software interchange, for a price no
    more than your reasonable cost of physically performing this
    conveying of source, or (2) access to copy the
    Corresponding Source from a network server at no charge.

    c) Convey individual copies of the object code with a copy of the
    written offer to provide the Corresponding Source.  This
    alternative is allowed only occasionally and noncommercially, and
    only if you received the object code with such an offer, in accord
    with subsection 6b.

    d) Convey the object code by offering access from a designated
    place (gratis or for a charge), and offer equivalent access to the
    Corresponding Source in the same way through the same place at no
    further charge.  You need not require recipients to copy the
    Corresponding Source along with the object code.  If the place to
    copy the object code is a network server, the Corresponding Source
    may be on a different server (operated by you or a third party)
    that supports equivalent copying facilities, provided you maintain
    clear directions next to the object code saying where to find the
    Corresponding Source.  Regardless of what server hosts the
    Corresponding Source, you remain obligated to ensure that it is
    available for as long as needed to satisfy these requirements.

    e) Convey the object code using peer-to-peer transmission, provided
    you inform other peers where the object code and Corresponding
    Source of the work are being offered to the general public at no
    charge under subsection 6d.

  A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

  A "User Product" is either (1) a "consumer product", which means any
tangible personal property which is normally used for personal, family,
or household purposes, or (2) anything designed or sold for incorporation
into a dwelling.  In determining whether a product is a consumer product,
doubtful cases shall be resolved in favor of coverage.  For a particular
product received by a particular user, "normally used" refers to a
typical or common use of that class of product, regardless of the status
of the particular user or of the way in which the particular user
actually uses, or expects or is expected to use, the product.  A product
is a consumer product regardless of whether the product has substantial
commercial, industrial or non-consumer uses, unless such uses represent
the only significant mode of use of the product.

  "Installation Information" for a User Product means any methods,
procedures, authorization keys, or other information required to install
and execute modified versions of a covered work in that User Product from
a modified version of its Corresponding Source.  The information must
suffice to ensure that the continued functioning of the modified object
code is in no case prevented or interfered with solely because
modification has been made.

  If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

  The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or updates
for a work that has been modified or installed by the recipient, or for
the User Product in which it has been modified or installed.  Access to a
network may be denied when the modification itself materially and
adversely affects the operation of the network or violates the rules and
protocols for communication across the network.

  Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

  7. Additional Terms.

  "Additional permissions" are terms that supplement the terms of this
License by making exceptions from one or more of its conditions.
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

  When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

  Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders of
that material) supplement the terms of this License with terms:

    a) Disclaiming warranty or limiting liability differently from the
    terms of sections 15 and 16 of this License; or

    b) Requiring preservation of specified reasonable legal notices or
    author attributions in that material or in the Appropriate Legal
    Notices displayed by works containing it; or

    c) Prohibiting misrepresentation of the origin of that material, or
    requiring that modified versions of such material be marked in
    reasonable ways as different from the original version; or

    d) Limiting the use for publicity purposes of names of licensors or
    authors of the material; or

    e) Declining to grant rights under trademark law for use of some
    trade names, trademarks, or service marks; or

    f) Requiring indemnification of licensors and authors of that
    material by anyone who conveys the material (or modified versions of
    it) with contractual assumptions of liability to the recipient, for
    any liability that these contractual assumptions directly impose on
    those licensors and authors.

  All other non-permissive additional terms are considered "further
restrictions" within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

  If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

  Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions;
the above requirements apply either way.

  8. Termination.

  You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

  However, if you cease all violation of this License, then your
license from a particular copyright holder is reinstated (a)
provisionally, unless and until the copyright holder explicitly and
finally terminates your license, and (b) permanently, if the copyright
holder fails to notify you of the violation by some reasonable means
prior to 60 days after the cessation.

  Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

  Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

  9. Acceptance Not Required for Having Copies.

  You are not required to accept this License in order to receive or
run a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

  10. Automatic Licensing of Downstream Recipients.

  Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

  An "entity transaction" is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

  You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

  11. Patents.

  A "contributor" is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's "contributor version".

  A contributor's "essential patent claims" are all patent claims
owned or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, "control" includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

  Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

  In the following three paragraphs, a "patent license" is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To "grant" such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

  If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  "Knowingly relying" means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

  If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

  A patent license is "discriminatory" if it does not include within
the scope of its coverage, prohibits the exercise of, or is
conditioned on the non-exercise of one or more of the rights that are
specifically granted under this License.  You may not convey a covered
work if you are a party to an arrangement with a third party that is
in the business of distributing software, under which you make payment
to the third party based on the extent of your activity of conveying
the work, and under which the third party grants, to any of the
parties who would receive the covered work from you, a discriminatory
patent license (a) in connection with copies of the covered work
conveyed by you (or copies made from those copies), or (b) primarily
for and in connection with specific products or compilations that
contain the covered work, unless you entered into that arrangement,
or that patent license was granted, prior to 28 March 2007.

  Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

  12. No Surrender of Others' Freedom.

  If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey a
covered work so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you may
not convey it at all.  For example, if you agree to terms that obligate you
to collect a royalty for further conveying from those to whom you convey
the Program, the only way you could satisfy both those terms and this
License would be to refrain entirely from conveying the Program.

  13. Remote Network Interaction; Use with the GNU General Public License.

  Notwithstanding any other provision of this License, if you modify the
Program, your modified version must prominently offer all users
interacting with it remotely through a computer network (if your version
supports such interaction) an opportunity to receive the Corresponding
Source of your version by providing access to the Corresponding Source
from a network server at no charge, through some standard or customary
means of facilitating copying of software.  This Corresponding Source
shall include the Corresponding Source for any work covered by version 3
of the GNU General Public License that is incorporated pursuant to the
following paragraph.

  Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the work with which it is combined will remain governed by version
3 of the GNU General Public License.

  14. Revised Versions of this License.

  The Free Software Foundation may publish revised and/or new versions of
the GNU Affero General Public License from time to time.  Such new versions
will be similar in spirit to the present version, but may differ in detail to
address new problems or concerns.

  Each version is given a distinguishing version number.  If the
Program specifies that a certain numbered version of the GNU Affero General
Public License "or any later version" applies to it, you have the
option of following the terms and conditions either of that numbered
version or of any later version published by the Free Software
Foundation.  If the Program does not specify a version number of the
GNU Affero General Public License, you may choose any version ever published
by the Free Software Foundation.

  If the Program specifies that a proxy can decide which future
versions of the GNU Affero General Public License can be used, that proxy's
public statement of acceptance of a version permanently authorizes you
to choose that version for the Program.

  Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

  15. Disclaimer of Warranty.

  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY
OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,
THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM
IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF
ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

  16. Limitation of Liability.

  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS
THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY
GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE
USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF
DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD
PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),
EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF
SUCH DAMAGES.

  17. Interpretation of Sections 15 and 16.

  If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

                     END OF TERMS AND CONDITIONS

            How to Apply These Terms to Your New Programs

  If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these terms.

  To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the "copyright" line and a pointer to where the full notice is found.

    <one line to give the program's name and a brief idea of what it does.>
    Copyright (C) <year>  <name of author>

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/>.

Also add information on how to contact you by electronic and paper mail.

  If your software can interact with users remotely through a computer
network, you should also make sure that it provides a way for users to
get its source.  For example, if your program is a web application, its
interface could display a "Source" link that leads users to an archive
of the code.  There are many ways you could offer source, and different
solutions will be better for different programs; see section 13 for the
specific requirements.

  You should also get your employer (if you work as a programmer) or school,
if any, to sign a "copyright disclaimer" for the program, if necessary.
For more information on this, and how to apply and follow the GNU AGPL, see
<https://www.gnu.org/licenses/>.


chartjs
---
Source: 
https://www.chartjs.org/

License: 
The MIT License (MIT)

Copyright (c) 2014-2022 Chart.js Contributors

Permission is hereby granted, free of charge, to any person obtaining a 
copy of this software and associated documentation files (the "Software"), 
to deal in the Software without restriction, including without limitation 
the rights to use, copy, modify, merge, publish, distribute, sublicense, 
and/or sell copies of the Software, and to permit persons to whom the 
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in 
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
DEALINGS IN THE SOFTWARE.



chartjs-datefns-adapter
---
Source: 
https://github.com/chartjs/chartjs-adapter-date-fns

License: 
The MIT License (MIT)

Copyright (c) 2019 Chart.js Contributors

Permission is hereby granted, free of charge, to any person obtaining a 
copy of this software and associated documentation files (the "Software"), 
to deal in the Software without restriction, including without limitation 
the rights to use, copy, modify, merge, publish, distribute, sublicense, 
and/or sell copies of the Software, and to permit persons to whom the 
Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in 
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, 
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER 
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER 
DEALINGS IN THE SOFTWARE.



datefns
---
Source: 
https://date-fns.org/

License: 
MIT License

Copyright (c) 2021 Sasha Koss and Lesha Koss 
https://kossnocorp.mit-license.org

Permission is hereby granted, free of charge, to any person obtaining a 
copy of this software and associated documentation files (the "Software"), to 
deal in the Software without restriction, including without limitation the 
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in 
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN 
THE SOFTWARE.



flatpickr
---
Source: 
https://flatpickr.js.org/

License: 
The MIT License (MIT)

Copyright (c) 2017 Gregory Petrosyan

Permission is hereby granted, free of charge, to any person obtaining a 
copy
of this software and associated documentation files (the "Software"), to 
deal
in the Software without restriction, including without limitation the 
rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in 
all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL 
THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING 
FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN 
THE
SOFTWARE.



multiselect
---
Source: 
https://github.com/miket-dev/multiselect

License: 
The MIT License (MIT)

Copyright (c) 2016 Mikhail Neofitov

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.



papaparse
---
Source: 
https://github.com/mholt/PapaParse

License: 
The MIT License (MIT)

Copyright (c) 2015 Matthew Holt

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



parsedown
---
Source: 
https://github.com/erusev/parsedown

License: 
The MIT License (MIT)

Copyright (c) 2013-2018 Emanuil Rusev, erusev.com

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.



suncalc
---
Source: 
https://github.com/mourner/suncalc

License: 
Copyright (c) 2014, Vladimir Agafonkin
All rights reserved.

Redistribution and use in source and binary forms, with or without 
modification, are
permitted provided that the following conditions are met:

   1. Redistributions of source code must retain the above copyright 
notice, this list of conditions and the following disclaimer.

   2. Redistributions in binary form must reproduce the above copyright 
notice, this list of conditions and the following disclaimer in the documentation 
and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS 
IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED 
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO 
EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, 
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, 
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS 
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT 
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE 
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.



-->
<style type="text/css">
.flatpickr-calendar{background:transparent;opacity:0;display:none;text-align:center;visibility:hidden;padding:0;-webkit-animation:none;animation:none;direction:ltr;border:0;font-size:14px;line-height:24px;border-radius:5px;position:absolute;width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-touch-action:manipulation;touch-action:manipulation;background:#fff;-webkit-box-shadow:1px 0 0 #e6e6e6,-1px 0 0 #e6e6e6,0 1px 0 #e6e6e6,0 -1px 0 #e6e6e6,0 3px 13px rgba(0,0,0,0.08);box-shadow:1px 0 0 #e6e6e6,-1px 0 0 #e6e6e6,0 1px 0 #e6e6e6,0 -1px 0 #e6e6e6,0 3px 13px rgba(0,0,0,0.08)}.flatpickr-calendar.open,.flatpickr-calendar.inline{opacity:1;max-height:640px;visibility:visible}.flatpickr-calendar.open{display:inline-block;z-index:99999}.flatpickr-calendar.animate.open{-webkit-animation:fpFadeInDown 300ms cubic-bezier(.23,1,.32,1);animation:fpFadeInDown 300ms cubic-bezier(.23,1,.32,1)}.flatpickr-calendar.inline{display:block;position:relative;top:2px}.flatpickr-calendar.static{position:absolute;top:calc(100% + 2px)}.flatpickr-calendar.static.open{z-index:999;display:block}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+1) .flatpickr-day.inRange:nth-child(7n+7){-webkit-box-shadow:none !important;box-shadow:none !important}.flatpickr-calendar.multiMonth .flatpickr-days .dayContainer:nth-child(n+2) .flatpickr-day.inRange:nth-child(7n+1){-webkit-box-shadow:-2px 0 0 #e6e6e6,5px 0 0 #e6e6e6;box-shadow:-2px 0 0 #e6e6e6,5px 0 0 #e6e6e6}.flatpickr-calendar .hasWeeks .dayContainer,.flatpickr-calendar .hasTime .dayContainer{border-bottom:0;border-bottom-right-radius:0;border-bottom-left-radius:0}.flatpickr-calendar .hasWeeks .dayContainer{border-left:0}.flatpickr-calendar.hasTime .flatpickr-time{height:40px;border-top:1px solid #e6e6e6}.flatpickr-calendar.noCalendar.hasTime .flatpickr-time{height:auto}.flatpickr-calendar:before,.flatpickr-calendar:after{position:absolute;display:block;pointer-events:none;border:solid transparent;content:'';height:0;width:0;left:22px}.flatpickr-calendar.rightMost:before,.flatpickr-calendar.arrowRight:before,.flatpickr-calendar.rightMost:after,.flatpickr-calendar.arrowRight:after{left:auto;right:22px}.flatpickr-calendar.arrowCenter:before,.flatpickr-calendar.arrowCenter:after{left:50%;right:50%}.flatpickr-calendar:before{border-width:5px;margin:0 -5px}.flatpickr-calendar:after{border-width:4px;margin:0 -4px}.flatpickr-calendar.arrowTop:before,.flatpickr-calendar.arrowTop:after{bottom:100%}.flatpickr-calendar.arrowTop:before{border-bottom-color:#e6e6e6}.flatpickr-calendar.arrowTop:after{border-bottom-color:#fff}.flatpickr-calendar.arrowBottom:before,.flatpickr-calendar.arrowBottom:after{top:100%}.flatpickr-calendar.arrowBottom:before{border-top-color:#e6e6e6}.flatpickr-calendar.arrowBottom:after{border-top-color:#fff}.flatpickr-calendar:focus{outline:0}.flatpickr-wrapper{position:relative;display:inline-block}.flatpickr-months{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.flatpickr-months .flatpickr-month{background:transparent;color:rgba(0,0,0,0.9);fill:rgba(0,0,0,0.9);height:34px;line-height:1;text-align:center;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.flatpickr-months .flatpickr-prev-month,.flatpickr-months .flatpickr-next-month{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;text-decoration:none;cursor:pointer;position:absolute;top:0;height:34px;padding:10px;z-index:3;color:rgba(0,0,0,0.9);fill:rgba(0,0,0,0.9)}.flatpickr-months .flatpickr-prev-month.flatpickr-disabled,.flatpickr-months .flatpickr-next-month.flatpickr-disabled{display:none}.flatpickr-months .flatpickr-prev-month i,.flatpickr-months .flatpickr-next-month i{position:relative}.flatpickr-months .flatpickr-prev-month.flatpickr-prev-month,.flatpickr-months .flatpickr-next-month.flatpickr-prev-month{/*
      /*rtl:begin:ignore*/left:0/*
      /*rtl:end:ignore*/}/*
      /*rtl:begin:ignore*/
/*
      /*rtl:end:ignore*/
.flatpickr-months .flatpickr-prev-month.flatpickr-next-month,.flatpickr-months .flatpickr-next-month.flatpickr-next-month{/*
      /*rtl:begin:ignore*/right:0/*
      /*rtl:end:ignore*/}/*
      /*rtl:begin:ignore*/
/*
      /*rtl:end:ignore*/
.flatpickr-months .flatpickr-prev-month:hover,.flatpickr-months .flatpickr-next-month:hover{color:#959ea9}.flatpickr-months .flatpickr-prev-month:hover svg,.flatpickr-months .flatpickr-next-month:hover svg{fill:#f64747}.flatpickr-months .flatpickr-prev-month svg,.flatpickr-months .flatpickr-next-month svg{width:14px;height:14px}.flatpickr-months .flatpickr-prev-month svg path,.flatpickr-months .flatpickr-next-month svg path{-webkit-transition:fill .1s;transition:fill .1s;fill:inherit}.numInputWrapper{position:relative;height:auto}.numInputWrapper input,.numInputWrapper span{display:inline-block}.numInputWrapper input{width:100%}.numInputWrapper input::-ms-clear{display:none}.numInputWrapper input::-webkit-outer-spin-button,.numInputWrapper input::-webkit-inner-spin-button{margin:0;-webkit-appearance:none}.numInputWrapper span{position:absolute;right:0;width:14px;padding:0 4px 0 2px;height:50%;line-height:50%;opacity:0;cursor:pointer;border:1px solid rgba(57,57,57,0.15);-webkit-box-sizing:border-box;box-sizing:border-box}.numInputWrapper span:hover{background:rgba(0,0,0,0.1)}.numInputWrapper span:active{background:rgba(0,0,0,0.2)}.numInputWrapper span:after{display:block;content:"";position:absolute}.numInputWrapper span.arrowUp{top:0;border-bottom:0}.numInputWrapper span.arrowUp:after{border-left:4px solid transparent;border-right:4px solid transparent;border-bottom:4px solid rgba(57,57,57,0.6);top:26%}.numInputWrapper span.arrowDown{top:50%}.numInputWrapper span.arrowDown:after{border-left:4px solid transparent;border-right:4px solid transparent;border-top:4px solid rgba(57,57,57,0.6);top:40%}.numInputWrapper span svg{width:inherit;height:auto}.numInputWrapper span svg path{fill:rgba(0,0,0,0.5)}.numInputWrapper:hover{background:rgba(0,0,0,0.05)}.numInputWrapper:hover span{opacity:1}.flatpickr-current-month{font-size:135%;line-height:inherit;font-weight:300;color:inherit;position:absolute;width:75%;left:12.5%;padding:7.48px 0 0 0;line-height:1;height:34px;display:inline-block;text-align:center;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.flatpickr-current-month span.cur-month{font-family:inherit;font-weight:700;color:inherit;display:inline-block;margin-left:.5ch;padding:0}.flatpickr-current-month span.cur-month:hover{background:rgba(0,0,0,0.05)}.flatpickr-current-month .numInputWrapper{width:6ch;width:7ch\0;display:inline-block}.flatpickr-current-month .numInputWrapper span.arrowUp:after{border-bottom-color:rgba(0,0,0,0.9)}.flatpickr-current-month .numInputWrapper span.arrowDown:after{border-top-color:rgba(0,0,0,0.9)}.flatpickr-current-month input.cur-year{background:transparent;-webkit-box-sizing:border-box;box-sizing:border-box;color:inherit;cursor:text;padding:0 0 0 .5ch;margin:0;display:inline-block;font-size:inherit;font-family:inherit;font-weight:300;line-height:inherit;height:auto;border:0;border-radius:0;vertical-align:initial;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield}.flatpickr-current-month input.cur-year:focus{outline:0}.flatpickr-current-month input.cur-year[disabled],.flatpickr-current-month input.cur-year[disabled]:hover{font-size:100%;color:rgba(0,0,0,0.5);background:transparent;pointer-events:none}.flatpickr-current-month .flatpickr-monthDropdown-months{appearance:menulist;background:transparent;border:none;border-radius:0;box-sizing:border-box;color:inherit;cursor:pointer;font-size:inherit;font-family:inherit;font-weight:300;height:auto;line-height:inherit;margin:-1px 0 0 0;outline:none;padding:0 0 0 .5ch;position:relative;vertical-align:initial;-webkit-box-sizing:border-box;-webkit-appearance:menulist;-moz-appearance:menulist;width:auto}.flatpickr-current-month .flatpickr-monthDropdown-months:focus,.flatpickr-current-month .flatpickr-monthDropdown-months:active{outline:none}.flatpickr-current-month .flatpickr-monthDropdown-months:hover{background:rgba(0,0,0,0.05)}.flatpickr-current-month .flatpickr-monthDropdown-months .flatpickr-monthDropdown-month{background-color:transparent;outline:none;padding:0}.flatpickr-weekdays{background:transparent;text-align:center;overflow:hidden;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;height:28px}.flatpickr-weekdays .flatpickr-weekdaycontainer{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}span.flatpickr-weekday{cursor:default;font-size:90%;background:transparent;color:rgba(0,0,0,0.54);line-height:1;margin:0;text-align:center;display:block;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;font-weight:bolder}.dayContainer,.flatpickr-weeks{padding:1px 0 0 0}.flatpickr-days{position:relative;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;width:307.875px}.flatpickr-days:focus{outline:0}.dayContainer{padding:0;outline:0;text-align:left;width:307.875px;min-width:307.875px;max-width:307.875px;-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block;display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-wrap:wrap;-ms-flex-pack:justify;-webkit-justify-content:space-around;justify-content:space-around;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);opacity:1}.dayContainer + .dayContainer{-webkit-box-shadow:-1px 0 0 #e6e6e6;box-shadow:-1px 0 0 #e6e6e6}.flatpickr-day{background:none;border:1px solid transparent;border-radius:150px;-webkit-box-sizing:border-box;box-sizing:border-box;color:#393939;cursor:pointer;font-weight:400;width:14.2857143%;-webkit-flex-basis:14.2857143%;-ms-flex-preferred-size:14.2857143%;flex-basis:14.2857143%;max-width:39px;height:39px;line-height:39px;margin:0;display:inline-block;position:relative;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;text-align:center}.flatpickr-day.inRange,.flatpickr-day.prevMonthDay.inRange,.flatpickr-day.nextMonthDay.inRange,.flatpickr-day.today.inRange,.flatpickr-day.prevMonthDay.today.inRange,.flatpickr-day.nextMonthDay.today.inRange,.flatpickr-day:hover,.flatpickr-day.prevMonthDay:hover,.flatpickr-day.nextMonthDay:hover,.flatpickr-day:focus,.flatpickr-day.prevMonthDay:focus,.flatpickr-day.nextMonthDay:focus{cursor:pointer;outline:0;background:#e6e6e6;border-color:#e6e6e6}.flatpickr-day.today{border-color:#959ea9}.flatpickr-day.today:hover,.flatpickr-day.today:focus{border-color:#959ea9;background:#959ea9;color:#fff}.flatpickr-day.selected,.flatpickr-day.startRange,.flatpickr-day.endRange,.flatpickr-day.selected.inRange,.flatpickr-day.startRange.inRange,.flatpickr-day.endRange.inRange,.flatpickr-day.selected:focus,.flatpickr-day.startRange:focus,.flatpickr-day.endRange:focus,.flatpickr-day.selected:hover,.flatpickr-day.startRange:hover,.flatpickr-day.endRange:hover,.flatpickr-day.selected.prevMonthDay,.flatpickr-day.startRange.prevMonthDay,.flatpickr-day.endRange.prevMonthDay,.flatpickr-day.selected.nextMonthDay,.flatpickr-day.startRange.nextMonthDay,.flatpickr-day.endRange.nextMonthDay{background:#569ff7;-webkit-box-shadow:none;box-shadow:none;color:#fff;border-color:#569ff7}.flatpickr-day.selected.startRange,.flatpickr-day.startRange.startRange,.flatpickr-day.endRange.startRange{border-radius:50px 0 0 50px}.flatpickr-day.selected.endRange,.flatpickr-day.startRange.endRange,.flatpickr-day.endRange.endRange{border-radius:0 50px 50px 0}.flatpickr-day.selected.startRange + .endRange:not(:nth-child(7n+1)),.flatpickr-day.startRange.startRange + .endRange:not(:nth-child(7n+1)),.flatpickr-day.endRange.startRange + .endRange:not(:nth-child(7n+1)){-webkit-box-shadow:-10px 0 0 #569ff7;box-shadow:-10px 0 0 #569ff7}.flatpickr-day.selected.startRange.endRange,.flatpickr-day.startRange.startRange.endRange,.flatpickr-day.endRange.startRange.endRange{border-radius:50px}.flatpickr-day.inRange{border-radius:0;-webkit-box-shadow:-5px 0 0 #e6e6e6,5px 0 0 #e6e6e6;box-shadow:-5px 0 0 #e6e6e6,5px 0 0 #e6e6e6}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover,.flatpickr-day.prevMonthDay,.flatpickr-day.nextMonthDay,.flatpickr-day.notAllowed,.flatpickr-day.notAllowed.prevMonthDay,.flatpickr-day.notAllowed.nextMonthDay{color:rgba(57,57,57,0.3);background:transparent;border-color:transparent;cursor:default}.flatpickr-day.flatpickr-disabled,.flatpickr-day.flatpickr-disabled:hover{cursor:not-allowed;color:rgba(57,57,57,0.1)}.flatpickr-day.week.selected{border-radius:0;-webkit-box-shadow:-5px 0 0 #569ff7,5px 0 0 #569ff7;box-shadow:-5px 0 0 #569ff7,5px 0 0 #569ff7}.flatpickr-day.hidden{visibility:hidden}.rangeMode .flatpickr-day{margin-top:1px}.flatpickr-weekwrapper{float:left}.flatpickr-weekwrapper .flatpickr-weeks{padding:0 12px;-webkit-box-shadow:1px 0 0 #e6e6e6;box-shadow:1px 0 0 #e6e6e6}.flatpickr-weekwrapper .flatpickr-weekday{float:none;width:100%;line-height:28px}.flatpickr-weekwrapper span.flatpickr-day,.flatpickr-weekwrapper span.flatpickr-day:hover{display:block;width:100%;max-width:none;color:rgba(57,57,57,0.3);background:transparent;cursor:default;border:none}.flatpickr-innerContainer{display:block;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}.flatpickr-rContainer{display:inline-block;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box}.flatpickr-time{text-align:center;outline:0;display:block;height:0;line-height:40px;max-height:40px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.flatpickr-time:after{content:"";display:table;clear:both}.flatpickr-time .numInputWrapper{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;width:40%;height:40px;float:left}.flatpickr-time .numInputWrapper span.arrowUp:after{border-bottom-color:#393939}.flatpickr-time .numInputWrapper span.arrowDown:after{border-top-color:#393939}.flatpickr-time.hasSeconds .numInputWrapper{width:26%}.flatpickr-time.time24hr .numInputWrapper{width:49%}.flatpickr-time input{background:transparent;-webkit-box-shadow:none;box-shadow:none;border:0;border-radius:0;text-align:center;margin:0;padding:0;height:inherit;line-height:inherit;color:#393939;font-size:14px;position:relative;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield}.flatpickr-time input.flatpickr-hour{font-weight:bold}.flatpickr-time input.flatpickr-minute,.flatpickr-time input.flatpickr-second{font-weight:400}.flatpickr-time input:focus{outline:0;border:0}.flatpickr-time .flatpickr-time-separator,.flatpickr-time .flatpickr-am-pm{height:inherit;float:left;line-height:inherit;color:#393939;font-weight:bold;width:2%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-align-self:center;-ms-flex-item-align:center;align-self:center}.flatpickr-time .flatpickr-am-pm{outline:0;width:18%;cursor:pointer;text-align:center;font-weight:400}.flatpickr-time input:hover,.flatpickr-time .flatpickr-am-pm:hover,.flatpickr-time input:focus,.flatpickr-time .flatpickr-am-pm:focus{background:#eee}.flatpickr-input[readonly]{cursor:pointer}@-webkit-keyframes fpFadeInDown{from{opacity:0;-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0)}to{opacity:1;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}@keyframes fpFadeInDown{from{opacity:0;-webkit-transform:translate3d(0,-20px,0);transform:translate3d(0,-20px,0)}to{opacity:1;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}}</style>
<style>
.multiselect-wrapper{width:180px;display:inline-block;white-space:nowrap;font-size:12px;font-family:"Segoe UI",Verdana,Helvetica,Sans-Serif;}.multiselect-wrapper .multiselect-input{width:100%;padding-right:50px;}.multiselect-wrapper label{display:block;font-size:12px;font-weight:600;}.multiselect-wrapper .multiselect-list{z-index:1;position:absolute;display:none;background-color:white;border:1px solid grey;border-bottom-left-radius:2px;border-bottom-right-radius:2px;margin-top:-2px;}.multiselect-wrapper .multiselect-list.active{display:block;}.multiselect-wrapper .multiselect-list>span{font-weight:bold;}.multiselect-wrapper .multiselect-list .multiselect-checkbox{margin-right:2px;}.multiselect-wrapper .multiselect-list>span,.multiselect-wrapper .multiselect-list li{cursor:default;}.multiselect-wrapper .multiselect-list{padding:5px;min-width:200px;}.multiselect-wrapper ul{list-style:none;display:block;position:relative;padding:0px;margin:0px;max-height:200px;overflow-y:auto;overflow-x:hidden;}.multiselect-wrapper ul li{padding-right:20px;display:block;}.multiselect-wrapper ul li.active{background-color:rgb(0,102,255);color:white;}.multiselect-wrapper ul li:hover{background-color:rgb(0,102,255);color:white;}.multiselect-input-div{height:34px;}.multiselect-input-div input{border:1px solid #ababab;background:#fff;margin:5px 0 6px 0;padding:5px;vertical-align:middle;}.multiselect-count{position:relative;text-align:center;border-radius:2px;background-color:lightblue;display:inline-block !important;padding:2px 7px;left:-45px;}.multiselect-wrapper.disabled .multiselect-dropdown-arrow{border-top:5px solid lightgray;}.multiselect-wrapper.disabled .multiselect-count{background-color:lightgray;}.multiselect-dropdown-arrow{width:0;height:0;border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid black;position:absolute;line-height:20px;text-align:center;display:inline-block !important;margin-top:17px;margin-left:-42px;}html{height:100%;}#cover{position:fixed;top:0;left:0;right:0;bottom:0;z-index:3;background-color:white;}body{margin:0;padding:0;color:gray;height:100%;}a{color:gray;}h2,h3,h4{margin:0;}h2.title{display:inline-block;}#pagetitle{color:dimgray;}.fakehr{padding-top:8px;padding-bottom:8px;width:100%;}.fakehrinside{height:2px;background:gray;}#titlehr{padding-top:2px;}.titlebox{text-align:center;}.multiselect-wrapper{min-width:140px;width:140px;text-align:left;margin-left:20px;position:relative;top:-2px;}#currentsqms{display:none;}.clickable{text-decoration:underline;cursor:pointer;}.padded{margin-left:3vw;margin-right:3vw;}.label{width:10vw;display:inline-block;}.defaultcursor{cursor:default;}.value{width:200px;display:inline-block;text-align:right;}.container,.optionscontainer{padding-left:4vw;padding-right:4vw;width:90vw;}.container{display:flex;justify-content:space-between;}.optionscontainer{text-align:center;}#loadbutton{margin-left:20px;}.box{margin:0;display:flex;align-items:flex-end;justify-content:flex-end;}.datetimebox{display:inline-block;text-align:center;}.datetimebox .input{display:inline;}.optiontext{margin-left:5px;margin-right:5px;}.tooltip{position:relative;display:inline-block;}.tooltip .lefttooltiptext,.tooltip .righttooltiptext,.tooltip .toptooltiptext,.tooltip .bottomtooltiptext,.tooltip .multitooltiptext{font-size:85%;padding:5px;visibility:hidden;background-color:black;color:#fff;text-align:center;border-radius:6px;position:absolute;z-index:1;transition:0s visibility;}.lefttooltiptext{top:-5px;right:105%;}.multitooltiptext{width:20vw;top:5px;left:140%;}.righttooltiptext{top:-5px;left:105%;}.toptooltiptext,.bottomtooltiptext{width:12vw;left:50%;margin-left:-6vw;}.toptooltiptext{bottom:100%;}.bottomtooltiptext{top:100%;}.tooltip:hover .lefttooltiptext,.tooltip:hover .righttooltiptext,.tooltip:hover .toptooltiptext,.tooltip:hover .bottomtooltiptext,.tooltip:hover .multitooltiptext{visibility:visible;transition-delay:1.5s;z-index:6;}#nightly{width:6em;}#monthly{display:none;}.monthlydropdown{position:relative;display:inline-block;}.monthlydropbutton{border:1px solid gray;background-color:white;color:gray;padding-top:2px;padding-left:5px;padding-right:4px;cursor:pointer;}.monthlydropbutton:hover,.monthlydropbutton:focus{background-color:rgb(225,225,225);}.monthlycontent{display:none;position:absolute;background-color:#f1f1f1;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);z-index:1;}.monthlycontent a{display:block;font-size:90%;border-bottom:1px solid gray;position:relative;color:gray;min-width:80px;padding:2px 16px;text-decoration:none;display:block;background-color:#f1f1f1;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);z-index:1;}.monthlycontent a:hover{background-color:#ddd;}.monthlyshow{display:block;}#startdatetime,#enddatetime{width:9em;}.contextmenu{visibility:hidden;position:fixed;top:0;left:0;border:1px solid #dedede;background:white;list-style:none;border-radius:0 6px 6px;padding:0 2px;z-index:2;}.menu-item,.menu-item-no-underline{font-family:sans-serif;padding:4px 10px;}.menu-item{border-bottom:1px solid #eee;}.menu-item select,.menu-item-no-underline select{padding-left:3px;margin-top:-3px;}.menu-item:hover{background:#dddddd;text-decoration:underline;cursor:pointer;}.menu-separator{height:2px;background:#999;}.menu-small-no-underline{font-size:85%;}.menu-item:hover .menu-small-no-underline{text-decoration:none;}.graphtext{margin-top:10px;margin-bottom:0;}.graphtextstats{margin-top:0;margin-bottom:2px;}#leftarrow,#rightarrow,#leftarrowgrid,#rightarrowgrid{margin-top:auto;margin-bottom:auto;cursor:pointer;}#leftarrow,#leftarrowgrid{margin-left:15px;float:left;}#rightarrow,#rightarrowgrid{margin-right:15px;float:right;}.arrow{border:solid dimgray;border-width:0 3px 3px 0;display:inline-block;padding:3px;}.rightarrow{transform:rotate(-45deg);-webkit-transform:rotate(-45deg);}.leftarrow{transform:rotate(135deg);-webkit-transform:rotate(135deg);}.gridarrow{border:solid lightgray;border-width:0 5px 5px 0;display:inline-block;padding:5px;}.gridrightarrow{transform:rotate(-45deg);-webkit-transform:rotate(-45deg);}.gridleftarrow{transform:rotate(135deg);-webkit-transform:rotate(135deg);}.shiftleft{margin-left:-5px;}.shiftright{margin-right:-5px;}#graphtitle,#graphtitlegrid,.graphsubtitle{color:dimgray;margin:0;text-align:center;width:100%;}.graphsubtitle{font-weight:normal;}#statsbox{display:flex;justify-content:center;align-items:center;}#stats{display:table;}.statsrow{display:table-row;padding:5px;}.statsitem{display:table-cell;text-align:left;padding-left:5px;padding-right:5px;padding-top:2px;padding-bottom:1px;}.chartbox{position:relative;width:100%;}#addfileclose{margin-top:10px;}.initialfileinput,.addfileinput{width:60vw;position:absolute;top:20%;left:50%;transform:translate(-50%,-50%);padding-left:2vw;padding-right:2vw;padding-top:5vh;padding-bottom:5vh;background-color:white;color:gray;text-align:center;border-radius:6px;z-index:1;}.initialfileinputcover,.addfileinputcover{display:none;position:fixed;top:0;left:0;right:0;bottom:0;z-index:2;background-color:rgba(225,225,225,0.7);}.uploadtext,.uploadtextsmall{margin-bottom:10px;display:block;}input[type="file"]{display:none;}.sqmfileupload{border:1px solid #ccc;display:inline-block;padding:6px 12px;cursor:pointer;}.uploadtextsmall{font-size:90%;}#thegraph{position:relative;}#timechartgridholder{display:none;z-index:5;position:absolute;width:99%;margin-left:0.5%;height:100%;background-color:rgba(225,225,225,0.9);border-radius:10px;opacity:0.0;transition:opacity 0.5s;}#timechartgrid{width:100%;height:100%;}#leftarrowgrid,#rightarrowgrid{display:flex;}#leftarrowgrid{margin-left:5px;}#rightarrowgrid{margin-right:5px;}#timechartgridtitle,#leftarrowgrid,#rightarrowgrid,#graphtitlegrid{color:rgb(255,255,255);}.timechartgridcontainer{width:100%;height:100%;display:flex;justify-content:space-between;}.timechartgridcontainer::before{content:"";}.timechartgridcontainer::after{content:"";}.timechartgridcolumn{display:flex;flex-direction:column;width:33%;height:100%;justify-content:space-between;}.timechartgridcolumn::before{content:"";}.timechartgridcolumn::after{content:"";}.timechartgriditem{width:100%;background:white;text-align:center;cursor:pointer;}.timechartitemtitle{padding-top:3px;cursor:pointer;font-size:80%;}#imagepopup{display:none;z-index:5;position:absolute;top:0;left:0;right:0;bottom:0;width:100%;width:-moz-available;width:-webkit-fill-available;width:fill-available;height:100%;height:-moz-available;height:-webkit-fill-available;height:fill-available;background-color:rgba(225,225,225,0.7);}#imagebackground{position:fixed;top:10vh;left:10vw;right:10vw;bottom:10vh;text-align:center;}.imagecontainer{text-align:center;}#theimage{max-width:76vw;max-height:76vh;width:auto;height:auto;padding-top:2vh;padding-bottom:2vh;padding-right:2vh;padding-left:2vh;background-color:rgb(0,0,0);border-radius:10px;}#theimagetext{color:rgb(225,225,225);padding-bottom:0.5em;height:1em;}#chartkeyhelper{display:flex;justify-content:center;align-items:center;}.keyitem{margin-left:20px;margin-right:20px;}.keysun,.keymoon,.keyclouds{border-color:#3e95cd;border-width:thin;border-style:solid;display:inline-block;height:10px;width:10px;border-radius:50%;font-size:90%;}#keymw1a{border-color:#3e95cd;border-width:thin;border-style:solid;display:inline-block;height:8px;width:8px;margin-bottom:1px;font-size:90%;border-radius:0%;transform:rotate(45deg);}.keylinecontainer,.keylinecontainerunknown,.halfkeylinecontainer{display:inline-block;height:10px;width:10px;position:relative;}.keylinecontainerunknown{width:36px;margin-left:10px;height:10px;}.keyline,.halfkeyline,.keylinedashed{position:absolute;top:4px;background:black;height:2px;transform:translateY(-50%);width:10px;display:inline-block;}.keylinedash{height:0px;border-top:2px #3e95cd solid;width:6px;margin-right:2px;display:inline-block;}.keylinedashed{cursor:default;top:-8px;height:1px;width:36px;margin-left:0;background:none;}.halfkeylinecontainer{width:5px;}.halfkeyline{width:5px;}.tooltip .keytooltiptext{font-size:85%;padding:5px;background-color:black;color:#fff;text-align:center;border-radius:6px;position:absolute;z-index:1;width:12vw;left:50%;margin-left:-6vw;margin-bottom:3px;bottom:100%;transition:0s visibility;visibility:hidden;}.tooltip:hover .keytooltiptext{visibility:visible;transition-delay:0.25s;}.loadingring{width:80px;height:80px;position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);z-index:10;}.loadingring:after{content:" ";display:block;width:64px;height:64px;margin:8px;border-radius:50%;border:6px solid #aaa;border-color:#aaa transparent #aaa transparent;animation:loadingring 1.2s linear infinite;}@keyframes loadingring{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}#options,#bestbox,#statsbox,#latestbox,#barbox,#chartkey{max-height:0;overflow:hidden;transition:max-height 0.3s ease-in-out;}#latestbox{animation-direction:reverse;margin-bottom:4px;}#barbox{transition:max-height 0.6s ease-in-out;}.chartjs-tooltip{opacity:0;visibility:hidden;position:absolute;transition:opacity 0.33s,visibility 0.5s;}#legendtooltip{display:none;background:black;border-radius:8px;color:white;position:absolute;z-index:2;font-size:85%;padding-left:5px;padding-right:5px;padding-top:3px;padding-bottom:3px;}#legendtooltipclick{width:100%;text-align:center;font-size:80%;margin-top:3px;}.thumbnail{background-color:#000;border-radius:6px;padding:3px;}#aboutlink,#datafileslink,#userguidelink{display:none;}#aboutpage{position:fixed;top:20%;left:50%;transform:translate(-50%,0%);opacity:0;display:none;transition:opacity 0.3s;}.aboutcontainer{position:relative;padding-top:10px;padding-bottom:10px;padding-left:25px;padding-right:25px;text-align:center;display:flex;flex-direction:column;justify-content:space-between;width:100%;height:100%;background:rgba(225,225,225,0.9);border-radius:10px;}.abouthref{margin-top:10px;font-size:120%;}.close{position:absolute;width:16px;height:16px;opacity:0.75;border:1px solid #333;cursor:pointer;}#userguidepage{z-index:10;position:fixed;top:2.5%;bottom:5%;left:5%;width:90%;transform:translate(-2.5%,0%);opacity:0;display:none;transition:opacity 0.3s;}.userguidetitle{position:relative;padding-top:10px;padding-bottom:10px;padding-left:25px;padding-right:25px;text-align:center;display:flex;flex-direction:column;justify-content:space-between;width:100%;}.userguidecontainer{position:relative;padding-top:10px;padding-bottom:10px;padding-left:25px;padding-right:25px;text-align:left;display:flex;flex-direction:column;justify-content:space-between;width:100%;height:100%;background:rgba(225,225,225,0.9);border-radius:10px;}.userguidecontainer h1,.userguidecontainer h2,.userguidecontainer h3{text-align:center;}#userguidetext{overflow-y:scroll;border:1px darkgray solid;padding-left:20px;padding-right:20px;margin-bottom:10px;background:rgb(255,255,255);}#imageclose{right:10px;top:10px;background:#bbb;}#closegrid{right:5px;top:5px;}#closeabout,#closeuserguide{right:10px;top:10px;}.close:hover{opacity:1.0;}.close:before,.close:after{position:absolute;left:7.5px;content:' ';height:16.5px;width:1px;background-color:#333;}.close:before{transform:rotate(45deg);}.close:after{transform:rotate(-45deg);}@media only screen and (max-width:620px){.multiselect-wrapper{margin:0;}.container{display:block;justify-content:start;}.box{width:100%;display:block;align-items:start;justify-content:start;display:table;}#showhideoptions{display:none;}#chartjs-tooltip{display:none;}.keyitem{text-align:center;}.keybox{text-align:left;display:block;}#gridbutton{display:none;}}@media only screen and (max-width:1000px){.optionscontainer .box input{display:block;}#sixmonths{display:none;}.datetimebox .input{display:block;}.optionitem,.optiontext,.datetimebox{vertical-align:top;}.tooltip .lefttooltiptext,.tooltip .righttooltiptext,.tooltip .toptooltiptext,.tooltip .bottomtooltiptext,.tooltip .multitooltiptext{display:none;}.nomobile{display:none;}.keyitem{text-align:center;}.keybox{text-align:left;display:block;}}@media only screen and (max-height:400px){.showhidebest,.showhidelatest,.lifileinput,.filesep{display:none;}}@media only screen and (max-height:600px){.limin,.limax,.showhidelegend,.showhidekey,.datafileslink{display:none;}}
</style>
<script type="text/javascript">
var sqmConfig;
if (!sqmConfig) {
	sqmCOnfig = {};
}
sqmConfig.fetchUrl = false;
sqmConfig.loadInBackground = false;
sqmConfig.showLatitudeLongitude = true;
/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Chart=e()}(this,(function(){"use strict";function t(){}const e=function(){let t=0;return function(){return t++}}();function i(t){return null==t}function s(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function n(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}const o=t=>("number"==typeof t||t instanceof Number)&&isFinite(+t);function a(t,e){return o(t)?t:e}function r(t,e){return void 0===t?e:t}const l=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100:t/e,h=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function c(t,e,i){if(t&&"function"==typeof t.call)return t.apply(i,e)}function d(t,e,i,o){let a,r,l;if(s(t))if(r=t.length,o)for(a=r-1;a>=0;a--)e.call(i,t[a],a);else for(a=0;a<r;a++)e.call(i,t[a],a);else if(n(t))for(l=Object.keys(t),r=l.length,a=0;a<r;a++)e.call(i,t[l[a]],l[a])}function u(t,e){let i,s,n,o;if(!t||!e||t.length!==e.length)return!1;for(i=0,s=t.length;i<s;++i)if(n=t[i],o=e[i],n.datasetIndex!==o.datasetIndex||n.index!==o.index)return!1;return!0}function f(t){if(s(t))return t.map(f);if(n(t)){const e=Object.create(null),i=Object.keys(t),s=i.length;let n=0;for(;n<s;++n)e[i[n]]=f(t[i[n]]);return e}return t}function g(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function p(t,e,i,s){if(!g(t))return;const o=e[t],a=i[t];n(o)&&n(a)?m(o,a,s):e[t]=f(a)}function m(t,e,i){const o=s(e)?e:[e],a=o.length;if(!n(t))return t;const r=(i=i||{}).merger||p;for(let s=0;s<a;++s){if(!n(e=o[s]))continue;const a=Object.keys(e);for(let s=0,n=a.length;s<n;++s)r(a[s],t,e,i)}return t}function b(t,e){return m(t,e,{merger:x})}function x(t,e,i){if(!g(t))return;const s=e[t],o=i[t];n(s)&&n(o)?b(s,o):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=f(o))}const _={"":t=>t,x:t=>t.x,y:t=>t.y};function y(t,e){const i=_[e]||(_[e]=function(t){const e=v(t);return t=>{for(const i of e){if(""===i)break;t=t&&t[i]}return t}}(e));return i(t)}function v(t){const e=t.split("."),i=[];let s="";for(const t of e)s+=t,s.endsWith("\\")?s=s.slice(0,-1)+".":(i.push(s),s="");return i}function w(t){return t.charAt(0).toUpperCase()+t.slice(1)}const M=t=>void 0!==t,k=t=>"function"==typeof t,S=(t,e)=>{if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0};function P(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}const D=Math.PI,O=2*D,C=O+D,A=Number.POSITIVE_INFINITY,T=D/180,L=D/2,E=D/4,R=2*D/3,I=Math.log10,z=Math.sign;function F(t){const e=Math.round(t);t=N(t,e,t/1e3)?e:t;const i=Math.pow(10,Math.floor(I(t))),s=t/i;return(s<=1?1:s<=2?2:s<=5?5:10)*i}function V(t){const e=[],i=Math.sqrt(t);let s;for(s=1;s<i;s++)t%s==0&&(e.push(s),e.push(t/s));return i===(0|i)&&e.push(i),e.sort(((t,e)=>t-e)).pop(),e}function B(t){return!isNaN(parseFloat(t))&&isFinite(t)}function N(t,e,i){return Math.abs(t-e)<i}function W(t,e){const i=Math.round(t);return i-e<=t&&i+e>=t}function j(t,e,i){let s,n,o;for(s=0,n=t.length;s<n;s++)o=t[s][i],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function H(t){return t*(D/180)}function $(t){return t*(180/D)}function Y(t){if(!o(t))return;let e=1,i=0;for(;Math.round(t*e)/e!==t;)e*=10,i++;return i}function U(t,e){const i=e.x-t.x,s=e.y-t.y,n=Math.sqrt(i*i+s*s);let o=Math.atan2(s,i);return o<-.5*D&&(o+=O),{angle:o,distance:n}}function X(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function q(t,e){return(t-e+C)%O-D}function K(t){return(t%O+O)%O}function G(t,e,i,s){const n=K(t),o=K(e),a=K(i),r=K(o-n),l=K(a-n),h=K(n-o),c=K(n-a);return n===o||n===a||s&&o===a||r>l&&h<c}function Z(t,e,i){return Math.max(e,Math.min(i,t))}function J(t){return Z(t,-32768,32767)}function Q(t,e,i,s=1e-6){return t>=Math.min(e,i)-s&&t<=Math.max(e,i)+s}function tt(t,e,i){i=i||(i=>t[i]<e);let s,n=t.length-1,o=0;for(;n-o>1;)s=o+n>>1,i(s)?o=s:n=s;return{lo:o,hi:n}}const et=(t,e,i,s)=>tt(t,i,s?s=>t[s][e]<=i:s=>t[s][e]<i),it=(t,e,i)=>tt(t,i,(s=>t[s][e]>=i));function st(t,e,i){let s=0,n=t.length;for(;s<n&&t[s]<e;)s++;for(;n>s&&t[n-1]>i;)n--;return s>0||n<t.length?t.slice(s,n):t}const nt=["push","pop","shift","splice","unshift"];function ot(t,e){t._chartjs?t._chartjs.listeners.push(e):(Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),nt.forEach((e=>{const i="_onData"+w(e),s=t[e];Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value(...e){const n=s.apply(this,e);return t._chartjs.listeners.forEach((t=>{"function"==typeof t[i]&&t[i](...e)})),n}})})))}function at(t,e){const i=t._chartjs;if(!i)return;const s=i.listeners,n=s.indexOf(e);-1!==n&&s.splice(n,1),s.length>0||(nt.forEach((e=>{delete t[e]})),delete t._chartjs)}function rt(t){const e=new Set;let i,s;for(i=0,s=t.length;i<s;++i)e.add(t[i]);return e.size===s?t:Array.from(e)}const lt="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function ht(t,e,i){const s=i||(t=>Array.prototype.slice.call(t));let n=!1,o=[];return function(...i){o=s(i),n||(n=!0,lt.call(window,(()=>{n=!1,t.apply(e,o)})))}}function ct(t,e){let i;return function(...s){return e?(clearTimeout(i),i=setTimeout(t,e,s)):t.apply(this,s),e}}const dt=t=>"start"===t?"left":"end"===t?"right":"center",ut=(t,e,i)=>"start"===t?e:"end"===t?i:(e+i)/2,ft=(t,e,i,s)=>t===(s?"left":"right")?i:"center"===t?(e+i)/2:e;function gt(t,e,i){const s=e.length;let n=0,o=s;if(t._sorted){const{iScale:a,_parsed:r}=t,l=a.axis,{min:h,max:c,minDefined:d,maxDefined:u}=a.getUserBounds();d&&(n=Z(Math.min(et(r,a.axis,h).lo,i?s:et(e,l,a.getPixelForValue(h)).lo),0,s-1)),o=u?Z(Math.max(et(r,a.axis,c,!0).hi+1,i?0:et(e,l,a.getPixelForValue(c),!0).hi+1),n,s)-n:s-n}return{start:n,count:o}}function pt(t){const{xScale:e,yScale:i,_scaleRanges:s}=t,n={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!s)return t._scaleRanges=n,!0;const o=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==i.min||s.ymax!==i.max;return Object.assign(s,n),o}var mt=new class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,s){const n=e.listeners[s],o=e.duration;n.forEach((s=>s({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)})))}_refresh(){this._request||(this._running=!0,this._request=lt.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((i,s)=>{if(!i.running||!i.items.length)return;const n=i.items;let o,a=n.length-1,r=!1;for(;a>=0;--a)o=n[a],o._active?(o._total>i.duration&&(i.duration=o._total),o.tick(t),r=!0):(n[a]=n[n.length-1],n.pop());r&&(s.draw(),this._notify(s,i,t,"progress")),n.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),e+=n.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}};
/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function bt(t){return t+.5|0}const xt=(t,e,i)=>Math.max(Math.min(t,i),e);function _t(t){return xt(bt(2.55*t),0,255)}function yt(t){return xt(bt(255*t),0,255)}function vt(t){return xt(bt(t/2.55)/100,0,1)}function wt(t){return xt(bt(100*t),0,100)}const Mt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},kt=[..."0123456789ABCDEF"],St=t=>kt[15&t],Pt=t=>kt[(240&t)>>4]+kt[15&t],Dt=t=>(240&t)>>4==(15&t);function Ot(t){var e=(t=>Dt(t.r)&&Dt(t.g)&&Dt(t.b)&&Dt(t.a))(t)?St:Pt;return t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0}const Ct=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function At(t,e,i){const s=e*Math.min(i,1-i),n=(e,n=(e+t/30)%12)=>i-s*Math.max(Math.min(n-3,9-n,1),-1);return[n(0),n(8),n(4)]}function Tt(t,e,i){const s=(s,n=(s+t/60)%6)=>i-i*e*Math.max(Math.min(n,4-n,1),0);return[s(5),s(3),s(1)]}function Lt(t,e,i){const s=At(t,1,.5);let n;for(e+i>1&&(n=1/(e+i),e*=n,i*=n),n=0;n<3;n++)s[n]*=1-e-i,s[n]+=e;return s}function Et(t){const e=t.r/255,i=t.g/255,s=t.b/255,n=Math.max(e,i,s),o=Math.min(e,i,s),a=(n+o)/2;let r,l,h;return n!==o&&(h=n-o,l=a>.5?h/(2-n-o):h/(n+o),r=function(t,e,i,s,n){return t===n?(e-i)/s+(e<i?6:0):e===n?(i-t)/s+2:(t-e)/s+4}(e,i,s,h,n),r=60*r+.5),[0|r,l||0,a]}function Rt(t,e,i,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,i,s)).map(yt)}function It(t,e,i){return Rt(At,t,e,i)}function zt(t){return(t%360+360)%360}function Ft(t){const e=Ct.exec(t);let i,s=255;if(!e)return;e[5]!==i&&(s=e[6]?_t(+e[5]):yt(+e[5]));const n=zt(+e[2]),o=+e[3]/100,a=+e[4]/100;return i="hwb"===e[1]?function(t,e,i){return Rt(Lt,t,e,i)}(n,o,a):"hsv"===e[1]?function(t,e,i){return Rt(Tt,t,e,i)}(n,o,a):It(n,o,a),{r:i[0],g:i[1],b:i[2],a:s}}const Vt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Bt={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Nt;function Wt(t){Nt||(Nt=function(){const t={},e=Object.keys(Bt),i=Object.keys(Vt);let s,n,o,a,r;for(s=0;s<e.length;s++){for(a=r=e[s],n=0;n<i.length;n++)o=i[n],r=r.replace(o,Vt[o]);o=parseInt(Bt[a],16),t[r]=[o>>16&255,o>>8&255,255&o]}return t}(),Nt.transparent=[0,0,0,0]);const e=Nt[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}const jt=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Ht=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,$t=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function Yt(t,e,i){if(t){let s=Et(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*i,0===e?360:1)),s=It(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function Ut(t,e){return t?Object.assign(e||{},t):t}function Xt(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=yt(t[3]))):(e=Ut(t,{r:0,g:0,b:0,a:1})).a=yt(e.a),e}function qt(t){return"r"===t.charAt(0)?function(t){const e=jt.exec(t);let i,s,n,o=255;if(e){if(e[7]!==i){const t=+e[7];o=e[8]?_t(t):xt(255*t,0,255)}return i=+e[1],s=+e[3],n=+e[5],i=255&(e[2]?_t(i):xt(i,0,255)),s=255&(e[4]?_t(s):xt(s,0,255)),n=255&(e[6]?_t(n):xt(n,0,255)),{r:i,g:s,b:n,a:o}}}(t):Ft(t)}class Kt{constructor(t){if(t instanceof Kt)return t;const e=typeof t;let i;var s,n,o;"object"===e?i=Xt(t):"string"===e&&(o=(s=t).length,"#"===s[0]&&(4===o||5===o?n={r:255&17*Mt[s[1]],g:255&17*Mt[s[2]],b:255&17*Mt[s[3]],a:5===o?17*Mt[s[4]]:255}:7!==o&&9!==o||(n={r:Mt[s[1]]<<4|Mt[s[2]],g:Mt[s[3]]<<4|Mt[s[4]],b:Mt[s[5]]<<4|Mt[s[6]],a:9===o?Mt[s[7]]<<4|Mt[s[8]]:255})),i=n||Wt(t)||qt(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Ut(this._rgb);return t&&(t.a=vt(t.a)),t}set rgb(t){this._rgb=Xt(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${vt(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?Ot(this._rgb):void 0}hslString(){return this._valid?function(t){if(!t)return;const e=Et(t),i=e[0],s=wt(e[1]),n=wt(e[2]);return t.a<255?`hsla(${i}, ${s}%, ${n}%, ${vt(t.a)})`:`hsl(${i}, ${s}%, ${n}%)`}(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,s=t.rgb;let n;const o=e===n?.5:e,a=2*o-1,r=i.a-s.a,l=((a*r==-1?a:(a+r)/(1+a*r))+1)/2;n=1-l,i.r=255&l*i.r+n*s.r+.5,i.g=255&l*i.g+n*s.g+.5,i.b=255&l*i.b+n*s.b+.5,i.a=o*i.a+(1-o)*s.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,i){const s=$t(vt(t.r)),n=$t(vt(t.g)),o=$t(vt(t.b));return{r:yt(Ht(s+i*($t(vt(e.r))-s))),g:yt(Ht(n+i*($t(vt(e.g))-n))),b:yt(Ht(o+i*($t(vt(e.b))-o))),a:t.a+i*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new Kt(this.rgb)}alpha(t){return this._rgb.a=yt(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=bt(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Yt(this._rgb,2,t),this}darken(t){return Yt(this._rgb,2,-t),this}saturate(t){return Yt(this._rgb,1,t),this}desaturate(t){return Yt(this._rgb,1,-t),this}rotate(t){return function(t,e){var i=Et(t);i[0]=zt(i[0]+e),i=It(i),t.r=i[0],t.g=i[1],t.b=i[2]}(this._rgb,t),this}}function Gt(t){return new Kt(t)}function Zt(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function Jt(t){return Zt(t)?t:Gt(t)}function Qt(t){return Zt(t)?t:Gt(t).saturate(.5).darken(.1).hexString()}const te=Object.create(null),ee=Object.create(null);function ie(t,e){if(!e)return t;const i=e.split(".");for(let e=0,s=i.length;e<s;++e){const s=i[e];t=t[s]||(t[s]=Object.create(null))}return t}function se(t,e,i){return"string"==typeof e?m(ie(t,e),i):m(ie(t,""),e)}var ne=new class{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>Qt(e.backgroundColor),this.hoverBorderColor=(t,e)=>Qt(e.borderColor),this.hoverColor=(t,e)=>Qt(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,e){return se(this,t,e)}get(t){return ie(this,t)}describe(t,e){return se(ee,t,e)}override(t,e){return se(te,t,e)}route(t,e,i,s){const o=ie(this,t),a=ie(this,i),l="_"+e;Object.defineProperties(o,{[l]:{value:o[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[l],e=a[s];return n(t)?Object.assign({},e,t):r(t,e)},set(t){this[l]=t}}})}}({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function oe(){return"undefined"!=typeof window&&"undefined"!=typeof document}function ae(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function re(t,e,i){let s;return"string"==typeof t?(s=parseInt(t,10),-1!==t.indexOf("%")&&(s=s/100*e.parentNode[i])):s=t,s}const le=t=>window.getComputedStyle(t,null);function he(t,e){return le(t).getPropertyValue(e)}const ce=["top","right","bottom","left"];function de(t,e,i){const s={};i=i?"-"+i:"";for(let n=0;n<4;n++){const o=ce[n];s[o]=parseFloat(t[e+"-"+o+i])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}function ue(t,e){if("native"in t)return t;const{canvas:i,currentDevicePixelRatio:s}=e,n=le(i),o="border-box"===n.boxSizing,a=de(n,"padding"),r=de(n,"border","width"),{x:l,y:h,box:c}=function(t,e){const i=t.touches,s=i&&i.length?i[0]:t,{offsetX:n,offsetY:o}=s;let a,r,l=!1;if(((t,e,i)=>(t>0||e>0)&&(!i||!i.shadowRoot))(n,o,t.target))a=n,r=o;else{const t=e.getBoundingClientRect();a=s.clientX-t.left,r=s.clientY-t.top,l=!0}return{x:a,y:r,box:l}}(t,i),d=a.left+(c&&r.left),u=a.top+(c&&r.top);let{width:f,height:g}=e;return o&&(f-=a.width+r.width,g-=a.height+r.height),{x:Math.round((l-d)/f*i.width/s),y:Math.round((h-u)/g*i.height/s)}}const fe=t=>Math.round(10*t)/10;function ge(t,e,i,s){const n=le(t),o=de(n,"margin"),a=re(n.maxWidth,t,"clientWidth")||A,r=re(n.maxHeight,t,"clientHeight")||A,l=function(t,e,i){let s,n;if(void 0===e||void 0===i){const o=ae(t);if(o){const t=o.getBoundingClientRect(),a=le(o),r=de(a,"border","width"),l=de(a,"padding");e=t.width-l.width-r.width,i=t.height-l.height-r.height,s=re(a.maxWidth,o,"clientWidth"),n=re(a.maxHeight,o,"clientHeight")}else e=t.clientWidth,i=t.clientHeight}return{width:e,height:i,maxWidth:s||A,maxHeight:n||A}}(t,e,i);let{width:h,height:c}=l;if("content-box"===n.boxSizing){const t=de(n,"border","width"),e=de(n,"padding");h-=e.width+t.width,c-=e.height+t.height}return h=Math.max(0,h-o.width),c=Math.max(0,s?Math.floor(h/s):c-o.height),h=fe(Math.min(h,a,l.maxWidth)),c=fe(Math.min(c,r,l.maxHeight)),h&&!c&&(c=fe(h/2)),{width:h,height:c}}function pe(t,e,i){const s=e||1,n=Math.floor(t.height*s),o=Math.floor(t.width*s);t.height=n/s,t.width=o/s;const a=t.canvas;return a.style&&(i||!a.style.height&&!a.style.width)&&(a.style.height=`${t.height}px`,a.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==s||a.height!==n||a.width!==o)&&(t.currentDevicePixelRatio=s,a.height=n,a.width=o,t.ctx.setTransform(s,0,0,s,0,0),!0)}const me=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(t){}return t}();function be(t,e){const i=he(t,e),s=i&&i.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function xe(t){return!t||i(t.size)||i(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function _e(t,e,i,s,n){let o=e[n];return o||(o=e[n]=t.measureText(n).width,i.push(n)),o>s&&(s=o),s}function ye(t,e,i,n){let o=(n=n||{}).data=n.data||{},a=n.garbageCollect=n.garbageCollect||[];n.font!==e&&(o=n.data={},a=n.garbageCollect=[],n.font=e),t.save(),t.font=e;let r=0;const l=i.length;let h,c,d,u,f;for(h=0;h<l;h++)if(u=i[h],null!=u&&!0!==s(u))r=_e(t,o,a,r,u);else if(s(u))for(c=0,d=u.length;c<d;c++)f=u[c],null==f||s(f)||(r=_e(t,o,a,r,f));t.restore();const g=a.length/2;if(g>i.length){for(h=0;h<g;h++)delete o[a[h]];a.splice(0,g)}return r}function ve(t,e,i){const s=t.currentDevicePixelRatio,n=0!==i?Math.max(i/2,.5):0;return Math.round((e-n)*s)/s+n}function we(t,e){(e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function Me(t,e,i,s){ke(t,e,i,s,null)}function ke(t,e,i,s,n){let o,a,r,l,h,c;const d=e.pointStyle,u=e.rotation,f=e.radius;let g=(u||0)*T;if(d&&"object"==typeof d&&(o=d.toString(),"[object HTMLImageElement]"===o||"[object HTMLCanvasElement]"===o))return t.save(),t.translate(i,s),t.rotate(g),t.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),void t.restore();if(!(isNaN(f)||f<=0)){switch(t.beginPath(),d){default:n?t.ellipse(i,s,n/2,f,0,0,O):t.arc(i,s,f,0,O),t.closePath();break;case"triangle":t.moveTo(i+Math.sin(g)*f,s-Math.cos(g)*f),g+=R,t.lineTo(i+Math.sin(g)*f,s-Math.cos(g)*f),g+=R,t.lineTo(i+Math.sin(g)*f,s-Math.cos(g)*f),t.closePath();break;case"rectRounded":h=.516*f,l=f-h,a=Math.cos(g+E)*l,r=Math.sin(g+E)*l,t.arc(i-a,s-r,h,g-D,g-L),t.arc(i+r,s-a,h,g-L,g),t.arc(i+a,s+r,h,g,g+L),t.arc(i-r,s+a,h,g+L,g+D),t.closePath();break;case"rect":if(!u){l=Math.SQRT1_2*f,c=n?n/2:l,t.rect(i-c,s-l,2*c,2*l);break}g+=E;case"rectRot":a=Math.cos(g)*f,r=Math.sin(g)*f,t.moveTo(i-a,s-r),t.lineTo(i+r,s-a),t.lineTo(i+a,s+r),t.lineTo(i-r,s+a),t.closePath();break;case"crossRot":g+=E;case"cross":a=Math.cos(g)*f,r=Math.sin(g)*f,t.moveTo(i-a,s-r),t.lineTo(i+a,s+r),t.moveTo(i+r,s-a),t.lineTo(i-r,s+a);break;case"star":a=Math.cos(g)*f,r=Math.sin(g)*f,t.moveTo(i-a,s-r),t.lineTo(i+a,s+r),t.moveTo(i+r,s-a),t.lineTo(i-r,s+a),g+=E,a=Math.cos(g)*f,r=Math.sin(g)*f,t.moveTo(i-a,s-r),t.lineTo(i+a,s+r),t.moveTo(i+r,s-a),t.lineTo(i-r,s+a);break;case"line":a=n?n/2:Math.cos(g)*f,r=Math.sin(g)*f,t.moveTo(i-a,s-r),t.lineTo(i+a,s+r);break;case"dash":t.moveTo(i,s),t.lineTo(i+Math.cos(g)*f,s+Math.sin(g)*f)}t.fill(),e.borderWidth>0&&t.stroke()}}function Se(t,e,i){return i=i||.5,!e||t&&t.x>e.left-i&&t.x<e.right+i&&t.y>e.top-i&&t.y<e.bottom+i}function Pe(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function De(t){t.restore()}function Oe(t,e,i,s,n){if(!e)return t.lineTo(i.x,i.y);if("middle"===n){const s=(e.x+i.x)/2;t.lineTo(s,e.y),t.lineTo(s,i.y)}else"after"===n!=!!s?t.lineTo(e.x,i.y):t.lineTo(i.x,e.y);t.lineTo(i.x,i.y)}function Ce(t,e,i,s){if(!e)return t.lineTo(i.x,i.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?i.cp2x:i.cp1x,s?i.cp2y:i.cp1y,i.x,i.y)}function Ae(t,e,n,o,a,r={}){const l=s(e)?e:[e],h=r.strokeWidth>0&&""!==r.strokeColor;let c,d;for(t.save(),t.font=a.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]);i(e.rotation)||t.rotate(e.rotation);e.color&&(t.fillStyle=e.color);e.textAlign&&(t.textAlign=e.textAlign);e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,r),c=0;c<l.length;++c)d=l[c],h&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),i(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(d,n,o,r.maxWidth)),t.fillText(d,n,o,r.maxWidth),Te(t,n,o,d,r),o+=a.lineHeight;t.restore()}function Te(t,e,i,s,n){if(n.strikethrough||n.underline){const o=t.measureText(s),a=e-o.actualBoundingBoxLeft,r=e+o.actualBoundingBoxRight,l=i-o.actualBoundingBoxAscent,h=i+o.actualBoundingBoxDescent,c=n.strikethrough?(l+h)/2:h;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=n.decorationWidth||2,t.moveTo(a,c),t.lineTo(r,c),t.stroke()}}function Le(t,e){const{x:i,y:s,w:n,h:o,radius:a}=e;t.arc(i+a.topLeft,s+a.topLeft,a.topLeft,-L,D,!0),t.lineTo(i,s+o-a.bottomLeft),t.arc(i+a.bottomLeft,s+o-a.bottomLeft,a.bottomLeft,D,L,!0),t.lineTo(i+n-a.bottomRight,s+o),t.arc(i+n-a.bottomRight,s+o-a.bottomRight,a.bottomRight,L,0,!0),t.lineTo(i+n,s+a.topRight),t.arc(i+n-a.topRight,s+a.topRight,a.topRight,0,-L,!0),t.lineTo(i+a.topLeft,s)}function Ee(t,e=[""],i=t,s,n=(()=>t[0])){M(s)||(s=$e("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:i,_fallback:s,_getTarget:n,override:n=>Ee([n,...t],e,i,s)};return new Proxy(o,{deleteProperty:(e,i)=>(delete e[i],delete e._keys,delete t[0][i],!0),get:(i,s)=>Ve(i,s,(()=>function(t,e,i,s){let n;for(const o of e)if(n=$e(ze(o,t),i),M(n))return Fe(t,n)?je(i,s,t,n):n}(s,e,t,i))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>Ye(t).includes(e),ownKeys:t=>Ye(t),set(t,e,i){const s=t._storage||(t._storage=n());return t[e]=s[e]=i,delete t._keys,!0}})}function Re(t,e,i,o){const a={_cacheable:!1,_proxy:t,_context:e,_subProxy:i,_stack:new Set,_descriptors:Ie(t,o),setContext:e=>Re(t,e,i,o),override:s=>Re(t.override(s),e,i,o)};return new Proxy(a,{deleteProperty:(e,i)=>(delete e[i],delete t[i],!0),get:(t,e,i)=>Ve(t,e,(()=>function(t,e,i){const{_proxy:o,_context:a,_subProxy:r,_descriptors:l}=t;let h=o[e];k(h)&&l.isScriptable(e)&&(h=function(t,e,i,s){const{_proxy:n,_context:o,_subProxy:a,_stack:r}=i;if(r.has(t))throw new Error("Recursion detected: "+Array.from(r).join("->")+"->"+t);r.add(t),e=e(o,a||s),r.delete(t),Fe(t,e)&&(e=je(n._scopes,n,t,e));return e}(e,h,t,i));s(h)&&h.length&&(h=function(t,e,i,s){const{_proxy:o,_context:a,_subProxy:r,_descriptors:l}=i;if(M(a.index)&&s(t))e=e[a.index%e.length];else if(n(e[0])){const i=e,s=o._scopes.filter((t=>t!==i));e=[];for(const n of i){const i=je(s,o,t,n);e.push(Re(i,a,r&&r[t],l))}}return e}(e,h,t,l.isIndexable));Fe(e,h)&&(h=Re(h,a,r&&r[e],l));return h}(t,e,i))),getOwnPropertyDescriptor:(e,i)=>e._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,i)=>Reflect.has(t,i),ownKeys:()=>Reflect.ownKeys(t),set:(e,i,s)=>(t[i]=s,delete e[i],!0)})}function Ie(t,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:s=e.indexable,_allKeys:n=e.allKeys}=t;return{allKeys:n,scriptable:i,indexable:s,isScriptable:k(i)?i:()=>i,isIndexable:k(s)?s:()=>s}}const ze=(t,e)=>t?t+w(e):e,Fe=(t,e)=>n(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function Ve(t,e,i){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const s=i();return t[e]=s,s}function Be(t,e,i){return k(t)?t(e,i):t}const Ne=(t,e)=>!0===t?e:"string"==typeof t?y(e,t):void 0;function We(t,e,i,s,n){for(const o of e){const e=Ne(i,o);if(e){t.add(e);const o=Be(e._fallback,i,n);if(M(o)&&o!==i&&o!==s)return o}else if(!1===e&&M(s)&&i!==s)return null}return!1}function je(t,e,i,o){const a=e._rootScopes,r=Be(e._fallback,i,o),l=[...t,...a],h=new Set;h.add(o);let c=He(h,l,i,r||i,o);return null!==c&&((!M(r)||r===i||(c=He(h,l,r,c,o),null!==c))&&Ee(Array.from(h),[""],a,r,(()=>function(t,e,i){const o=t._getTarget();e in o||(o[e]={});const a=o[e];if(s(a)&&n(i))return i;return a}(e,i,o))))}function He(t,e,i,s,n){for(;i;)i=We(t,e,i,s,n);return i}function $e(t,e){for(const i of e){if(!i)continue;const e=i[t];if(M(e))return e}}function Ye(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const i of t)for(const t of Object.keys(i).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Ue(t,e,i,s){const{iScale:n}=t,{key:o="r"}=this._parsing,a=new Array(s);let r,l,h,c;for(r=0,l=s;r<l;++r)h=r+i,c=e[h],a[r]={r:n.parse(y(c,o),h)};return a}const Xe=Number.EPSILON||1e-14,qe=(t,e)=>e<t.length&&!t[e].skip&&t[e],Ke=t=>"x"===t?"y":"x";function Ge(t,e,i,s){const n=t.skip?e:t,o=e,a=i.skip?e:i,r=X(o,n),l=X(a,o);let h=r/(r+l),c=l/(r+l);h=isNaN(h)?0:h,c=isNaN(c)?0:c;const d=s*h,u=s*c;return{previous:{x:o.x-d*(a.x-n.x),y:o.y-d*(a.y-n.y)},next:{x:o.x+u*(a.x-n.x),y:o.y+u*(a.y-n.y)}}}function Ze(t,e="x"){const i=Ke(e),s=t.length,n=Array(s).fill(0),o=Array(s);let a,r,l,h=qe(t,0);for(a=0;a<s;++a)if(r=l,l=h,h=qe(t,a+1),l){if(h){const t=h[e]-l[e];n[a]=0!==t?(h[i]-l[i])/t:0}o[a]=r?h?z(n[a-1])!==z(n[a])?0:(n[a-1]+n[a])/2:n[a-1]:n[a]}!function(t,e,i){const s=t.length;let n,o,a,r,l,h=qe(t,0);for(let c=0;c<s-1;++c)l=h,h=qe(t,c+1),l&&h&&(N(e[c],0,Xe)?i[c]=i[c+1]=0:(n=i[c]/e[c],o=i[c+1]/e[c],r=Math.pow(n,2)+Math.pow(o,2),r<=9||(a=3/Math.sqrt(r),i[c]=n*a*e[c],i[c+1]=o*a*e[c])))}(t,n,o),function(t,e,i="x"){const s=Ke(i),n=t.length;let o,a,r,l=qe(t,0);for(let h=0;h<n;++h){if(a=r,r=l,l=qe(t,h+1),!r)continue;const n=r[i],c=r[s];a&&(o=(n-a[i])/3,r[`cp1${i}`]=n-o,r[`cp1${s}`]=c-o*e[h]),l&&(o=(l[i]-n)/3,r[`cp2${i}`]=n+o,r[`cp2${s}`]=c+o*e[h])}}(t,o,e)}function Je(t,e,i){return Math.max(Math.min(t,i),e)}function Qe(t,e,i,s,n){let o,a,r,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)Ze(t,n);else{let i=s?t[t.length-1]:t[0];for(o=0,a=t.length;o<a;++o)r=t[o],l=Ge(i,r,t[Math.min(o+1,a-(s?0:1))%a],e.tension),r.cp1x=l.previous.x,r.cp1y=l.previous.y,r.cp2x=l.next.x,r.cp2y=l.next.y,i=r}e.capBezierPoints&&function(t,e){let i,s,n,o,a,r=Se(t[0],e);for(i=0,s=t.length;i<s;++i)a=o,o=r,r=i<s-1&&Se(t[i+1],e),o&&(n=t[i],a&&(n.cp1x=Je(n.cp1x,e.left,e.right),n.cp1y=Je(n.cp1y,e.top,e.bottom)),r&&(n.cp2x=Je(n.cp2x,e.left,e.right),n.cp2y=Je(n.cp2y,e.top,e.bottom)))}(t,i)}const ti=t=>0===t||1===t,ei=(t,e,i)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*O/i),ii=(t,e,i)=>Math.pow(2,-10*t)*Math.sin((t-e)*O/i)+1,si={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*L),easeOutSine:t=>Math.sin(t*L),easeInOutSine:t=>-.5*(Math.cos(D*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>ti(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>ti(t)?t:ei(t,.075,.3),easeOutElastic:t=>ti(t)?t:ii(t,.075,.3),easeInOutElastic(t){const e=.1125;return ti(t)?t:t<.5?.5*ei(2*t,e,.45):.5+.5*ii(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-si.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeInOutBounce:t=>t<.5?.5*si.easeInBounce(2*t):.5*si.easeOutBounce(2*t-1)+.5};function ni(t,e,i,s){return{x:t.x+i*(e.x-t.x),y:t.y+i*(e.y-t.y)}}function oi(t,e,i,s){return{x:t.x+i*(e.x-t.x),y:"middle"===s?i<.5?t.y:e.y:"after"===s?i<1?t.y:e.y:i>0?e.y:t.y}}function ai(t,e,i,s){const n={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},a=ni(t,n,i),r=ni(n,o,i),l=ni(o,e,i),h=ni(a,r,i),c=ni(r,l,i);return ni(h,c,i)}const ri=new Map;function li(t,e,i){return function(t,e){e=e||{};const i=t+JSON.stringify(e);let s=ri.get(i);return s||(s=new Intl.NumberFormat(t,e),ri.set(i,s)),s}(e,i).format(t)}const hi=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),ci=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function di(t,e){const i=(""+t).match(hi);if(!i||"normal"===i[1])return 1.2*e;switch(t=+i[2],i[3]){case"px":return t;case"%":t/=100}return e*t}function ui(t,e){const i={},s=n(e),o=s?Object.keys(e):e,a=n(t)?s?i=>r(t[i],t[e[i]]):e=>t[e]:()=>t;for(const t of o)i[t]=+a(t)||0;return i}function fi(t){return ui(t,{top:"y",right:"x",bottom:"y",left:"x"})}function gi(t){return ui(t,["topLeft","topRight","bottomLeft","bottomRight"])}function pi(t){const e=fi(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function mi(t,e){t=t||{},e=e||ne.font;let i=r(t.size,e.size);"string"==typeof i&&(i=parseInt(i,10));let s=r(t.style,e.style);s&&!(""+s).match(ci)&&(console.warn('Invalid font style specified: "'+s+'"'),s="");const n={family:r(t.family,e.family),lineHeight:di(r(t.lineHeight,e.lineHeight),i),size:i,style:s,weight:r(t.weight,e.weight),string:""};return n.string=xe(n),n}function bi(t,e,i,n){let o,a,r,l=!0;for(o=0,a=t.length;o<a;++o)if(r=t[o],void 0!==r&&(void 0!==e&&"function"==typeof r&&(r=r(e),l=!1),void 0!==i&&s(r)&&(r=r[i%r.length],l=!1),void 0!==r))return n&&!l&&(n.cacheable=!1),r}function xi(t,e,i){const{min:s,max:n}=t,o=h(e,(n-s)/2),a=(t,e)=>i&&0===t?0:t+e;return{min:a(s,-Math.abs(o)),max:a(n,o)}}function _i(t,e){return Object.assign(Object.create(t),e)}function yi(t,e,i){return t?function(t,e){return{x:i=>t+t+e-i,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,i):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function vi(t,e){let i,s;"ltr"!==e&&"rtl"!==e||(i=t.canvas.style,s=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),t.prevTextDirection=s)}function wi(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Mi(t){return"angle"===t?{between:G,compare:q,normalize:K}:{between:Q,compare:(t,e)=>t-e,normalize:t=>t}}function ki({start:t,end:e,count:i,loop:s,style:n}){return{start:t%i,end:e%i,loop:s&&(e-t+1)%i==0,style:n}}function Si(t,e,i){if(!i)return[t];const{property:s,start:n,end:o}=i,a=e.length,{compare:r,between:l,normalize:h}=Mi(s),{start:c,end:d,loop:u,style:f}=function(t,e,i){const{property:s,start:n,end:o}=i,{between:a,normalize:r}=Mi(s),l=e.length;let h,c,{start:d,end:u,loop:f}=t;if(f){for(d+=l,u+=l,h=0,c=l;h<c&&a(r(e[d%l][s]),n,o);++h)d--,u--;d%=l,u%=l}return u<d&&(u+=l),{start:d,end:u,loop:f,style:t.style}}(t,e,i),g=[];let p,m,b,x=!1,_=null;const y=()=>x||l(n,b,p)&&0!==r(n,b),v=()=>!x||0===r(o,p)||l(o,b,p);for(let t=c,i=c;t<=d;++t)m=e[t%a],m.skip||(p=h(m[s]),p!==b&&(x=l(p,n,o),null===_&&y()&&(_=0===r(p,n)?t:i),null!==_&&v()&&(g.push(ki({start:_,end:t,loop:u,count:a,style:f})),_=null),i=t,b=p));return null!==_&&g.push(ki({start:_,end:d,loop:u,count:a,style:f})),g}function Pi(t,e){const i=[],s=t.segments;for(let n=0;n<s.length;n++){const o=Si(s[n],t.points,e);o.length&&i.push(...o)}return i}function Di(t,e){const i=t.points,s=t.options.spanGaps,n=i.length;if(!n)return[];const o=!!t._loop,{start:a,end:r}=function(t,e,i,s){let n=0,o=e-1;if(i&&!s)for(;n<e&&!t[n].skip;)n++;for(;n<e&&t[n].skip;)n++;for(n%=e,i&&(o+=n);o>n&&t[o%e].skip;)o--;return o%=e,{start:n,end:o}}(i,n,o,s);if(!0===s)return Oi(t,[{start:a,end:r,loop:o}],i,e);return Oi(t,function(t,e,i,s){const n=t.length,o=[];let a,r=e,l=t[e];for(a=e+1;a<=i;++a){const i=t[a%n];i.skip||i.stop?l.skip||(s=!1,o.push({start:e%n,end:(a-1)%n,loop:s}),e=r=i.stop?a:null):(r=a,l.skip&&(e=a)),l=i}return null!==r&&o.push({start:e%n,end:r%n,loop:s}),o}(i,a,r<a?r+n:r,!!t._fullLoop&&0===a&&r===n-1),i,e)}function Oi(t,e,i,s){return s&&s.setContext&&i?function(t,e,i,s){const n=t._chart.getContext(),o=Ci(t.options),{_datasetIndex:a,options:{spanGaps:r}}=t,l=i.length,h=[];let c=o,d=e[0].start,u=d;function f(t,e,s,n){const o=r?-1:1;if(t!==e){for(t+=l;i[t%l].skip;)t-=o;for(;i[e%l].skip;)e+=o;t%l!=e%l&&(h.push({start:t%l,end:e%l,loop:s,style:n}),c=n,d=e%l)}}for(const t of e){d=r?d:t.start;let e,o=i[d%l];for(u=d+1;u<=t.end;u++){const r=i[u%l];e=Ci(s.setContext(_i(n,{type:"segment",p0:o,p1:r,p0DataIndex:(u-1)%l,p1DataIndex:u%l,datasetIndex:a}))),Ai(e,c)&&f(d,u-1,t.loop,c),o=r,c=e}d<u-1&&f(d,u-1,t.loop,c)}return h}(t,e,i,s):e}function Ci(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Ai(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}var Ti=Object.freeze({__proto__:null,easingEffects:si,isPatternOrGradient:Zt,color:Jt,getHoverColor:Qt,noop:t,uid:e,isNullOrUndef:i,isArray:s,isObject:n,isFinite:o,finiteOrDefault:a,valueOrDefault:r,toPercentage:l,toDimension:h,callback:c,each:d,_elementsEqual:u,clone:f,_merger:p,merge:m,mergeIf:b,_mergerIf:x,_deprecated:function(t,e,i,s){void 0!==e&&console.warn(t+': "'+i+'" is deprecated. Please use "'+s+'" instead')},resolveObjectKey:y,_splitKey:v,_capitalize:w,defined:M,isFunction:k,setsEqual:S,_isClickEvent:P,toFontString:xe,_measureText:_e,_longestText:ye,_alignPixel:ve,clearCanvas:we,drawPoint:Me,drawPointLegend:ke,_isPointInArea:Se,clipArea:Pe,unclipArea:De,_steppedLineTo:Oe,_bezierCurveTo:Ce,renderText:Ae,addRoundedRectPath:Le,_lookup:tt,_lookupByKey:et,_rlookupByKey:it,_filterBetween:st,listenArrayEvents:ot,unlistenArrayEvents:at,_arrayUnique:rt,_createResolver:Ee,_attachContext:Re,_descriptors:Ie,_parseObjectDataRadialScale:Ue,splineCurve:Ge,splineCurveMonotone:Ze,_updateBezierControlPoints:Qe,_isDomSupported:oe,_getParentNode:ae,getStyle:he,getRelativePosition:ue,getMaximumSize:ge,retinaScale:pe,supportsEventListenerOptions:me,readUsedSize:be,fontString:function(t,e,i){return e+" "+t+"px "+i},requestAnimFrame:lt,throttled:ht,debounce:ct,_toLeftRightCenter:dt,_alignStartEnd:ut,_textX:ft,_getStartAndCountOfVisiblePoints:gt,_scaleRangesChanged:pt,_pointInLine:ni,_steppedInterpolation:oi,_bezierInterpolation:ai,formatNumber:li,toLineHeight:di,_readValueToProps:ui,toTRBL:fi,toTRBLCorners:gi,toPadding:pi,toFont:mi,resolve:bi,_addGrace:xi,createContext:_i,PI:D,TAU:O,PITAU:C,INFINITY:A,RAD_PER_DEG:T,HALF_PI:L,QUARTER_PI:E,TWO_THIRDS_PI:R,log10:I,sign:z,niceNum:F,_factorize:V,isNumber:B,almostEquals:N,almostWhole:W,_setMinAndMaxByKey:j,toRadians:H,toDegrees:$,_decimalPlaces:Y,getAngleFromPoint:U,distanceBetweenPoints:X,_angleDiff:q,_normalizeAngle:K,_angleBetween:G,_limitValue:Z,_int16Range:J,_isBetween:Q,getRtlAdapter:yi,overrideTextDirection:vi,restoreTextDirection:wi,_boundSegment:Si,_boundSegments:Pi,_computeSegments:Di});function Li(t,e,i,s){const{controller:n,data:o,_sorted:a}=t,r=n._cachedMeta.iScale;if(r&&e===r.axis&&"r"!==e&&a&&o.length){const t=r._reversePixels?it:et;if(!s)return t(o,e,i);if(n._sharedOptions){const s=o[0],n="function"==typeof s.getRange&&s.getRange(e);if(n){const s=t(o,e,i-n),a=t(o,e,i+n);return{lo:s.lo,hi:a.hi}}}}return{lo:0,hi:o.length-1}}function Ei(t,e,i,s,n){const o=t.getSortedVisibleDatasetMetas(),a=i[e];for(let t=0,i=o.length;t<i;++t){const{index:i,data:r}=o[t],{lo:l,hi:h}=Li(o[t],e,a,n);for(let t=l;t<=h;++t){const e=r[t];e.skip||s(e,i,t)}}}function Ri(t,e,i,s,n){const o=[];if(!n&&!t.isPointInArea(e))return o;return Ei(t,i,e,(function(i,a,r){(n||Se(i,t.chartArea,0))&&i.inRange(e.x,e.y,s)&&o.push({element:i,datasetIndex:a,index:r})}),!0),o}function Ii(t,e,i,s,n,o){let a=[];const r=function(t){const e=-1!==t.indexOf("x"),i=-1!==t.indexOf("y");return function(t,s){const n=e?Math.abs(t.x-s.x):0,o=i?Math.abs(t.y-s.y):0;return Math.sqrt(Math.pow(n,2)+Math.pow(o,2))}}(i);let l=Number.POSITIVE_INFINITY;return Ei(t,i,e,(function(i,h,c){const d=i.inRange(e.x,e.y,n);if(s&&!d)return;const u=i.getCenterPoint(n);if(!(!!o||t.isPointInArea(u))&&!d)return;const f=r(e,u);f<l?(a=[{element:i,datasetIndex:h,index:c}],l=f):f===l&&a.push({element:i,datasetIndex:h,index:c})})),a}function zi(t,e,i,s,n,o){return o||t.isPointInArea(e)?"r"!==i||s?Ii(t,e,i,s,n,o):function(t,e,i,s){let n=[];return Ei(t,i,e,(function(t,i,o){const{startAngle:a,endAngle:r}=t.getProps(["startAngle","endAngle"],s),{angle:l}=U(t,{x:e.x,y:e.y});G(l,a,r)&&n.push({element:t,datasetIndex:i,index:o})})),n}(t,e,i,n):[]}function Fi(t,e,i,s,n){const o=[],a="x"===i?"inXRange":"inYRange";let r=!1;return Ei(t,i,e,((t,s,l)=>{t[a](e[i],n)&&(o.push({element:t,datasetIndex:s,index:l}),r=r||t.inRange(e.x,e.y,n))})),s&&!r?[]:o}var Vi={evaluateInteractionItems:Ei,modes:{index(t,e,i,s){const n=ue(e,t),o=i.axis||"x",a=i.includeInvisible||!1,r=i.intersect?Ri(t,n,o,s,a):zi(t,n,o,!1,s,a),l=[];return r.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=r[0].index,i=t.data[e];i&&!i.skip&&l.push({element:i,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,i,s){const n=ue(e,t),o=i.axis||"xy",a=i.includeInvisible||!1;let r=i.intersect?Ri(t,n,o,s,a):zi(t,n,o,!1,s,a);if(r.length>0){const e=r[0].datasetIndex,i=t.getDatasetMeta(e).data;r=[];for(let t=0;t<i.length;++t)r.push({element:i[t],datasetIndex:e,index:t})}return r},point:(t,e,i,s)=>Ri(t,ue(e,t),i.axis||"xy",s,i.includeInvisible||!1),nearest(t,e,i,s){const n=ue(e,t),o=i.axis||"xy",a=i.includeInvisible||!1;return zi(t,n,o,i.intersect,s,a)},x:(t,e,i,s)=>Fi(t,ue(e,t),"x",i.intersect,s),y:(t,e,i,s)=>Fi(t,ue(e,t),"y",i.intersect,s)}};const Bi=["left","top","right","bottom"];function Ni(t,e){return t.filter((t=>t.pos===e))}function Wi(t,e){return t.filter((t=>-1===Bi.indexOf(t.pos)&&t.box.axis===e))}function ji(t,e){return t.sort(((t,i)=>{const s=e?i:t,n=e?t:i;return s.weight===n.weight?s.index-n.index:s.weight-n.weight}))}function Hi(t,e){const i=function(t){const e={};for(const i of t){const{stack:t,pos:s,stackWeight:n}=i;if(!t||!Bi.includes(s))continue;const o=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=n}return e}(t),{vBoxMaxWidth:s,hBoxMaxHeight:n}=e;let o,a,r;for(o=0,a=t.length;o<a;++o){r=t[o];const{fullSize:a}=r.box,l=i[r.stack],h=l&&r.stackWeight/l.weight;r.horizontal?(r.width=h?h*s:a&&e.availableWidth,r.height=n):(r.width=s,r.height=h?h*n:a&&e.availableHeight)}return i}function $i(t,e,i,s){return Math.max(t[i],e[i])+Math.max(t[s],e[s])}function Yi(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Ui(t,e,i,s){const{pos:o,box:a}=i,r=t.maxPadding;if(!n(o)){i.size&&(t[o]-=i.size);const e=s[i.stack]||{size:0,count:1};e.size=Math.max(e.size,i.horizontal?a.height:a.width),i.size=e.size/e.count,t[o]+=i.size}a.getPadding&&Yi(r,a.getPadding());const l=Math.max(0,e.outerWidth-$i(r,t,"left","right")),h=Math.max(0,e.outerHeight-$i(r,t,"top","bottom")),c=l!==t.w,d=h!==t.h;return t.w=l,t.h=h,i.horizontal?{same:c,other:d}:{same:d,other:c}}function Xi(t,e){const i=e.maxPadding;function s(t){const s={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{s[t]=Math.max(e[t],i[t])})),s}return s(t?["left","right"]:["top","bottom"])}function qi(t,e,i,s){const n=[];let o,a,r,l,h,c;for(o=0,a=t.length,h=0;o<a;++o){r=t[o],l=r.box,l.update(r.width||e.w,r.height||e.h,Xi(r.horizontal,e));const{same:a,other:d}=Ui(e,i,r,s);h|=a&&n.length,c=c||d,l.fullSize||n.push(r)}return h&&qi(n,e,i,s)||c}function Ki(t,e,i,s,n){t.top=i,t.left=e,t.right=e+s,t.bottom=i+n,t.width=s,t.height=n}function Gi(t,e,i,s){const n=i.padding;let{x:o,y:a}=e;for(const r of t){const t=r.box,l=s[r.stack]||{count:1,placed:0,weight:1},h=r.stackWeight/l.weight||1;if(r.horizontal){const s=e.w*h,o=l.size||t.height;M(l.start)&&(a=l.start),t.fullSize?Ki(t,n.left,a,i.outerWidth-n.right-n.left,o):Ki(t,e.left+l.placed,a,s,o),l.start=a,l.placed+=s,a=t.bottom}else{const s=e.h*h,a=l.size||t.width;M(l.start)&&(o=l.start),t.fullSize?Ki(t,o,n.top,a,i.outerHeight-n.bottom-n.top):Ki(t,o,e.top+l.placed,a,s),l.start=o,l.placed+=s,o=t.right}}e.x=o,e.y=a}ne.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var Zi={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const i=t.boxes?t.boxes.indexOf(e):-1;-1!==i&&t.boxes.splice(i,1)},configure(t,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(t,e,i,s){if(!t)return;const n=pi(t.options.layout.padding),o=Math.max(e-n.width,0),a=Math.max(i-n.height,0),r=function(t){const e=function(t){const e=[];let i,s,n,o,a,r;for(i=0,s=(t||[]).length;i<s;++i)n=t[i],({position:o,options:{stack:a,stackWeight:r=1}}=n),e.push({index:i,box:n,pos:o,horizontal:n.isHorizontal(),weight:n.weight,stack:a&&o+a,stackWeight:r});return e}(t),i=ji(e.filter((t=>t.box.fullSize)),!0),s=ji(Ni(e,"left"),!0),n=ji(Ni(e,"right")),o=ji(Ni(e,"top"),!0),a=ji(Ni(e,"bottom")),r=Wi(e,"x"),l=Wi(e,"y");return{fullSize:i,leftAndTop:s.concat(o),rightAndBottom:n.concat(l).concat(a).concat(r),chartArea:Ni(e,"chartArea"),vertical:s.concat(n).concat(l),horizontal:o.concat(a).concat(r)}}(t.boxes),l=r.vertical,h=r.horizontal;d(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const c=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,u=Object.freeze({outerWidth:e,outerHeight:i,padding:n,availableWidth:o,availableHeight:a,vBoxMaxWidth:o/2/c,hBoxMaxHeight:a/2}),f=Object.assign({},n);Yi(f,pi(s));const g=Object.assign({maxPadding:f,w:o,h:a,x:n.left,y:n.top},n),p=Hi(l.concat(h),u);qi(r.fullSize,g,u,p),qi(l,g,u,p),qi(h,g,u,p)&&qi(l,g,u,p),function(t){const e=t.maxPadding;function i(i){const s=Math.max(e[i]-t[i],0);return t[i]+=s,s}t.y+=i("top"),t.x+=i("left"),i("right"),i("bottom")}(g),Gi(r.leftAndTop,g,u,p),g.x+=g.w,g.y+=g.h,Gi(r.rightAndBottom,g,u,p),t.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},d(r.chartArea,(e=>{const i=e.box;Object.assign(i,t.chartArea),i.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})}))}};class Ji{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,s){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):i)}}isAttached(t){return!0}updateConfig(t){}}class Qi extends Ji{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const ts={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},es=t=>null===t||""===t;const is=!!me&&{passive:!0};function ss(t,e,i){t.canvas.removeEventListener(e,i,is)}function ns(t,e){for(const i of t)if(i===e||i.contains(e))return!0}function os(t,e,i){const s=t.canvas,n=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||ns(i.addedNodes,s),e=e&&!ns(i.removedNodes,s);e&&i()}));return n.observe(document,{childList:!0,subtree:!0}),n}function as(t,e,i){const s=t.canvas,n=new MutationObserver((t=>{let e=!1;for(const i of t)e=e||ns(i.removedNodes,s),e=e&&!ns(i.addedNodes,s);e&&i()}));return n.observe(document,{childList:!0,subtree:!0}),n}const rs=new Map;let ls=0;function hs(){const t=window.devicePixelRatio;t!==ls&&(ls=t,rs.forEach(((e,i)=>{i.currentDevicePixelRatio!==t&&e()})))}function cs(t,e,i){const s=t.canvas,n=s&&ae(s);if(!n)return;const o=ht(((t,e)=>{const s=n.clientWidth;i(t,e),s<n.clientWidth&&i()}),window),a=new ResizeObserver((t=>{const e=t[0],i=e.contentRect.width,s=e.contentRect.height;0===i&&0===s||o(i,s)}));return a.observe(n),function(t,e){rs.size||window.addEventListener("resize",hs),rs.set(t,e)}(t,o),a}function ds(t,e,i){i&&i.disconnect(),"resize"===e&&function(t){rs.delete(t),rs.size||window.removeEventListener("resize",hs)}(t)}function us(t,e,i){const s=t.canvas,n=ht((e=>{null!==t.ctx&&i(function(t,e){const i=ts[t.type]||t.type,{x:s,y:n}=ue(t,e);return{type:i,chart:e,native:t,x:void 0!==s?s:null,y:void 0!==n?n:null}}(e,t))}),t,(t=>{const e=t[0];return[e,e.offsetX,e.offsetY]}));return function(t,e,i){t.addEventListener(e,i,is)}(s,e,n),n}class fs extends Ji{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(function(t,e){const i=t.style,s=t.getAttribute("height"),n=t.getAttribute("width");if(t.$chartjs={initial:{height:s,width:n,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",es(n)){const e=be(t,"width");void 0!==e&&(t.width=e)}if(es(s))if(""===t.style.height)t.height=t.width/(e||2);else{const e=be(t,"height");void 0!==e&&(t.height=e)}}(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e.$chartjs)return!1;const s=e.$chartjs.initial;["height","width"].forEach((t=>{const n=s[t];i(n)?e.removeAttribute(t):e.setAttribute(t,n)}));const n=s.style||{};return Object.keys(n).forEach((t=>{e.style[t]=n[t]})),e.width=e.width,delete e.$chartjs,!0}addEventListener(t,e,i){this.removeEventListener(t,e);const s=t.$proxies||(t.$proxies={}),n={attach:os,detach:as,resize:cs}[e]||us;s[e]=n(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),s=i[e];if(!s)return;({attach:ds,detach:ds,resize:ds}[e]||ss)(t,e,s),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,s){return ge(t,e,i,s)}isAttached(t){const e=ae(t);return!(!e||!e.isConnected)}}function gs(t){return!oe()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?Qi:fs}var ps=Object.freeze({__proto__:null,_detectPlatform:gs,BasePlatform:Ji,BasicPlatform:Qi,DomPlatform:fs});const ms="transparent",bs={boolean:(t,e,i)=>i>.5?e:t,color(t,e,i){const s=Jt(t||ms),n=s.valid&&Jt(e||ms);return n&&n.valid?n.mix(s,i).hexString():e},number:(t,e,i)=>t+(e-t)*i};class xs{constructor(t,e,i,s){const n=e[i];s=bi([t.to,s,n,t.from]);const o=bi([t.from,n,s]);this._active=!0,this._fn=t.fn||bs[t.type||typeof o],this._easing=si[t.easing]||si.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const s=this._target[this._prop],n=i-this._start,o=this._duration-n;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=n,this._loop=!!t.loop,this._to=bi([t.to,e,s,t.from]),this._from=bi([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,s=this._prop,n=this._from,o=this._loop,a=this._to;let r;if(this._active=n!==a&&(o||e<i),!this._active)return this._target[s]=a,void this._notify(!0);e<0?this._target[s]=n:(r=e/i%2,r=o&&r>1?2-r:r,r=this._easing(Math.min(1,Math.max(0,r))),this._target[s]=this._fn(n,a,r))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,i)=>{t.push({res:e,rej:i})}))}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let t=0;t<i.length;t++)i[t][e]()}}ne.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const _s=Object.keys(ne.animation);ne.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),ne.set("animations",{colors:{type:"color",properties:["color","borderColor","backgroundColor"]},numbers:{type:"number",properties:["x","y","borderWidth","radius","tension"]}}),ne.describe("animations",{_fallback:"animation"}),ne.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}});class ys{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!n(t))return;const e=this._properties;Object.getOwnPropertyNames(t).forEach((i=>{const o=t[i];if(!n(o))return;const a={};for(const t of _s)a[t]=o[t];(s(o.properties)&&o.properties||[i]).forEach((t=>{t!==i&&e.has(t)||e.set(t,a)}))}))}_animateOptions(t,e){const i=e.options,s=function(t,e){if(!e)return;let i=t.options;if(!i)return void(t.options=e);i.$shared&&(t.options=i=Object.assign({},i,{$shared:!1,$animations:{}}));return i}(t,i);if(!s)return[];const n=this._createAnimations(s,i);return i.$shared&&function(t,e){const i=[],s=Object.keys(e);for(let e=0;e<s.length;e++){const n=t[s[e]];n&&n.active()&&i.push(n.wait())}return Promise.all(i)}(t.options.$animations,i).then((()=>{t.options=i}),(()=>{})),n}_createAnimations(t,e){const i=this._properties,s=[],n=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let r;for(r=o.length-1;r>=0;--r){const l=o[r];if("$"===l.charAt(0))continue;if("options"===l){s.push(...this._animateOptions(t,e));continue}const h=e[l];let c=n[l];const d=i.get(l);if(c){if(d&&c.active()){c.update(d,h,a);continue}c.cancel()}d&&d.duration?(n[l]=c=new xs(d,t,l,h),s.push(c)):t[l]=h}return s}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const i=this._createAnimations(t,e);return i.length?(mt.add(this._chart,i),!0):void 0}}function vs(t,e){const i=t&&t.options||{},s=i.reverse,n=void 0===i.min?e:0,o=void 0===i.max?e:0;return{start:s?o:n,end:s?n:o}}function ws(t,e){const i=[],s=t._getSortedDatasetMetas(e);let n,o;for(n=0,o=s.length;n<o;++n)i.push(s[n].index);return i}function Ms(t,e,i,s={}){const n=t.keys,a="single"===s.mode;let r,l,h,c;if(null!==e){for(r=0,l=n.length;r<l;++r){if(h=+n[r],h===i){if(s.all)continue;break}c=t.values[h],o(c)&&(a||0===e||z(e)===z(c))&&(e+=c)}return e}}function ks(t,e){const i=t&&t.options.stacked;return i||void 0===i&&void 0!==e.stack}function Ss(t,e,i){const s=t[e]||(t[e]={});return s[i]||(s[i]={})}function Ps(t,e,i,s){for(const n of e.getMatchingVisibleMetas(s).reverse()){const e=t[n.index];if(i&&e>0||!i&&e<0)return n.index}return null}function Ds(t,e){const{chart:i,_cachedMeta:s}=t,n=i._stacks||(i._stacks={}),{iScale:o,vScale:a,index:r}=s,l=o.axis,h=a.axis,c=function(t,e,i){return`${t.id}.${e.id}.${i.stack||i.type}`}(o,a,s),d=e.length;let u;for(let t=0;t<d;++t){const i=e[t],{[l]:o,[h]:d}=i;u=(i._stacks||(i._stacks={}))[h]=Ss(n,c,o),u[r]=d,u._top=Ps(u,a,!0,s.type),u._bottom=Ps(u,a,!1,s.type)}}function Os(t,e){const i=t.scales;return Object.keys(i).filter((t=>i[t].axis===e)).shift()}function Cs(t,e){const i=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[s]||void 0===e[s][i])return;delete e[s][i]}}}const As=t=>"reset"===t||"none"===t,Ts=(t,e)=>e?t:Object.assign({},t);class Ls{constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=ks(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&Cs(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),s=(t,e,i,s)=>"x"===t?e:"r"===t?s:i,n=e.xAxisID=r(i.xAxisID,Os(t,"x")),o=e.yAxisID=r(i.yAxisID,Os(t,"y")),a=e.rAxisID=r(i.rAxisID,Os(t,"r")),l=e.indexAxis,h=e.iAxisID=s(l,n,o,a),c=e.vAxisID=s(l,o,n,a);e.xScale=this.getScaleForId(n),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(h),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&at(this._data,this),t._stacked&&Cs(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(n(e))this._data=function(t){const e=Object.keys(t),i=new Array(e.length);let s,n,o;for(s=0,n=e.length;s<n;++s)o=e[s],i[s]={x:o,y:t[o]};return i}(e);else if(i!==e){if(i){at(i,this);const t=this._cachedMeta;Cs(t),t._parsed=[]}e&&Object.isExtensible(e)&&ot(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const n=e._stacked;e._stacked=ks(e.vScale,e),e.stack!==i.stack&&(s=!0,Cs(e),e.stack=i.stack),this._resyncElements(t),(s||n!==e._stacked)&&Ds(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:o}=this,{iScale:a,_stacked:r}=i,l=a.axis;let h,c,d,u=0===t&&e===o.length||i._sorted,f=t>0&&i._parsed[t-1];if(!1===this._parsing)i._parsed=o,i._sorted=!0,d=o;else{d=s(o[t])?this.parseArrayData(i,o,t,e):n(o[t])?this.parseObjectData(i,o,t,e):this.parsePrimitiveData(i,o,t,e);const a=()=>null===c[l]||f&&c[l]<f[l];for(h=0;h<e;++h)i._parsed[h+t]=c=d[h],u&&(a()&&(u=!1),f=c);i._sorted=u}r&&Ds(this,d)}parsePrimitiveData(t,e,i,s){const{iScale:n,vScale:o}=t,a=n.axis,r=o.axis,l=n.getLabels(),h=n===o,c=new Array(s);let d,u,f;for(d=0,u=s;d<u;++d)f=d+i,c[d]={[a]:h||n.parse(l[f],f),[r]:o.parse(e[f],f)};return c}parseArrayData(t,e,i,s){const{xScale:n,yScale:o}=t,a=new Array(s);let r,l,h,c;for(r=0,l=s;r<l;++r)h=r+i,c=e[h],a[r]={x:n.parse(c[0],h),y:o.parse(c[1],h)};return a}parseObjectData(t,e,i,s){const{xScale:n,yScale:o}=t,{xAxisKey:a="x",yAxisKey:r="y"}=this._parsing,l=new Array(s);let h,c,d,u;for(h=0,c=s;h<c;++h)d=h+i,u=e[d],l[h]={x:n.parse(y(u,a),d),y:o.parse(y(u,r),d)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const s=this.chart,n=this._cachedMeta,o=e[t.axis];return Ms({keys:ws(s,!0),values:e._stacks[t.axis]},o,n.index,{mode:i})}updateRangeFromParsed(t,e,i,s){const n=i[e.axis];let o=null===n?NaN:n;const a=s&&i._stacks[e.axis];s&&a&&(s.values=a,o=Ms(s,n,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const i=this._cachedMeta,s=i._parsed,n=i._sorted&&t===i.iScale,a=s.length,r=this._getOtherScale(t),l=((t,e,i)=>t&&!e.hidden&&e._stacked&&{keys:ws(i,!0),values:null})(e,i,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(t){const{min:e,max:i,minDefined:s,maxDefined:n}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:n?i:Number.POSITIVE_INFINITY}}(r);let u,f;function g(){f=s[u];const e=f[r.axis];return!o(f[t.axis])||c>e||d<e}for(u=0;u<a&&(g()||(this.updateRangeFromParsed(h,t,f,l),!n));++u);if(n)for(u=a-1;u>=0;--u)if(!g()){this.updateRangeFromParsed(h,t,f,l);break}return h}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let s,n,a;for(s=0,n=e.length;s<n;++s)a=e[s][t.axis],o(a)&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,s=e.vScale,n=this.getParsed(t);return{label:i?""+i.getLabelForValue(n[i.axis]):"",value:s?""+s.getLabelForValue(n[s.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,i,s,o;return n(t)?(e=t.top,i=t.right,s=t.bottom,o=t.left):e=i=s=o=t,{top:e,right:i,bottom:s,left:o,disabled:!1===t}}(r(this.options.clip,function(t,e,i){if(!1===i)return!1;const s=vs(t,i),n=vs(e,i);return{top:n.end,right:s.end,bottom:n.start,left:s.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,s=i.data||[],n=e.chartArea,o=[],a=this._drawStart||0,r=this._drawCount||s.length-a,l=this.options.drawActiveElementsOnTop;let h;for(i.dataset&&i.dataset.draw(t,n,a,r),h=a;h<a+r;++h){const e=s[h];e.hidden||(e.active&&l?o.push(e):e.draw(t,n))}for(h=0;h<o.length;++h)o[h].draw(t,n)}getStyle(t,e){const i=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const s=this.getDataset();let n;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];n=e.$context||(e.$context=function(t,e,i){return _i(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),n.parsed=this.getParsed(t),n.raw=s.data[t],n.index=n.dataIndex=t}else n=this.$context||(this.$context=function(t,e){return _i(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),n.dataset=s,n.index=n.datasetIndex=this.index;return n.active=!!e,n.mode=i,n}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const s="active"===e,n=this._cachedDataOpts,o=t+"-"+e,a=n[o],r=this.enableOptionSharing&&M(i);if(a)return Ts(a,r);const l=this.chart.config,h=l.datasetElementScopeKeys(this._type,t),c=s?[`${t}Hover`,"hover",t,""]:[t,""],d=l.getOptionScopes(this.getDataset(),h),u=Object.keys(ne.elements[t]),f=l.resolveNamedOptions(d,u,(()=>this.getContext(i,s)),c);return f.$shared&&(f.$shared=r,n[o]=Object.freeze(Ts(f,r))),f}_resolveAnimations(t,e,i){const s=this.chart,n=this._cachedDataOpts,o=`animation-${e}`,a=n[o];if(a)return a;let r;if(!1!==s.options.animation){const s=this.chart.config,n=s.datasetAnimationScopeKeys(this._type,e),o=s.getOptionScopes(this.getDataset(),n);r=s.createResolver(o,this.getContext(t,i,e))}const l=new ys(s,r&&r.animations);return r&&r._cacheable&&(n[o]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||As(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),s=this._sharedOptions,n=this.getSharedOptions(i),o=this.includeOptions(e,n)||n!==s;return this.updateSharedOptions(n,e,i),{sharedOptions:n,includeOptions:o}}updateElement(t,e,i,s){As(s)?Object.assign(t,i):this._resolveAnimations(e,s).update(t,i)}updateSharedOptions(t,e,i){t&&!As(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,s){t.active=s;const n=this.getStyle(e,s);this._resolveAnimations(e,i,s).update(t,{options:!s&&this.getSharedOptions(n)||n})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[t,e,i]of this._syncList)this[t](e,i);this._syncList=[];const s=i.length,n=e.length,o=Math.min(n,s);o&&this.parse(0,o),n>s?this._insertElements(s,n-s,t):n<s&&this._removeElements(n,s-n)}_insertElements(t,e,i=!0){const s=this._cachedMeta,n=s.data,o=t+e;let a;const r=t=>{for(t.length+=e,a=t.length-1;a>=o;a--)t[a]=t[a-e]};for(r(n),a=t;a<o;++a)n[a]=new this.dataElementType;this._parsing&&r(s._parsed),this.parse(t,e),i&&this.updateElements(n,t,e,"reset")}updateElements(t,e,i,s){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,e);i._stacked&&Cs(i,s)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,s]=t;this[e](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Ls.defaults={},Ls.prototype.datasetElementType=null,Ls.prototype.dataElementType=null;class Es{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return B(this.x)&&B(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const s={};return t.forEach((t=>{s[t]=i[t]&&i[t].active()?i[t]._to:this[t]})),s}}Es.defaults={},Es.defaultRoutes=void 0;const Rs={values:t=>s(t)?t:""+t,numeric(t,e,i){if(0===t)return"0";const s=this.chart.options.locale;let n,o=t;if(i.length>1){const e=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(e<1e-4||e>1e15)&&(n="scientific"),o=function(t,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;Math.abs(i)>=1&&t!==Math.floor(t)&&(i=t-Math.floor(t));return i}(t,i)}const a=I(Math.abs(o)),r=Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:n,minimumFractionDigits:r,maximumFractionDigits:r};return Object.assign(l,this.options.ticks.format),li(t,s,l)},logarithmic(t,e,i){if(0===t)return"0";const s=t/Math.pow(10,Math.floor(I(t)));return 1===s||2===s||5===s?Rs.numeric.call(this,t,e,i):""}};var Is={formatters:Rs};function zs(t,e){const s=t.options.ticks,n=s.maxTicksLimit||function(t){const e=t.options.offset,i=t._tickSize(),s=t._length/i+(e?0:1),n=t._maxLength/i;return Math.floor(Math.min(s,n))}(t),o=s.major.enabled?function(t){const e=[];let i,s;for(i=0,s=t.length;i<s;i++)t[i].major&&e.push(i);return e}(e):[],a=o.length,r=o[0],l=o[a-1],h=[];if(a>n)return function(t,e,i,s){let n,o=0,a=i[0];for(s=Math.ceil(s),n=0;n<t.length;n++)n===a&&(e.push(t[n]),o++,a=i[o*s])}(e,h,o,a/n),h;const c=function(t,e,i){const s=function(t){const e=t.length;let i,s;if(e<2)return!1;for(s=t[0],i=1;i<e;++i)if(t[i]-t[i-1]!==s)return!1;return s}(t),n=e.length/i;if(!s)return Math.max(n,1);const o=V(s);for(let t=0,e=o.length-1;t<e;t++){const e=o[t];if(e>n)return e}return Math.max(n,1)}(o,e,n);if(a>0){let t,s;const n=a>1?Math.round((l-r)/(a-1)):null;for(Fs(e,h,c,i(n)?0:r-n,r),t=0,s=a-1;t<s;t++)Fs(e,h,c,o[t],o[t+1]);return Fs(e,h,c,l,i(n)?e.length:l+n),h}return Fs(e,h,c),h}function Fs(t,e,i,s,n){const o=r(s,0),a=Math.min(r(n,t.length),t.length);let l,h,c,d=0;for(i=Math.ceil(i),n&&(l=n-s,i=l/Math.floor(l/i)),c=o;c<0;)d++,c=Math.round(o+d*i);for(h=Math.max(o,0);h<a;h++)h===c&&(e.push(t[h]),d++,c=Math.round(o+d*i))}ne.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Is.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),ne.route("scale.ticks","color","","color"),ne.route("scale.grid","color","","borderColor"),ne.route("scale.grid","borderColor","","borderColor"),ne.route("scale.title","color","","color"),ne.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t}),ne.describe("scales",{_fallback:"scale"}),ne.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t});const Vs=(t,e,i)=>"top"===e||"left"===e?t[e]+i:t[e]-i;function Bs(t,e){const i=[],s=t.length/e,n=t.length;let o=0;for(;o<n;o+=s)i.push(t[Math.floor(o)]);return i}function Ns(t,e,i){const s=t.ticks.length,n=Math.min(e,s-1),o=t._startPixel,a=t._endPixel,r=1e-6;let l,h=t.getPixelForTick(n);if(!(i&&(l=1===s?Math.max(h-o,a-h):0===e?(t.getPixelForTick(1)-h)/2:(h-t.getPixelForTick(n-1))/2,h+=n<e?l:-l,h<o-r||h>a+r)))return h}function Ws(t){return t.drawTicks?t.tickLength:0}function js(t,e){if(!t.display)return 0;const i=mi(t.font,e),n=pi(t.padding);return(s(t.text)?t.text.length:1)*i.lineHeight+n.height}function Hs(t,e,i){let s=dt(t);return(i&&"right"!==e||!i&&"right"===e)&&(s=(t=>"left"===t?"right":"right"===t?"left":t)(s)),s}class $s extends Es{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:s}=this;return t=a(t,Number.POSITIVE_INFINITY),e=a(e,Number.NEGATIVE_INFINITY),i=a(i,Number.POSITIVE_INFINITY),s=a(s,Number.NEGATIVE_INFINITY),{min:a(t,i),max:a(e,s),minDefined:o(t),maxDefined:o(e)}}getMinMax(t){let e,{min:i,max:s,minDefined:n,maxDefined:o}=this.getUserBounds();if(n&&o)return{min:i,max:s};const r=this.getMatchingVisibleMetas();for(let a=0,l=r.length;a<l;++a)e=r[a].controller.getMinMax(this,t),n||(i=Math.min(i,e.min)),o||(s=Math.max(s,e.max));return i=o&&i>s?s:i,s=n&&i>s?i:s,{min:a(i,a(s,i)),max:a(s,a(i,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){c(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:s,grace:n,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=xi(this,n,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const r=a<this.ticks.length;this._convertTicksToLabels(r?Bs(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||"auto"===o.source)&&(this.ticks=zs(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),r&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,i=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,i=!i),this._startPixel=t,this._endPixel=e,this._reversePixels=i,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){c(this.options.afterUpdate,[this])}beforeSetDimensions(){c(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){c(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),c(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){c(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,s,n;for(i=0,s=t.length;i<s;i++)n=t[i],n.label=c(e.callback,[n.value,i,t],this)}afterTickToLabelConversion(){c(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){c(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=this.ticks.length,s=e.minRotation||0,n=e.maxRotation;let o,a,r,l=s;if(!this._isVisible()||!e.display||s>=n||i<=1||!this.isHorizontal())return void(this.labelRotation=s);const h=this._getLabelSizes(),c=h.widest.width,d=h.highest.height,u=Z(this.chart.width-c,0,this.maxWidth);o=t.offset?this.maxWidth/i:u/(i-1),c+6>o&&(o=u/(i-(t.offset?.5:1)),a=this.maxHeight-Ws(t.grid)-e.padding-js(t.title,this.chart.options.font),r=Math.sqrt(c*c+d*d),l=$(Math.min(Math.asin(Z((h.highest.height+6)/o,-1,1)),Math.asin(Z(a/r,-1,1))-Math.asin(Z(d/r,-1,1)))),l=Math.max(s,Math.min(n,l))),this.labelRotation=l}afterCalculateLabelRotation(){c(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){c(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:s,grid:n}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const o=js(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=Ws(n)+o):(t.height=this.maxHeight,t.width=Ws(n)+o),i.display&&this.ticks.length){const{first:e,last:s,widest:n,highest:o}=this._getLabelSizes(),r=2*i.padding,l=H(this.labelRotation),h=Math.cos(l),c=Math.sin(l);if(a){const e=i.mirror?0:c*n.width+h*o.height;t.height=Math.min(this.maxHeight,t.height+e+r)}else{const e=i.mirror?0:h*n.width+c*o.height;t.width=Math.min(this.maxWidth,t.width+e+r)}this._calculatePadding(e,s,c,h)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,s){const{ticks:{align:n,padding:o},position:a}=this.options,r=0!==this.labelRotation,l="top"!==a&&"x"===this.axis;if(this.isHorizontal()){const a=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let c=0,d=0;r?l?(c=s*t.width,d=i*e.height):(c=i*t.height,d=s*e.width):"start"===n?d=e.width:"end"===n?c=t.width:"inner"!==n&&(c=t.width/2,d=e.width/2),this.paddingLeft=Math.max((c-a+o)*this.width/(this.width-a),0),this.paddingRight=Math.max((d-h+o)*this.width/(this.width-h),0)}else{let i=e.height/2,s=t.height/2;"start"===n?(i=0,s=t.height):"end"===n&&(i=e.height,s=0),this.paddingTop=i+o,this.paddingBottom=s+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){c(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,s;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,s=t.length;e<s;e++)i(t[e].label)&&(t.splice(e,1),s--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=Bs(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(t,e){const{ctx:n,_longestTextCache:o}=this,a=[],r=[];let l,h,c,u,f,g,p,m,b,x,_,y=0,v=0;for(l=0;l<e;++l){if(u=t[l].label,f=this._resolveTickFontOptions(l),n.font=g=f.string,p=o[g]=o[g]||{data:{},gc:[]},m=f.lineHeight,b=x=0,i(u)||s(u)){if(s(u))for(h=0,c=u.length;h<c;++h)_=u[h],i(_)||s(_)||(b=_e(n,p.data,p.gc,b,_),x+=m)}else b=_e(n,p.data,p.gc,b,u),x=m;a.push(b),r.push(x),y=Math.max(b,y),v=Math.max(x,v)}!function(t,e){d(t,(t=>{const i=t.gc,s=i.length/2;let n;if(s>e){for(n=0;n<s;++n)delete t.data[i[n]];i.splice(0,s)}}))}(o,e);const w=a.indexOf(y),M=r.indexOf(v),k=t=>({width:a[t]||0,height:r[t]||0});return{first:k(0),last:k(e-1),widest:k(w),highest:k(M),widths:a,heights:r}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return J(this._alignToPixels?ve(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=function(t,e,i){return _i(t,{tick:i,index:e,type:"tick"})}(this.getContext(),t,i))}return this.$context||(this.$context=_i(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=H(this.labelRotation),i=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),n=this._getLabelSizes(),o=t.autoSkipPadding||0,a=n?n.widest.width+o:0,r=n?n.highest.height+o:0;return this.isHorizontal()?r*i>a*s?a/i:r/s:r*s<a*i?r/i:a/s}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,s=this.options,{grid:o,position:a}=s,l=o.offset,h=this.isHorizontal(),c=this.ticks.length+(l?1:0),d=Ws(o),u=[],f=o.setContext(this.getContext()),g=f.drawBorder?f.borderWidth:0,p=g/2,m=function(t){return ve(i,t,g)};let b,x,_,y,v,w,M,k,S,P,D,O;if("top"===a)b=m(this.bottom),w=this.bottom-d,k=b-p,P=m(t.top)+p,O=t.bottom;else if("bottom"===a)b=m(this.top),P=t.top,O=m(t.bottom)-p,w=b+p,k=this.top+d;else if("left"===a)b=m(this.right),v=this.right-d,M=b-p,S=m(t.left)+p,D=t.right;else if("right"===a)b=m(this.left),S=t.left,D=m(t.right)-p,v=b+p,M=this.left+d;else if("x"===e){if("center"===a)b=m((t.top+t.bottom)/2+.5);else if(n(a)){const t=Object.keys(a)[0],e=a[t];b=m(this.chart.scales[t].getPixelForValue(e))}P=t.top,O=t.bottom,w=b+p,k=w+d}else if("y"===e){if("center"===a)b=m((t.left+t.right)/2);else if(n(a)){const t=Object.keys(a)[0],e=a[t];b=m(this.chart.scales[t].getPixelForValue(e))}v=b-p,M=v-d,S=t.left,D=t.right}const C=r(s.ticks.maxTicksLimit,c),A=Math.max(1,Math.ceil(c/C));for(x=0;x<c;x+=A){const t=o.setContext(this.getContext(x)),e=t.lineWidth,s=t.color,n=t.borderDash||[],a=t.borderDashOffset,r=t.tickWidth,c=t.tickColor,d=t.tickBorderDash||[],f=t.tickBorderDashOffset;_=Ns(this,x,l),void 0!==_&&(y=ve(i,_,e),h?v=M=S=D=y:w=k=P=O=y,u.push({tx1:v,ty1:w,tx2:M,ty2:k,x1:S,y1:P,x2:D,y2:O,width:e,color:s,borderDash:n,borderDashOffset:a,tickWidth:r,tickColor:c,tickBorderDash:d,tickBorderDashOffset:f}))}return this._ticksLength=c,this._borderValue=b,u}_computeLabelItems(t){const e=this.axis,i=this.options,{position:o,ticks:a}=i,r=this.isHorizontal(),l=this.ticks,{align:h,crossAlign:c,padding:d,mirror:u}=a,f=Ws(i.grid),g=f+d,p=u?-d:g,m=-H(this.labelRotation),b=[];let x,_,y,v,w,M,k,S,P,D,O,C,A="middle";if("top"===o)M=this.bottom-p,k=this._getXAxisLabelAlignment();else if("bottom"===o)M=this.top+p,k=this._getXAxisLabelAlignment();else if("left"===o){const t=this._getYAxisLabelAlignment(f);k=t.textAlign,w=t.x}else if("right"===o){const t=this._getYAxisLabelAlignment(f);k=t.textAlign,w=t.x}else if("x"===e){if("center"===o)M=(t.top+t.bottom)/2+g;else if(n(o)){const t=Object.keys(o)[0],e=o[t];M=this.chart.scales[t].getPixelForValue(e)+g}k=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===o)w=(t.left+t.right)/2-g;else if(n(o)){const t=Object.keys(o)[0],e=o[t];w=this.chart.scales[t].getPixelForValue(e)}k=this._getYAxisLabelAlignment(f).textAlign}"y"===e&&("start"===h?A="top":"end"===h&&(A="bottom"));const T=this._getLabelSizes();for(x=0,_=l.length;x<_;++x){y=l[x],v=y.label;const t=a.setContext(this.getContext(x));S=this.getPixelForTick(x)+a.labelOffset,P=this._resolveTickFontOptions(x),D=P.lineHeight,O=s(v)?v.length:1;const e=O/2,i=t.color,n=t.textStrokeColor,h=t.textStrokeWidth;let d,f=k;if(r?(w=S,"inner"===k&&(f=x===_-1?this.options.reverse?"left":"right":0===x?this.options.reverse?"right":"left":"center"),C="top"===o?"near"===c||0!==m?-O*D+D/2:"center"===c?-T.highest.height/2-e*D+D:-T.highest.height+D/2:"near"===c||0!==m?D/2:"center"===c?T.highest.height/2-e*D:T.highest.height-O*D,u&&(C*=-1)):(M=S,C=(1-O)*D/2),t.showLabelBackdrop){const e=pi(t.backdropPadding),i=T.heights[x],s=T.widths[x];let n=M+C-e.top,o=w-e.left;switch(A){case"middle":n-=i/2;break;case"bottom":n-=i}switch(k){case"center":o-=s/2;break;case"right":o-=s}d={left:o,top:n,width:s+e.width,height:i+e.height,color:t.backdropColor}}b.push({rotation:m,label:v,font:P,color:i,strokeColor:n,strokeWidth:h,textOffset:C,textAlign:f,textBaseline:A,translation:[w,M],backdrop:d})}return b}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-H(this.labelRotation))return"top"===t?"left":"right";let i="center";return"start"===e.align?i="left":"end"===e.align?i="right":"inner"===e.align&&(i="inner"),i}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:s,padding:n}}=this.options,o=t+n,a=this._getLabelSizes().widest.width;let r,l;return"left"===e?s?(l=this.right+n,"near"===i?r="left":"center"===i?(r="center",l+=a/2):(r="right",l+=a)):(l=this.right-o,"near"===i?r="right":"center"===i?(r="center",l-=a/2):(r="left",l=this.left)):"right"===e?s?(l=this.left+n,"near"===i?r="right":"center"===i?(r="center",l-=a/2):(r="left",l-=a)):(l=this.left+o,"near"===i?r="left":"center"===i?(r="center",l+=a/2):(r="right",l=this.right)):r="right",{textAlign:r,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:s,width:n,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,s,n,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const i=this.ticks.findIndex((e=>e.value===t));if(i>=0){return e.setContext(this.getContext(i)).lineWidth}return 0}drawGrid(t){const e=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let n,o;const a=(t,e,s)=>{s.width&&s.color&&(i.save(),i.lineWidth=s.width,i.strokeStyle=s.color,i.setLineDash(s.borderDash||[]),i.lineDashOffset=s.borderDashOffset,i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.stroke(),i.restore())};if(e.display)for(n=0,o=s.length;n<o;++n){const t=s[n];e.drawOnChartArea&&a({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&a({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{grid:i}}=this,s=i.setContext(this.getContext()),n=i.drawBorder?s.borderWidth:0;if(!n)return;const o=i.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let r,l,h,c;this.isHorizontal()?(r=ve(t,this.left,n)-n/2,l=ve(t,this.right,o)+o/2,h=c=a):(h=ve(t,this.top,n)-n/2,c=ve(t,this.bottom,o)+o/2,r=l=a),e.save(),e.lineWidth=s.borderWidth,e.strokeStyle=s.borderColor,e.beginPath(),e.moveTo(r,h),e.lineTo(l,c),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,i=this._computeLabelArea();i&&Pe(e,i);const s=this._labelItems||(this._labelItems=this._computeLabelItems(t));let n,o;for(n=0,o=s.length;n<o;++n){const t=s[n],i=t.font,o=t.label;t.backdrop&&(e.fillStyle=t.backdrop.color,e.fillRect(t.backdrop.left,t.backdrop.top,t.backdrop.width,t.backdrop.height)),Ae(e,o,0,t.textOffset,i,t)}i&&De(e)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:o}}=this;if(!i.display)return;const a=mi(i.font),r=pi(i.padding),l=i.align;let h=a.lineHeight/2;"bottom"===e||"center"===e||n(e)?(h+=r.bottom,s(i.text)&&(h+=a.lineHeight*(i.text.length-1))):h+=r.top;const{titleX:c,titleY:d,maxWidth:u,rotation:f}=function(t,e,i,s){const{top:o,left:a,bottom:r,right:l,chart:h}=t,{chartArea:c,scales:d}=h;let u,f,g,p=0;const m=r-o,b=l-a;if(t.isHorizontal()){if(f=ut(s,a,l),n(i)){const t=Object.keys(i)[0],s=i[t];g=d[t].getPixelForValue(s)+m-e}else g="center"===i?(c.bottom+c.top)/2+m-e:Vs(t,i,e);u=l-a}else{if(n(i)){const t=Object.keys(i)[0],s=i[t];f=d[t].getPixelForValue(s)-b+e}else f="center"===i?(c.left+c.right)/2-b+e:Vs(t,i,e);g=ut(s,r,o),p="left"===i?-L:L}return{titleX:f,titleY:g,maxWidth:u,rotation:p}}(this,h,e,l);Ae(t,i.text,0,0,a,{color:i.color,maxWidth:u,rotation:f,textAlign:Hs(l,e,o),textBaseline:"middle",translation:[c,d]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=r(t.grid&&t.grid.z,-1);return this._isVisible()&&this.draw===$s.prototype.draw?[{z:i,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let n,o;for(n=0,o=e.length;n<o;++n){const o=e[n];o[i]!==this.id||t&&o.type!==t||s.push(o)}return s}_resolveTickFontOptions(t){return mi(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ys{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;(function(t){return"id"in t&&"defaults"in t})(e)&&(i=this.register(e));const s=this.items,n=t.id,o=this.scope+"."+n;if(!n)throw new Error("class does not have id: "+t);return n in s||(s[n]=t,function(t,e,i){const s=m(Object.create(null),[i?ne.get(i):{},ne.get(e),t.defaults]);ne.set(e,s),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((i=>{const s=i.split("."),n=s.pop(),o=[t].concat(s).join("."),a=e[i].split("."),r=a.pop(),l=a.join(".");ne.route(o,n,l,r)}))}(e,t.defaultRoutes);t.descriptors&&ne.describe(e,t.descriptors)}(t,o,i),this.override&&ne.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,s=this.scope;i in e&&delete e[i],s&&i in ne[s]&&(delete ne[s][i],this.override&&delete te[i])}}var Us=new class{constructor(){this.controllers=new Ys(Ls,"datasets",!0),this.elements=new Ys(Es,"elements"),this.plugins=new Ys(Object,"plugins"),this.scales=new Ys($s,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach((e=>{const s=i||this._getRegistryForType(e);i||s.isForType(e)||s===this.plugins&&e.id?this._exec(t,s,e):d(e,(e=>{const s=i||this._getRegistryForType(e);this._exec(t,s,e)}))}))}_exec(t,e,i){const s=w(t);c(i["before"+s],[],i),e[t](i),c(i["after"+s],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const s=e.get(t);if(void 0===s)throw new Error('"'+t+'" is not a registered '+i+".");return s}};class Xs{constructor(){this._init=[]}notify(t,e,i,s){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const n=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(n,t,e,i);return"afterDestroy"===e&&(this._notify(n,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,i,s){s=s||{};for(const n of t){const t=n.plugin;if(!1===c(t[i],[e,s,n.options],t)&&s.cancelable)return!1}return!0}invalidate(){i(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,s=r(i.options&&i.options.plugins,{}),n=function(t){const e={},i=[],s=Object.keys(Us.plugins.items);for(let t=0;t<s.length;t++)i.push(Us.getPlugin(s[t]));const n=t.plugins||[];for(let t=0;t<n.length;t++){const s=n[t];-1===i.indexOf(s)&&(i.push(s),e[s.id]=!0)}return{plugins:i,localIds:e}}(i);return!1!==s||e?function(t,{plugins:e,localIds:i},s,n){const o=[],a=t.getContext();for(const r of e){const e=r.id,l=qs(s[e],n);null!==l&&o.push({plugin:r,options:Ks(t.config,{plugin:r,local:i[e]},l,a)})}return o}(t,n,s,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,s=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(s(e,i),t,"stop"),this._notify(s(i,e),t,"start")}}function qs(t,e){return e||!1!==t?!0===t?{}:t:null}function Ks(t,{plugin:e,local:i},s,n){const o=t.pluginScopeKeys(e),a=t.getOptionScopes(s,o);return i&&e.defaults&&a.push(e.defaults),t.createResolver(a,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Gs(t,e){const i=ne.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function Zs(t,e){return"x"===t||"y"===t?t:e.axis||("top"===(i=e.position)||"bottom"===i?"x":"left"===i||"right"===i?"y":void 0)||t.charAt(0).toLowerCase();var i}function Js(t){const e=t.options||(t.options={});e.plugins=r(e.plugins,{}),e.scales=function(t,e){const i=te[t.type]||{scales:{}},s=e.scales||{},o=Gs(t.type,e),a=Object.create(null),r=Object.create(null);return Object.keys(s).forEach((t=>{const e=s[t];if(!n(e))return console.error(`Invalid scale configuration for scale: ${t}`);if(e._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${t}`);const l=Zs(t,e),h=function(t,e){return t===e?"_index_":"_value_"}(l,o),c=i.scales||{};a[l]=a[l]||t,r[t]=b(Object.create(null),[{axis:l},e,c[l],c[h]])})),t.data.datasets.forEach((i=>{const n=i.type||t.type,o=i.indexAxis||Gs(n,e),l=(te[n]||{}).scales||{};Object.keys(l).forEach((t=>{const e=function(t,e){let i=t;return"_index_"===t?i=e:"_value_"===t&&(i="x"===e?"y":"x"),i}(t,o),n=i[e+"AxisID"]||a[e]||e;r[n]=r[n]||Object.create(null),b(r[n],[{axis:e},s[n],l[t]])}))})),Object.keys(r).forEach((t=>{const e=r[t];b(e,[ne.scales[e.type],ne.scale])})),r}(t,e)}function Qs(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const tn=new Map,en=new Set;function sn(t,e){let i=tn.get(t);return i||(i=e(),tn.set(t,i),en.add(i)),i}const nn=(t,e,i)=>{const s=y(e,i);void 0!==s&&t.add(s)};class on{constructor(t){this._config=function(t){return(t=t||{}).data=Qs(t.data),Js(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Qs(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Js(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return sn(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return sn(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return sn(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return sn(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const i=this._scopeCache;let s=i.get(t);return s&&!e||(s=new Map,i.set(t,s)),s}getOptionScopes(t,e,i){const{options:s,type:n}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;const r=new Set;e.forEach((e=>{t&&(r.add(t),e.forEach((e=>nn(r,t,e)))),e.forEach((t=>nn(r,s,t))),e.forEach((t=>nn(r,te[n]||{},t))),e.forEach((t=>nn(r,ne,t))),e.forEach((t=>nn(r,ee,t)))}));const l=Array.from(r);return 0===l.length&&l.push(Object.create(null)),en.has(e)&&o.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,te[e]||{},ne.datasets[e]||{},{type:e},ne,ee]}resolveNamedOptions(t,e,i,n=[""]){const o={$shared:!0},{resolver:a,subPrefixes:r}=an(this._resolverCache,t,n);let l=a;if(function(t,e){const{isScriptable:i,isIndexable:n}=Ie(t);for(const o of e){const e=i(o),a=n(o),r=(a||e)&&t[o];if(e&&(k(r)||rn(r))||a&&s(r))return!0}return!1}(a,e)){o.$shared=!1;l=Re(a,i=k(i)?i():i,this.createResolver(t,i,r))}for(const t of e)o[t]=l[t];return o}createResolver(t,e,i=[""],s){const{resolver:o}=an(this._resolverCache,t,i);return n(e)?Re(o,e,void 0,s):o}}function an(t,e,i){let s=t.get(e);s||(s=new Map,t.set(e,s));const n=i.join();let o=s.get(n);if(!o){o={resolver:Ee(e,i),subPrefixes:i.filter((t=>!t.toLowerCase().includes("hover")))},s.set(n,o)}return o}const rn=t=>n(t)&&Object.getOwnPropertyNames(t).reduce(((e,i)=>e||k(t[i])),!1);const ln=["top","bottom","left","right","chartArea"];function hn(t,e){return"top"===t||"bottom"===t||-1===ln.indexOf(t)&&"x"===e}function cn(t,e){return function(i,s){return i[t]===s[t]?i[e]-s[e]:i[t]-s[t]}}function dn(t){const e=t.chart,i=e.options.animation;e.notifyPlugins("afterRender"),c(i&&i.onComplete,[t],e)}function un(t){const e=t.chart,i=e.options.animation;c(i&&i.onProgress,[t],e)}function fn(t){return oe()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const gn={},pn=t=>{const e=fn(t);return Object.values(gn).filter((t=>t.canvas===e)).pop()};function mn(t,e,i){const s=Object.keys(t);for(const n of s){const s=+n;if(s>=e){const o=t[n];delete t[n],(i>0||s>e)&&(t[s+i]=o)}}}class bn{constructor(t,i){const s=this.config=new on(i),n=fn(t),o=pn(n);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const a=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||gs(n)),this.platform.updateConfig(s);const r=this.platform.acquireContext(n,a.aspectRatio),l=r&&r.canvas,h=l&&l.height,c=l&&l.width;this.id=e(),this.ctx=r,this.canvas=l,this.width=c,this.height=h,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Xs,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=ct((t=>this.update(t)),a.resizeDelay||0),this._dataChanges=[],gn[this.id]=this,r&&l?(mt.listen(this,"complete",dn),mt.listen(this,"progress",un),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:s,height:n,_aspectRatio:o}=this;return i(t)?e&&o?o:n?s/n:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():pe(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return we(this.canvas,this.ctx),this}stop(){return mt.stop(this),this}resize(t,e){mt.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,s=this.canvas,n=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,e,n),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),r=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,pe(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),c(i.onResize,[this,o],this),this.attached&&this._doResize(r)&&this.render())}ensureScalesHaveIDs(){d(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,s=Object.keys(i).reduce(((t,e)=>(t[e]=!1,t)),{});let n=[];e&&(n=n.concat(Object.keys(e).map((t=>{const i=e[t],s=Zs(t,i),n="r"===s,o="x"===s;return{options:i,dposition:n?"chartArea":o?"bottom":"left",dtype:n?"radialLinear":o?"category":"linear"}})))),d(n,(e=>{const n=e.options,o=n.id,a=Zs(o,n),l=r(n.type,e.dtype);void 0!==n.position&&hn(n.position,a)===hn(e.dposition)||(n.position=e.dposition),s[o]=!0;let h=null;if(o in i&&i[o].type===l)h=i[o];else{h=new(Us.getScale(l))({id:o,type:l,ctx:this.ctx,chart:this}),i[h.id]=h}h.init(n,t)})),d(s,((t,e)=>{t||delete i[e]})),d(i,(t=>{Zi.configure(this,t,t.options),Zi.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort(((t,e)=>t.index-e.index)),i>e){for(let t=e;t<i;++t)this._destroyDatasetMeta(t);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(cn("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,i)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(i)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=e.length;i<s;i++){const s=e[i];let n=this.getDatasetMeta(i);const o=s.type||this.config.type;if(n.type&&n.type!==o&&(this._destroyDatasetMeta(i),n=this.getDatasetMeta(i)),n.type=o,n.indexAxis=s.indexAxis||Gs(o,this.options),n.order=s.order||0,n.index=i,n.label=""+s.label,n.visible=this.isDatasetVisible(i),n.controller)n.controller.updateIndex(i),n.controller.linkScales();else{const e=Us.getController(o),{datasetElementType:s,dataElementType:a}=ne.datasets[o];Object.assign(e.prototype,{dataElementType:Us.getElement(a),datasetElementType:s&&Us.getElement(s)}),n.controller=new e(this,i),t.push(n.controller)}}return this._updateMetasets(),t}_resetElements(){d(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const n=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),i=!s&&-1===n.indexOf(e);e.buildOrUpdateElements(i),o=Math.max(+e.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),s||d(n,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(cn("z","_idx"));const{_active:a,_lastEvent:r}=this;r?this._eventHandler(r,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){d(this.scales,(t=>{Zi.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);S(e,i)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:n}of e){mn(t,s,"_removeElements"===i?-n:n)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),s=i(0);for(let t=1;t<e;t++)if(!S(s,i(t)))return;return Array.from(s).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Zi.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],d(this.boxes,(t=>{i&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,k(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",s)&&(i.controller._update(e),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(mt.has(this)?this.attached&&!mt.running(this)&&mt.start(this):(this.draw(),dn({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let s,n;for(s=0,n=e.length;s<n;++s){const n=e[s];t&&!n.visible||i.push(n)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i=t._clip,s=!i.disabled,n=this.chartArea,o={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",o)&&(s&&Pe(e,{left:!1===i.left?0:n.left-i.left,right:!1===i.right?this.width:n.right+i.right,top:!1===i.top?0:n.top-i.top,bottom:!1===i.bottom?this.height:n.bottom+i.bottom}),t.controller.draw(),s&&De(e),o.cancelable=!1,this.notifyPlugins("afterDatasetDraw",o))}isPointInArea(t){return Se(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,s){const n=Vi.modes[e];return"function"==typeof n?n(this,t,i,s):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let s=i.filter((t=>t&&t._dataset===e)).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=_i(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return"boolean"==typeof i.hidden?!i.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const s=i?"show":"hide",n=this.getDatasetMeta(t),o=n.controller._resolveAnimations(void 0,s);M(e)?(n.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(n,{visible:i}),this.update((e=>e.datasetIndex===t?s:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),mt.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),we(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete gn[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(i,s)=>{e.addEventListener(this,i,s),t[i]=s},s=(t,e,i)=>{t.offsetX=e,t.offsetY=i,this._eventHandler(t)};d(this.options.events,(t=>i(t,s)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(i,s)=>{e.addEventListener(this,i,s),t[i]=s},s=(i,s)=>{t[i]&&(e.removeEventListener(this,i,s),delete t[i])},n=(t,e)=>{this.canvas&&this.resize(t,e)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),i("resize",n),i("detach",o)};o=()=>{this.attached=!1,s("resize",n),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){d(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},d(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const s=i?"set":"remove";let n,o,a,r;for("dataset"===e&&(n=this.getDatasetMeta(t[0].datasetIndex),n.controller["_"+s+"DatasetHoverStyle"]()),a=0,r=t.length;a<r;++a){o=t[a];const e=o&&this.getDatasetMeta(o.datasetIndex).controller;e&&e[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map((({datasetIndex:t,index:e})=>{const i=this.getDatasetMeta(t);if(!i)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:i.data[e],index:e}}));!u(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}_updateHoverStyles(t,e,i){const s=this.options.hover,n=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),o=n(e,t),a=i?t:n(t,e);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},s=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",i,s))return;const n=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(n||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:s=[],options:n}=this,o=e,a=this._getActiveElements(t,s,i,o),r=P(t),l=function(t,e,i,s){return i&&"mouseout"!==t.type?s?e:t:null}(t,this._lastEvent,i,r);i&&(this._lastEvent=null,c(n.onHover,[t,a,this],this),r&&c(n.onClick,[t,a,this],this));const h=!u(a,s);return(h||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=l,h}_getActiveElements(t,e,i,s){if("mouseout"===t.type)return[];if(!i)return e;const n=this.options.hover;return this.getElementsAtEventForMode(t,n.mode,n,s)}}const xn=()=>d(bn.instances,(t=>t._plugins.invalidate())),_n=!0;function yn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}Object.defineProperties(bn,{defaults:{enumerable:_n,value:ne},instances:{enumerable:_n,value:gn},overrides:{enumerable:_n,value:te},registry:{enumerable:_n,value:Us},version:{enumerable:_n,value:"3.9.1"},getChart:{enumerable:_n,value:pn},register:{enumerable:_n,value:(...t)=>{Us.add(...t),xn()}},unregister:{enumerable:_n,value:(...t)=>{Us.remove(...t),xn()}}});class vn{constructor(t){this.options=t||{}}init(t){}formats(){return yn()}parse(t,e){return yn()}format(t,e){return yn()}add(t,e,i){return yn()}diff(t,e,i){return yn()}startOf(t,e,i){return yn()}endOf(t,e){return yn()}}vn.override=function(t){Object.assign(vn.prototype,t)};var wn={_date:vn};function Mn(t){const e=t.iScale,i=function(t,e){if(!t._cache.$bar){const i=t.getMatchingVisibleMetas(e);let s=[];for(let e=0,n=i.length;e<n;e++)s=s.concat(i[e].controller.getAllParsedValues(t));t._cache.$bar=rt(s.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let s,n,o,a,r=e._length;const l=()=>{32767!==o&&-32768!==o&&(M(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(s=0,n=i.length;s<n;++s)o=e.getPixelForValue(i[s]),l();for(a=void 0,s=0,n=e.ticks.length;s<n;++s)o=e.getPixelForTick(s),l();return r}function kn(t,e,i,n){return s(t)?function(t,e,i,s){const n=i.parse(t[0],s),o=i.parse(t[1],s),a=Math.min(n,o),r=Math.max(n,o);let l=a,h=r;Math.abs(a)>Math.abs(r)&&(l=r,h=a),e[i.axis]=h,e._custom={barStart:l,barEnd:h,start:n,end:o,min:a,max:r}}(t,e,i,n):e[i.axis]=i.parse(t,n),e}function Sn(t,e,i,s){const n=t.iScale,o=t.vScale,a=n.getLabels(),r=n===o,l=[];let h,c,d,u;for(h=i,c=i+s;h<c;++h)u=e[h],d={},d[n.axis]=r||n.parse(a[h],h),l.push(kn(u,d,o,h));return l}function Pn(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function Dn(t,e,i,s){let n=e.borderSkipped;const o={};if(!n)return void(t.borderSkipped=o);if(!0===n)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:a,end:r,reverse:l,top:h,bottom:c}=function(t){let e,i,s,n,o;return t.horizontal?(e=t.base>t.x,i="left",s="right"):(e=t.base<t.y,i="bottom",s="top"),e?(n="end",o="start"):(n="start",o="end"),{start:i,end:s,reverse:e,top:n,bottom:o}}(t);"middle"===n&&i&&(t.enableBorderRadius=!0,(i._top||0)===s?n=h:(i._bottom||0)===s?n=c:(o[On(c,a,r,l)]=!0,n=h)),o[On(n,a,r,l)]=!0,t.borderSkipped=o}function On(t,e,i,s){var n,o,a;return s?(a=i,t=Cn(t=(n=t)===(o=e)?a:n===a?o:n,i,e)):t=Cn(t,e,i),t}function Cn(t,e,i){return"start"===t?e:"end"===t?i:t}function An(t,{inflateAmount:e},i){t.inflateAmount="auto"===e?1===i?.33:0:e}class Tn extends Ls{parsePrimitiveData(t,e,i,s){return Sn(t,e,i,s)}parseArrayData(t,e,i,s){return Sn(t,e,i,s)}parseObjectData(t,e,i,s){const{iScale:n,vScale:o}=t,{xAxisKey:a="x",yAxisKey:r="y"}=this._parsing,l="x"===n.axis?a:r,h="x"===o.axis?a:r,c=[];let d,u,f,g;for(d=i,u=i+s;d<u;++d)g=e[d],f={},f[n.axis]=n.parse(y(g,l),d),c.push(kn(y(g,h),f,o,d));return c}updateRangeFromParsed(t,e,i,s){super.updateRangeFromParsed(t,e,i,s);const n=i._custom;n&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,n.min),t.max=Math.max(t.max,n.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:s}=e,n=this.getParsed(t),o=n._custom,a=Pn(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(n[s.axis]);return{label:""+i.getLabelForValue(n[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,s,n){const o="reset"===n,{index:a,_cachedMeta:{vScale:r}}=this,l=r.getBasePixel(),h=r.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:u}=this._getSharedOptions(e,n);for(let f=e;f<e+s;f++){const e=this.getParsed(f),s=o||i(e[r.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),g=this._calculateBarIndexPixels(f,c),p=(e._stacks||{})[r.axis],m={horizontal:h,base:s.base,enableBorderRadius:!p||Pn(e._custom)||a===p._top||a===p._bottom,x:h?s.head:g.center,y:h?g.center:s.head,height:h?g.size:Math.abs(s.size),width:h?Math.abs(s.size):g.size};u&&(m.options=d||this.resolveDataElementOptions(f,t[f].active?"active":n));const b=m.options||t[f].options;Dn(m,b,p,a),An(m,b,c.ratio),this.updateElement(t[f],f,m,n)}}_getStacks(t,e){const{iScale:s}=this._cachedMeta,n=s.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),o=s.options.stacked,a=[],r=t=>{const s=t.controller.getParsed(e),n=s&&s[t.vScale.axis];if(i(n)||isNaN(n))return!0};for(const i of n)if((void 0===e||!r(i))&&((!1===o||-1===a.indexOf(i.stack)||void 0===o&&void 0===i.stack)&&a.push(i.stack),i.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,i){const s=this._getStacks(t,i),n=void 0!==e?s.indexOf(e):-1;return-1===n?s.length-1:n}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,s=[];let n,o;for(n=0,o=e.data.length;n<o;++n)s.push(i.getPixelForValue(this.getParsed(n)[i.axis],n));const a=t.barThickness;return{min:a||Mn(e),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:s},options:{base:n,minBarLength:o}}=this,a=n||0,r=this.getParsed(t),l=r._custom,h=Pn(l);let c,d,u=r[e.axis],f=0,g=s?this.applyStack(e,r,s):u;g!==u&&(f=g-u,g=u),h&&(u=l.barStart,g=l.barEnd-l.barStart,0!==u&&z(u)!==z(l.barEnd)&&(f=0),f+=u);const p=i(n)||h?f:n;let m=e.getPixelForValue(p);if(c=this.chart.getDataVisibility(t)?e.getPixelForValue(f+g):m,d=c-m,Math.abs(d)<o){d=function(t,e,i){return 0!==t?z(t):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}(d,e,a)*o,u===a&&(m-=d/2);const t=e.getPixelForDecimal(0),i=e.getPixelForDecimal(1),s=Math.min(t,i),n=Math.max(t,i);m=Math.max(Math.min(m,n),s),c=m+d}if(m===e.getPixelForValue(a)){const t=z(d)*e.getLineWidthForValue(a)/2;m+=t,d-=t}return{size:d,base:m,head:c,center:c+d/2}}_calculateBarIndexPixels(t,e){const s=e.scale,n=this.options,o=n.skipNull,a=r(n.maxBarThickness,1/0);let l,h;if(e.grouped){const s=o?this._getStackCount(t):e.stackCount,r="flex"===n.barThickness?function(t,e,i,s){const n=e.pixels,o=n[t];let a=t>0?n[t-1]:null,r=t<n.length-1?n[t+1]:null;const l=i.categoryPercentage;null===a&&(a=o-(null===r?e.end-e.start:r-o)),null===r&&(r=o+o-a);const h=o-(o-Math.min(a,r))/2*l;return{chunk:Math.abs(r-a)/2*l/s,ratio:i.barPercentage,start:h}}(t,e,n,s):function(t,e,s,n){const o=s.barThickness;let a,r;return i(o)?(a=e.min*s.categoryPercentage,r=s.barPercentage):(a=o*n,r=1),{chunk:a/n,ratio:r,start:e.pixels[t]-a/2}}(t,e,n,s),c=this._getStackIndex(this.index,this._cachedMeta.stack,o?t:void 0);l=r.start+r.chunk*c+r.chunk/2,h=Math.min(a,r.chunk*r.ratio)}else l=s.getPixelForValue(this.getParsed(t)[s.axis],t),h=Math.min(a,e.min*e.ratio);return{base:l-h/2,head:l+h/2,center:l,size:h}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,s=i.length;let n=0;for(;n<s;++n)null!==this.getParsed(n)[e.axis]&&i[n].draw(this._ctx)}}Tn.id="bar",Tn.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}},Tn.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class Ln extends Ls{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,s){const n=super.parsePrimitiveData(t,e,i,s);for(let t=0;t<n.length;t++)n[t]._custom=this.resolveDataElementOptions(t+i).radius;return n}parseArrayData(t,e,i,s){const n=super.parseArrayData(t,e,i,s);for(let t=0;t<n.length;t++){const s=e[i+t];n[t]._custom=r(s[2],this.resolveDataElementOptions(t+i).radius)}return n}parseObjectData(t,e,i,s){const n=super.parseObjectData(t,e,i,s);for(let t=0;t<n.length;t++){const s=e[i+t];n[t]._custom=r(s&&s.r&&+s.r,this.resolveDataElementOptions(t+i).radius)}return n}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,{xScale:i,yScale:s}=e,n=this.getParsed(t),o=i.getLabelForValue(n.x),a=s.getLabelForValue(n.y),r=n._custom;return{label:e.label,value:"("+o+", "+a+(r?", "+r:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,s){const n="reset"===s,{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:r,includeOptions:l}=this._getSharedOptions(e,s),h=o.axis,c=a.axis;for(let d=e;d<e+i;d++){const e=t[d],i=!n&&this.getParsed(d),u={},f=u[h]=n?o.getPixelForDecimal(.5):o.getPixelForValue(i[h]),g=u[c]=n?a.getBasePixel():a.getPixelForValue(i[c]);u.skip=isNaN(f)||isNaN(g),l&&(u.options=r||this.resolveDataElementOptions(d,e.active?"active":s),n&&(u.options.radius=0)),this.updateElement(e,d,u,s)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,e);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const n=s.radius;return"active"!==e&&(s.radius=0),s.radius+=r(i&&i._custom,n),s}}Ln.id="bubble",Ln.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}},Ln.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title:()=>""}}}};class En extends Ls{constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,s=this._cachedMeta;if(!1===this._parsing)s._parsed=i;else{let o,a,r=t=>+i[t];if(n(i[t])){const{key:t="value"}=this._parsing;r=e=>+y(i[e],t)}for(o=t,a=t+e;o<a;++o)s._parsed[o]=r(o)}}_getRotation(){return H(this.options.rotation-90)}_getCircumference(){return H(this.options.circumference)}_getRotationExtents(){let t=O,e=-O;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const s=this.chart.getDatasetMeta(i).controller,n=s._getRotation(),o=s._getCircumference();t=Math.min(t,n),e=Math.max(e,n+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,s=this._cachedMeta,n=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(n)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),r=Math.min(l(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:d,rotation:u}=this._getRotationExtents(),{ratioX:f,ratioY:g,offsetX:p,offsetY:m}=function(t,e,i){let s=1,n=1,o=0,a=0;if(e<O){const r=t,l=r+e,h=Math.cos(r),c=Math.sin(r),d=Math.cos(l),u=Math.sin(l),f=(t,e,s)=>G(t,r,l,!0)?1:Math.max(e,e*i,s,s*i),g=(t,e,s)=>G(t,r,l,!0)?-1:Math.min(e,e*i,s,s*i),p=f(0,h,d),m=f(L,c,u),b=g(D,h,d),x=g(D+L,c,u);s=(p-b)/2,n=(m-x)/2,o=-(p+b)/2,a=-(m+x)/2}return{ratioX:s,ratioY:n,offsetX:o,offsetY:a}}(u,d,r),b=(i.width-o)/f,x=(i.height-o)/g,_=Math.max(Math.min(b,x)/2,0),y=h(this.options.radius,_),v=(y-Math.max(y*r,0))/this._getVisibleDatasetWeightTotal();this.offsetX=p*y,this.offsetY=m*y,s.total=this.calculateTotal(),this.outerRadius=y-v*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-v*c,0),this.updateElements(n,0,n.length,t)}_circumference(t,e){const i=this.options,s=this._cachedMeta,n=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||null===s._parsed[t]||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*n/O)}updateElements(t,e,i,s){const n="reset"===s,o=this.chart,a=o.chartArea,r=o.options.animation,l=(a.left+a.right)/2,h=(a.top+a.bottom)/2,c=n&&r.animateScale,d=c?0:this.innerRadius,u=c?0:this.outerRadius,{sharedOptions:f,includeOptions:g}=this._getSharedOptions(e,s);let p,m=this._getRotation();for(p=0;p<e;++p)m+=this._circumference(p,n);for(p=e;p<e+i;++p){const e=this._circumference(p,n),i=t[p],o={x:l+this.offsetX,y:h+this.offsetY,startAngle:m,endAngle:m+e,circumference:e,outerRadius:u,innerRadius:d};g&&(o.options=f||this.resolveDataElementOptions(p,i.active?"active":s)),m+=e,this.updateElement(i,p,o,s)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i,s=0;for(i=0;i<e.length;i++){const n=t._parsed[i];null===n||isNaN(n)||!this.chart.getDataVisibility(i)||e[i].hidden||(s+=Math.abs(n))}return s}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?O*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],n=li(e._parsed[t],i.options.locale);return{label:s[t]||"",value:n}}getMaxBorderWidth(t){let e=0;const i=this.chart;let s,n,o,a,r;if(!t)for(s=0,n=i.data.datasets.length;s<n;++s)if(i.isDatasetVisible(s)){o=i.getDatasetMeta(s),t=o.data,a=o.controller;break}if(!t)return 0;for(s=0,n=t.length;s<n;++s)r=a.resolveDataElementOptions(s),"inner"!==r.borderAlign&&(e=Math.max(e,r.borderWidth||0,r.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,s=t.length;i<s;++i){const t=this.resolveDataElementOptions(i);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max(r(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}En.id="doughnut",En.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"},En.descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t},En.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i}}=t.legend.options;return e.labels.map(((e,s)=>{const n=t.getDatasetMeta(0).controller.getStyle(s);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(s),index:s}}))}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}},tooltip:{callbacks:{title:()=>"",label(t){let e=t.label;const i=": "+t.formattedValue;return s(e)?(e=e.slice(),e[0]+=i):e+=i,e}}}}};class Rn extends Ls{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:s=[],_dataset:n}=e,o=this.chart._animationsDisabled;let{start:a,count:r}=gt(e,s,o);this._drawStart=a,this._drawCount=r,pt(e)&&(a=0,r=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!n._decimated,i.points=s;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:l},t),this.updateElements(s,a,r,t)}updateElements(t,e,s,n){const o="reset"===n,{iScale:a,vScale:r,_stacked:l,_dataset:h}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(e,n),u=a.axis,f=r.axis,{spanGaps:g,segment:p}=this.options,m=B(g)?g:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||o||"none"===n;let x=e>0&&this.getParsed(e-1);for(let g=e;g<e+s;++g){const e=t[g],s=this.getParsed(g),_=b?e:{},y=i(s[f]),v=_[u]=a.getPixelForValue(s[u],g),w=_[f]=o||y?r.getBasePixel():r.getPixelForValue(l?this.applyStack(r,s,l):s[f],g);_.skip=isNaN(v)||isNaN(w)||y,_.stop=g>0&&Math.abs(s[u]-x[u])>m,p&&(_.parsed=s,_.raw=h.data[g]),d&&(_.options=c||this.resolveDataElementOptions(g,e.active?"active":n)),b||this.updateElement(e,g,_,n),x=s}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const n=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,n,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Rn.id="line",Rn.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1},Rn.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class In extends Ls{constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],n=li(e._parsed[t].r,i.options.locale);return{label:s[t]||"",value:n}}parseObjectData(t,e,i,s){return Ue.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,i)=>{const s=this.getParsed(i).r;!isNaN(s)&&this.chart.getDataVisibility(i)&&(s<e.min&&(e.min=s),s>e.max&&(e.max=s))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,s=Math.min(e.right-e.left,e.bottom-e.top),n=Math.max(s/2,0),o=(n-Math.max(i.cutoutPercentage?n/100*i.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=n-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,e,i,s){const n="reset"===s,o=this.chart,a=o.options.animation,r=this._cachedMeta.rScale,l=r.xCenter,h=r.yCenter,c=r.getIndexAngle(0)-.5*D;let d,u=c;const f=360/this.countVisibleElements();for(d=0;d<e;++d)u+=this._computeAngle(d,s,f);for(d=e;d<e+i;d++){const e=t[d];let i=u,g=u+this._computeAngle(d,s,f),p=o.getDataVisibility(d)?r.getDistanceFromCenterForValue(this.getParsed(d).r):0;u=g,n&&(a.animateScale&&(p=0),a.animateRotate&&(i=g=c));const m={x:l,y:h,innerRadius:0,outerRadius:p,startAngle:i,endAngle:g,options:this.resolveDataElementOptions(d,e.active?"active":s)};this.updateElement(e,d,m,s)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,i)=>{!isNaN(this.getParsed(i).r)&&this.chart.getDataVisibility(i)&&e++})),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?H(this.resolveDataElementOptions(t,e).angle||i):0}}In.id="polarArea",In.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0},In.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i}}=t.legend.options;return e.labels.map(((e,s)=>{const n=t.getDatasetMeta(0).controller.getStyle(s);return{text:e,fillStyle:n.backgroundColor,strokeStyle:n.borderColor,lineWidth:n.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(s),index:s}}))}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}},tooltip:{callbacks:{title:()=>"",label:t=>t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class zn extends En{}zn.id="pie",zn.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class Fn extends Ls{getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,s){return Ue.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta,i=e.dataset,s=e.data||[],n=e.iScale.getLabels();if(i.points=s,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const o={_loop:!0,_fullLoop:n.length===s.length,options:e};this.updateElement(i,void 0,o,t)}this.updateElements(s,0,s.length,t)}updateElements(t,e,i,s){const n=this._cachedMeta.rScale,o="reset"===s;for(let a=e;a<e+i;a++){const e=t[a],i=this.resolveDataElementOptions(a,e.active?"active":s),r=n.getPointPositionForValue(a,this.getParsed(a).r),l=o?n.xCenter:r.x,h=o?n.yCenter:r.y,c={x:l,y:h,angle:r.angle,skip:isNaN(l)||isNaN(h),options:i};this.updateElement(e,a,c,s)}}}Fn.id="radar",Fn.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}},Fn.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Vn extends Ls{update(t){const e=this._cachedMeta,{data:i=[]}=e,s=this.chart._animationsDisabled;let{start:n,count:o}=gt(e,i,s);if(this._drawStart=n,this._drawCount=o,pt(e)&&(n=0,o=i.length),this.options.showLine){const{dataset:n,_dataset:o}=e;n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!o._decimated,n.points=i;const a=this.resolveDatasetElementOptions(t);a.segment=this.options.segment,this.updateElement(n,void 0,{animated:!s,options:a},t)}this.updateElements(i,n,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=Us.getElement("line")),super.addElements()}updateElements(t,e,s,n){const o="reset"===n,{iScale:a,vScale:r,_stacked:l,_dataset:h}=this._cachedMeta,c=this.resolveDataElementOptions(e,n),d=this.getSharedOptions(c),u=this.includeOptions(n,d),f=a.axis,g=r.axis,{spanGaps:p,segment:m}=this.options,b=B(p)?p:Number.POSITIVE_INFINITY,x=this.chart._animationsDisabled||o||"none"===n;let _=e>0&&this.getParsed(e-1);for(let c=e;c<e+s;++c){const e=t[c],s=this.getParsed(c),p=x?e:{},y=i(s[g]),v=p[f]=a.getPixelForValue(s[f],c),w=p[g]=o||y?r.getBasePixel():r.getPixelForValue(l?this.applyStack(r,s,l):s[g],c);p.skip=isNaN(v)||isNaN(w)||y,p.stop=c>0&&Math.abs(s[f]-_[f])>b,m&&(p.parsed=s,p.raw=h.data[c]),u&&(p.options=d||this.resolveDataElementOptions(c,e.active?"active":n)),x||this.updateElement(e,c,p,n),_=s}this.updateSharedOptions(d,n,c)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let i=e.length-1;i>=0;--i)t=Math.max(t,e[i].size(this.resolveDataElementOptions(i))/2);return t>0&&t}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!e.length)return s;const n=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(s,n,o)/2}}Vn.id="scatter",Vn.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1},Vn.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title:()=>"",label:t=>"("+t.label+", "+t.formattedValue+")"}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Bn=Object.freeze({__proto__:null,BarController:Tn,BubbleController:Ln,DoughnutController:En,LineController:Rn,PolarAreaController:In,PieController:zn,RadarController:Fn,ScatterController:Vn});function Nn(t,e,i){const{startAngle:s,pixelMargin:n,x:o,y:a,outerRadius:r,innerRadius:l}=e;let h=n/r;t.beginPath(),t.arc(o,a,r,s-h,i+h),l>n?(h=n/l,t.arc(o,a,l,i+h,s-h,!0)):t.arc(o,a,n,i+L,s-L),t.closePath(),t.clip()}function Wn(t,e,i,s){const n=ui(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const o=(i-e)/2,a=Math.min(o,s*e/2),r=t=>{const e=(i-Math.min(o,t))*s/2;return Z(t,0,Math.min(o,e))};return{outerStart:r(n.outerStart),outerEnd:r(n.outerEnd),innerStart:Z(n.innerStart,0,a),innerEnd:Z(n.innerEnd,0,a)}}function jn(t,e,i,s){return{x:i+t*Math.cos(e),y:s+t*Math.sin(e)}}function Hn(t,e,i,s,n,o){const{x:a,y:r,startAngle:l,pixelMargin:h,innerRadius:c}=e,d=Math.max(e.outerRadius+s+i-h,0),u=c>0?c+s+i+h:0;let f=0;const g=n-l;if(s){const t=((c>0?c-s:0)+(d>0?d-s:0))/2;f=(g-(0!==t?g*t/(t+s):g))/2}const p=(g-Math.max(.001,g*d-i/D)/d)/2,m=l+p+f,b=n-p-f,{outerStart:x,outerEnd:_,innerStart:y,innerEnd:v}=Wn(e,u,d,b-m),w=d-x,M=d-_,k=m+x/w,S=b-_/M,P=u+y,O=u+v,C=m+y/P,A=b-v/O;if(t.beginPath(),o){if(t.arc(a,r,d,k,S),_>0){const e=jn(M,S,a,r);t.arc(e.x,e.y,_,S,b+L)}const e=jn(O,b,a,r);if(t.lineTo(e.x,e.y),v>0){const e=jn(O,A,a,r);t.arc(e.x,e.y,v,b+L,A+Math.PI)}if(t.arc(a,r,u,b-v/u,m+y/u,!0),y>0){const e=jn(P,C,a,r);t.arc(e.x,e.y,y,C+Math.PI,m-L)}const i=jn(w,m,a,r);if(t.lineTo(i.x,i.y),x>0){const e=jn(w,k,a,r);t.arc(e.x,e.y,x,m-L,k)}}else{t.moveTo(a,r);const e=Math.cos(k)*d+a,i=Math.sin(k)*d+r;t.lineTo(e,i);const s=Math.cos(S)*d+a,n=Math.sin(S)*d+r;t.lineTo(s,n)}t.closePath()}function $n(t,e,i,s,n,o){const{options:a}=e,{borderWidth:r,borderJoinStyle:l}=a,h="inner"===a.borderAlign;r&&(h?(t.lineWidth=2*r,t.lineJoin=l||"round"):(t.lineWidth=r,t.lineJoin=l||"bevel"),e.fullCircles&&function(t,e,i){const{x:s,y:n,startAngle:o,pixelMargin:a,fullCircles:r}=e,l=Math.max(e.outerRadius-a,0),h=e.innerRadius+a;let c;for(i&&Nn(t,e,o+O),t.beginPath(),t.arc(s,n,h,o+O,o,!0),c=0;c<r;++c)t.stroke();for(t.beginPath(),t.arc(s,n,l,o,o+O),c=0;c<r;++c)t.stroke()}(t,e,h),h&&Nn(t,e,n),Hn(t,e,i,s,n,o),t.stroke())}class Yn extends Es{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.getProps(["x","y"],i),{angle:n,distance:o}=U(s,{x:t,y:e}),{startAngle:a,endAngle:l,innerRadius:h,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),u=this.options.spacing/2,f=r(d,l-a)>=O||G(n,a,l),g=Q(o,h+u,c+u);return f&&g}getCenterPoint(t){const{x:e,y:i,startAngle:s,endAngle:n,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:r,spacing:l}=this.options,h=(s+n)/2,c=(o+a+l+r)/2;return{x:e+Math.cos(h)*c,y:i+Math.sin(h)*c}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,s=(e.offset||0)/2,n=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=i>O?Math.floor(i/O):0,0===i||this.innerRadius<0||this.outerRadius<0)return;t.save();let a=0;if(s){a=s/2;const e=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(e)*a,Math.sin(e)*a),this.circumference>=D&&(a=s)}t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor;const r=function(t,e,i,s,n){const{fullCircles:o,startAngle:a,circumference:r}=e;let l=e.endAngle;if(o){Hn(t,e,i,s,a+O,n);for(let e=0;e<o;++e)t.fill();isNaN(r)||(l=a+r%O,r%O==0&&(l+=O))}return Hn(t,e,i,s,l,n),t.fill(),l}(t,this,a,n,o);$n(t,this,a,n,r,o),t.restore()}}function Un(t,e,i=e){t.lineCap=r(i.borderCapStyle,e.borderCapStyle),t.setLineDash(r(i.borderDash,e.borderDash)),t.lineDashOffset=r(i.borderDashOffset,e.borderDashOffset),t.lineJoin=r(i.borderJoinStyle,e.borderJoinStyle),t.lineWidth=r(i.borderWidth,e.borderWidth),t.strokeStyle=r(i.borderColor,e.borderColor)}function Xn(t,e,i){t.lineTo(i.x,i.y)}function qn(t,e,i={}){const s=t.length,{start:n=0,end:o=s-1}=i,{start:a,end:r}=e,l=Math.max(n,a),h=Math.min(o,r),c=n<a&&o<a||n>r&&o>r;return{count:s,start:l,loop:e.loop,ilen:h<l&&!c?s+h-l:h-l}}function Kn(t,e,i,s){const{points:n,options:o}=e,{count:a,start:r,loop:l,ilen:h}=qn(n,i,s),c=function(t){return t.stepped?Oe:t.tension||"monotone"===t.cubicInterpolationMode?Ce:Xn}(o);let d,u,f,{move:g=!0,reverse:p}=s||{};for(d=0;d<=h;++d)u=n[(r+(p?h-d:d))%a],u.skip||(g?(t.moveTo(u.x,u.y),g=!1):c(t,f,u,p,o.stepped),f=u);return l&&(u=n[(r+(p?h:0))%a],c(t,f,u,p,o.stepped)),!!l}function Gn(t,e,i,s){const n=e.points,{count:o,start:a,ilen:r}=qn(n,i,s),{move:l=!0,reverse:h}=s||{};let c,d,u,f,g,p,m=0,b=0;const x=t=>(a+(h?r-t:t))%o,_=()=>{f!==g&&(t.lineTo(m,g),t.lineTo(m,f),t.lineTo(m,p))};for(l&&(d=n[x(0)],t.moveTo(d.x,d.y)),c=0;c<=r;++c){if(d=n[x(c)],d.skip)continue;const e=d.x,i=d.y,s=0|e;s===u?(i<f?f=i:i>g&&(g=i),m=(b*m+e)/++b):(_(),t.lineTo(e,i),u=s,b=0,f=g=i),p=i}_()}function Zn(t){const e=t.options,i=e.borderDash&&e.borderDash.length;return!(t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||i)?Gn:Kn}Yn.id="arc",Yn.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0},Yn.defaultRoutes={backgroundColor:"backgroundColor"};const Jn="function"==typeof Path2D;function Qn(t,e,i,s){Jn&&!e.options.segment?function(t,e,i,s){let n=e._path;n||(n=e._path=new Path2D,e.path(n,i,s)&&n.closePath()),Un(t,e.options),t.stroke(n)}(t,e,i,s):function(t,e,i,s){const{segments:n,options:o}=e,a=Zn(e);for(const r of n)Un(t,o,r.style),t.beginPath(),a(t,e,r,{start:i,end:i+s-1})&&t.closePath(),t.stroke()}(t,e,i,s)}class to extends Es{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||"monotone"===i.cubicInterpolationMode)&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;Qe(this._points,i,t,s,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Di(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,s=t[e],n=this.points,o=Pi(this,{property:e,start:s,end:s});if(!o.length)return;const a=[],r=function(t){return t.stepped?oi:t.tension||"monotone"===t.cubicInterpolationMode?ai:ni}(i);let l,h;for(l=0,h=o.length;l<h;++l){const{start:h,end:c}=o[l],d=n[h],u=n[c];if(d===u){a.push(d);continue}const f=r(d,u,Math.abs((s-d[e])/(u[e]-d[e])),i.stepped);f[e]=t[e],a.push(f)}return 1===a.length?a[0]:a}pathSegment(t,e,i){return Zn(this)(t,this,e,i)}path(t,e,i){const s=this.segments,n=Zn(this);let o=this._loop;e=e||0,i=i||this.points.length-e;for(const a of s)o&=n(t,this,a,{start:e,end:e+i-1});return!!o}draw(t,e,i,s){const n=this.options||{};(this.points||[]).length&&n.borderWidth&&(t.save(),Qn(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function eo(t,e,i,s){const n=t.options,{[i]:o}=t.getProps([i],s);return Math.abs(e-o)<n.radius+n.hitRadius}to.id="line",to.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0},to.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"},to.descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};class io extends Es{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.options,{x:n,y:o}=this.getProps(["x","y"],i);return Math.pow(t-n,2)+Math.pow(e-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,e){return eo(this,t,"x",e)}inYRange(t,e){return eo(this,t,"y",e)}getCenterPoint(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){let e=(t=t||this.options||{}).radius||0;e=Math.max(e,e&&t.hoverRadius||0);return 2*(e+(e&&t.borderWidth||0))}draw(t,e){const i=this.options;this.skip||i.radius<.1||!Se(this,e,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Me(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function so(t,e){const{x:i,y:s,base:n,width:o,height:a}=t.getProps(["x","y","base","width","height"],e);let r,l,h,c,d;return t.horizontal?(d=a/2,r=Math.min(i,n),l=Math.max(i,n),h=s-d,c=s+d):(d=o/2,r=i-d,l=i+d,h=Math.min(s,n),c=Math.max(s,n)),{left:r,top:h,right:l,bottom:c}}function no(t,e,i,s){return t?0:Z(e,i,s)}function oo(t){const e=so(t),i=e.right-e.left,s=e.bottom-e.top,o=function(t,e,i){const s=t.options.borderWidth,n=t.borderSkipped,o=fi(s);return{t:no(n.top,o.top,0,i),r:no(n.right,o.right,0,e),b:no(n.bottom,o.bottom,0,i),l:no(n.left,o.left,0,e)}}(t,i/2,s/2),a=function(t,e,i){const{enableBorderRadius:s}=t.getProps(["enableBorderRadius"]),o=t.options.borderRadius,a=gi(o),r=Math.min(e,i),l=t.borderSkipped,h=s||n(o);return{topLeft:no(!h||l.top||l.left,a.topLeft,0,r),topRight:no(!h||l.top||l.right,a.topRight,0,r),bottomLeft:no(!h||l.bottom||l.left,a.bottomLeft,0,r),bottomRight:no(!h||l.bottom||l.right,a.bottomRight,0,r)}}(t,i/2,s/2);return{outer:{x:e.left,y:e.top,w:i,h:s,radius:a},inner:{x:e.left+o.l,y:e.top+o.t,w:i-o.l-o.r,h:s-o.t-o.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(o.t,o.l)),topRight:Math.max(0,a.topRight-Math.max(o.t,o.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(o.b,o.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(o.b,o.r))}}}}function ao(t,e,i,s){const n=null===e,o=null===i,a=t&&!(n&&o)&&so(t,s);return a&&(n||Q(e,a.left,a.right))&&(o||Q(i,a.top,a.bottom))}function ro(t,e){t.rect(e.x,e.y,e.w,e.h)}function lo(t,e,i={}){const s=t.x!==i.x?-e:0,n=t.y!==i.y?-e:0,o=(t.x+t.w!==i.x+i.w?e:0)-s,a=(t.y+t.h!==i.y+i.h?e:0)-n;return{x:t.x+s,y:t.y+n,w:t.w+o,h:t.h+a,radius:t.radius}}io.id="point",io.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0},io.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};class ho extends Es{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:s}}=this,{inner:n,outer:o}=oo(this),a=(r=o.radius).topLeft||r.topRight||r.bottomLeft||r.bottomRight?Le:ro;var r;t.save(),o.w===n.w&&o.h===n.h||(t.beginPath(),a(t,lo(o,e,n)),t.clip(),a(t,lo(n,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,lo(n,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,i){return ao(this,t,e,i)}inXRange(t,e){return ao(this,t,null,e)}inYRange(t,e){return ao(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:s,horizontal:n}=this.getProps(["x","y","base","horizontal"],t);return{x:n?(e+s)/2:e,y:n?i:(i+s)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}}ho.id="bar",ho.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0},ho.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var co=Object.freeze({__proto__:null,ArcElement:Yn,LineElement:to,PointElement:io,BarElement:ho});function uo(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function fo(t){t.data.datasets.forEach((t=>{uo(t)}))}var go={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,s)=>{if(!s.enabled)return void fo(t);const n=t.width;t.data.datasets.forEach(((e,o)=>{const{_data:a,indexAxis:r}=e,l=t.getDatasetMeta(o),h=a||e.data;if("y"===bi([r,t.options.indexAxis]))return;if(!l.controller.supportsDecimation)return;const c=t.scales[l.xAxisID];if("linear"!==c.type&&"time"!==c.type)return;if(t.options.parsing)return;let{start:d,count:u}=function(t,e){const i=e.length;let s,n=0;const{iScale:o}=t,{min:a,max:r,minDefined:l,maxDefined:h}=o.getUserBounds();return l&&(n=Z(et(e,o.axis,a).lo,0,i-1)),s=h?Z(et(e,o.axis,r).hi+1,n,i)-n:i-n,{start:n,count:s}}(l,h);if(u<=(s.threshold||4*n))return void uo(e);let f;switch(i(a)&&(e._data=h,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),s.algorithm){case"lttb":f=function(t,e,i,s,n){const o=n.samples||s;if(o>=i)return t.slice(e,e+i);const a=[],r=(i-2)/(o-2);let l=0;const h=e+i-1;let c,d,u,f,g,p=e;for(a[l++]=t[p],c=0;c<o-2;c++){let s,n=0,o=0;const h=Math.floor((c+1)*r)+1+e,m=Math.min(Math.floor((c+2)*r)+1,i)+e,b=m-h;for(s=h;s<m;s++)n+=t[s].x,o+=t[s].y;n/=b,o/=b;const x=Math.floor(c*r)+1+e,_=Math.min(Math.floor((c+1)*r)+1,i)+e,{x:y,y:v}=t[p];for(u=f=-1,s=x;s<_;s++)f=.5*Math.abs((y-n)*(t[s].y-v)-(y-t[s].x)*(o-v)),f>u&&(u=f,d=t[s],g=s);a[l++]=d,p=g}return a[l++]=t[h],a}(h,d,u,n,s);break;case"min-max":f=function(t,e,s,n){let o,a,r,l,h,c,d,u,f,g,p=0,m=0;const b=[],x=e+s-1,_=t[e].x,y=t[x].x-_;for(o=e;o<e+s;++o){a=t[o],r=(a.x-_)/y*n,l=a.y;const e=0|r;if(e===h)l<f?(f=l,c=o):l>g&&(g=l,d=o),p=(m*p+a.x)/++m;else{const s=o-1;if(!i(c)&&!i(d)){const e=Math.min(c,d),i=Math.max(c,d);e!==u&&e!==s&&b.push({...t[e],x:p}),i!==u&&i!==s&&b.push({...t[i],x:p})}o>0&&s!==u&&b.push(t[s]),b.push(a),h=e,m=0,f=g=l,c=d=u=o}}return b}(h,d,u,n);break;default:throw new Error(`Unsupported decimation algorithm '${s.algorithm}'`)}e._decimated=f}))},destroy(t){fo(t)}};function po(t,e,i,s){if(s)return;let n=e[t],o=i[t];return"angle"===t&&(n=K(n),o=K(o)),{property:t,start:n,end:o}}function mo(t,e,i){for(;e>t;e--){const t=i[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function bo(t,e,i,s){return t&&e?s(t[i],e[i]):t?t[i]:e?e[i]:0}function xo(t,e){let i=[],n=!1;return s(t)?(n=!0,i=t):i=function(t,e){const{x:i=null,y:s=null}=t||{},n=e.points,o=[];return e.segments.forEach((({start:t,end:e})=>{e=mo(t,e,n);const a=n[t],r=n[e];null!==s?(o.push({x:a.x,y:s}),o.push({x:r.x,y:s})):null!==i&&(o.push({x:i,y:a.y}),o.push({x:i,y:r.y}))})),o}(t,e),i.length?new to({points:i,options:{tension:0},_loop:n,_fullLoop:n}):null}function _o(t){return t&&!1!==t.fill}function yo(t,e,i){let s=t[e].fill;const n=[e];let a;if(!i)return s;for(;!1!==s&&-1===n.indexOf(s);){if(!o(s))return s;if(a=t[s],!a)return!1;if(a.visible)return s;n.push(s),s=a.fill}return!1}function vo(t,e,i){const s=function(t){const e=t.options,i=e.fill;let s=r(i&&i.target,i);void 0===s&&(s=!!e.backgroundColor);if(!1===s||null===s)return!1;if(!0===s)return"origin";return s}(t);if(n(s))return!isNaN(s.value)&&s;let a=parseFloat(s);return o(a)&&Math.floor(a)===a?function(t,e,i,s){"-"!==t&&"+"!==t||(i=e+i);if(i===e||i<0||i>=s)return!1;return i}(s[0],e,a,i):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function wo(t,e,i){const s=[];for(let n=0;n<i.length;n++){const o=i[n],{first:a,last:r,point:l}=Mo(o,e,"x");if(!(!l||a&&r))if(a)s.unshift(l);else if(t.push(l),!r)break}t.push(...s)}function Mo(t,e,i){const s=t.interpolate(e,i);if(!s)return{};const n=s[i],o=t.segments,a=t.points;let r=!1,l=!1;for(let t=0;t<o.length;t++){const e=o[t],s=a[e.start][i],h=a[e.end][i];if(Q(n,s,h)){r=n===s,l=n===h;break}}return{first:r,last:l,point:s}}class ko{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:s,y:n,radius:o}=this;return e=e||{start:0,end:O},t.arc(s,n,o,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:s}=this,n=t.angle;return{x:e+Math.cos(n)*s,y:i+Math.sin(n)*s,angle:n}}}function So(t){const{chart:e,fill:i,line:s}=t;if(o(i))return function(t,e){const i=t.getDatasetMeta(e);return i&&t.isDatasetVisible(e)?i.dataset:null}(e,i);if("stack"===i)return function(t){const{scale:e,index:i,line:s}=t,n=[],o=s.segments,a=s.points,r=function(t,e){const i=[],s=t.getMatchingVisibleMetas("line");for(let t=0;t<s.length;t++){const n=s[t];if(n.index===e)break;n.hidden||i.unshift(n.dataset)}return i}(e,i);r.push(xo({x:null,y:e.bottom},s));for(let t=0;t<o.length;t++){const e=o[t];for(let t=e.start;t<=e.end;t++)wo(n,a[t],r)}return new to({points:n,options:{}})}(t);if("shape"===i)return!0;const a=function(t){if((t.scale||{}).getPointPositionForValue)return function(t){const{scale:e,fill:i}=t,s=e.options,o=e.getLabels().length,a=s.reverse?e.max:e.min,r=function(t,e,i){let s;return s="start"===t?i:"end"===t?e.options.reverse?e.min:e.max:n(t)?t.value:e.getBaseValue(),s}(i,e,a),l=[];if(s.grid.circular){const t=e.getPointPositionForValue(0,a);return new ko({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(r)})}for(let t=0;t<o;++t)l.push(e.getPointPositionForValue(t,r));return l}(t);return function(t){const{scale:e={},fill:i}=t,s=function(t,e){let i=null;return"start"===t?i=e.bottom:"end"===t?i=e.top:n(t)?i=e.getPixelForValue(t.value):e.getBasePixel&&(i=e.getBasePixel()),i}(i,e);if(o(s)){const t=e.isHorizontal();return{x:t?s:null,y:t?null:s}}return null}(t)}(t);return a instanceof ko?a:xo(a,s)}function Po(t,e,i){const s=So(e),{line:n,scale:o,axis:a}=e,r=n.options,l=r.fill,h=r.backgroundColor,{above:c=h,below:d=h}=l||{};s&&n.points.length&&(Pe(t,i),function(t,e){const{line:i,target:s,above:n,below:o,area:a,scale:r}=e,l=i._loop?"angle":e.axis;t.save(),"x"===l&&o!==n&&(Do(t,s,a.top),Oo(t,{line:i,target:s,color:n,scale:r,property:l}),t.restore(),t.save(),Do(t,s,a.bottom));Oo(t,{line:i,target:s,color:o,scale:r,property:l}),t.restore()}(t,{line:n,target:s,above:c,below:d,area:i,scale:o,axis:a}),De(t))}function Do(t,e,i){const{segments:s,points:n}=e;let o=!0,a=!1;t.beginPath();for(const r of s){const{start:s,end:l}=r,h=n[s],c=n[mo(s,l,n)];o?(t.moveTo(h.x,h.y),o=!1):(t.lineTo(h.x,i),t.lineTo(h.x,h.y)),a=!!e.pathSegment(t,r,{move:a}),a?t.closePath():t.lineTo(c.x,i)}t.lineTo(e.first().x,i),t.closePath(),t.clip()}function Oo(t,e){const{line:i,target:s,property:n,color:o,scale:a}=e,r=function(t,e,i){const s=t.segments,n=t.points,o=e.points,a=[];for(const t of s){let{start:s,end:r}=t;r=mo(s,r,n);const l=po(i,n[s],n[r],t.loop);if(!e.segments){a.push({source:t,target:l,start:n[s],end:n[r]});continue}const h=Pi(e,l);for(const e of h){const s=po(i,o[e.start],o[e.end],e.loop),r=Si(t,n,s);for(const t of r)a.push({source:t,target:e,start:{[i]:bo(l,s,"start",Math.max)},end:{[i]:bo(l,s,"end",Math.min)}})}}return a}(i,s,n);for(const{source:e,target:l,start:h,end:c}of r){const{style:{backgroundColor:r=o}={}}=e,d=!0!==s;t.save(),t.fillStyle=r,Co(t,a,d&&po(n,h,c)),t.beginPath();const u=!!i.pathSegment(t,e);let f;if(d){u?t.closePath():Ao(t,s,c,n);const e=!!s.pathSegment(t,l,{move:u,reverse:!0});f=u&&e,f||Ao(t,s,h,n)}t.closePath(),t.fill(f?"evenodd":"nonzero"),t.restore()}}function Co(t,e,i){const{top:s,bottom:n}=e.chart.chartArea,{property:o,start:a,end:r}=i||{};"x"===o&&(t.beginPath(),t.rect(a,s,r-a,n-s),t.clip())}function Ao(t,e,i,s){const n=e.interpolate(i,s);n&&t.lineTo(n.x,n.y)}var To={id:"filler",afterDatasetsUpdate(t,e,i){const s=(t.data.datasets||[]).length,n=[];let o,a,r,l;for(a=0;a<s;++a)o=t.getDatasetMeta(a),r=o.dataset,l=null,r&&r.options&&r instanceof to&&(l={visible:t.isDatasetVisible(a),index:a,fill:vo(r,a,s),chart:t,axis:o.controller.options.indexAxis,scale:o.vScale,line:r}),o.$filler=l,n.push(l);for(a=0;a<s;++a)l=n[a],l&&!1!==l.fill&&(l.fill=yo(n,a,i.propagate))},beforeDraw(t,e,i){const s="beforeDraw"===i.drawTime,n=t.getSortedVisibleDatasetMetas(),o=t.chartArea;for(let e=n.length-1;e>=0;--e){const i=n[e].$filler;i&&(i.line.updateControlPoints(o,i.axis),s&&i.fill&&Po(t.ctx,i,o))}},beforeDatasetsDraw(t,e,i){if("beforeDatasetsDraw"!==i.drawTime)return;const s=t.getSortedVisibleDatasetMetas();for(let e=s.length-1;e>=0;--e){const i=s[e].$filler;_o(i)&&Po(t.ctx,i,t.chartArea)}},beforeDatasetDraw(t,e,i){const s=e.meta.$filler;_o(s)&&"beforeDatasetDraw"===i.drawTime&&Po(t.ctx,s,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Lo=(t,e)=>{let{boxHeight:i=e,boxWidth:s=e}=t;return t.usePointStyle&&(i=Math.min(i,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:i,itemHeight:Math.max(e,i)}};class Eo extends Es{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=c(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,i)=>t.sort(e,i,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const i=t.labels,s=mi(i.font),n=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:r}=Lo(i,n);let l,h;e.font=s.string,this.isHorizontal()?(l=this.maxWidth,h=this._fitRows(o,n,a,r)+10):(h=this.maxHeight,l=this._fitCols(o,n,a,r)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,s){const{ctx:n,maxWidth:o,options:{labels:{padding:a}}}=this,r=this.legendHitBoxes=[],l=this.lineWidths=[0],h=s+a;let c=t;n.textAlign="left",n.textBaseline="middle";let d=-1,u=-h;return this.legendItems.forEach(((t,f)=>{const g=i+e/2+n.measureText(t.text).width;(0===f||l[l.length-1]+g+2*a>o)&&(c+=h,l[l.length-(f>0?0:1)]=0,u+=h,d++),r[f]={left:0,top:u,row:d,width:g,height:s},l[l.length-1]+=g+a})),c}_fitCols(t,e,i,s){const{ctx:n,maxHeight:o,options:{labels:{padding:a}}}=this,r=this.legendHitBoxes=[],l=this.columnSizes=[],h=o-t;let c=a,d=0,u=0,f=0,g=0;return this.legendItems.forEach(((t,o)=>{const p=i+e/2+n.measureText(t.text).width;o>0&&u+s+2*a>h&&(c+=d+a,l.push({width:d,height:u}),f+=d+a,g++,d=u=0),r[o]={left:f,top:u,col:g,width:p,height:s},d=Math.max(d,p),u+=s+a})),c+=d,l.push({width:d,height:u}),c}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:s},rtl:n}}=this,o=yi(n,this.left,this.width);if(this.isHorizontal()){let n=0,a=ut(i,this.left+s,this.right-this.lineWidths[n]);for(const r of e)n!==r.row&&(n=r.row,a=ut(i,this.left+s,this.right-this.lineWidths[n])),r.top+=this.top+t+s,r.left=o.leftForLtr(o.x(a),r.width),a+=r.width+s}else{let n=0,a=ut(i,this.top+t+s,this.bottom-this.columnSizes[n].height);for(const r of e)r.col!==n&&(n=r.col,a=ut(i,this.top+t+s,this.bottom-this.columnSizes[n].height)),r.top=a,r.left+=this.left+s,r.left=o.leftForLtr(o.x(r.left),r.width),a+=r.height+s}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;Pe(t,this),this._draw(),De(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:s}=this,{align:n,labels:o}=t,a=ne.color,l=yi(t.rtl,this.left,this.width),h=mi(o.font),{color:c,padding:d}=o,u=h.size,f=u/2;let g;this.drawTitle(),s.textAlign=l.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=h.string;const{boxWidth:p,boxHeight:m,itemHeight:b}=Lo(o,u),x=this.isHorizontal(),_=this._computeTitleHeight();g=x?{x:ut(n,this.left+d,this.right-i[0]),y:this.top+d+_,line:0}:{x:this.left+d,y:ut(n,this.top+_+d,this.bottom-e[0].height),line:0},vi(this.ctx,t.textDirection);const y=b+d;this.legendItems.forEach(((v,w)=>{s.strokeStyle=v.fontColor||c,s.fillStyle=v.fontColor||c;const M=s.measureText(v.text).width,k=l.textAlign(v.textAlign||(v.textAlign=o.textAlign)),S=p+f+M;let P=g.x,D=g.y;l.setWidth(this.width),x?w>0&&P+S+d>this.right&&(D=g.y+=y,g.line++,P=g.x=ut(n,this.left+d,this.right-i[g.line])):w>0&&D+y>this.bottom&&(P=g.x=P+e[g.line].width+d,g.line++,D=g.y=ut(n,this.top+_+d,this.bottom-e[g.line].height));!function(t,e,i){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;s.save();const n=r(i.lineWidth,1);if(s.fillStyle=r(i.fillStyle,a),s.lineCap=r(i.lineCap,"butt"),s.lineDashOffset=r(i.lineDashOffset,0),s.lineJoin=r(i.lineJoin,"miter"),s.lineWidth=n,s.strokeStyle=r(i.strokeStyle,a),s.setLineDash(r(i.lineDash,[])),o.usePointStyle){const a={radius:m*Math.SQRT2/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:n},r=l.xPlus(t,p/2);ke(s,a,r,e+f,o.pointStyleWidth&&p)}else{const o=e+Math.max((u-m)/2,0),a=l.leftForLtr(t,p),r=gi(i.borderRadius);s.beginPath(),Object.values(r).some((t=>0!==t))?Le(s,{x:a,y:o,w:p,h:m,radius:r}):s.rect(a,o,p,m),s.fill(),0!==n&&s.stroke()}s.restore()}(l.x(P),D,v),P=ft(k,P+p+f,x?P+S:this.right,t.rtl),function(t,e,i){Ae(s,i.text,t,e+b/2,h,{strikethrough:i.hidden,textAlign:l.textAlign(i.textAlign)})}(l.x(P),D,v),x?g.x+=S+d:g.y+=y})),wi(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=mi(e.font),s=pi(e.padding);if(!e.display)return;const n=yi(t.rtl,this.left,this.width),o=this.ctx,a=e.position,r=i.size/2,l=s.top+r;let h,c=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),h=this.top+l,c=ut(t.align,c,this.right-d);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);h=l+ut(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const u=ut(a,c,c+d);o.textAlign=n.textAlign(dt(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,Ae(o,e.text,u,h,i)}_computeTitleHeight(){const t=this.options.title,e=mi(t.font),i=pi(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,s,n;if(Q(t,this.left,this.right)&&Q(e,this.top,this.bottom))for(n=this.legendHitBoxes,i=0;i<n.length;++i)if(s=n[i],Q(t,s.left,s.left+s.width)&&Q(e,s.top,s.top+s.height))return this.legendItems[i];return null}handleEvent(t){const e=this.options;if(!function(t,e){if(("mousemove"===t||"mouseout"===t)&&(e.onHover||e.onLeave))return!0;if(e.onClick&&("click"===t||"mouseup"===t))return!0;return!1}(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const o=this._hoveredItem,a=(n=i,null!==(s=o)&&null!==n&&s.datasetIndex===n.datasetIndex&&s.index===n.index);o&&!a&&c(e.onLeave,[t,o,this],this),this._hoveredItem=i,i&&!a&&c(e.onHover,[t,i,this],this)}else i&&c(e.onClick,[t,i,this],this);var s,n}}var Ro={id:"legend",_element:Eo,start(t,e,i){const s=t.legend=new Eo({ctx:t.ctx,options:i,chart:t});Zi.configure(t,s,i),Zi.addBox(t,s)},stop(t){Zi.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,i){const s=t.legend;Zi.configure(t,s,i),s.options=i},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,i){const s=e.datasetIndex,n=i.chart;n.isDatasetVisible(s)?(n.hide(s),e.hidden=!0):(n.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:i,pointStyle:s,textAlign:n,color:o}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const a=t.controller.getStyle(i?0:void 0),r=pi(a.borderWidth);return{text:e[t.index].label,fillStyle:a.backgroundColor,fontColor:o,hidden:!t.visible,lineCap:a.borderCapStyle,lineDash:a.borderDash,lineDashOffset:a.borderDashOffset,lineJoin:a.borderJoinStyle,lineWidth:(r.width+r.height)/4,strokeStyle:a.borderColor,pointStyle:s||a.pointStyle,rotation:a.rotation,textAlign:n||a.textAlign,borderRadius:0,datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Io extends Es{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const n=s(i.text)?i.text.length:1;this._padding=pi(i.padding);const o=n*mi(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:i,bottom:s,right:n,options:o}=this,a=o.align;let r,l,h,c=0;return this.isHorizontal()?(l=ut(a,i,n),h=e+t,r=n-i):("left"===o.position?(l=i+t,h=ut(a,s,e),c=-.5*D):(l=n-t,h=ut(a,e,s),c=.5*D),r=s-e),{titleX:l,titleY:h,maxWidth:r,rotation:c}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=mi(e.font),s=i.lineHeight/2+this._padding.top,{titleX:n,titleY:o,maxWidth:a,rotation:r}=this._drawArgs(s);Ae(t,e.text,0,0,i,{color:e.color,maxWidth:a,rotation:r,textAlign:dt(e.align),textBaseline:"middle",translation:[n,o]})}}var zo={id:"title",_element:Io,start(t,e,i){!function(t,e){const i=new Io({ctx:t.ctx,options:e,chart:t});Zi.configure(t,i,e),Zi.addBox(t,i),t.titleBlock=i}(t,i)},stop(t){const e=t.titleBlock;Zi.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,i){const s=t.titleBlock;Zi.configure(t,s,i),s.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Fo=new WeakMap;var Vo={id:"subtitle",start(t,e,i){const s=new Io({ctx:t.ctx,options:i,chart:t});Zi.configure(t,s,i),Zi.addBox(t,s),Fo.set(t,s)},stop(t){Zi.removeBox(t,Fo.get(t)),Fo.delete(t)},beforeUpdate(t,e,i){const s=Fo.get(t);Zi.configure(t,s,i),s.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Bo={average(t){if(!t.length)return!1;let e,i,s=0,n=0,o=0;for(e=0,i=t.length;e<i;++e){const i=t[e].element;if(i&&i.hasValue()){const t=i.tooltipPosition();s+=t.x,n+=t.y,++o}}return{x:s/o,y:n/o}},nearest(t,e){if(!t.length)return!1;let i,s,n,o=e.x,a=e.y,r=Number.POSITIVE_INFINITY;for(i=0,s=t.length;i<s;++i){const s=t[i].element;if(s&&s.hasValue()){const t=X(e,s.getCenterPoint());t<r&&(r=t,n=s)}}if(n){const t=n.tooltipPosition();o=t.x,a=t.y}return{x:o,y:a}}};function No(t,e){return e&&(s(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Wo(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function jo(t,e){const{element:i,datasetIndex:s,index:n}=e,o=t.getDatasetMeta(s).controller,{label:a,value:r}=o.getLabelAndValue(n);return{chart:t,label:a,parsed:o.getParsed(n),raw:t.data.datasets[s].data[n],formattedValue:r,dataset:o.getDataset(),dataIndex:n,datasetIndex:s,element:i}}function Ho(t,e){const i=t.chart.ctx,{body:s,footer:n,title:o}=t,{boxWidth:a,boxHeight:r}=e,l=mi(e.bodyFont),h=mi(e.titleFont),c=mi(e.footerFont),u=o.length,f=n.length,g=s.length,p=pi(e.padding);let m=p.height,b=0,x=s.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);if(x+=t.beforeBody.length+t.afterBody.length,u&&(m+=u*h.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),x){m+=g*(e.displayColors?Math.max(r,l.lineHeight):l.lineHeight)+(x-g)*l.lineHeight+(x-1)*e.bodySpacing}f&&(m+=e.footerMarginTop+f*c.lineHeight+(f-1)*e.footerSpacing);let _=0;const y=function(t){b=Math.max(b,i.measureText(t).width+_)};return i.save(),i.font=h.string,d(t.title,y),i.font=l.string,d(t.beforeBody.concat(t.afterBody),y),_=e.displayColors?a+2+e.boxPadding:0,d(s,(t=>{d(t.before,y),d(t.lines,y),d(t.after,y)})),_=0,i.font=c.string,d(t.footer,y),i.restore(),b+=p.width,{width:b,height:m}}function $o(t,e,i,s){const{x:n,width:o}=i,{width:a,chartArea:{left:r,right:l}}=t;let h="center";return"center"===s?h=n<=(r+l)/2?"left":"right":n<=o/2?h="left":n>=a-o/2&&(h="right"),function(t,e,i,s){const{x:n,width:o}=s,a=i.caretSize+i.caretPadding;return"left"===t&&n+o+a>e.width||"right"===t&&n-o-a<0||void 0}(h,t,e,i)&&(h="center"),h}function Yo(t,e,i){const s=i.yAlign||e.yAlign||function(t,e){const{y:i,height:s}=e;return i<s/2?"top":i>t.height-s/2?"bottom":"center"}(t,i);return{xAlign:i.xAlign||e.xAlign||$o(t,e,i,s),yAlign:s}}function Uo(t,e,i,s){const{caretSize:n,caretPadding:o,cornerRadius:a}=t,{xAlign:r,yAlign:l}=i,h=n+o,{topLeft:c,topRight:d,bottomLeft:u,bottomRight:f}=gi(a);let g=function(t,e){let{x:i,width:s}=t;return"right"===e?i-=s:"center"===e&&(i-=s/2),i}(e,r);const p=function(t,e,i){let{y:s,height:n}=t;return"top"===e?s+=i:s-="bottom"===e?n+i:n/2,s}(e,l,h);return"center"===l?"left"===r?g+=h:"right"===r&&(g-=h):"left"===r?g-=Math.max(c,u)+n:"right"===r&&(g+=Math.max(d,f)+n),{x:Z(g,0,s.width-e.width),y:Z(p,0,s.height-e.height)}}function Xo(t,e,i){const s=pi(i.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-s.right:t.x+s.left}function qo(t){return No([],Wo(t))}function Ko(t,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?t.override(i):t}class Go extends Es{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&e.options.animation&&i.animations,n=new ys(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(n)),n}getContext(){return this.$context||(this.$context=(t=this.chart.getContext(),e=this,i=this._tooltipItems,_i(t,{tooltip:e,tooltipItems:i,type:"tooltip"})));var t,e,i}getTitle(t,e){const{callbacks:i}=e,s=i.beforeTitle.apply(this,[t]),n=i.title.apply(this,[t]),o=i.afterTitle.apply(this,[t]);let a=[];return a=No(a,Wo(s)),a=No(a,Wo(n)),a=No(a,Wo(o)),a}getBeforeBody(t,e){return qo(e.callbacks.beforeBody.apply(this,[t]))}getBody(t,e){const{callbacks:i}=e,s=[];return d(t,(t=>{const e={before:[],lines:[],after:[]},n=Ko(i,t);No(e.before,Wo(n.beforeLabel.call(this,t))),No(e.lines,n.label.call(this,t)),No(e.after,Wo(n.afterLabel.call(this,t))),s.push(e)})),s}getAfterBody(t,e){return qo(e.callbacks.afterBody.apply(this,[t]))}getFooter(t,e){const{callbacks:i}=e,s=i.beforeFooter.apply(this,[t]),n=i.footer.apply(this,[t]),o=i.afterFooter.apply(this,[t]);let a=[];return a=No(a,Wo(s)),a=No(a,Wo(n)),a=No(a,Wo(o)),a}_createItems(t){const e=this._active,i=this.chart.data,s=[],n=[],o=[];let a,r,l=[];for(a=0,r=e.length;a<r;++a)l.push(jo(this.chart,e[a]));return t.filter&&(l=l.filter(((e,s,n)=>t.filter(e,s,n,i)))),t.itemSort&&(l=l.sort(((e,s)=>t.itemSort(e,s,i)))),d(l,(e=>{const i=Ko(t.callbacks,e);s.push(i.labelColor.call(this,e)),n.push(i.labelPointStyle.call(this,e)),o.push(i.labelTextColor.call(this,e))})),this.labelColors=s,this.labelPointStyles=n,this.labelTextColors=o,this.dataPoints=l,l}update(t,e){const i=this.options.setContext(this.getContext()),s=this._active;let n,o=[];if(s.length){const t=Bo[i.position].call(this,s,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const e=this._size=Ho(this,i),a=Object.assign({},t,e),r=Yo(this.chart,i,a),l=Uo(i,a,r,this.chart);this.xAlign=r.xAlign,this.yAlign=r.yAlign,n={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(n={opacity:0});this._tooltipItems=o,this.$context=void 0,n&&this._resolveAnimations().update(this,n),SQMTimeChart.hooktwo(this,n),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,s){const n=this.getCaretPosition(t,i,s);e.lineTo(n.x1,n.y1),e.lineTo(n.x2,n.y2),e.lineTo(n.x3,n.y3)}getCaretPosition(t,e,i){const{xAlign:s,yAlign:n}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:r,topRight:l,bottomLeft:h,bottomRight:c}=gi(a),{x:d,y:u}=t,{width:f,height:g}=e;let p,m,b,x,_,y;return"center"===n?(_=u+g/2,"left"===s?(p=d,m=p-o,x=_+o,y=_-o):(p=d+f,m=p+o,x=_-o,y=_+o),b=p):(m="left"===s?d+Math.max(r,h)+o:"right"===s?d+f-Math.max(l,c)-o:this.caretX,"top"===n?(x=u,_=x-o,p=m-o,b=m+o):(x=u+g,_=x+o,p=m+o,b=m-o),y=x),{x1:p,x2:m,x3:b,y1:x,y2:_,y3:y}}drawTitle(t,e,i){const s=this.title,n=s.length;let o,a,r;if(n){const l=yi(i.rtl,this.x,this.width);for(t.x=Xo(this,i.titleAlign,i),e.textAlign=l.textAlign(i.titleAlign),e.textBaseline="middle",o=mi(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=o.string,r=0;r<n;++r)e.fillText(s[r],l.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,r+1===n&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,s,o){const a=this.labelColors[i],r=this.labelPointStyles[i],{boxHeight:l,boxWidth:h,boxPadding:c}=o,d=mi(o.bodyFont),u=Xo(this,"left",o),f=s.x(u),g=l<d.lineHeight?(d.lineHeight-l)/2:0,p=e.y+g;if(o.usePointStyle){const e={radius:Math.min(h,l)/2,pointStyle:r.pointStyle,rotation:r.rotation,borderWidth:1},i=s.leftForLtr(f,h)+h/2,n=p+l/2;t.strokeStyle=o.multiKeyBackground,t.fillStyle=o.multiKeyBackground,Me(t,e,i,n),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,Me(t,e,i,n)}else{t.lineWidth=n(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const e=s.leftForLtr(f,h-c),i=s.leftForLtr(s.xPlus(f,1),h-c-2),r=gi(a.borderRadius);Object.values(r).some((t=>0!==t))?(t.beginPath(),t.fillStyle=o.multiKeyBackground,Le(t,{x:e,y:p,w:h,h:l,radius:r}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),Le(t,{x:i,y:p+1,w:h-2,h:l-2,radius:r}),t.fill()):(t.fillStyle=o.multiKeyBackground,t.fillRect(e,p,h,l),t.strokeRect(e,p,h,l),t.fillStyle=a.backgroundColor,t.fillRect(i,p+1,h-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:s}=this,{bodySpacing:n,bodyAlign:o,displayColors:a,boxHeight:r,boxWidth:l,boxPadding:h}=i,c=mi(i.bodyFont);let u=c.lineHeight,f=0;const g=yi(i.rtl,this.x,this.width),p=function(i){e.fillText(i,g.x(t.x+f),t.y+u/2),t.y+=u+n},m=g.textAlign(o);let b,x,_,y,v,w,M;for(e.textAlign=o,e.textBaseline="middle",e.font=c.string,t.x=Xo(this,m,i),e.fillStyle=i.bodyColor,d(this.beforeBody,p),f=a&&"right"!==m?"center"===o?l/2+h:l+2+h:0,y=0,w=s.length;y<w;++y){for(b=s[y],x=this.labelTextColors[y],e.fillStyle=x,d(b.before,p),_=b.lines,a&&_.length&&(this._drawColorBox(e,t,y,g,i),u=Math.max(c.lineHeight,r)),v=0,M=_.length;v<M;++v)p(_[v]),u=c.lineHeight;d(b.after,p)}f=0,u=c.lineHeight,d(this.afterBody,p),t.y-=n}drawFooter(t,e,i){const s=this.footer,n=s.length;let o,a;if(n){const r=yi(i.rtl,this.x,this.width);for(t.x=Xo(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=r.textAlign(i.footerAlign),e.textBaseline="middle",o=mi(i.footerFont),e.fillStyle=i.footerColor,e.font=o.string,a=0;a<n;++a)e.fillText(s[a],r.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,e,i,s){const{xAlign:n,yAlign:o}=this,{x:a,y:r}=t,{width:l,height:h}=i,{topLeft:c,topRight:d,bottomLeft:u,bottomRight:f}=gi(s.cornerRadius);e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.beginPath(),e.moveTo(a+c,r),"top"===o&&this.drawCaret(t,e,i,s),e.lineTo(a+l-d,r),e.quadraticCurveTo(a+l,r,a+l,r+d),"center"===o&&"right"===n&&this.drawCaret(t,e,i,s),e.lineTo(a+l,r+h-f),e.quadraticCurveTo(a+l,r+h,a+l-f,r+h),"bottom"===o&&this.drawCaret(t,e,i,s),e.lineTo(a+u,r+h),e.quadraticCurveTo(a,r+h,a,r+h-u),"center"===o&&"left"===n&&this.drawCaret(t,e,i,s),e.lineTo(a,r+c),e.quadraticCurveTo(a,r,a+c,r),e.closePath(),e.fill(),s.borderWidth>0&&e.stroke(),SQMTimeChart.hook(this,a,r,l,h,n,o)}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,s=i&&i.x,n=i&&i.y;if(s||n){const i=Bo[t.position].call(this,this._active,this._eventPosition);if(!i)return;const o=this._size=Ho(this,t),a=Object.assign({},i,this._size),r=Yo(e,t,a),l=Uo(t,a,r,e);s._to===l.x&&n._to===l.y||(this.xAlign=r.xAlign,this.yAlign=r.yAlign,this.width=o.width,this.height=o.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const s={width:this.width,height:this.height},n={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=pi(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(n,t,s,e),vi(t,e.textDirection),n.y+=o.top,this.drawTitle(n,t,e),this.drawBody(n,t,e),this.drawFooter(n,t,e),wi(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,s=t.map((({datasetIndex:t,index:e})=>{const i=this.chart.getDatasetMeta(t);if(!i)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:i.data[e],index:e}})),n=!u(i,s),o=this._positionChanged(s,e);(n||o)&&(this._active=s,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,n=this._active||[],o=this._getActiveElements(t,n,e,i),a=this._positionChanged(o,t),r=e||!u(o,n)||a;return r&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),r}_getActiveElements(t,e,i,s){const n=this.options;if("mouseout"===t.type)return[];if(!s)return e;const o=this.chart.getElementsAtEventForMode(t,n.mode,n,i);return n.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:i,caretY:s,options:n}=this,o=Bo[n.position].call(this,t,e);return!1!==o&&(i!==o.x||s!==o.y)}}Go.positioners=Bo;var Zo={id:"tooltip",_element:Go,positioners:Bo,afterInit(t,e,i){i&&(t.tooltip=new Go({chart:t,options:i}))},beforeUpdate(t,e,i){t.tooltip&&t.tooltip.initialize(i)},reset(t,e,i){t.tooltip&&t.tooltip.initialize(i)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",i))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",i)}},afterEvent(t,e){if(t.tooltip){const i=e.replay;t.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:t,title(t){if(t.length>0){const e=t[0],i=e.chart.data.labels,s=i?i.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return i[e.dataIndex]}return""},afterTitle:t,beforeBody:t,beforeLabel:t,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const s=t.formattedValue;return i(s)||(e+=s),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:t,afterBody:t,beforeFooter:t,footer:t,afterFooter:t}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},Jo=Object.freeze({__proto__:null,Decimation:go,Filler:To,Legend:Ro,SubTitle:Vo,Title:zo,Tooltip:Zo});function Qo(t,e,i,s){const n=t.indexOf(e);if(-1===n)return((t,e,i,s)=>("string"==typeof e?(i=t.push(e)-1,s.unshift({index:i,label:e})):isNaN(e)&&(i=null),i))(t,e,i,s);return n!==t.lastIndexOf(e)?i:n}class ta extends $s{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:i,label:s}of e)t[i]===s&&t.splice(i,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(i(t))return null;const s=this.getLabels();return((t,e)=>null===t?null:Z(Math.round(t),0,e))(e=isFinite(e)&&s[e]===t?e:Qo(s,t,r(e,t),this._addedLabels),s.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(i=0),e||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,s=[];let n=this.getLabels();n=0===t&&e===n.length-1?n:n.slice(t,e+1),this._valueRange=Math.max(n.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let i=t;i<=e;i++)s.push({value:i});return s}getLabelForValue(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function ea(t,e,{horizontal:i,minRotation:s}){const n=H(s),o=(i?Math.sin(n):Math.cos(n))||.001,a=.75*e*(""+t).length;return Math.min(e/o,a)}ta.id="category",ta.defaults={ticks:{callback:ta.prototype.getLabelForValue}};class ia extends $s{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return i(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:n}=this;const o=t=>s=e?s:t,a=t=>n=i?n:t;if(t){const t=z(s),e=z(n);t<0&&e<0?a(0):t>0&&e>0&&o(0)}if(s===n){let e=1;(n>=Number.MAX_SAFE_INTEGER||s<=Number.MIN_SAFE_INTEGER)&&(e=Math.abs(.05*n)),a(n+e),t||o(s-e)}this.min=s,this.max=n}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:i,stepSize:s}=t;return s?(e=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),i=i||11),i&&(e=Math.min(i,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let s=this.getTickLimit();s=Math.max(2,s);const n=function(t,e){const s=[],{bounds:n,step:o,min:a,max:r,precision:l,count:h,maxTicks:c,maxDigits:d,includeBounds:u}=t,f=o||1,g=c-1,{min:p,max:m}=e,b=!i(a),x=!i(r),_=!i(h),y=(m-p)/(d+1);let v,w,M,k,S=F((m-p)/g/f)*f;if(S<1e-14&&!b&&!x)return[{value:p},{value:m}];k=Math.ceil(m/S)-Math.floor(p/S),k>g&&(S=F(k*S/g/f)*f),i(l)||(v=Math.pow(10,l),S=Math.ceil(S*v)/v),"ticks"===n?(w=Math.floor(p/S)*S,M=Math.ceil(m/S)*S):(w=p,M=m),b&&x&&o&&W((r-a)/o,S/1e3)?(k=Math.round(Math.min((r-a)/S,c)),S=(r-a)/k,w=a,M=r):_?(w=b?a:w,M=x?r:M,k=h-1,S=(M-w)/k):(k=(M-w)/S,k=N(k,Math.round(k),S/1e3)?Math.round(k):Math.ceil(k));const P=Math.max(Y(S),Y(w));v=Math.pow(10,i(l)?P:l),w=Math.round(w*v)/v,M=Math.round(M*v)/v;let D=0;for(b&&(u&&w!==a?(s.push({value:a}),w<a&&D++,N(Math.round((w+D*S)*v)/v,a,ea(a,y,t))&&D++):w<a&&D++);D<k;++D)s.push({value:Math.round((w+D*S)*v)/v});return x&&u&&M!==r?s.length&&N(s[s.length-1].value,r,ea(r,y,t))?s[s.length-1].value=r:s.push({value:r}):x&&M!==r||s.push({value:M}),s}({maxTicks:s,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&j(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-e)/Math.max(t.length-1,1)/2;e-=s,i+=s}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return li(t,this.chart.options.locale,this.options.ticks.format)}}class sa extends ia{determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=o(t)?t:0,this.max=o(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=H(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,n=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,n.lineHeight/s))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}function na(t){return 1===t/Math.pow(10,Math.floor(I(t)))}sa.id="linear",sa.defaults={ticks:{callback:Is.formatters.numeric}};class oa extends $s{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=ia.prototype.parse.apply(this,[t,e]);if(0!==i)return o(i)&&i>0?i:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=o(t)?Math.max(0,t):null,this.max=o(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,s=this.max;const n=e=>i=t?i:e,o=t=>s=e?s:t,a=(t,e)=>Math.pow(10,Math.floor(I(t))+e);i===s&&(i<=0?(n(1),o(10)):(n(a(i,-1)),o(a(s,1)))),i<=0&&n(a(s,-1)),s<=0&&o(a(i,1)),this._zero&&this.min!==this._suggestedMin&&i===a(this.min,0)&&n(a(i,-1)),this.min=i,this.max=s}buildTicks(){const t=this.options,e=function(t,e){const i=Math.floor(I(e.max)),s=Math.ceil(e.max/Math.pow(10,i)),n=[];let o=a(t.min,Math.pow(10,Math.floor(I(e.min)))),r=Math.floor(I(o)),l=Math.floor(o/Math.pow(10,r)),h=r<0?Math.pow(10,Math.abs(r)):1;do{n.push({value:o,major:na(o)}),++l,10===l&&(l=1,++r,h=r>=0?1:h),o=Math.round(l*Math.pow(10,r)*h)/h}while(r<i||r===i&&l<s);const c=a(t.max,o);return n.push({value:c,major:na(o)}),n}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&j(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":li(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=I(t),this._valueRange=I(this.max)-I(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(I(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function aa(t){const e=t.ticks;if(e.display&&t.display){const t=pi(e.backdropPadding);return r(e.font&&e.font.size,ne.font.size)+t.height}return 0}function ra(t,e,i,s,n){return t===s||t===n?{start:e-i/2,end:e+i/2}:t<s||t>n?{start:e-i,end:e}:{start:e,end:e+i}}function la(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},i=Object.assign({},e),n=[],o=[],a=t._pointLabels.length,r=t.options.pointLabels,l=r.centerPointLabels?D/a:0;for(let u=0;u<a;u++){const a=r.setContext(t.getPointLabelContext(u));o[u]=a.padding;const f=t.getPointPosition(u,t.drawingArea+o[u],l),g=mi(a.font),p=(h=t.ctx,c=g,d=s(d=t._pointLabels[u])?d:[d],{w:ye(h,c.string,d),h:d.length*c.lineHeight});n[u]=p;const m=K(t.getIndexAngle(u)+l),b=Math.round($(m));ha(i,e,m,ra(b,f.x,p.w,0,180),ra(b,f.y,p.h,90,270))}var h,c,d;t.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),t._pointLabelItems=function(t,e,i){const s=[],n=t._pointLabels.length,o=t.options,a=aa(o)/2,r=t.drawingArea,l=o.pointLabels.centerPointLabels?D/n:0;for(let o=0;o<n;o++){const n=t.getPointPosition(o,r+a+i[o],l),h=Math.round($(K(n.angle+L))),c=e[o],d=ua(n.y,c.h,h),u=ca(h),f=da(n.x,c.w,u);s.push({x:n.x,y:d,textAlign:u,left:f,top:d,right:f+c.w,bottom:d+c.h})}return s}(t,n,o)}function ha(t,e,i,s,n){const o=Math.abs(Math.sin(i)),a=Math.abs(Math.cos(i));let r=0,l=0;s.start<e.l?(r=(e.l-s.start)/o,t.l=Math.min(t.l,e.l-r)):s.end>e.r&&(r=(s.end-e.r)/o,t.r=Math.max(t.r,e.r+r)),n.start<e.t?(l=(e.t-n.start)/a,t.t=Math.min(t.t,e.t-l)):n.end>e.b&&(l=(n.end-e.b)/a,t.b=Math.max(t.b,e.b+l))}function ca(t){return 0===t||180===t?"center":t<180?"left":"right"}function da(t,e,i){return"right"===i?t-=e:"center"===i&&(t-=e/2),t}function ua(t,e,i){return 90===i||270===i?t-=e/2:(i>270||i<90)&&(t-=e),t}function fa(t,e,i,s){const{ctx:n}=t;if(i)n.arc(t.xCenter,t.yCenter,e,0,O);else{let i=t.getPointPosition(0,e);n.moveTo(i.x,i.y);for(let o=1;o<s;o++)i=t.getPointPosition(o,e),n.lineTo(i.x,i.y)}}oa.id="logarithmic",oa.defaults={ticks:{callback:Is.formatters.logarithmic,major:{enabled:!0}}};class ga extends ia{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=pi(aa(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=o(t)&&!isNaN(t)?t:0,this.max=o(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/aa(this.options))}generateTickLabels(t){ia.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const i=c(this.options.pointLabels.callback,[t,e],this);return i||0===i?i:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?la(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,s))}getIndexAngle(t){return K(t*(O/(this._pointLabels.length||1))+H(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(i(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(i(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return function(t,e,i){return _i(t,{label:i,index:e,type:"pointLabel"})}(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const s=this.getIndexAngle(t)-L+i;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:s,bottom:n}=this._pointLabelItems[t];return{left:e,top:i,right:s,bottom:n}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),fa(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:s,grid:n}=e,o=this._pointLabels.length;let a,r,l;if(e.pointLabels.display&&function(t,e){const{ctx:s,options:{pointLabels:n}}=t;for(let o=e-1;o>=0;o--){const e=n.setContext(t.getPointLabelContext(o)),a=mi(e.font),{x:r,y:l,textAlign:h,left:c,top:d,right:u,bottom:f}=t._pointLabelItems[o],{backdropColor:g}=e;if(!i(g)){const t=gi(e.borderRadius),i=pi(e.backdropPadding);s.fillStyle=g;const n=c-i.left,o=d-i.top,a=u-c+i.width,r=f-d+i.height;Object.values(t).some((t=>0!==t))?(s.beginPath(),Le(s,{x:n,y:o,w:a,h:r,radius:t}),s.fill()):s.fillRect(n,o,a,r)}Ae(s,t._pointLabels[o],r,l+a.lineHeight/2,a,{color:e.color,textAlign:h,textBaseline:"middle"})}}(this,o),n.display&&this.ticks.forEach(((t,e)=>{if(0!==e){r=this.getDistanceFromCenterForValue(t.value);!function(t,e,i,s){const n=t.ctx,o=e.circular,{color:a,lineWidth:r}=e;!o&&!s||!a||!r||i<0||(n.save(),n.strokeStyle=a,n.lineWidth=r,n.setLineDash(e.borderDash),n.lineDashOffset=e.borderDashOffset,n.beginPath(),fa(t,i,o,s),n.closePath(),n.stroke(),n.restore())}(this,n.setContext(this.getContext(e-1)),r,o)}})),s.display){for(t.save(),a=o-1;a>=0;a--){const i=s.setContext(this.getPointLabelContext(a)),{color:n,lineWidth:o}=i;o&&n&&(t.lineWidth=o,t.strokeStyle=n,t.setLineDash(i.borderDash),t.lineDashOffset=i.borderDashOffset,r=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),l=this.getPointPosition(a,r),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let n,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((s,a)=>{if(0===a&&!e.reverse)return;const r=i.setContext(this.getContext(a)),l=mi(r.font);if(n=this.getDistanceFromCenterForValue(this.ticks[a].value),r.showLabelBackdrop){t.font=l.string,o=t.measureText(s.label).width,t.fillStyle=r.backdropColor;const e=pi(r.backdropPadding);t.fillRect(-o/2-e.left,-n-l.size/2-e.top,o+e.width,l.size+e.height)}Ae(t,s.label,0,-n,l,{color:r.color})})),t.restore()}drawTitle(){}}ga.id="radialLinear",ga.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Is.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}},ga.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"},ga.descriptors={angleLines:{_fallback:"grid"}};const pa={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ma=Object.keys(pa);function ba(t,e){return t-e}function xa(t,e){if(i(e))return null;const s=t._adapter,{parser:n,round:a,isoWeekday:r}=t._parseOpts;let l=e;return"function"==typeof n&&(l=n(l)),o(l)||(l="string"==typeof n?s.parse(l,n):s.parse(l)),null===l?null:(a&&(l="week"!==a||!B(r)&&!0!==r?s.startOf(l,a):s.startOf(l,"isoWeek",r)),+l)}function _a(t,e,i,s){const n=ma.length;for(let o=ma.indexOf(t);o<n-1;++o){const t=pa[ma[o]],n=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((i-e)/(n*t.size))<=s)return ma[o]}return ma[n-1]}function ya(t,e,i){if(i){if(i.length){const{lo:s,hi:n}=tt(i,e);t[i[s]>=e?i[s]:i[n]]=!0}}else t[e]=!0}function va(t,e,i){const s=[],n={},o=e.length;let a,r;for(a=0;a<o;++a)r=e[a],n[r]=a,s.push({value:r,major:!1});return 0!==o&&i?function(t,e,i,s){const n=t._adapter,o=+n.startOf(e[0].value,s),a=e[e.length-1].value;let r,l;for(r=o;r<=a;r=+n.add(r,1,s))l=i[r],l>=0&&(e[l].major=!0);return e}(t,s,n,i):s}class wa extends $s{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e){const i=t.time||(t.time={}),s=this._adapter=new wn._date(t.adapters.date);s.init(e),b(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:xa(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:s,max:n,minDefined:a,maxDefined:r}=this.getUserBounds();function l(t){a||isNaN(t.min)||(s=Math.min(s,t.min)),r||isNaN(t.max)||(n=Math.max(n,t.max))}a&&r||(l(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||l(this.getMinMax(!1))),s=o(s)&&!isNaN(s)?s:+e.startOf(Date.now(),i),n=o(n)&&!isNaN(n)?n:+e.endOf(Date.now(),i)+1,this.min=Math.min(s,n-1),this.max=Math.max(s+1,n)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,s="labels"===i.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const n=this.min,o=st(s,n,this.max);return this._unit=e.unit||(i.autoSkip?_a(e.minUnit,this.min,this.max,this._getLabelCapacity(n)):function(t,e,i,s,n){for(let o=ma.length-1;o>=ma.indexOf(i);o--){const i=ma[o];if(pa[i].common&&t._adapter.diff(n,s,i)>=e-1)return i}return ma[i?ma.indexOf(i):0]}(this,o.length,e.minUnit,this.min,this.max)),this._majorUnit=i.major.enabled&&"year"!==this._unit?function(t){for(let e=ma.indexOf(t)+1,i=ma.length;e<i;++e)if(pa[ma[e]].common)return ma[e]}(this._unit):void 0,this.initOffsets(s),t.reverse&&o.reverse(),va(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t){let e,i,s=0,n=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),s=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,i=this.getDecimalForValue(t[t.length-1]),n=1===t.length?i:(i-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;s=Z(s,0,o),n=Z(n,0,o),this._offsets={start:s,end:n,factor:1/(s+1+n)}}_generate(){const t=this._adapter,e=this.min,i=this.max,s=this.options,n=s.time,o=n.unit||_a(n.minUnit,e,i,this._getLabelCapacity(e)),a=r(n.stepSize,1),l="week"===o&&n.isoWeekday,h=B(l)||!0===l,c={};let d,u,f=e;if(h&&(f=+t.startOf(f,"isoWeek",l)),f=+t.startOf(f,h?"day":o),t.diff(i,e,o)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+o);const g="data"===s.ticks.source&&this.getDataTimestamps();for(d=f,u=0;d<i;d=+t.add(d,a,o),u++)ya(c,d,g);return d!==i&&"ticks"!==s.bounds&&1!==u||ya(c,d,g),Object.keys(c).sort(((t,e)=>t-e)).map((t=>+t))}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}_tickFormatFunction(t,e,i,s){const n=this.options,o=n.time.displayFormats,a=this._unit,r=this._majorUnit,l=a&&o[a],h=r&&o[r],d=i[e],u=r&&h&&d&&d.major,f=this._adapter.format(t,s||(u?h:l)),g=n.ticks.callback;return g?c(g,[f,e,i],this):f}generateTickLabels(t){let e,i,s;for(e=0,i=t.length;e<i;++e)s=t[e],s.label=this._tickFormatFunction(s.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,s=H(this.isHorizontal()?e.maxRotation:e.minRotation),n=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:i*n+a*o,h:i*o+a*n}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,s=i[e.unit]||i.millisecond,n=this._tickFormatFunction(t,0,va(this,[t],this._majorUnit),s),o=this._getLabelSize(n),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t,e,i=this._cache.data||[];if(i.length)return i;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,e=s.length;t<e;++t)i=i.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(i)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const s=this.getLabels();for(e=0,i=s.length;e<i;++e)t.push(xa(this,s[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return rt(t.sort(ba))}}function Ma(t,e,i){let s,n,o,a,r=0,l=t.length-1;i?(e>=t[r].pos&&e<=t[l].pos&&({lo:r,hi:l}=et(t,"pos",e)),({pos:s,time:o}=t[r]),({pos:n,time:a}=t[l])):(e>=t[r].time&&e<=t[l].time&&({lo:r,hi:l}=et(t,"time",e)),({time:s,pos:o}=t[r]),({time:n,pos:a}=t[l]));const h=n-s;return h?o+(a-o)*(e-s)/h:o}wa.id="time",wa.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};class ka extends wa{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Ma(e,this.min),this._tableRange=Ma(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,s=[],n=[];let o,a,r,l,h;for(o=0,a=t.length;o<a;++o)l=t[o],l>=e&&l<=i&&s.push(l);if(s.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,a=s.length;o<a;++o)h=s[o+1],r=s[o-1],l=s[o],Math.round((h+r)/2)!==l&&n.push({time:l,pos:o/(a-1)});return n}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return t=e.length&&i.length?this.normalize(e.concat(i)):e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Ma(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return Ma(this._table,i*this._tableRange+this._minPos,!0)}}ka.id="timeseries",ka.defaults=wa.defaults;var Sa=Object.freeze({__proto__:null,CategoryScale:ta,LinearScale:sa,LogarithmicScale:oa,RadialLinearScale:ga,TimeScale:wa,TimeSeriesScale:ka});return bn.register(Bn,Sa,co,Jo),bn.helpers={...Ti},bn._adapters=wn,bn.Animation=xs,bn.Animations=ys,bn.animator=mt,bn.controllers=Us.controllers.items,bn.DatasetController=Ls,bn.Element=Es,bn.elements=co,bn.Interaction=Vi,bn.layouts=Zi,bn.platforms=ps,bn.Scale=$s,bn.Ticks=Is,Object.assign(bn,Bn,Sa,co,Jo,ps),bn.Chart=bn,"undefined"!=typeof window&&(window.Chart=bn),bn}));
/*!
 * chartjs-adapter-date-fns v3.0.0
 * https://www.chartjs.org
 * (c) 2022 chartjs-adapter-date-fns Contributors
 * Released under the MIT license
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Chart)}(this,(function(t){"use strict";function e(t){if(null===t||!0===t||!1===t)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function r(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function n(t){r(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}function a(t,a){r(2,arguments);var i=n(t),o=e(a);return isNaN(o)?new Date(NaN):o?(i.setDate(i.getDate()+o),i):i}function i(t,a){r(2,arguments);var i=n(t),o=e(a);if(isNaN(o))return new Date(NaN);if(!o)return i;var u=i.getDate(),s=new Date(i.getTime());s.setMonth(i.getMonth()+o+1,0);var c=s.getDate();return u>=c?s:(i.setFullYear(s.getFullYear(),s.getMonth(),u),i)}function o(t,a){r(2,arguments);var i=n(t).getTime(),o=e(a);return new Date(i+o)}var u=36e5;function s(t,a){r(1,arguments);var i=a||{},o=i.locale,u=o&&o.options&&o.options.weekStartsOn,s=null==u?0:e(u),c=null==i.weekStartsOn?s:e(i.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=n(t),l=d.getDay(),f=(l<c?7:0)+l-c;return d.setDate(d.getDate()-f),d.setHours(0,0,0,0),d}function c(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function d(t){r(1,arguments);var e=n(t);return e.setHours(0,0,0,0),e}var l=864e5;function f(t,e){r(2,arguments);var n=d(t),a=d(e),i=n.getTime()-c(n),o=a.getTime()-c(a);return Math.round((i-o)/l)}function h(t,e){r(2,arguments);var a=n(t),i=n(e),o=a.getTime()-i.getTime();return o<0?-1:o>0?1:o}function m(t){r(1,arguments);var e=n(t);return!isNaN(e)}function w(t,e){r(2,arguments);var a=n(t),i=n(e),o=a.getFullYear()-i.getFullYear(),u=a.getMonth()-i.getMonth();return 12*o+u}function g(t,e){r(2,arguments);var a=n(t),i=n(e);return a.getFullYear()-i.getFullYear()}function v(t,e){var r=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return r<0?-1:r>0?1:r}function y(t,e){r(2,arguments);var a=n(t),i=n(e),o=v(a,i),u=Math.abs(f(a,i));a.setDate(a.getDate()-o*u);var s=v(a,i)===-o,c=o*(u-s);return 0===c?0:c}function b(t,e){r(2,arguments);var a=n(t),i=n(e);return a.getTime()-i.getTime()}var T=36e5;function p(t){r(1,arguments);var e=n(t);return e.setHours(23,59,59,999),e}function C(t){r(1,arguments);var e=n(t),a=e.getMonth();return e.setFullYear(e.getFullYear(),a+1,0),e.setHours(23,59,59,999),e}function M(t){r(1,arguments);var e=n(t);return p(e).getTime()===C(e).getTime()}function D(t,e){r(2,arguments);var a,i=n(t),o=n(e),u=h(i,o),s=Math.abs(w(i,o));if(s<1)a=0;else{1===i.getMonth()&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-u*s);var c=h(i,o)===-u;M(n(t))&&1===s&&1===h(t,o)&&(c=!1),a=u*(s-c)}return 0===a?0:a}var x={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function k(t){return function(e){var r=e||{},n=r.width?String(r.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}var U={date:k({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:k({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:k({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Y={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function N(t){return function(e,r){var n,a=r||{};if("formatting"===(a.context?String(a.context):"standalone")&&t.formattingValues){var i=t.defaultFormattingWidth||t.defaultWidth,o=a.width?String(a.width):i;n=t.formattingValues[o]||t.formattingValues[i]}else{var u=t.defaultWidth,s=a.width?String(a.width):t.defaultWidth;n=t.values[s]||t.values[u]}return n[t.argumentCallback?t.argumentCallback(e):e]}}function S(t){return function(e,r){var n=String(e),a=r||{},i=a.width,o=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],u=n.match(o);if(!u)return null;var s,c=u[0],d=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth];return s="[object Array]"===Object.prototype.toString.call(d)?function(t,e){for(var r=0;r<t.length;r++)if(e(t[r]))return r}(d,(function(t){return t.test(c)})):function(t,e){for(var r in t)if(t.hasOwnProperty(r)&&e(t[r]))return r}(d,(function(t){return t.test(c)})),s=t.valueCallback?t.valueCallback(s):s,{value:s=a.valueCallback?a.valueCallback(s):s,rest:n.slice(c.length)}}}var P,q={code:"en-US",formatDistance:function(t,e,r){var n;return r=r||{},n="string"==typeof x[t]?x[t]:1===e?x[t].one:x[t].other.replace("{{count}}",e),r.addSuffix?r.comparison>0?"in "+n:n+" ago":n},formatLong:U,formatRelative:function(t,e,r,n){return Y[t]},localize:{ordinalNumber:function(t,e){var r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:N({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:N({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(t){return Number(t)-1}}),month:N({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:N({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:N({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(P={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(t){return parseInt(t,10)}},function(t,e){var r=String(t),n=e||{},a=r.match(P.matchPattern);if(!a)return null;var i=a[0],o=r.match(P.parsePattern);if(!o)return null;var u=P.valueCallback?P.valueCallback(o[0]):o[0];return{value:u=n.valueCallback?n.valueCallback(u):u,rest:r.slice(i.length)}}),era:S({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:S({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:S({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:S({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:S({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function H(t,n){r(2,arguments);var a=e(n);return o(t,-a)}function E(t,e){for(var r=t<0?"-":"",n=Math.abs(t).toString();n.length<e;)n="0"+n;return r+n}var O={y:function(t,e){var r=t.getUTCFullYear(),n=r>0?r:1-r;return E("yy"===e?n%100:n,e.length)},M:function(t,e){var r=t.getUTCMonth();return"M"===e?String(r+1):E(r+1,2)},d:function(t,e){return E(t.getUTCDate(),e.length)},a:function(t,e){var r=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return"am"===r?"a.m.":"p.m."}},h:function(t,e){return E(t.getUTCHours()%12||12,e.length)},H:function(t,e){return E(t.getUTCHours(),e.length)},m:function(t,e){return E(t.getUTCMinutes(),e.length)},s:function(t,e){return E(t.getUTCSeconds(),e.length)},S:function(t,e){var r=e.length,n=t.getUTCMilliseconds();return E(Math.floor(n*Math.pow(10,r-3)),e.length)}},F=864e5;function W(t){r(1,arguments);var e=1,a=n(t),i=a.getUTCDay(),o=(i<e?7:0)+i-e;return a.setUTCDate(a.getUTCDate()-o),a.setUTCHours(0,0,0,0),a}function L(t){r(1,arguments);var e=n(t),a=e.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(a+1,0,4),i.setUTCHours(0,0,0,0);var o=W(i),u=new Date(0);u.setUTCFullYear(a,0,4),u.setUTCHours(0,0,0,0);var s=W(u);return e.getTime()>=o.getTime()?a+1:e.getTime()>=s.getTime()?a:a-1}function Q(t){r(1,arguments);var e=L(t),n=new Date(0);n.setUTCFullYear(e,0,4),n.setUTCHours(0,0,0,0);var a=W(n);return a}var R=6048e5;function I(t){r(1,arguments);var e=n(t),a=W(e).getTime()-Q(e).getTime();return Math.round(a/R)+1}function G(t,a){r(1,arguments);var i=a||{},o=i.locale,u=o&&o.options&&o.options.weekStartsOn,s=null==u?0:e(u),c=null==i.weekStartsOn?s:e(i.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=n(t),l=d.getUTCDay(),f=(l<c?7:0)+l-c;return d.setUTCDate(d.getUTCDate()-f),d.setUTCHours(0,0,0,0),d}function X(t,a){r(1,arguments);var i=n(t,a),o=i.getUTCFullYear(),u=a||{},s=u.locale,c=s&&s.options&&s.options.firstWeekContainsDate,d=null==c?1:e(c),l=null==u.firstWeekContainsDate?d:e(u.firstWeekContainsDate);if(!(l>=1&&l<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var f=new Date(0);f.setUTCFullYear(o+1,0,l),f.setUTCHours(0,0,0,0);var h=G(f,a),m=new Date(0);m.setUTCFullYear(o,0,l),m.setUTCHours(0,0,0,0);var w=G(m,a);return i.getTime()>=h.getTime()?o+1:i.getTime()>=w.getTime()?o:o-1}function j(t,n){r(1,arguments);var a=n||{},i=a.locale,o=i&&i.options&&i.options.firstWeekContainsDate,u=null==o?1:e(o),s=null==a.firstWeekContainsDate?u:e(a.firstWeekContainsDate),c=X(t,n),d=new Date(0);d.setUTCFullYear(c,0,s),d.setUTCHours(0,0,0,0);var l=G(d,n);return l}var B=6048e5;function z(t,e){r(1,arguments);var a=n(t),i=G(a,e).getTime()-j(a,e).getTime();return Math.round(i/B)+1}var A="midnight",Z="noon",K="morning",$="afternoon",_="evening",J="night",V={G:function(t,e,r){var n=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if("yo"===e){var n=t.getUTCFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return O.y(t,e)},Y:function(t,e,r,n){var a=X(t,n),i=a>0?a:1-a;return"YY"===e?E(i%100,2):"Yo"===e?r.ordinalNumber(i,{unit:"year"}):E(i,e.length)},R:function(t,e){return E(L(t),e.length)},u:function(t,e){return E(t.getUTCFullYear(),e.length)},Q:function(t,e,r){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return E(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){var n=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return E(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){var n=t.getUTCMonth();switch(e){case"M":case"MM":return O.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){var n=t.getUTCMonth();switch(e){case"L":return String(n+1);case"LL":return E(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){var a=z(t,n);return"wo"===e?r.ordinalNumber(a,{unit:"week"}):E(a,e.length)},I:function(t,e,r){var n=I(t);return"Io"===e?r.ordinalNumber(n,{unit:"week"}):E(n,e.length)},d:function(t,e,r){return"do"===e?r.ordinalNumber(t.getUTCDate(),{unit:"date"}):O.d(t,e)},D:function(t,e,a){var i=function(t){r(1,arguments);var e=n(t),a=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var i=e.getTime(),o=a-i;return Math.floor(o/F)+1}(t);return"Do"===e?a.ordinalNumber(i,{unit:"dayOfYear"}):E(i,e.length)},E:function(t,e,r){var n=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){var a=t.getUTCDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return E(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){var a=t.getUTCDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return E(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){var n=t.getUTCDay(),a=0===n?7:n;switch(e){case"i":return String(a);case"ii":return E(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){var n=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(t,e,r){var n,a=t.getUTCHours();switch(n=12===a?Z:0===a?A:a/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(t,e,r){var n,a=t.getUTCHours();switch(n=a>=17?_:a>=12?$:a>=4?K:J,e){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(t,e,r){if("ho"===e){var n=t.getUTCHours()%12;return 0===n&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return O.h(t,e)},H:function(t,e,r){return"Ho"===e?r.ordinalNumber(t.getUTCHours(),{unit:"hour"}):O.H(t,e)},K:function(t,e,r){var n=t.getUTCHours()%12;return"Ko"===e?r.ordinalNumber(n,{unit:"hour"}):E(n,e.length)},k:function(t,e,r){var n=t.getUTCHours();return 0===n&&(n=24),"ko"===e?r.ordinalNumber(n,{unit:"hour"}):E(n,e.length)},m:function(t,e,r){return"mo"===e?r.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):O.m(t,e)},s:function(t,e,r){return"so"===e?r.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):O.s(t,e)},S:function(t,e){return O.S(t,e)},X:function(t,e,r,n){var a=(n._originalDate||t).getTimezoneOffset();if(0===a)return"Z";switch(e){case"X":return et(a);case"XXXX":case"XX":return rt(a);default:return rt(a,":")}},x:function(t,e,r,n){var a=(n._originalDate||t).getTimezoneOffset();switch(e){case"x":return et(a);case"xxxx":case"xx":return rt(a);default:return rt(a,":")}},O:function(t,e,r,n){var a=(n._originalDate||t).getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+tt(a,":");default:return"GMT"+rt(a,":")}},z:function(t,e,r,n){var a=(n._originalDate||t).getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+tt(a,":");default:return"GMT"+rt(a,":")}},t:function(t,e,r,n){var a=n._originalDate||t;return E(Math.floor(a.getTime()/1e3),e.length)},T:function(t,e,r,n){return E((n._originalDate||t).getTime(),e.length)}};function tt(t,e){var r=t>0?"-":"+",n=Math.abs(t),a=Math.floor(n/60),i=n%60;if(0===i)return r+String(a);var o=e||"";return r+String(a)+o+E(i,2)}function et(t,e){return t%60==0?(t>0?"-":"+")+E(Math.abs(t)/60,2):rt(t,e)}function rt(t,e){var r=e||"",n=t>0?"-":"+",a=Math.abs(t);return n+E(Math.floor(a/60),2)+r+E(a%60,2)}var nt=V;function at(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}}function it(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}}var ot={p:it,P:function(t,e){var r,n=t.match(/(P+)(p+)?/),a=n[1],i=n[2];if(!i)return at(t,e);switch(a){case"P":r=e.dateTime({width:"short"});break;case"PP":r=e.dateTime({width:"medium"});break;case"PPP":r=e.dateTime({width:"long"});break;default:r=e.dateTime({width:"full"})}return r.replace("{{date}}",at(a,e)).replace("{{time}}",it(i,e))}},ut=ot,st=["D","DD"],ct=["YY","YYYY"];function dt(t){return-1!==st.indexOf(t)}function lt(t){return-1!==ct.indexOf(t)}function ft(t,e,r){if("YYYY"===t)throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("YY"===t)throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("D"===t)throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"));if("DD"===t)throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(r,"`; see: https://git.io/fxCyr"))}var ht=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,mt=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,wt=/^'([^]*?)'?$/,gt=/''/g,vt=/[a-zA-Z]/;function yt(t){return t.match(wt)[1].replace(gt,"'")}function bt(t,e){if(null==t)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in e=e||{})e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function Tt(t,a,i){r(2,arguments);var o=i||{},u=o.locale,s=u&&u.options&&u.options.weekStartsOn,c=null==s?0:e(s),d=null==o.weekStartsOn?c:e(o.weekStartsOn);if(!(d>=0&&d<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var l=n(t),f=e(a),h=l.getUTCDay(),m=f%7,w=(m+7)%7,g=(w<d?7:0)+f-h;return l.setUTCDate(l.getUTCDate()+g),l}var pt=/^(1[0-2]|0?\d)/,Ct=/^(3[0-1]|[0-2]?\d)/,Mt=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,Dt=/^(5[0-3]|[0-4]?\d)/,xt=/^(2[0-3]|[0-1]?\d)/,kt=/^(2[0-4]|[0-1]?\d)/,Ut=/^(1[0-1]|0?\d)/,Yt=/^(1[0-2]|0?\d)/,Nt=/^[0-5]?\d/,St=/^[0-5]?\d/,Pt=/^\d/,qt=/^\d{1,2}/,Ht=/^\d{1,3}/,Et=/^\d{1,4}/,Ot=/^-?\d+/,Ft=/^-?\d/,Wt=/^-?\d{1,2}/,Lt=/^-?\d{1,3}/,Qt=/^-?\d{1,4}/,Rt=/^([+-])(\d{2})(\d{2})?|Z/,It=/^([+-])(\d{2})(\d{2})|Z/,Gt=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,Xt=/^([+-])(\d{2}):(\d{2})|Z/,jt=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function Bt(t,e,r){var n=e.match(t);if(!n)return null;var a=parseInt(n[0],10);return{value:r?r(a):a,rest:e.slice(n[0].length)}}function zt(t,e){var r=e.match(t);return r?"Z"===r[0]?{value:0,rest:e.slice(1)}:{value:("+"===r[1]?1:-1)*(36e5*(r[2]?parseInt(r[2],10):0)+6e4*(r[3]?parseInt(r[3],10):0)+1e3*(r[5]?parseInt(r[5],10):0)),rest:e.slice(r[0].length)}:null}function At(t,e){return Bt(Ot,t,e)}function Zt(t,e,r){switch(t){case 1:return Bt(Pt,e,r);case 2:return Bt(qt,e,r);case 3:return Bt(Ht,e,r);case 4:return Bt(Et,e,r);default:return Bt(new RegExp("^\\d{1,"+t+"}"),e,r)}}function Kt(t,e,r){switch(t){case 1:return Bt(Ft,e,r);case 2:return Bt(Wt,e,r);case 3:return Bt(Lt,e,r);case 4:return Bt(Qt,e,r);default:return Bt(new RegExp("^-?\\d{1,"+t+"}"),e,r)}}function $t(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function _t(t,e){var r,n=e>0,a=n?e:1-e;if(a<=50)r=t||100;else{var i=a+50;r=t+100*Math.floor(i/100)-(t>=i%100?100:0)}return n?r:1-r}var Jt=[31,28,31,30,31,30,31,31,30,31,30,31],Vt=[31,29,31,30,31,30,31,31,30,31,30,31];function te(t){return t%400==0||t%4==0&&t%100!=0}var ee={G:{priority:140,parse:function(t,e,r,n){switch(e){case"G":case"GG":case"GGG":return r.era(t,{width:"abbreviated"})||r.era(t,{width:"narrow"});case"GGGGG":return r.era(t,{width:"narrow"});default:return r.era(t,{width:"wide"})||r.era(t,{width:"abbreviated"})||r.era(t,{width:"narrow"})}},set:function(t,e,r,n){return e.era=r,t.setUTCFullYear(r,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(t,e,r,n){var a=function(t){return{year:t,isTwoDigitYear:"yy"===e}};switch(e){case"y":return Zt(4,t,a);case"yo":return r.ordinalNumber(t,{unit:"year",valueCallback:a});default:return Zt(e.length,t,a)}},validate:function(t,e,r){return e.isTwoDigitYear||e.year>0},set:function(t,e,r,n){var a=t.getUTCFullYear();if(r.isTwoDigitYear){var i=_t(r.year,a);return t.setUTCFullYear(i,0,1),t.setUTCHours(0,0,0,0),t}var o="era"in e&&1!==e.era?1-r.year:r.year;return t.setUTCFullYear(o,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(t,e,r,n){var a=function(t){return{year:t,isTwoDigitYear:"YY"===e}};switch(e){case"Y":return Zt(4,t,a);case"Yo":return r.ordinalNumber(t,{unit:"year",valueCallback:a});default:return Zt(e.length,t,a)}},validate:function(t,e,r){return e.isTwoDigitYear||e.year>0},set:function(t,e,r,n){var a=X(t,n);if(r.isTwoDigitYear){var i=_t(r.year,a);return t.setUTCFullYear(i,0,n.firstWeekContainsDate),t.setUTCHours(0,0,0,0),G(t,n)}var o="era"in e&&1!==e.era?1-r.year:r.year;return t.setUTCFullYear(o,0,n.firstWeekContainsDate),t.setUTCHours(0,0,0,0),G(t,n)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(t,e,r,n){return Kt("R"===e?4:e.length,t)},set:function(t,e,r,n){var a=new Date(0);return a.setUTCFullYear(r,0,4),a.setUTCHours(0,0,0,0),W(a)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(t,e,r,n){return Kt("u"===e?4:e.length,t)},set:function(t,e,r,n){return t.setUTCFullYear(r,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(t,e,r,n){switch(e){case"Q":case"QQ":return Zt(e.length,t);case"Qo":return r.ordinalNumber(t,{unit:"quarter"});case"QQQ":return r.quarter(t,{width:"abbreviated",context:"formatting"})||r.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(t,{width:"narrow",context:"formatting"});default:return r.quarter(t,{width:"wide",context:"formatting"})||r.quarter(t,{width:"abbreviated",context:"formatting"})||r.quarter(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,r){return e>=1&&e<=4},set:function(t,e,r,n){return t.setUTCMonth(3*(r-1),1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(t,e,r,n){switch(e){case"q":case"qq":return Zt(e.length,t);case"qo":return r.ordinalNumber(t,{unit:"quarter"});case"qqq":return r.quarter(t,{width:"abbreviated",context:"standalone"})||r.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(t,{width:"narrow",context:"standalone"});default:return r.quarter(t,{width:"wide",context:"standalone"})||r.quarter(t,{width:"abbreviated",context:"standalone"})||r.quarter(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,r){return e>=1&&e<=4},set:function(t,e,r,n){return t.setUTCMonth(3*(r-1),1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(t,e,r,n){var a=function(t){return t-1};switch(e){case"M":return Bt(pt,t,a);case"MM":return Zt(2,t,a);case"Mo":return r.ordinalNumber(t,{unit:"month",valueCallback:a});case"MMM":return r.month(t,{width:"abbreviated",context:"formatting"})||r.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(t,{width:"narrow",context:"formatting"});default:return r.month(t,{width:"wide",context:"formatting"})||r.month(t,{width:"abbreviated",context:"formatting"})||r.month(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,r){return e>=0&&e<=11},set:function(t,e,r,n){return t.setUTCMonth(r,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(t,e,r,n){var a=function(t){return t-1};switch(e){case"L":return Bt(pt,t,a);case"LL":return Zt(2,t,a);case"Lo":return r.ordinalNumber(t,{unit:"month",valueCallback:a});case"LLL":return r.month(t,{width:"abbreviated",context:"standalone"})||r.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(t,{width:"narrow",context:"standalone"});default:return r.month(t,{width:"wide",context:"standalone"})||r.month(t,{width:"abbreviated",context:"standalone"})||r.month(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,r){return e>=0&&e<=11},set:function(t,e,r,n){return t.setUTCMonth(r,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(t,e,r,n){switch(e){case"w":return Bt(Dt,t);case"wo":return r.ordinalNumber(t,{unit:"week"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=1&&e<=53},set:function(t,a,i,o){return G(function(t,a,i){r(2,arguments);var o=n(t),u=e(a),s=z(o,i)-u;return o.setUTCDate(o.getUTCDate()-7*s),o}(t,i,o),o)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(t,e,r,n){switch(e){case"I":return Bt(Dt,t);case"Io":return r.ordinalNumber(t,{unit:"week"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=1&&e<=53},set:function(t,a,i,o){return W(function(t,a){r(2,arguments);var i=n(t),o=e(a),u=I(i)-o;return i.setUTCDate(i.getUTCDate()-7*u),i}(t,i,o),o)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(t,e,r,n){switch(e){case"d":return Bt(Ct,t);case"do":return r.ordinalNumber(t,{unit:"date"});default:return Zt(e.length,t)}},validate:function(t,e,r){var n=te(t.getUTCFullYear()),a=t.getUTCMonth();return n?e>=1&&e<=Vt[a]:e>=1&&e<=Jt[a]},set:function(t,e,r,n){return t.setUTCDate(r),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(t,e,r,n){switch(e){case"D":case"DD":return Bt(Mt,t);case"Do":return r.ordinalNumber(t,{unit:"date"});default:return Zt(e.length,t)}},validate:function(t,e,r){return te(t.getUTCFullYear())?e>=1&&e<=366:e>=1&&e<=365},set:function(t,e,r,n){return t.setUTCMonth(0,r),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(t,e,r,n){switch(e){case"E":case"EE":case"EEE":return r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});default:return r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,r){return e>=0&&e<=6},set:function(t,e,r,n){return(t=Tt(t,r,n)).setUTCHours(0,0,0,0),t},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(t,e,r,n){var a=function(t){var e=7*Math.floor((t-1)/7);return(t+n.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return Zt(e.length,t,a);case"eo":return r.ordinalNumber(t,{unit:"day",valueCallback:a});case"eee":return r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"eeeee":return r.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});default:return r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,r){return e>=0&&e<=6},set:function(t,e,r,n){return(t=Tt(t,r,n)).setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(t,e,r,n){var a=function(t){var e=7*Math.floor((t-1)/7);return(t+n.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return Zt(e.length,t,a);case"co":return r.ordinalNumber(t,{unit:"day",valueCallback:a});case"ccc":return r.day(t,{width:"abbreviated",context:"standalone"})||r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"});case"ccccc":return r.day(t,{width:"narrow",context:"standalone"});case"cccccc":return r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"});default:return r.day(t,{width:"wide",context:"standalone"})||r.day(t,{width:"abbreviated",context:"standalone"})||r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,r){return e>=0&&e<=6},set:function(t,e,r,n){return(t=Tt(t,r,n)).setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(t,e,r,n){var a=function(t){return 0===t?7:t};switch(e){case"i":case"ii":return Zt(e.length,t);case"io":return r.ordinalNumber(t,{unit:"day"});case"iii":return r.day(t,{width:"abbreviated",context:"formatting",valueCallback:a})||r.day(t,{width:"short",context:"formatting",valueCallback:a})||r.day(t,{width:"narrow",context:"formatting",valueCallback:a});case"iiiii":return r.day(t,{width:"narrow",context:"formatting",valueCallback:a});case"iiiiii":return r.day(t,{width:"short",context:"formatting",valueCallback:a})||r.day(t,{width:"narrow",context:"formatting",valueCallback:a});default:return r.day(t,{width:"wide",context:"formatting",valueCallback:a})||r.day(t,{width:"abbreviated",context:"formatting",valueCallback:a})||r.day(t,{width:"short",context:"formatting",valueCallback:a})||r.day(t,{width:"narrow",context:"formatting",valueCallback:a})}},validate:function(t,e,r){return e>=1&&e<=7},set:function(t,a,i,o){return t=function(t,a){r(2,arguments);var i=e(a);i%7==0&&(i-=7);var o=1,u=n(t),s=u.getUTCDay(),c=((i%7+7)%7<o?7:0)+i-s;return u.setUTCDate(u.getUTCDate()+c),u}(t,i,o),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(t,e,r,n){switch(e){case"a":case"aa":case"aaa":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(t,{width:"narrow",context:"formatting"});default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,r,n){return t.setUTCHours($t(r),0,0,0),t},incompatibleTokens:["b","B","H","K","k","t","T"]},b:{priority:80,parse:function(t,e,r,n){switch(e){case"b":case"bb":case"bbb":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(t,{width:"narrow",context:"formatting"});default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,r,n){return t.setUTCHours($t(r),0,0,0),t},incompatibleTokens:["a","B","H","K","k","t","T"]},B:{priority:80,parse:function(t,e,r,n){switch(e){case"B":case"BB":case"BBB":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(t,{width:"narrow",context:"formatting"});default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,r,n){return t.setUTCHours($t(r),0,0,0),t},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(t,e,r,n){switch(e){case"h":return Bt(Yt,t);case"ho":return r.ordinalNumber(t,{unit:"hour"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=1&&e<=12},set:function(t,e,r,n){var a=t.getUTCHours()>=12;return a&&r<12?t.setUTCHours(r+12,0,0,0):a||12!==r?t.setUTCHours(r,0,0,0):t.setUTCHours(0,0,0,0),t},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(t,e,r,n){switch(e){case"H":return Bt(xt,t);case"Ho":return r.ordinalNumber(t,{unit:"hour"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=0&&e<=23},set:function(t,e,r,n){return t.setUTCHours(r,0,0,0),t},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(t,e,r,n){switch(e){case"K":return Bt(Ut,t);case"Ko":return r.ordinalNumber(t,{unit:"hour"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=0&&e<=11},set:function(t,e,r,n){return t.getUTCHours()>=12&&r<12?t.setUTCHours(r+12,0,0,0):t.setUTCHours(r,0,0,0),t},incompatibleTokens:["a","b","h","H","k","t","T"]},k:{priority:70,parse:function(t,e,r,n){switch(e){case"k":return Bt(kt,t);case"ko":return r.ordinalNumber(t,{unit:"hour"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=1&&e<=24},set:function(t,e,r,n){var a=r<=24?r%24:r;return t.setUTCHours(a,0,0,0),t},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(t,e,r,n){switch(e){case"m":return Bt(Nt,t);case"mo":return r.ordinalNumber(t,{unit:"minute"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=0&&e<=59},set:function(t,e,r,n){return t.setUTCMinutes(r,0,0),t},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(t,e,r,n){switch(e){case"s":return Bt(St,t);case"so":return r.ordinalNumber(t,{unit:"second"});default:return Zt(e.length,t)}},validate:function(t,e,r){return e>=0&&e<=59},set:function(t,e,r,n){return t.setUTCSeconds(r,0),t},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(t,e,r,n){return Zt(e.length,t,(function(t){return Math.floor(t*Math.pow(10,3-e.length))}))},set:function(t,e,r,n){return t.setUTCMilliseconds(r),t},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(t,e,r,n){switch(e){case"X":return zt(Rt,t);case"XX":return zt(It,t);case"XXXX":return zt(Gt,t);case"XXXXX":return zt(jt,t);default:return zt(Xt,t)}},set:function(t,e,r,n){return e.timestampIsSet?t:new Date(t.getTime()-r)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(t,e,r,n){switch(e){case"x":return zt(Rt,t);case"xx":return zt(It,t);case"xxxx":return zt(Gt,t);case"xxxxx":return zt(jt,t);default:return zt(Xt,t)}},set:function(t,e,r,n){return e.timestampIsSet?t:new Date(t.getTime()-r)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(t,e,r,n){return At(t)},set:function(t,e,r,n){return[new Date(1e3*r),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(t,e,r,n){return At(t)},set:function(t,e,r,n){return[new Date(r),{timestampIsSet:!0}]},incompatibleTokens:"*"}},re=ee,ne=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ae=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ie=/^'([^]*?)'?$/,oe=/''/g,ue=/\S/,se=/[a-zA-Z]/;function ce(t,e){if(e.timestampIsSet)return t;var r=new Date(0);return r.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),r.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),r}function de(t){return t.match(ie)[1].replace(oe,"'")}var le=36e5,fe={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},he=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,me=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,we=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ge(t){var e,r={},n=t.split(fe.dateTimeDelimiter);if(n.length>2)return r;if(/:/.test(n[0])?(r.date=null,e=n[0]):(r.date=n[0],e=n[1],fe.timeZoneDelimiter.test(r.date)&&(r.date=t.split(fe.timeZoneDelimiter)[0],e=t.substr(r.date.length,t.length))),e){var a=fe.timezone.exec(e);a?(r.time=e.replace(a[1],""),r.timezone=a[1]):r.time=e}return r}function ve(t,e){var r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),n=t.match(r);if(!n)return{year:null};var a=n[1]&&parseInt(n[1]),i=n[2]&&parseInt(n[2]);return{year:null==i?a:100*i,restDateString:t.slice((n[1]||n[2]).length)}}function ye(t,e){if(null===e)return null;var r=t.match(he);if(!r)return null;var n=!!r[4],a=be(r[1]),i=be(r[2])-1,o=be(r[3]),u=be(r[4]),s=be(r[5])-1;if(n)return function(t,e,r){return e>=1&&e<=53&&r>=0&&r<=6}(0,u,s)?function(t,e,r){var n=new Date(0);n.setUTCFullYear(t,0,4);var a=n.getUTCDay()||7,i=7*(e-1)+r+1-a;return n.setUTCDate(n.getUTCDate()+i),n}(e,u,s):new Date(NaN);var c=new Date(0);return function(t,e,r){return e>=0&&e<=11&&r>=1&&r<=(Me[e]||(De(t)?29:28))}(e,i,o)&&function(t,e){return e>=1&&e<=(De(t)?366:365)}(e,a)?(c.setUTCFullYear(e,i,Math.max(a,o)),c):new Date(NaN)}function be(t){return t?parseInt(t):1}function Te(t){var e=t.match(me);if(!e)return null;var r=pe(e[1]),n=pe(e[2]),a=pe(e[3]);return function(t,e,r){if(24===t)return 0===e&&0===r;return r>=0&&r<60&&e>=0&&e<60&&t>=0&&t<25}(r,n,a)?r*le+6e4*n+1e3*a:NaN}function pe(t){return t&&parseFloat(t.replace(",","."))||0}function Ce(t){if("Z"===t)return 0;var e=t.match(we);if(!e)return 0;var r="+"===e[1]?-1:1,n=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return function(t,e){return e>=0&&e<=59}(0,a)?r*(n*le+6e4*a):NaN}var Me=[31,null,31,30,31,30,31,31,30,31,30,31];function De(t){return t%400==0||t%4==0&&t%100}const xe={datetime:"MMM d, yyyy, h:mm:ss aaaa",millisecond:"h:mm:ss.SSS aaaa",second:"h:mm:ss aaaa",minute:"h:mm aaaa",hour:"ha",day:"MMM d",week:"PP",month:"MMM yyyy",quarter:"qqq - yyyy",year:"yyyy"};t._adapters._date.override({_id:"date-fns",formats:function(){return xe},parse:function(t,a){if(null==t)return null;const i=typeof t;return"number"===i||t instanceof Date?t=n(t):"string"===i&&(t="string"==typeof a?function(t,a,i,o){r(3,arguments);var u=String(t),s=String(a),d=o||{},l=d.locale||q;if(!l.match)throw new RangeError("locale must contain match property");var f=l.options&&l.options.firstWeekContainsDate,h=null==f?1:e(f),m=null==d.firstWeekContainsDate?h:e(d.firstWeekContainsDate);if(!(m>=1&&m<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var w=l.options&&l.options.weekStartsOn,g=null==w?0:e(w),v=null==d.weekStartsOn?g:e(d.weekStartsOn);if(!(v>=0&&v<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(""===s)return""===u?n(i):new Date(NaN);var y,b={firstWeekContainsDate:m,weekStartsOn:v,locale:l},T=[{priority:10,subPriority:-1,set:ce,index:0}],p=s.match(ae).map((function(t){var e=t[0];return"p"===e||"P"===e?(0,ut[e])(t,l.formatLong,b):t})).join("").match(ne),C=[];for(y=0;y<p.length;y++){var M=p[y];!d.useAdditionalWeekYearTokens&&lt(M)&&ft(M,s,t),!d.useAdditionalDayOfYearTokens&&dt(M)&&ft(M,s,t);var D=M[0],x=re[D];if(x){var k=x.incompatibleTokens;if(Array.isArray(k)){for(var U=void 0,Y=0;Y<C.length;Y++){var N=C[Y].token;if(-1!==k.indexOf(N)||N===D){U=C[Y];break}}if(U)throw new RangeError("The format string mustn't contain `".concat(U.fullToken,"` and `").concat(M,"` at the same time"))}else if("*"===x.incompatibleTokens&&C.length)throw new RangeError("The format string mustn't contain `".concat(M,"` and any other token at the same time"));C.push({token:D,fullToken:M});var S=x.parse(u,M,l.match,b);if(!S)return new Date(NaN);T.push({priority:x.priority,subPriority:x.subPriority||0,set:x.set,validate:x.validate,value:S.value,index:T.length}),u=S.rest}else{if(D.match(se))throw new RangeError("Format string contains an unescaped latin alphabet character `"+D+"`");if("''"===M?M="'":"'"===D&&(M=de(M)),0!==u.indexOf(M))return new Date(NaN);u=u.slice(M.length)}}if(u.length>0&&ue.test(u))return new Date(NaN);var P=T.map((function(t){return t.priority})).sort((function(t,e){return e-t})).filter((function(t,e,r){return r.indexOf(t)===e})).map((function(t){return T.filter((function(e){return e.priority===t})).sort((function(t,e){return e.subPriority-t.subPriority}))})).map((function(t){return t[0]})),E=n(i);if(isNaN(E))return new Date(NaN);var O=H(E,c(E)),F={};for(y=0;y<P.length;y++){var W=P[y];if(W.validate&&!W.validate(O,W.value,b))return new Date(NaN);var L=W.set(O,F,W.value,b);L[0]?(O=L[0],bt(F,L[1])):O=L}return O}(t,a,new Date,this.options):function(t,n){r(1,arguments);var a=n||{},i=null==a.additionalDigits?2:e(a.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!=typeof t&&"[object String]"!==Object.prototype.toString.call(t))return new Date(NaN);var o,u=ge(t);if(u.date){var s=ve(u.date,i);o=ye(s.restDateString,s.year)}if(isNaN(o)||!o)return new Date(NaN);var c,d=o.getTime(),l=0;if(u.time&&(l=Te(u.time),isNaN(l)||null===l))return new Date(NaN);if(!u.timezone){var f=new Date(d+l),h=new Date(0);return h.setFullYear(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate()),h.setHours(f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds(),f.getUTCMilliseconds()),h}return c=Ce(u.timezone),isNaN(c)?new Date(NaN):new Date(d+l+c)}(t,this.options)),m(t)?t.getTime():null},format:function(t,a){return function(t,a,i){r(2,arguments);var o=String(a),u=i||{},s=u.locale||q,d=s.options&&s.options.firstWeekContainsDate,l=null==d?1:e(d),f=null==u.firstWeekContainsDate?l:e(u.firstWeekContainsDate);if(!(f>=1&&f<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=s.options&&s.options.weekStartsOn,w=null==h?0:e(h),g=null==u.weekStartsOn?w:e(u.weekStartsOn);if(!(g>=0&&g<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!s.localize)throw new RangeError("locale must contain localize property");if(!s.formatLong)throw new RangeError("locale must contain formatLong property");var v=n(t);if(!m(v))throw new RangeError("Invalid time value");var y=c(v),b=H(v,y),T={firstWeekContainsDate:f,weekStartsOn:g,locale:s,_originalDate:v},p=o.match(mt).map((function(t){var e=t[0];return"p"===e||"P"===e?(0,ut[e])(t,s.formatLong,T):t})).join("").match(ht).map((function(e){if("''"===e)return"'";var r=e[0];if("'"===r)return yt(e);var n=nt[r];if(n)return!u.useAdditionalWeekYearTokens&&lt(e)&&ft(e,a,t),!u.useAdditionalDayOfYearTokens&&dt(e)&&ft(e,a,t),n(b,e,s.localize,T);if(r.match(vt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+r+"`");return e})).join("");return p}(t,a,this.options)},add:function(t,n,s){switch(s){case"millisecond":return o(t,n);case"second":return function(t,n){r(2,arguments);var a=e(n);return o(t,1e3*a)}(t,n);case"minute":return function(t,n){r(2,arguments);var a=e(n);return o(t,6e4*a)}(t,n);case"hour":return function(t,n){r(2,arguments);var a=e(n);return o(t,a*u)}(t,n);case"day":return a(t,n);case"week":return function(t,n){r(2,arguments);var i=e(n),o=7*i;return a(t,o)}(t,n);case"month":return i(t,n);case"quarter":return function(t,n){r(2,arguments);var a=e(n),o=3*a;return i(t,o)}(t,n);case"year":return function(t,n){r(2,arguments);var a=e(n);return i(t,12*a)}(t,n);default:return t}},diff:function(t,e,a){switch(a){case"millisecond":return b(t,e);case"second":return function(t,e){r(2,arguments);var n=b(t,e)/1e3;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"minute":return function(t,e){r(2,arguments);var n=b(t,e)/6e4;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"hour":return function(t,e){r(2,arguments);var n=b(t,e)/T;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"day":return y(t,e);case"week":return function(t,e){r(2,arguments);var n=y(t,e)/7;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"month":return D(t,e);case"quarter":return function(t,e){r(2,arguments);var n=D(t,e)/3;return n>0?Math.floor(n):Math.ceil(n)}(t,e);case"year":return function(t,e){r(2,arguments);var a=n(t),i=n(e),o=h(a,i),u=Math.abs(g(a,i));a.setFullYear("1584"),i.setFullYear("1584");var s=h(a,i)===-o,c=o*(u-s);return 0===c?0:c}(t,e);default:return 0}},startOf:function(t,e,a){switch(e){case"second":return function(t){r(1,arguments);var e=n(t);return e.setMilliseconds(0),e}(t);case"minute":return function(t){r(1,arguments);var e=n(t);return e.setSeconds(0,0),e}(t);case"hour":return function(t){r(1,arguments);var e=n(t);return e.setMinutes(0,0,0),e}(t);case"day":return d(t);case"week":return s(t);case"isoWeek":return s(t,{weekStartsOn:+a});case"month":return function(t){r(1,arguments);var e=n(t);return e.setDate(1),e.setHours(0,0,0,0),e}(t);case"quarter":return function(t){r(1,arguments);var e=n(t),a=e.getMonth(),i=a-a%3;return e.setMonth(i,1),e.setHours(0,0,0,0),e}(t);case"year":return function(t){r(1,arguments);var e=n(t),a=new Date(0);return a.setFullYear(e.getFullYear(),0,1),a.setHours(0,0,0,0),a}(t);default:return t}},endOf:function(t,a){switch(a){case"second":return function(t){r(1,arguments);var e=n(t);return e.setMilliseconds(999),e}(t);case"minute":return function(t){r(1,arguments);var e=n(t);return e.setSeconds(59,999),e}(t);case"hour":return function(t){r(1,arguments);var e=n(t);return e.setMinutes(59,59,999),e}(t);case"day":return p(t);case"week":return function(t,a){r(1,arguments);var i=a||{},o=i.locale,u=o&&o.options&&o.options.weekStartsOn,s=null==u?0:e(u),c=null==i.weekStartsOn?s:e(i.weekStartsOn);if(!(c>=0&&c<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=n(t),l=d.getDay(),f=6+(l<c?-7:0)-(l-c);return d.setDate(d.getDate()+f),d.setHours(23,59,59,999),d}(t);case"month":return C(t);case"quarter":return function(t){r(1,arguments);var e=n(t),a=e.getMonth(),i=a-a%3+3;return e.setMonth(i,0),e.setHours(23,59,59,999),e}(t);case"year":return function(t){r(1,arguments);var e=n(t),a=e.getFullYear();return e.setFullYear(a+1,0,0),e.setHours(23,59,59,999),e}(t);default:return t}}})}));
// Copyright (c) 2021 Sasha Koss and Lesha Koss 
// https://kossnocorp.mit-license.org
(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory();else if(typeof define==="function"&&define.amd)define([],factory);else if(typeof exports==="object")exports["dateFns"]=factory();else root["dateFns"]=factory()})(this,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0)}([function(module,exports,__webpack_require__){module.exports={addDays:__webpack_require__(1),addHours:__webpack_require__(5),addISOYears:__webpack_require__(7),addMilliseconds:__webpack_require__(6),addMinutes:__webpack_require__(15),addMonths:__webpack_require__(16),addQuarters:__webpack_require__(18),addSeconds:__webpack_require__(19),addWeeks:__webpack_require__(20),addYears:__webpack_require__(21),areRangesOverlapping:__webpack_require__(22),closestIndexTo:__webpack_require__(23),closestTo:__webpack_require__(24),compareAsc:__webpack_require__(25),compareDesc:__webpack_require__(26),differenceInCalendarDays:__webpack_require__(13),differenceInCalendarISOWeeks:__webpack_require__(27),differenceInCalendarISOYears:__webpack_require__(28),differenceInCalendarMonths:__webpack_require__(29),differenceInCalendarQuarters:__webpack_require__(30),differenceInCalendarWeeks:__webpack_require__(32),differenceInCalendarYears:__webpack_require__(33),differenceInDays:__webpack_require__(34),differenceInHours:__webpack_require__(35),differenceInISOYears:__webpack_require__(37),differenceInMilliseconds:__webpack_require__(36),differenceInMinutes:__webpack_require__(39),differenceInMonths:__webpack_require__(40),differenceInQuarters:__webpack_require__(41),differenceInSeconds:__webpack_require__(42),differenceInWeeks:__webpack_require__(43),differenceInYears:__webpack_require__(44),distanceInWords:__webpack_require__(45),distanceInWordsStrict:__webpack_require__(50),distanceInWordsToNow:__webpack_require__(51),eachDay:__webpack_require__(52),endOfDay:__webpack_require__(53),endOfHour:__webpack_require__(54),endOfISOWeek:__webpack_require__(55),endOfISOYear:__webpack_require__(57),endOfMinute:__webpack_require__(58),endOfMonth:__webpack_require__(59),endOfQuarter:__webpack_require__(60),endOfSecond:__webpack_require__(61),endOfToday:__webpack_require__(62),endOfTomorrow:__webpack_require__(63),endOfWeek:__webpack_require__(56),endOfYear:__webpack_require__(64),endOfYesterday:__webpack_require__(65),format:__webpack_require__(66),getDate:__webpack_require__(71),getDay:__webpack_require__(72),getDayOfYear:__webpack_require__(67),getDaysInMonth:__webpack_require__(17),getDaysInYear:__webpack_require__(73),getHours:__webpack_require__(75),getISODay:__webpack_require__(76),getISOWeek:__webpack_require__(69),getISOWeeksInYear:__webpack_require__(77),getISOYear:__webpack_require__(8),getMilliseconds:__webpack_require__(78),getMinutes:__webpack_require__(79),getMonth:__webpack_require__(80),getOverlappingDaysInRanges:__webpack_require__(81),getQuarter:__webpack_require__(31),getSeconds:__webpack_require__(82),getTime:__webpack_require__(83),getYear:__webpack_require__(84),isAfter:__webpack_require__(85),isBefore:__webpack_require__(86),isDate:__webpack_require__(4),isEqual:__webpack_require__(87),isFirstDayOfMonth:__webpack_require__(88),isFriday:__webpack_require__(89),isFuture:__webpack_require__(90),isLastDayOfMonth:__webpack_require__(91),isLeapYear:__webpack_require__(74),isMonday:__webpack_require__(92),isPast:__webpack_require__(93),isSameDay:__webpack_require__(94),isSameHour:__webpack_require__(95),isSameISOWeek:__webpack_require__(97),isSameISOYear:__webpack_require__(99),isSameMinute:__webpack_require__(100),isSameMonth:__webpack_require__(102),isSameQuarter:__webpack_require__(103),isSameSecond:__webpack_require__(105),isSameWeek:__webpack_require__(98),isSameYear:__webpack_require__(107),isSaturday:__webpack_require__(108),isSunday:__webpack_require__(109),isThisHour:__webpack_require__(110),isThisISOWeek:__webpack_require__(111),isThisISOYear:__webpack_require__(112),isThisMinute:__webpack_require__(113),isThisMonth:__webpack_require__(114),isThisQuarter:__webpack_require__(115),isThisSecond:__webpack_require__(116),isThisWeek:__webpack_require__(117),isThisYear:__webpack_require__(118),isThursday:__webpack_require__(119),isToday:__webpack_require__(120),isTomorrow:__webpack_require__(121),isTuesday:__webpack_require__(122),isValid:__webpack_require__(70),isWednesday:__webpack_require__(123),isWeekend:__webpack_require__(124),isWithinRange:__webpack_require__(125),isYesterday:__webpack_require__(126),lastDayOfISOWeek:__webpack_require__(127),lastDayOfISOYear:__webpack_require__(129),lastDayOfMonth:__webpack_require__(130),lastDayOfQuarter:__webpack_require__(131),lastDayOfWeek:__webpack_require__(128),lastDayOfYear:__webpack_require__(132),max:__webpack_require__(133),min:__webpack_require__(134),parse:__webpack_require__(2),setDate:__webpack_require__(135),setDay:__webpack_require__(136),setDayOfYear:__webpack_require__(137),setHours:__webpack_require__(138),setISODay:__webpack_require__(139),setISOWeek:__webpack_require__(140),setISOYear:__webpack_require__(11),setMilliseconds:__webpack_require__(141),setMinutes:__webpack_require__(142),setMonth:__webpack_require__(143),setQuarter:__webpack_require__(144),setSeconds:__webpack_require__(145),setYear:__webpack_require__(146),startOfDay:__webpack_require__(14),startOfHour:__webpack_require__(96),startOfISOWeek:__webpack_require__(9),startOfISOYear:__webpack_require__(12),startOfMinute:__webpack_require__(101),startOfMonth:__webpack_require__(147),startOfQuarter:__webpack_require__(104),startOfSecond:__webpack_require__(106),startOfToday:__webpack_require__(148),startOfTomorrow:__webpack_require__(149),startOfWeek:__webpack_require__(10),startOfYear:__webpack_require__(68),startOfYesterday:__webpack_require__(150),subDays:__webpack_require__(151),subHours:__webpack_require__(152),subISOYears:__webpack_require__(38),subMilliseconds:__webpack_require__(153),subMinutes:__webpack_require__(154),subMonths:__webpack_require__(155),subQuarters:__webpack_require__(156),subSeconds:__webpack_require__(157),subWeeks:__webpack_require__(158),subYears:__webpack_require__(159)}},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function addDays(dirtyDate,dirtyAmount){var date=parse(dirtyDate);var amount=Number(dirtyAmount);date.setDate(date.getDate()+amount);return date}module.exports=addDays},function(module,exports,__webpack_require__){var getTimezoneOffsetInMilliseconds=__webpack_require__(3);var isDate=__webpack_require__(4);var MILLISECONDS_IN_HOUR=36e5;var MILLISECONDS_IN_MINUTE=6e4;var DEFAULT_ADDITIONAL_DIGITS=2;var parseTokenDateTimeDelimeter=/[T ]/;var parseTokenPlainTime=/:/;var parseTokenYY=/^(\d{2})$/;var parseTokensYYY=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/];var parseTokenYYYY=/^(\d{4})/;var parseTokensYYYYY=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/];var parseTokenMM=/^-(\d{2})$/;var parseTokenDDD=/^-?(\d{3})$/;var parseTokenMMDD=/^-?(\d{2})-?(\d{2})$/;var parseTokenWww=/^-?W(\d{2})$/;var parseTokenWwwD=/^-?W(\d{2})-?(\d{1})$/;var parseTokenHH=/^(\d{2}([.,]\d*)?)$/;var parseTokenHHMM=/^(\d{2}):?(\d{2}([.,]\d*)?)$/;var parseTokenHHMMSS=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/;var parseTokenTimezone=/([Z+-].*)$/;var parseTokenTimezoneZ=/^(Z)$/;var parseTokenTimezoneHH=/^([+-])(\d{2})$/;var parseTokenTimezoneHHMM=/^([+-])(\d{2}):?(\d{2})$/;function parse(argument,dirtyOptions){if(isDate(argument)){return new Date(argument.getTime())}else if(typeof argument!=="string"){return new Date(argument)}var options=dirtyOptions||{};var additionalDigits=options.additionalDigits;if(additionalDigits==null){additionalDigits=DEFAULT_ADDITIONAL_DIGITS}else{additionalDigits=Number(additionalDigits)}var dateStrings=splitDateString(argument);var parseYearResult=parseYear(dateStrings.date,additionalDigits);var year=parseYearResult.year;var restDateString=parseYearResult.restDateString;var date=parseDate(restDateString,year);if(date){var timestamp=date.getTime();var time=0;var offset;if(dateStrings.time){time=parseTime(dateStrings.time)}if(dateStrings.timezone){offset=parseTimezone(dateStrings.timezone)*MILLISECONDS_IN_MINUTE}else{var fullTime=timestamp+time;var fullTimeDate=new Date(fullTime);offset=getTimezoneOffsetInMilliseconds(fullTimeDate);var fullTimeDateNextDay=new Date(fullTime);fullTimeDateNextDay.setDate(fullTimeDate.getDate()+1);var offsetDiff=getTimezoneOffsetInMilliseconds(fullTimeDateNextDay)-getTimezoneOffsetInMilliseconds(fullTimeDate);if(offsetDiff>0){offset+=offsetDiff}}return new Date(timestamp+time+offset)}else{return new Date(argument)}}function splitDateString(dateString){var dateStrings={};var array=dateString.split(parseTokenDateTimeDelimeter);var timeString;if(parseTokenPlainTime.test(array[0])){dateStrings.date=null;timeString=array[0]}else{dateStrings.date=array[0];timeString=array[1]}if(timeString){var token=parseTokenTimezone.exec(timeString);if(token){dateStrings.time=timeString.replace(token[1],"");dateStrings.timezone=token[1]}else{dateStrings.time=timeString}}return dateStrings}function parseYear(dateString,additionalDigits){var parseTokenYYY=parseTokensYYY[additionalDigits];var parseTokenYYYYY=parseTokensYYYYY[additionalDigits];var token;token=parseTokenYYYY.exec(dateString)||parseTokenYYYYY.exec(dateString);if(token){var yearString=token[1];return{year:parseInt(yearString,10),restDateString:dateString.slice(yearString.length)}}token=parseTokenYY.exec(dateString)||parseTokenYYY.exec(dateString);if(token){var centuryString=token[1];return{year:parseInt(centuryString,10)*100,restDateString:dateString.slice(centuryString.length)}}return{year:null}}function parseDate(dateString,year){if(year===null){return null}var token;var date;var month;var week;if(dateString.length===0){date=new Date(0);date.setUTCFullYear(year);return date}token=parseTokenMM.exec(dateString);if(token){date=new Date(0);month=parseInt(token[1],10)-1;date.setUTCFullYear(year,month);return date}token=parseTokenDDD.exec(dateString);if(token){date=new Date(0);var dayOfYear=parseInt(token[1],10);date.setUTCFullYear(year,0,dayOfYear);return date}token=parseTokenMMDD.exec(dateString);if(token){date=new Date(0);month=parseInt(token[1],10)-1;var day=parseInt(token[2],10);date.setUTCFullYear(year,month,day);return date}token=parseTokenWww.exec(dateString);if(token){week=parseInt(token[1],10)-1;return dayOfISOYear(year,week)}token=parseTokenWwwD.exec(dateString);if(token){week=parseInt(token[1],10)-1;var dayOfWeek=parseInt(token[2],10)-1;return dayOfISOYear(year,week,dayOfWeek)}return null}function parseTime(timeString){var token;var hours;var minutes;token=parseTokenHH.exec(timeString);if(token){hours=parseFloat(token[1].replace(",","."));return hours%24*MILLISECONDS_IN_HOUR}token=parseTokenHHMM.exec(timeString);if(token){hours=parseInt(token[1],10);minutes=parseFloat(token[2].replace(",","."));return hours%24*MILLISECONDS_IN_HOUR+minutes*MILLISECONDS_IN_MINUTE}token=parseTokenHHMMSS.exec(timeString);if(token){hours=parseInt(token[1],10);minutes=parseInt(token[2],10);var seconds=parseFloat(token[3].replace(",","."));return hours%24*MILLISECONDS_IN_HOUR+minutes*MILLISECONDS_IN_MINUTE+seconds*1e3}return null}function parseTimezone(timezoneString){var token;var absoluteOffset;token=parseTokenTimezoneZ.exec(timezoneString);if(token){return 0}token=parseTokenTimezoneHH.exec(timezoneString);if(token){absoluteOffset=parseInt(token[2],10)*60;return token[1]==="+"?-absoluteOffset:absoluteOffset}token=parseTokenTimezoneHHMM.exec(timezoneString);if(token){absoluteOffset=parseInt(token[2],10)*60+parseInt(token[3],10);return token[1]==="+"?-absoluteOffset:absoluteOffset}return 0}function dayOfISOYear(isoYear,week,day){week=week||0;day=day||0;var date=new Date(0);date.setUTCFullYear(isoYear,0,4);var fourthOfJanuaryDay=date.getUTCDay()||7;var diff=week*7+day+1-fourthOfJanuaryDay;date.setUTCDate(date.getUTCDate()+diff);return date}module.exports=parse},function(module,exports){var MILLISECONDS_IN_MINUTE=6e4;module.exports=function getTimezoneOffsetInMilliseconds(dirtyDate){var date=new Date(dirtyDate.getTime());var baseTimezoneOffset=date.getTimezoneOffset();date.setSeconds(0,0);var millisecondsPartOfTimezoneOffset=date.getTime()%MILLISECONDS_IN_MINUTE;return baseTimezoneOffset*MILLISECONDS_IN_MINUTE+millisecondsPartOfTimezoneOffset}},function(module,exports){function isDate(argument){return argument instanceof Date}module.exports=isDate},function(module,exports,__webpack_require__){var addMilliseconds=__webpack_require__(6);var MILLISECONDS_IN_HOUR=36e5;function addHours(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMilliseconds(dirtyDate,amount*MILLISECONDS_IN_HOUR)}module.exports=addHours},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function addMilliseconds(dirtyDate,dirtyAmount){var timestamp=parse(dirtyDate).getTime();var amount=Number(dirtyAmount);return new Date(timestamp+amount)}module.exports=addMilliseconds},function(module,exports,__webpack_require__){var getISOYear=__webpack_require__(8);var setISOYear=__webpack_require__(11);function addISOYears(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return setISOYear(dirtyDate,getISOYear(dirtyDate)+amount)}module.exports=addISOYears},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var startOfISOWeek=__webpack_require__(9);function getISOYear(dirtyDate){var date=parse(dirtyDate);var year=date.getFullYear();var fourthOfJanuaryOfNextYear=new Date(0);fourthOfJanuaryOfNextYear.setFullYear(year+1,0,4);fourthOfJanuaryOfNextYear.setHours(0,0,0,0);var startOfNextYear=startOfISOWeek(fourthOfJanuaryOfNextYear);var fourthOfJanuaryOfThisYear=new Date(0);fourthOfJanuaryOfThisYear.setFullYear(year,0,4);fourthOfJanuaryOfThisYear.setHours(0,0,0,0);var startOfThisYear=startOfISOWeek(fourthOfJanuaryOfThisYear);if(date.getTime()>=startOfNextYear.getTime()){return year+1}else if(date.getTime()>=startOfThisYear.getTime()){return year}else{return year-1}}module.exports=getISOYear},function(module,exports,__webpack_require__){var startOfWeek=__webpack_require__(10);function startOfISOWeek(dirtyDate){return startOfWeek(dirtyDate,{weekStartsOn:1})}module.exports=startOfISOWeek},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfWeek(dirtyDate,dirtyOptions){var weekStartsOn=dirtyOptions?Number(dirtyOptions.weekStartsOn)||0:0;var date=parse(dirtyDate);var day=date.getDay();var diff=(day<weekStartsOn?7:0)+day-weekStartsOn;date.setDate(date.getDate()-diff);date.setHours(0,0,0,0);return date}module.exports=startOfWeek},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var startOfISOYear=__webpack_require__(12);var differenceInCalendarDays=__webpack_require__(13);function setISOYear(dirtyDate,dirtyISOYear){var date=parse(dirtyDate);var isoYear=Number(dirtyISOYear);var diff=differenceInCalendarDays(date,startOfISOYear(date));var fourthOfJanuary=new Date(0);fourthOfJanuary.setFullYear(isoYear,0,4);fourthOfJanuary.setHours(0,0,0,0);date=startOfISOYear(fourthOfJanuary);date.setDate(date.getDate()+diff);return date}module.exports=setISOYear},function(module,exports,__webpack_require__){var getISOYear=__webpack_require__(8);var startOfISOWeek=__webpack_require__(9);function startOfISOYear(dirtyDate){var year=getISOYear(dirtyDate);var fourthOfJanuary=new Date(0);fourthOfJanuary.setFullYear(year,0,4);fourthOfJanuary.setHours(0,0,0,0);var date=startOfISOWeek(fourthOfJanuary);return date}module.exports=startOfISOYear},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(14);var MILLISECONDS_IN_MINUTE=6e4;var MILLISECONDS_IN_DAY=864e5;function differenceInCalendarDays(dirtyDateLeft,dirtyDateRight){var startOfDayLeft=startOfDay(dirtyDateLeft);var startOfDayRight=startOfDay(dirtyDateRight);var timestampLeft=startOfDayLeft.getTime()-startOfDayLeft.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;var timestampRight=startOfDayRight.getTime()-startOfDayRight.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;return Math.round((timestampLeft-timestampRight)/MILLISECONDS_IN_DAY)}module.exports=differenceInCalendarDays},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfDay(dirtyDate){var date=parse(dirtyDate);date.setHours(0,0,0,0);return date}module.exports=startOfDay},function(module,exports,__webpack_require__){var addMilliseconds=__webpack_require__(6);var MILLISECONDS_IN_MINUTE=6e4;function addMinutes(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMilliseconds(dirtyDate,amount*MILLISECONDS_IN_MINUTE)}module.exports=addMinutes},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var getDaysInMonth=__webpack_require__(17);function addMonths(dirtyDate,dirtyAmount){var date=parse(dirtyDate);var amount=Number(dirtyAmount);var desiredMonth=date.getMonth()+amount;var dateWithDesiredMonth=new Date(0);dateWithDesiredMonth.setFullYear(date.getFullYear(),desiredMonth,1);dateWithDesiredMonth.setHours(0,0,0,0);var daysInMonth=getDaysInMonth(dateWithDesiredMonth);date.setMonth(desiredMonth,Math.min(daysInMonth,date.getDate()));return date}module.exports=addMonths},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getDaysInMonth(dirtyDate){var date=parse(dirtyDate);var year=date.getFullYear();var monthIndex=date.getMonth();var lastDayOfMonth=new Date(0);lastDayOfMonth.setFullYear(year,monthIndex+1,0);lastDayOfMonth.setHours(0,0,0,0);return lastDayOfMonth.getDate()}module.exports=getDaysInMonth},function(module,exports,__webpack_require__){var addMonths=__webpack_require__(16);function addQuarters(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);var months=amount*3;return addMonths(dirtyDate,months)}module.exports=addQuarters},function(module,exports,__webpack_require__){var addMilliseconds=__webpack_require__(6);function addSeconds(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMilliseconds(dirtyDate,amount*1e3)}module.exports=addSeconds},function(module,exports,__webpack_require__){var addDays=__webpack_require__(1);function addWeeks(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);var days=amount*7;return addDays(dirtyDate,days)}module.exports=addWeeks},function(module,exports,__webpack_require__){var addMonths=__webpack_require__(16);function addYears(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMonths(dirtyDate,amount*12)}module.exports=addYears},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function areRangesOverlapping(dirtyInitialRangeStartDate,dirtyInitialRangeEndDate,dirtyComparedRangeStartDate,dirtyComparedRangeEndDate){var initialStartTime=parse(dirtyInitialRangeStartDate).getTime();var initialEndTime=parse(dirtyInitialRangeEndDate).getTime();var comparedStartTime=parse(dirtyComparedRangeStartDate).getTime();var comparedEndTime=parse(dirtyComparedRangeEndDate).getTime();if(initialStartTime>initialEndTime||comparedStartTime>comparedEndTime){throw new Error("The start of the range cannot be after the end of the range")}return initialStartTime<comparedEndTime&&comparedStartTime<initialEndTime}module.exports=areRangesOverlapping},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function closestIndexTo(dirtyDateToCompare,dirtyDatesArray){if(!(dirtyDatesArray instanceof Array)){throw new TypeError(toString.call(dirtyDatesArray)+" is not an instance of Array")}var dateToCompare=parse(dirtyDateToCompare);var timeToCompare=dateToCompare.getTime();var result;var minDistance;dirtyDatesArray.forEach(function(dirtyDate,index){var currentDate=parse(dirtyDate);var distance=Math.abs(timeToCompare-currentDate.getTime());if(result===undefined||distance<minDistance){result=index;minDistance=distance}});return result}module.exports=closestIndexTo},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function closestTo(dirtyDateToCompare,dirtyDatesArray){if(!(dirtyDatesArray instanceof Array)){throw new TypeError(toString.call(dirtyDatesArray)+" is not an instance of Array")}var dateToCompare=parse(dirtyDateToCompare);var timeToCompare=dateToCompare.getTime();var result;var minDistance;dirtyDatesArray.forEach(function(dirtyDate){var currentDate=parse(dirtyDate);var distance=Math.abs(timeToCompare-currentDate.getTime());if(result===undefined||distance<minDistance){result=currentDate;minDistance=distance}});return result}module.exports=closestTo},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function compareAsc(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var timeLeft=dateLeft.getTime();var dateRight=parse(dirtyDateRight);var timeRight=dateRight.getTime();if(timeLeft<timeRight){return-1}else if(timeLeft>timeRight){return 1}else{return 0}}module.exports=compareAsc},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function compareDesc(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var timeLeft=dateLeft.getTime();var dateRight=parse(dirtyDateRight);var timeRight=dateRight.getTime();if(timeLeft>timeRight){return-1}else if(timeLeft<timeRight){return 1}else{return 0}}module.exports=compareDesc},function(module,exports,__webpack_require__){var startOfISOWeek=__webpack_require__(9);var MILLISECONDS_IN_MINUTE=6e4;var MILLISECONDS_IN_WEEK=6048e5;function differenceInCalendarISOWeeks(dirtyDateLeft,dirtyDateRight){var startOfISOWeekLeft=startOfISOWeek(dirtyDateLeft);var startOfISOWeekRight=startOfISOWeek(dirtyDateRight);var timestampLeft=startOfISOWeekLeft.getTime()-startOfISOWeekLeft.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;var timestampRight=startOfISOWeekRight.getTime()-startOfISOWeekRight.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;return Math.round((timestampLeft-timestampRight)/MILLISECONDS_IN_WEEK)}module.exports=differenceInCalendarISOWeeks},function(module,exports,__webpack_require__){var getISOYear=__webpack_require__(8);function differenceInCalendarISOYears(dirtyDateLeft,dirtyDateRight){return getISOYear(dirtyDateLeft)-getISOYear(dirtyDateRight)}module.exports=differenceInCalendarISOYears},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function differenceInCalendarMonths(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);var yearDiff=dateLeft.getFullYear()-dateRight.getFullYear();var monthDiff=dateLeft.getMonth()-dateRight.getMonth();return yearDiff*12+monthDiff}module.exports=differenceInCalendarMonths},function(module,exports,__webpack_require__){var getQuarter=__webpack_require__(31);var parse=__webpack_require__(2);function differenceInCalendarQuarters(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);var yearDiff=dateLeft.getFullYear()-dateRight.getFullYear();var quarterDiff=getQuarter(dateLeft)-getQuarter(dateRight);return yearDiff*4+quarterDiff}module.exports=differenceInCalendarQuarters},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getQuarter(dirtyDate){var date=parse(dirtyDate);var quarter=Math.floor(date.getMonth()/3)+1;return quarter}module.exports=getQuarter},function(module,exports,__webpack_require__){var startOfWeek=__webpack_require__(10);var MILLISECONDS_IN_MINUTE=6e4;var MILLISECONDS_IN_WEEK=6048e5;function differenceInCalendarWeeks(dirtyDateLeft,dirtyDateRight,dirtyOptions){var startOfWeekLeft=startOfWeek(dirtyDateLeft,dirtyOptions);var startOfWeekRight=startOfWeek(dirtyDateRight,dirtyOptions);var timestampLeft=startOfWeekLeft.getTime()-startOfWeekLeft.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;var timestampRight=startOfWeekRight.getTime()-startOfWeekRight.getTimezoneOffset()*MILLISECONDS_IN_MINUTE;return Math.round((timestampLeft-timestampRight)/MILLISECONDS_IN_WEEK)}module.exports=differenceInCalendarWeeks},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function differenceInCalendarYears(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);return dateLeft.getFullYear()-dateRight.getFullYear()}module.exports=differenceInCalendarYears},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var differenceInCalendarDays=__webpack_require__(13);var compareAsc=__webpack_require__(25);function differenceInDays(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);var sign=compareAsc(dateLeft,dateRight);var difference=Math.abs(differenceInCalendarDays(dateLeft,dateRight));dateLeft.setDate(dateLeft.getDate()-sign*difference);var isLastDayNotFull=compareAsc(dateLeft,dateRight)===-sign;return sign*(difference-isLastDayNotFull)}module.exports=differenceInDays},function(module,exports,__webpack_require__){var differenceInMilliseconds=__webpack_require__(36);var MILLISECONDS_IN_HOUR=36e5;function differenceInHours(dirtyDateLeft,dirtyDateRight){var diff=differenceInMilliseconds(dirtyDateLeft,dirtyDateRight)/MILLISECONDS_IN_HOUR;return diff>0?Math.floor(diff):Math.ceil(diff)}module.exports=differenceInHours},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function differenceInMilliseconds(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);return dateLeft.getTime()-dateRight.getTime()}module.exports=differenceInMilliseconds},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var differenceInCalendarISOYears=__webpack_require__(28);var compareAsc=__webpack_require__(25);var subISOYears=__webpack_require__(38);function differenceInISOYears(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);var sign=compareAsc(dateLeft,dateRight);var difference=Math.abs(differenceInCalendarISOYears(dateLeft,dateRight));dateLeft=subISOYears(dateLeft,sign*difference);var isLastISOYearNotFull=compareAsc(dateLeft,dateRight)===-sign;return sign*(difference-isLastISOYearNotFull)}module.exports=differenceInISOYears},function(module,exports,__webpack_require__){var addISOYears=__webpack_require__(7);function subISOYears(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addISOYears(dirtyDate,-amount)}module.exports=subISOYears},function(module,exports,__webpack_require__){var differenceInMilliseconds=__webpack_require__(36);var MILLISECONDS_IN_MINUTE=6e4;function differenceInMinutes(dirtyDateLeft,dirtyDateRight){var diff=differenceInMilliseconds(dirtyDateLeft,dirtyDateRight)/MILLISECONDS_IN_MINUTE;return diff>0?Math.floor(diff):Math.ceil(diff)}module.exports=differenceInMinutes},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var differenceInCalendarMonths=__webpack_require__(29);var compareAsc=__webpack_require__(25);function differenceInMonths(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);var sign=compareAsc(dateLeft,dateRight);var difference=Math.abs(differenceInCalendarMonths(dateLeft,dateRight));dateLeft.setMonth(dateLeft.getMonth()-sign*difference);var isLastMonthNotFull=compareAsc(dateLeft,dateRight)===-sign;return sign*(difference-isLastMonthNotFull)}module.exports=differenceInMonths},function(module,exports,__webpack_require__){var differenceInMonths=__webpack_require__(40);function differenceInQuarters(dirtyDateLeft,dirtyDateRight){var diff=differenceInMonths(dirtyDateLeft,dirtyDateRight)/3;return diff>0?Math.floor(diff):Math.ceil(diff)}module.exports=differenceInQuarters},function(module,exports,__webpack_require__){var differenceInMilliseconds=__webpack_require__(36);function differenceInSeconds(dirtyDateLeft,dirtyDateRight){var diff=differenceInMilliseconds(dirtyDateLeft,dirtyDateRight)/1e3;return diff>0?Math.floor(diff):Math.ceil(diff)}module.exports=differenceInSeconds},function(module,exports,__webpack_require__){var differenceInDays=__webpack_require__(34);function differenceInWeeks(dirtyDateLeft,dirtyDateRight){var diff=differenceInDays(dirtyDateLeft,dirtyDateRight)/7;return diff>0?Math.floor(diff):Math.ceil(diff)}module.exports=differenceInWeeks},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var differenceInCalendarYears=__webpack_require__(33);var compareAsc=__webpack_require__(25);function differenceInYears(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);var sign=compareAsc(dateLeft,dateRight);var difference=Math.abs(differenceInCalendarYears(dateLeft,dateRight));dateLeft.setFullYear(dateLeft.getFullYear()-sign*difference);var isLastYearNotFull=compareAsc(dateLeft,dateRight)===-sign;return sign*(difference-isLastYearNotFull)}module.exports=differenceInYears},function(module,exports,__webpack_require__){var compareDesc=__webpack_require__(26);var parse=__webpack_require__(2);var differenceInSeconds=__webpack_require__(42);var differenceInMonths=__webpack_require__(40);var enLocale=__webpack_require__(46);var MINUTES_IN_DAY=1440;var MINUTES_IN_ALMOST_TWO_DAYS=2520;var MINUTES_IN_MONTH=43200;var MINUTES_IN_TWO_MONTHS=86400;function distanceInWords(dirtyDateToCompare,dirtyDate,dirtyOptions){var options=dirtyOptions||{};var comparison=compareDesc(dirtyDateToCompare,dirtyDate);var locale=options.locale;var localize=enLocale.distanceInWords.localize;if(locale&&locale.distanceInWords&&locale.distanceInWords.localize){localize=locale.distanceInWords.localize}var localizeOptions={addSuffix:Boolean(options.addSuffix),comparison:comparison};var dateLeft,dateRight;if(comparison>0){dateLeft=parse(dirtyDateToCompare);dateRight=parse(dirtyDate)}else{dateLeft=parse(dirtyDate);dateRight=parse(dirtyDateToCompare)}var seconds=differenceInSeconds(dateRight,dateLeft);var offset=dateRight.getTimezoneOffset()-dateLeft.getTimezoneOffset();var minutes=Math.round(seconds/60)-offset;var months;if(minutes<2){if(options.includeSeconds){if(seconds<5){return localize("lessThanXSeconds",5,localizeOptions)}else if(seconds<10){return localize("lessThanXSeconds",10,localizeOptions)}else if(seconds<20){return localize("lessThanXSeconds",20,localizeOptions)}else if(seconds<40){return localize("halfAMinute",null,localizeOptions)}else if(seconds<60){return localize("lessThanXMinutes",1,localizeOptions)}else{return localize("xMinutes",1,localizeOptions)}}else{if(minutes===0){return localize("lessThanXMinutes",1,localizeOptions)}else{return localize("xMinutes",minutes,localizeOptions)}}}else if(minutes<45){return localize("xMinutes",minutes,localizeOptions)}else if(minutes<90){return localize("aboutXHours",1,localizeOptions)}else if(minutes<MINUTES_IN_DAY){var hours=Math.round(minutes/60);return localize("aboutXHours",hours,localizeOptions)}else if(minutes<MINUTES_IN_ALMOST_TWO_DAYS){return localize("xDays",1,localizeOptions)}else if(minutes<MINUTES_IN_MONTH){var days=Math.round(minutes/MINUTES_IN_DAY);return localize("xDays",days,localizeOptions)}else if(minutes<MINUTES_IN_TWO_MONTHS){months=Math.round(minutes/MINUTES_IN_MONTH);return localize("aboutXMonths",months,localizeOptions)}months=differenceInMonths(dateRight,dateLeft);if(months<12){var nearestMonth=Math.round(minutes/MINUTES_IN_MONTH);return localize("xMonths",nearestMonth,localizeOptions)}else{var monthsSinceStartOfYear=months%12;var years=Math.floor(months/12);if(monthsSinceStartOfYear<3){return localize("aboutXYears",years,localizeOptions)}else if(monthsSinceStartOfYear<9){return localize("overXYears",years,localizeOptions);
}else{return localize("almostXYears",years+1,localizeOptions)}}}module.exports=distanceInWords},function(module,exports,__webpack_require__){var buildDistanceInWordsLocale=__webpack_require__(47);var buildFormatLocale=__webpack_require__(48);module.exports={distanceInWords:buildDistanceInWordsLocale(),format:buildFormatLocale()}},function(module,exports){function buildDistanceInWordsLocale(){var distanceInWordsLocale={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function localize(token,count,options){options=options||{};var result;if(typeof distanceInWordsLocale[token]==="string"){result=distanceInWordsLocale[token]}else if(count===1){result=distanceInWordsLocale[token].one}else{result=distanceInWordsLocale[token].other.replace("{{count}}",count)}if(options.addSuffix){if(options.comparison>0){return"in "+result}else{return result+" ago"}}return result}return{localize:localize}}module.exports=buildDistanceInWordsLocale},function(module,exports,__webpack_require__){var buildFormattingTokensRegExp=__webpack_require__(49);function buildFormatLocale(){var months3char=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var monthsFull=["January","February","March","April","May","June","July","August","September","October","November","December"];var weekdays2char=["Su","Mo","Tu","We","Th","Fr","Sa"];var weekdays3char=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];var weekdaysFull=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var meridiemUppercase=["AM","PM"];var meridiemLowercase=["am","pm"];var meridiemFull=["a.m.","p.m."];var formatters={MMM:function(date){return months3char[date.getMonth()]},MMMM:function(date){return monthsFull[date.getMonth()]},dd:function(date){return weekdays2char[date.getDay()]},ddd:function(date){return weekdays3char[date.getDay()]},dddd:function(date){return weekdaysFull[date.getDay()]},A:function(date){return date.getHours()/12>=1?meridiemUppercase[1]:meridiemUppercase[0]},a:function(date){return date.getHours()/12>=1?meridiemLowercase[1]:meridiemLowercase[0]},aa:function(date){return date.getHours()/12>=1?meridiemFull[1]:meridiemFull[0]}};var ordinalFormatters=["M","D","DDD","d","Q","W"];ordinalFormatters.forEach(function(formatterToken){formatters[formatterToken+"o"]=function(date,formatters){return ordinal(formatters[formatterToken](date))}});return{formatters:formatters,formattingTokensRegExp:buildFormattingTokensRegExp(formatters)}}function ordinal(number){var rem100=number%100;if(rem100>20||rem100<10){switch(rem100%10){case 1:return number+"st";case 2:return number+"nd";case 3:return number+"rd"}}return number+"th"}module.exports=buildFormatLocale},function(module,exports){var commonFormatterKeys=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];function buildFormattingTokensRegExp(formatters){var formatterKeys=[];for(var key in formatters){if(formatters.hasOwnProperty(key)){formatterKeys.push(key)}}var formattingTokens=commonFormatterKeys.concat(formatterKeys).sort().reverse();var formattingTokensRegExp=new RegExp("(\\[[^\\[]*\\])|(\\\\)?"+"("+formattingTokens.join("|")+"|.)","g");return formattingTokensRegExp}module.exports=buildFormattingTokensRegExp},function(module,exports,__webpack_require__){var compareDesc=__webpack_require__(26);var parse=__webpack_require__(2);var differenceInSeconds=__webpack_require__(42);var enLocale=__webpack_require__(46);var MINUTES_IN_DAY=1440;var MINUTES_IN_MONTH=43200;var MINUTES_IN_YEAR=525600;function distanceInWordsStrict(dirtyDateToCompare,dirtyDate,dirtyOptions){var options=dirtyOptions||{};var comparison=compareDesc(dirtyDateToCompare,dirtyDate);var locale=options.locale;var localize=enLocale.distanceInWords.localize;if(locale&&locale.distanceInWords&&locale.distanceInWords.localize){localize=locale.distanceInWords.localize}var localizeOptions={addSuffix:Boolean(options.addSuffix),comparison:comparison};var dateLeft,dateRight;if(comparison>0){dateLeft=parse(dirtyDateToCompare);dateRight=parse(dirtyDate)}else{dateLeft=parse(dirtyDate);dateRight=parse(dirtyDateToCompare)}var unit;var mathPartial=Math[options.partialMethod?String(options.partialMethod):"floor"];var seconds=differenceInSeconds(dateRight,dateLeft);var offset=dateRight.getTimezoneOffset()-dateLeft.getTimezoneOffset();var minutes=mathPartial(seconds/60)-offset;var hours,days,months,years;if(options.unit){unit=String(options.unit)}else{if(minutes<1){unit="s"}else if(minutes<60){unit="m"}else if(minutes<MINUTES_IN_DAY){unit="h"}else if(minutes<MINUTES_IN_MONTH){unit="d"}else if(minutes<MINUTES_IN_YEAR){unit="M"}else{unit="Y"}}if(unit==="s"){return localize("xSeconds",seconds,localizeOptions)}else if(unit==="m"){return localize("xMinutes",minutes,localizeOptions)}else if(unit==="h"){hours=mathPartial(minutes/60);return localize("xHours",hours,localizeOptions)}else if(unit==="d"){days=mathPartial(minutes/MINUTES_IN_DAY);return localize("xDays",days,localizeOptions)}else if(unit==="M"){months=mathPartial(minutes/MINUTES_IN_MONTH);return localize("xMonths",months,localizeOptions)}else if(unit==="Y"){years=mathPartial(minutes/MINUTES_IN_YEAR);return localize("xYears",years,localizeOptions)}throw new Error("Unknown unit: "+unit)}module.exports=distanceInWordsStrict},function(module,exports,__webpack_require__){var distanceInWords=__webpack_require__(45);function distanceInWordsToNow(dirtyDate,dirtyOptions){return distanceInWords(Date.now(),dirtyDate,dirtyOptions)}module.exports=distanceInWordsToNow},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function eachDay(dirtyStartDate,dirtyEndDate,dirtyStep){var startDate=parse(dirtyStartDate);var endDate=parse(dirtyEndDate);var step=dirtyStep!==undefined?dirtyStep:1;var endTime=endDate.getTime();if(startDate.getTime()>endTime){throw new Error("The first date cannot be after the second date")}var dates=[];var currentDate=startDate;currentDate.setHours(0,0,0,0);while(currentDate.getTime()<=endTime){dates.push(parse(currentDate));currentDate.setDate(currentDate.getDate()+step)}return dates}module.exports=eachDay},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfDay(dirtyDate){var date=parse(dirtyDate);date.setHours(23,59,59,999);return date}module.exports=endOfDay},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfHour(dirtyDate){var date=parse(dirtyDate);date.setMinutes(59,59,999);return date}module.exports=endOfHour},function(module,exports,__webpack_require__){var endOfWeek=__webpack_require__(56);function endOfISOWeek(dirtyDate){return endOfWeek(dirtyDate,{weekStartsOn:1})}module.exports=endOfISOWeek},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfWeek(dirtyDate,dirtyOptions){var weekStartsOn=dirtyOptions?Number(dirtyOptions.weekStartsOn)||0:0;var date=parse(dirtyDate);var day=date.getDay();var diff=(day<weekStartsOn?-7:0)+6-(day-weekStartsOn);date.setDate(date.getDate()+diff);date.setHours(23,59,59,999);return date}module.exports=endOfWeek},function(module,exports,__webpack_require__){var getISOYear=__webpack_require__(8);var startOfISOWeek=__webpack_require__(9);function endOfISOYear(dirtyDate){var year=getISOYear(dirtyDate);var fourthOfJanuaryOfNextYear=new Date(0);fourthOfJanuaryOfNextYear.setFullYear(year+1,0,4);fourthOfJanuaryOfNextYear.setHours(0,0,0,0);var date=startOfISOWeek(fourthOfJanuaryOfNextYear);date.setMilliseconds(date.getMilliseconds()-1);return date}module.exports=endOfISOYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfMinute(dirtyDate){var date=parse(dirtyDate);date.setSeconds(59,999);return date}module.exports=endOfMinute},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfMonth(dirtyDate){var date=parse(dirtyDate);var month=date.getMonth();date.setFullYear(date.getFullYear(),month+1,0);date.setHours(23,59,59,999);return date}module.exports=endOfMonth},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfQuarter(dirtyDate){var date=parse(dirtyDate);var currentMonth=date.getMonth();var month=currentMonth-currentMonth%3+3;date.setMonth(month,0);date.setHours(23,59,59,999);return date}module.exports=endOfQuarter},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfSecond(dirtyDate){var date=parse(dirtyDate);date.setMilliseconds(999);return date}module.exports=endOfSecond},function(module,exports,__webpack_require__){var endOfDay=__webpack_require__(53);function endOfToday(){return endOfDay(new Date)}module.exports=endOfToday},function(module,exports){function endOfTomorrow(){var now=new Date;var year=now.getFullYear();var month=now.getMonth();var day=now.getDate();var date=new Date(0);date.setFullYear(year,month,day+1);date.setHours(23,59,59,999);return date}module.exports=endOfTomorrow},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function endOfYear(dirtyDate){var date=parse(dirtyDate);var year=date.getFullYear();date.setFullYear(year+1,0,0);date.setHours(23,59,59,999);return date}module.exports=endOfYear},function(module,exports){function endOfYesterday(){var now=new Date;var year=now.getFullYear();var month=now.getMonth();var day=now.getDate();var date=new Date(0);date.setFullYear(year,month,day-1);date.setHours(23,59,59,999);return date}module.exports=endOfYesterday},function(module,exports,__webpack_require__){var getDayOfYear=__webpack_require__(67);var getISOWeek=__webpack_require__(69);var getISOYear=__webpack_require__(8);var parse=__webpack_require__(2);var isValid=__webpack_require__(70);var enLocale=__webpack_require__(46);function format(dirtyDate,dirtyFormatStr,dirtyOptions){var formatStr=dirtyFormatStr?String(dirtyFormatStr):"YYYY-MM-DDTHH:mm:ss.SSSZ";var options=dirtyOptions||{};var locale=options.locale;var localeFormatters=enLocale.format.formatters;var formattingTokensRegExp=enLocale.format.formattingTokensRegExp;if(locale&&locale.format&&locale.format.formatters){localeFormatters=locale.format.formatters;if(locale.format.formattingTokensRegExp){formattingTokensRegExp=locale.format.formattingTokensRegExp}}var date=parse(dirtyDate);if(!isValid(date)){return"Invalid Date"}var formatFn=buildFormatFn(formatStr,localeFormatters,formattingTokensRegExp);return formatFn(date)}var formatters={M:function(date){return date.getMonth()+1},MM:function(date){return addLeadingZeros(date.getMonth()+1,2)},Q:function(date){return Math.ceil((date.getMonth()+1)/3)},D:function(date){return date.getDate()},DD:function(date){return addLeadingZeros(date.getDate(),2)},DDD:function(date){return getDayOfYear(date)},DDDD:function(date){return addLeadingZeros(getDayOfYear(date),3)},d:function(date){return date.getDay()},E:function(date){return date.getDay()||7},W:function(date){return getISOWeek(date)},WW:function(date){return addLeadingZeros(getISOWeek(date),2)},YY:function(date){return addLeadingZeros(date.getFullYear(),4).substr(2)},YYYY:function(date){return addLeadingZeros(date.getFullYear(),4)},GG:function(date){return String(getISOYear(date)).substr(2)},GGGG:function(date){return getISOYear(date)},H:function(date){return date.getHours()},HH:function(date){return addLeadingZeros(date.getHours(),2)},h:function(date){var hours=date.getHours();if(hours===0){return 12}else if(hours>12){return hours%12}else{return hours}},hh:function(date){return addLeadingZeros(formatters["h"](date),2)},m:function(date){return date.getMinutes()},mm:function(date){return addLeadingZeros(date.getMinutes(),2)},s:function(date){return date.getSeconds()},ss:function(date){return addLeadingZeros(date.getSeconds(),2)},S:function(date){return Math.floor(date.getMilliseconds()/100)},SS:function(date){return addLeadingZeros(Math.floor(date.getMilliseconds()/10),2)},SSS:function(date){return addLeadingZeros(date.getMilliseconds(),3)},Z:function(date){return formatTimezone(date.getTimezoneOffset(),":")},ZZ:function(date){return formatTimezone(date.getTimezoneOffset())},X:function(date){return Math.floor(date.getTime()/1e3)},x:function(date){return date.getTime()}};function buildFormatFn(formatStr,localeFormatters,formattingTokensRegExp){var array=formatStr.match(formattingTokensRegExp);var length=array.length;var i;var formatter;for(i=0;i<length;i++){formatter=localeFormatters[array[i]]||formatters[array[i]];if(formatter){array[i]=formatter}else{array[i]=removeFormattingTokens(array[i])}}return function(date){var output="";for(var i=0;i<length;i++){if(array[i]instanceof Function){output+=array[i](date,formatters)}else{output+=array[i]}}return output}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|]$/g,"")}return input.replace(/\\/g,"")}function formatTimezone(offset,delimeter){delimeter=delimeter||"";var sign=offset>0?"-":"+";var absOffset=Math.abs(offset);var hours=Math.floor(absOffset/60);var minutes=absOffset%60;return sign+addLeadingZeros(hours,2)+delimeter+addLeadingZeros(minutes,2)}function addLeadingZeros(number,targetLength){var output=Math.abs(number).toString();while(output.length<targetLength){output="0"+output}return output}module.exports=format},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var startOfYear=__webpack_require__(68);var differenceInCalendarDays=__webpack_require__(13);function getDayOfYear(dirtyDate){var date=parse(dirtyDate);var diff=differenceInCalendarDays(date,startOfYear(date));var dayOfYear=diff+1;return dayOfYear}module.exports=getDayOfYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfYear(dirtyDate){var cleanDate=parse(dirtyDate);var date=new Date(0);date.setFullYear(cleanDate.getFullYear(),0,1);date.setHours(0,0,0,0);return date}module.exports=startOfYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var startOfISOWeek=__webpack_require__(9);var startOfISOYear=__webpack_require__(12);var MILLISECONDS_IN_WEEK=6048e5;function getISOWeek(dirtyDate){var date=parse(dirtyDate);var diff=startOfISOWeek(date).getTime()-startOfISOYear(date).getTime();return Math.round(diff/MILLISECONDS_IN_WEEK)+1}module.exports=getISOWeek},function(module,exports,__webpack_require__){var isDate=__webpack_require__(4);function isValid(dirtyDate){if(isDate(dirtyDate)){return!isNaN(dirtyDate)}else{throw new TypeError(toString.call(dirtyDate)+" is not an instance of Date")}}module.exports=isValid},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getDate(dirtyDate){var date=parse(dirtyDate);var dayOfMonth=date.getDate();return dayOfMonth}module.exports=getDate},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getDay(dirtyDate){var date=parse(dirtyDate);var day=date.getDay();return day}module.exports=getDay},function(module,exports,__webpack_require__){var isLeapYear=__webpack_require__(74);function getDaysInYear(dirtyDate){return isLeapYear(dirtyDate)?366:365}module.exports=getDaysInYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isLeapYear(dirtyDate){var date=parse(dirtyDate);var year=date.getFullYear();return year%400===0||year%4===0&&year%100!==0}module.exports=isLeapYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getHours(dirtyDate){var date=parse(dirtyDate);var hours=date.getHours();return hours}module.exports=getHours},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getISODay(dirtyDate){var date=parse(dirtyDate);var day=date.getDay();if(day===0){day=7}return day}module.exports=getISODay},function(module,exports,__webpack_require__){var startOfISOYear=__webpack_require__(12);var addWeeks=__webpack_require__(20);var MILLISECONDS_IN_WEEK=6048e5;function getISOWeeksInYear(dirtyDate){var thisYear=startOfISOYear(dirtyDate);var nextYear=startOfISOYear(addWeeks(thisYear,60));var diff=nextYear.valueOf()-thisYear.valueOf();return Math.round(diff/MILLISECONDS_IN_WEEK)}module.exports=getISOWeeksInYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getMilliseconds(dirtyDate){var date=parse(dirtyDate);var milliseconds=date.getMilliseconds();return milliseconds}module.exports=getMilliseconds},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getMinutes(dirtyDate){var date=parse(dirtyDate);var minutes=date.getMinutes();return minutes}module.exports=getMinutes},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getMonth(dirtyDate){var date=parse(dirtyDate);var month=date.getMonth();return month}module.exports=getMonth},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var MILLISECONDS_IN_DAY=24*60*60*1e3;function getOverlappingDaysInRanges(dirtyInitialRangeStartDate,dirtyInitialRangeEndDate,dirtyComparedRangeStartDate,dirtyComparedRangeEndDate){var initialStartTime=parse(dirtyInitialRangeStartDate).getTime();var initialEndTime=parse(dirtyInitialRangeEndDate).getTime();var comparedStartTime=parse(dirtyComparedRangeStartDate).getTime();var comparedEndTime=parse(dirtyComparedRangeEndDate).getTime();if(initialStartTime>initialEndTime||comparedStartTime>comparedEndTime){throw new Error("The start of the range cannot be after the end of the range")}var isOverlapping=initialStartTime<comparedEndTime&&comparedStartTime<initialEndTime;if(!isOverlapping){return 0}var overlapStartDate=comparedStartTime<initialStartTime?initialStartTime:comparedStartTime;var overlapEndDate=comparedEndTime>initialEndTime?initialEndTime:comparedEndTime;var differenceInMs=overlapEndDate-overlapStartDate;return Math.ceil(differenceInMs/MILLISECONDS_IN_DAY)}module.exports=getOverlappingDaysInRanges},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getSeconds(dirtyDate){var date=parse(dirtyDate);var seconds=date.getSeconds();return seconds}module.exports=getSeconds},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getTime(dirtyDate){var date=parse(dirtyDate);var timestamp=date.getTime();return timestamp}module.exports=getTime},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function getYear(dirtyDate){var date=parse(dirtyDate);var year=date.getFullYear();return year}module.exports=getYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isAfter(dirtyDate,dirtyDateToCompare){var date=parse(dirtyDate);var dateToCompare=parse(dirtyDateToCompare);return date.getTime()>dateToCompare.getTime()}module.exports=isAfter},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isBefore(dirtyDate,dirtyDateToCompare){var date=parse(dirtyDate);var dateToCompare=parse(dirtyDateToCompare);return date.getTime()<dateToCompare.getTime()}module.exports=isBefore},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isEqual(dirtyLeftDate,dirtyRightDate){var dateLeft=parse(dirtyLeftDate);var dateRight=parse(dirtyRightDate);return dateLeft.getTime()===dateRight.getTime()}module.exports=isEqual},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isFirstDayOfMonth(dirtyDate){return parse(dirtyDate).getDate()===1}module.exports=isFirstDayOfMonth},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isFriday(dirtyDate){return parse(dirtyDate).getDay()===5}module.exports=isFriday},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isFuture(dirtyDate){return parse(dirtyDate).getTime()>(new Date).getTime()}module.exports=isFuture},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var endOfDay=__webpack_require__(53);var endOfMonth=__webpack_require__(59);function isLastDayOfMonth(dirtyDate){var date=parse(dirtyDate);return endOfDay(date).getTime()===endOfMonth(date).getTime()}module.exports=isLastDayOfMonth},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isMonday(dirtyDate){return parse(dirtyDate).getDay()===1}module.exports=isMonday},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isPast(dirtyDate){return parse(dirtyDate).getTime()<(new Date).getTime()}module.exports=isPast},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(14);function isSameDay(dirtyDateLeft,dirtyDateRight){var dateLeftStartOfDay=startOfDay(dirtyDateLeft);var dateRightStartOfDay=startOfDay(dirtyDateRight);return dateLeftStartOfDay.getTime()===dateRightStartOfDay.getTime()}module.exports=isSameDay},function(module,exports,__webpack_require__){var startOfHour=__webpack_require__(96);function isSameHour(dirtyDateLeft,dirtyDateRight){var dateLeftStartOfHour=startOfHour(dirtyDateLeft);var dateRightStartOfHour=startOfHour(dirtyDateRight);return dateLeftStartOfHour.getTime()===dateRightStartOfHour.getTime()}module.exports=isSameHour},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfHour(dirtyDate){var date=parse(dirtyDate);date.setMinutes(0,0,0);return date}module.exports=startOfHour},function(module,exports,__webpack_require__){var isSameWeek=__webpack_require__(98);function isSameISOWeek(dirtyDateLeft,dirtyDateRight){return isSameWeek(dirtyDateLeft,dirtyDateRight,{weekStartsOn:1})}module.exports=isSameISOWeek},function(module,exports,__webpack_require__){var startOfWeek=__webpack_require__(10);function isSameWeek(dirtyDateLeft,dirtyDateRight,dirtyOptions){var dateLeftStartOfWeek=startOfWeek(dirtyDateLeft,dirtyOptions);var dateRightStartOfWeek=startOfWeek(dirtyDateRight,dirtyOptions);return dateLeftStartOfWeek.getTime()===dateRightStartOfWeek.getTime()}module.exports=isSameWeek},function(module,exports,__webpack_require__){var startOfISOYear=__webpack_require__(12);function isSameISOYear(dirtyDateLeft,dirtyDateRight){var dateLeftStartOfYear=startOfISOYear(dirtyDateLeft);var dateRightStartOfYear=startOfISOYear(dirtyDateRight);return dateLeftStartOfYear.getTime()===dateRightStartOfYear.getTime()}module.exports=isSameISOYear},function(module,exports,__webpack_require__){var startOfMinute=__webpack_require__(101);function isSameMinute(dirtyDateLeft,dirtyDateRight){var dateLeftStartOfMinute=startOfMinute(dirtyDateLeft);var dateRightStartOfMinute=startOfMinute(dirtyDateRight);return dateLeftStartOfMinute.getTime()===dateRightStartOfMinute.getTime()}module.exports=isSameMinute},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfMinute(dirtyDate){var date=parse(dirtyDate);date.setSeconds(0,0);return date}module.exports=startOfMinute},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isSameMonth(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);return dateLeft.getFullYear()===dateRight.getFullYear()&&dateLeft.getMonth()===dateRight.getMonth()}module.exports=isSameMonth},function(module,exports,__webpack_require__){var startOfQuarter=__webpack_require__(104);function isSameQuarter(dirtyDateLeft,dirtyDateRight){var dateLeftStartOfQuarter=startOfQuarter(dirtyDateLeft);var dateRightStartOfQuarter=startOfQuarter(dirtyDateRight);return dateLeftStartOfQuarter.getTime()===dateRightStartOfQuarter.getTime()}module.exports=isSameQuarter},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfQuarter(dirtyDate){var date=parse(dirtyDate);var currentMonth=date.getMonth();var month=currentMonth-currentMonth%3;date.setMonth(month,1);date.setHours(0,0,0,0);return date}module.exports=startOfQuarter},function(module,exports,__webpack_require__){var startOfSecond=__webpack_require__(106);function isSameSecond(dirtyDateLeft,dirtyDateRight){var dateLeftStartOfSecond=startOfSecond(dirtyDateLeft);var dateRightStartOfSecond=startOfSecond(dirtyDateRight);return dateLeftStartOfSecond.getTime()===dateRightStartOfSecond.getTime()}module.exports=isSameSecond},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfSecond(dirtyDate){var date=parse(dirtyDate);date.setMilliseconds(0);return date}module.exports=startOfSecond},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isSameYear(dirtyDateLeft,dirtyDateRight){var dateLeft=parse(dirtyDateLeft);var dateRight=parse(dirtyDateRight);return dateLeft.getFullYear()===dateRight.getFullYear()}module.exports=isSameYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isSaturday(dirtyDate){return parse(dirtyDate).getDay()===6}module.exports=isSaturday},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isSunday(dirtyDate){return parse(dirtyDate).getDay()===0}module.exports=isSunday},function(module,exports,__webpack_require__){var isSameHour=__webpack_require__(95);function isThisHour(dirtyDate){return isSameHour(new Date,dirtyDate)}module.exports=isThisHour},function(module,exports,__webpack_require__){var isSameISOWeek=__webpack_require__(97);function isThisISOWeek(dirtyDate){return isSameISOWeek(new Date,dirtyDate)}module.exports=isThisISOWeek},function(module,exports,__webpack_require__){var isSameISOYear=__webpack_require__(99);function isThisISOYear(dirtyDate){return isSameISOYear(new Date,dirtyDate)}module.exports=isThisISOYear},function(module,exports,__webpack_require__){var isSameMinute=__webpack_require__(100);function isThisMinute(dirtyDate){return isSameMinute(new Date,dirtyDate)}module.exports=isThisMinute},function(module,exports,__webpack_require__){var isSameMonth=__webpack_require__(102);function isThisMonth(dirtyDate){return isSameMonth(new Date,dirtyDate)}module.exports=isThisMonth},function(module,exports,__webpack_require__){var isSameQuarter=__webpack_require__(103);function isThisQuarter(dirtyDate){return isSameQuarter(new Date,dirtyDate)}module.exports=isThisQuarter},function(module,exports,__webpack_require__){var isSameSecond=__webpack_require__(105);function isThisSecond(dirtyDate){return isSameSecond(new Date,dirtyDate)}module.exports=isThisSecond},function(module,exports,__webpack_require__){var isSameWeek=__webpack_require__(98);function isThisWeek(dirtyDate,dirtyOptions){return isSameWeek(new Date,dirtyDate,dirtyOptions)}module.exports=isThisWeek},function(module,exports,__webpack_require__){var isSameYear=__webpack_require__(107);function isThisYear(dirtyDate){return isSameYear(new Date,dirtyDate)}module.exports=isThisYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isThursday(dirtyDate){return parse(dirtyDate).getDay()===4}module.exports=isThursday},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(14);function isToday(dirtyDate){return startOfDay(dirtyDate).getTime()===startOfDay(new Date).getTime()}module.exports=isToday},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(14);function isTomorrow(dirtyDate){var tomorrow=new Date;tomorrow.setDate(tomorrow.getDate()+1);return startOfDay(dirtyDate).getTime()===startOfDay(tomorrow).getTime()}module.exports=isTomorrow},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isTuesday(dirtyDate){return parse(dirtyDate).getDay()===2}module.exports=isTuesday},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isWednesday(dirtyDate){return parse(dirtyDate).getDay()===3}module.exports=isWednesday},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isWeekend(dirtyDate){var date=parse(dirtyDate);var day=date.getDay();return day===0||day===6}module.exports=isWeekend},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function isWithinRange(dirtyDate,dirtyStartDate,dirtyEndDate){var time=parse(dirtyDate).getTime();var startTime=parse(dirtyStartDate).getTime();var endTime=parse(dirtyEndDate).getTime();if(startTime>endTime){throw new Error("The start of the range cannot be after the end of the range")}return time>=startTime&&time<=endTime}module.exports=isWithinRange},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(14);function isYesterday(dirtyDate){var yesterday=new Date;yesterday.setDate(yesterday.getDate()-1);return startOfDay(dirtyDate).getTime()===startOfDay(yesterday).getTime()}module.exports=isYesterday},function(module,exports,__webpack_require__){var lastDayOfWeek=__webpack_require__(128);function lastDayOfISOWeek(dirtyDate){return lastDayOfWeek(dirtyDate,{weekStartsOn:1})}module.exports=lastDayOfISOWeek},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function lastDayOfWeek(dirtyDate,dirtyOptions){var weekStartsOn=dirtyOptions?Number(dirtyOptions.weekStartsOn)||0:0;var date=parse(dirtyDate);var day=date.getDay();var diff=(day<weekStartsOn?-7:0)+6-(day-weekStartsOn);date.setHours(0,0,0,0);date.setDate(date.getDate()+diff);return date}module.exports=lastDayOfWeek},function(module,exports,__webpack_require__){var getISOYear=__webpack_require__(8);var startOfISOWeek=__webpack_require__(9);function lastDayOfISOYear(dirtyDate){var year=getISOYear(dirtyDate);var fourthOfJanuary=new Date(0);fourthOfJanuary.setFullYear(year+1,0,4);fourthOfJanuary.setHours(0,0,0,0);var date=startOfISOWeek(fourthOfJanuary);date.setDate(date.getDate()-1);return date}module.exports=lastDayOfISOYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function lastDayOfMonth(dirtyDate){var date=parse(dirtyDate);var month=date.getMonth();date.setFullYear(date.getFullYear(),month+1,0);date.setHours(0,0,0,0);return date}module.exports=lastDayOfMonth},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function lastDayOfQuarter(dirtyDate){var date=parse(dirtyDate);var currentMonth=date.getMonth();var month=currentMonth-currentMonth%3+3;date.setMonth(month,0);date.setHours(0,0,0,0);return date}module.exports=lastDayOfQuarter},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function lastDayOfYear(dirtyDate){var date=parse(dirtyDate);var year=date.getFullYear();date.setFullYear(year+1,0,0);date.setHours(0,0,0,0);return date}module.exports=lastDayOfYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function max(){var dirtyDates=Array.prototype.slice.call(arguments);var dates=dirtyDates.map(function(dirtyDate){return parse(dirtyDate)});var latestTimestamp=Math.max.apply(null,dates);return new Date(latestTimestamp)}module.exports=max},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function min(){var dirtyDates=Array.prototype.slice.call(arguments);var dates=dirtyDates.map(function(dirtyDate){return parse(dirtyDate)});var earliestTimestamp=Math.min.apply(null,dates);return new Date(earliestTimestamp)}module.exports=min},function(module,exports,__webpack_require__){
var parse=__webpack_require__(2);function setDate(dirtyDate,dirtyDayOfMonth){var date=parse(dirtyDate);var dayOfMonth=Number(dirtyDayOfMonth);date.setDate(dayOfMonth);return date}module.exports=setDate},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var addDays=__webpack_require__(1);function setDay(dirtyDate,dirtyDay,dirtyOptions){var weekStartsOn=dirtyOptions?Number(dirtyOptions.weekStartsOn)||0:0;var date=parse(dirtyDate);var day=Number(dirtyDay);var currentDay=date.getDay();var remainder=day%7;var dayIndex=(remainder+7)%7;var diff=(dayIndex<weekStartsOn?7:0)+day-currentDay;return addDays(date,diff)}module.exports=setDay},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function setDayOfYear(dirtyDate,dirtyDayOfYear){var date=parse(dirtyDate);var dayOfYear=Number(dirtyDayOfYear);date.setMonth(0);date.setDate(dayOfYear);return date}module.exports=setDayOfYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function setHours(dirtyDate,dirtyHours){var date=parse(dirtyDate);var hours=Number(dirtyHours);date.setHours(hours);return date}module.exports=setHours},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var addDays=__webpack_require__(1);var getISODay=__webpack_require__(76);function setISODay(dirtyDate,dirtyDay){var date=parse(dirtyDate);var day=Number(dirtyDay);var currentDay=getISODay(date);var diff=day-currentDay;return addDays(date,diff)}module.exports=setISODay},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var getISOWeek=__webpack_require__(69);function setISOWeek(dirtyDate,dirtyISOWeek){var date=parse(dirtyDate);var isoWeek=Number(dirtyISOWeek);var diff=getISOWeek(date)-isoWeek;date.setDate(date.getDate()-diff*7);return date}module.exports=setISOWeek},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function setMilliseconds(dirtyDate,dirtyMilliseconds){var date=parse(dirtyDate);var milliseconds=Number(dirtyMilliseconds);date.setMilliseconds(milliseconds);return date}module.exports=setMilliseconds},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function setMinutes(dirtyDate,dirtyMinutes){var date=parse(dirtyDate);var minutes=Number(dirtyMinutes);date.setMinutes(minutes);return date}module.exports=setMinutes},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var getDaysInMonth=__webpack_require__(17);function setMonth(dirtyDate,dirtyMonth){var date=parse(dirtyDate);var month=Number(dirtyMonth);var year=date.getFullYear();var day=date.getDate();var dateWithDesiredMonth=new Date(0);dateWithDesiredMonth.setFullYear(year,month,15);dateWithDesiredMonth.setHours(0,0,0,0);var daysInMonth=getDaysInMonth(dateWithDesiredMonth);date.setMonth(month,Math.min(day,daysInMonth));return date}module.exports=setMonth},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);var setMonth=__webpack_require__(143);function setQuarter(dirtyDate,dirtyQuarter){var date=parse(dirtyDate);var quarter=Number(dirtyQuarter);var oldQuarter=Math.floor(date.getMonth()/3)+1;var diff=quarter-oldQuarter;return setMonth(date,date.getMonth()+diff*3)}module.exports=setQuarter},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function setSeconds(dirtyDate,dirtySeconds){var date=parse(dirtyDate);var seconds=Number(dirtySeconds);date.setSeconds(seconds);return date}module.exports=setSeconds},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function setYear(dirtyDate,dirtyYear){var date=parse(dirtyDate);var year=Number(dirtyYear);date.setFullYear(year);return date}module.exports=setYear},function(module,exports,__webpack_require__){var parse=__webpack_require__(2);function startOfMonth(dirtyDate){var date=parse(dirtyDate);date.setDate(1);date.setHours(0,0,0,0);return date}module.exports=startOfMonth},function(module,exports,__webpack_require__){var startOfDay=__webpack_require__(14);function startOfToday(){return startOfDay(new Date)}module.exports=startOfToday},function(module,exports){function startOfTomorrow(){var now=new Date;var year=now.getFullYear();var month=now.getMonth();var day=now.getDate();var date=new Date(0);date.setFullYear(year,month,day+1);date.setHours(0,0,0,0);return date}module.exports=startOfTomorrow},function(module,exports){function startOfYesterday(){var now=new Date;var year=now.getFullYear();var month=now.getMonth();var day=now.getDate();var date=new Date(0);date.setFullYear(year,month,day-1);date.setHours(0,0,0,0);return date}module.exports=startOfYesterday},function(module,exports,__webpack_require__){var addDays=__webpack_require__(1);function subDays(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addDays(dirtyDate,-amount)}module.exports=subDays},function(module,exports,__webpack_require__){var addHours=__webpack_require__(5);function subHours(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addHours(dirtyDate,-amount)}module.exports=subHours},function(module,exports,__webpack_require__){var addMilliseconds=__webpack_require__(6);function subMilliseconds(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMilliseconds(dirtyDate,-amount)}module.exports=subMilliseconds},function(module,exports,__webpack_require__){var addMinutes=__webpack_require__(15);function subMinutes(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMinutes(dirtyDate,-amount)}module.exports=subMinutes},function(module,exports,__webpack_require__){var addMonths=__webpack_require__(16);function subMonths(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addMonths(dirtyDate,-amount)}module.exports=subMonths},function(module,exports,__webpack_require__){var addQuarters=__webpack_require__(18);function subQuarters(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addQuarters(dirtyDate,-amount)}module.exports=subQuarters},function(module,exports,__webpack_require__){var addSeconds=__webpack_require__(19);function subSeconds(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addSeconds(dirtyDate,-amount)}module.exports=subSeconds},function(module,exports,__webpack_require__){var addWeeks=__webpack_require__(20);function subWeeks(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addWeeks(dirtyDate,-amount)}module.exports=subWeeks},function(module,exports,__webpack_require__){var addYears=__webpack_require__(21);function subYears(dirtyDate,dirtyAmount){var amount=Number(dirtyAmount);return addYears(dirtyDate,-amount)}module.exports=subYears}])});/* flatpickr v4.6.13,, @license MIT */
// Copyright (c) 2017 Gregory Petrosyan
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).flatpickr=n()}(this,(function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var n,t=1,a=arguments.length;t<a;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};function n(){for(var e=0,n=0,t=arguments.length;n<t;n++)e+=arguments[n].length;var a=Array(e),i=0;for(n=0;n<t;n++)for(var o=arguments[n],r=0,l=o.length;r<l;r++,i++)a[i]=o[r];return a}var t=["onChange","onClose","onDayCreate","onDestroy","onKeyDown","onMonthChange","onOpen","onParseConfig","onReady","onValueUpdate","onYearChange","onPreCalendarPosition"],a={_disable:[],allowInput:!1,allowInvalidPreload:!1,altFormat:"F j, Y",altInput:!1,altInputClass:"form-control input",animate:"object"==typeof window&&-1===window.navigator.userAgent.indexOf("MSIE"),ariaDateFormat:"F j, Y",autoFillDefaultTime:!0,clickOpens:!0,closeOnSelect:!0,conjunction:", ",dateFormat:"Y-m-d",defaultHour:12,defaultMinute:0,defaultSeconds:0,disable:[],disableMobile:!1,enableSeconds:!1,enableTime:!1,errorHandler:function(e){return"undefined"!=typeof console&&console.warn(e)},getWeek:function(e){var n=new Date(e.getTime());n.setHours(0,0,0,0),n.setDate(n.getDate()+3-(n.getDay()+6)%7);var t=new Date(n.getFullYear(),0,4);return 1+Math.round(((n.getTime()-t.getTime())/864e5-3+(t.getDay()+6)%7)/7)},hourIncrement:1,ignoredFocusElements:[],inline:!1,locale:"default",minuteIncrement:5,mode:"single",monthSelectorType:"dropdown",nextArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>",noCalendar:!1,now:new Date,onChange:[],onClose:[],onDayCreate:[],onDestroy:[],onKeyDown:[],onMonthChange:[],onOpen:[],onParseConfig:[],onReady:[],onValueUpdate:[],onYearChange:[],onPreCalendarPosition:[],plugins:[],position:"auto",positionElement:void 0,prevArrow:"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>",shorthandCurrentMonth:!1,showMonths:1,static:!1,time_24hr:!1,weekNumbers:!1,wrap:!1},i={weekdays:{shorthand:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longhand:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},months:{shorthand:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longhand:["January","February","March","April","May","June","July","August","September","October","November","December"]},daysInMonth:[31,28,31,30,31,30,31,31,30,31,30,31],firstDayOfWeek:0,ordinal:function(e){var n=e%100;if(n>3&&n<21)return"th";switch(n%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},rangeSeparator:" to ",weekAbbreviation:"Wk",scrollTitle:"Scroll to increment",toggleTitle:"Click to toggle",amPM:["AM","PM"],yearAriaLabel:"Year",monthAriaLabel:"Month",hourAriaLabel:"Hour",minuteAriaLabel:"Minute",time_24hr:!1},o=function(e,n){return void 0===n&&(n=2),("000"+e).slice(-1*n)},r=function(e){return!0===e?1:0};function l(e,n){var t;return function(){var a=this,i=arguments;clearTimeout(t),t=setTimeout((function(){return e.apply(a,i)}),n)}}var c=function(e){return e instanceof Array?e:[e]};function s(e,n,t){if(!0===t)return e.classList.add(n);e.classList.remove(n)}function d(e,n,t){var a=window.document.createElement(e);return n=n||"",t=t||"",a.className=n,void 0!==t&&(a.textContent=t),a}function u(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function f(e,n){return n(e)?e:e.parentNode?f(e.parentNode,n):void 0}function m(e,n){var t=d("div","numInputWrapper"),a=d("input","numInput "+e),i=d("span","arrowUp"),o=d("span","arrowDown");if(-1===navigator.userAgent.indexOf("MSIE 9.0")?a.type="number":(a.type="text",a.pattern="\\d*"),void 0!==n)for(var r in n)a.setAttribute(r,n[r]);return t.appendChild(a),t.appendChild(i),t.appendChild(o),t}function g(e){try{return"function"==typeof e.composedPath?e.composedPath()[0]:e.target}catch(n){return e.target}}var p=function(){},h=function(e,n,t){return t.months[n?"shorthand":"longhand"][e]},v={D:p,F:function(e,n,t){e.setMonth(t.months.longhand.indexOf(n))},G:function(e,n){e.setHours((e.getHours()>=12?12:0)+parseFloat(n))},H:function(e,n){e.setHours(parseFloat(n))},J:function(e,n){e.setDate(parseFloat(n))},K:function(e,n,t){e.setHours(e.getHours()%12+12*r(new RegExp(t.amPM[1],"i").test(n)))},M:function(e,n,t){e.setMonth(t.months.shorthand.indexOf(n))},S:function(e,n){e.setSeconds(parseFloat(n))},U:function(e,n){return new Date(1e3*parseFloat(n))},W:function(e,n,t){var a=parseInt(n),i=new Date(e.getFullYear(),0,2+7*(a-1),0,0,0,0);return i.setDate(i.getDate()-i.getDay()+t.firstDayOfWeek),i},Y:function(e,n){e.setFullYear(parseFloat(n))},Z:function(e,n){return new Date(n)},d:function(e,n){e.setDate(parseFloat(n))},h:function(e,n){e.setHours((e.getHours()>=12?12:0)+parseFloat(n))},i:function(e,n){e.setMinutes(parseFloat(n))},j:function(e,n){e.setDate(parseFloat(n))},l:p,m:function(e,n){e.setMonth(parseFloat(n)-1)},n:function(e,n){e.setMonth(parseFloat(n)-1)},s:function(e,n){e.setSeconds(parseFloat(n))},u:function(e,n){return new Date(parseFloat(n))},w:p,y:function(e,n){e.setFullYear(2e3+parseFloat(n))}},D={D:"",F:"",G:"(\\d\\d|\\d)",H:"(\\d\\d|\\d)",J:"(\\d\\d|\\d)\\w+",K:"",M:"",S:"(\\d\\d|\\d)",U:"(.+)",W:"(\\d\\d|\\d)",Y:"(\\d{4})",Z:"(.+)",d:"(\\d\\d|\\d)",h:"(\\d\\d|\\d)",i:"(\\d\\d|\\d)",j:"(\\d\\d|\\d)",l:"",m:"(\\d\\d|\\d)",n:"(\\d\\d|\\d)",s:"(\\d\\d|\\d)",u:"(.+)",w:"(\\d\\d|\\d)",y:"(\\d{2})"},w={Z:function(e){return e.toISOString()},D:function(e,n,t){return n.weekdays.shorthand[w.w(e,n,t)]},F:function(e,n,t){return h(w.n(e,n,t)-1,!1,n)},G:function(e,n,t){return o(w.h(e,n,t))},H:function(e){return o(e.getHours())},J:function(e,n){return void 0!==n.ordinal?e.getDate()+n.ordinal(e.getDate()):e.getDate()},K:function(e,n){return n.amPM[r(e.getHours()>11)]},M:function(e,n){return h(e.getMonth(),!0,n)},S:function(e){return o(e.getSeconds())},U:function(e){return e.getTime()/1e3},W:function(e,n,t){return t.getWeek(e)},Y:function(e){return o(e.getFullYear(),4)},d:function(e){return o(e.getDate())},h:function(e){return e.getHours()%12?e.getHours()%12:12},i:function(e){return o(e.getMinutes())},j:function(e){return e.getDate()},l:function(e,n){return n.weekdays.longhand[e.getDay()]},m:function(e){return o(e.getMonth()+1)},n:function(e){return e.getMonth()+1},s:function(e){return e.getSeconds()},u:function(e){return e.getTime()},w:function(e){return e.getDay()},y:function(e){return String(e.getFullYear()).substring(2)}},b=function(e){var n=e.config,t=void 0===n?a:n,o=e.l10n,r=void 0===o?i:o,l=e.isMobile,c=void 0!==l&&l;return function(e,n,a){var i=a||r;return void 0===t.formatDate||c?n.split("").map((function(n,a,o){return w[n]&&"\\"!==o[a-1]?w[n](e,i,t):"\\"!==n?n:""})).join(""):t.formatDate(e,n,i)}},C=function(e){var n=e.config,t=void 0===n?a:n,o=e.l10n,r=void 0===o?i:o;return function(e,n,i,o){if(0===e||e){var l,c=o||r,s=e;if(e instanceof Date)l=new Date(e.getTime());else if("string"!=typeof e&&void 0!==e.toFixed)l=new Date(e);else if("string"==typeof e){var d=n||(t||a).dateFormat,u=String(e).trim();if("today"===u)l=new Date,i=!0;else if(t&&t.parseDate)l=t.parseDate(e,d);else if(/Z$/.test(u)||/GMT$/.test(u))l=new Date(e);else{for(var f=void 0,m=[],g=0,p=0,h="";g<d.length;g++){var w=d[g],b="\\"===w,C="\\"===d[g-1]||b;if(D[w]&&!C){h+=D[w];var M=new RegExp(h).exec(e);M&&(f=!0)&&m["Y"!==w?"push":"unshift"]({fn:v[w],val:M[++p]})}else b||(h+=".")}l=t&&t.noCalendar?new Date((new Date).setHours(0,0,0,0)):new Date((new Date).getFullYear(),0,1,0,0,0,0),m.forEach((function(e){var n=e.fn,t=e.val;return l=n(l,t,c)||l})),l=f?l:void 0}}if(l instanceof Date&&!isNaN(l.getTime()))return!0===i&&l.setHours(0,0,0,0),l;t.errorHandler(new Error("Invalid date provided: "+s))}}};function M(e,n,t){return void 0===t&&(t=!0),!1!==t?new Date(e.getTime()).setHours(0,0,0,0)-new Date(n.getTime()).setHours(0,0,0,0):e.getTime()-n.getTime()}var y=function(e,n,t){return 3600*e+60*n+t},x=864e5;function E(e){var n=e.defaultHour,t=e.defaultMinute,a=e.defaultSeconds;if(void 0!==e.minDate){var i=e.minDate.getHours(),o=e.minDate.getMinutes(),r=e.minDate.getSeconds();n<i&&(n=i),n===i&&t<o&&(t=o),n===i&&t===o&&a<r&&(a=e.minDate.getSeconds())}if(void 0!==e.maxDate){var l=e.maxDate.getHours(),c=e.maxDate.getMinutes();(n=Math.min(n,l))===l&&(t=Math.min(c,t)),n===l&&t===c&&(a=e.maxDate.getSeconds())}return{hours:n,minutes:t,seconds:a}}"function"!=typeof Object.assign&&(Object.assign=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(!e)throw TypeError("Cannot convert undefined or null to object");for(var a=function(n){n&&Object.keys(n).forEach((function(t){return e[t]=n[t]}))},i=0,o=n;i<o.length;i++){var r=o[i];a(r)}return e});function k(p,v){var w={config:e(e({},a),I.defaultConfig),l10n:i};function k(){var e;return(null===(e=w.calendarContainer)||void 0===e?void 0:e.getRootNode()).activeElement||document.activeElement}function T(e){return e.bind(w)}function S(){var e=w.config;!1===e.weekNumbers&&1===e.showMonths||!0!==e.noCalendar&&window.requestAnimationFrame((function(){if(void 0!==w.calendarContainer&&(w.calendarContainer.style.visibility="hidden",w.calendarContainer.style.display="block"),void 0!==w.daysContainer){var n=(w.days.offsetWidth+1)*e.showMonths;w.daysContainer.style.width=n+"px",w.calendarContainer.style.width=n+(void 0!==w.weekWrapper?w.weekWrapper.offsetWidth:0)+"px",w.calendarContainer.style.removeProperty("visibility"),w.calendarContainer.style.removeProperty("display")}}))}function _(e){if(0===w.selectedDates.length){var n=void 0===w.config.minDate||M(new Date,w.config.minDate)>=0?new Date:new Date(w.config.minDate.getTime()),t=E(w.config);n.setHours(t.hours,t.minutes,t.seconds,n.getMilliseconds()),w.selectedDates=[n],w.latestSelectedDateObj=n}void 0!==e&&"blur"!==e.type&&function(e){e.preventDefault();var n="keydown"===e.type,t=g(e),a=t;void 0!==w.amPM&&t===w.amPM&&(w.amPM.textContent=w.l10n.amPM[r(w.amPM.textContent===w.l10n.amPM[0])]);var i=parseFloat(a.getAttribute("min")),l=parseFloat(a.getAttribute("max")),c=parseFloat(a.getAttribute("step")),s=parseInt(a.value,10),d=e.delta||(n?38===e.which?1:-1:0),u=s+c*d;if(void 0!==a.value&&2===a.value.length){var f=a===w.hourElement,m=a===w.minuteElement;u<i?(u=l+u+r(!f)+(r(f)&&r(!w.amPM)),m&&L(void 0,-1,w.hourElement)):u>l&&(u=a===w.hourElement?u-l-r(!w.amPM):i,m&&L(void 0,1,w.hourElement)),w.amPM&&f&&(1===c?u+s===23:Math.abs(u-s)>c)&&(w.amPM.textContent=w.l10n.amPM[r(w.amPM.textContent===w.l10n.amPM[0])]),a.value=o(u)}}(e);var a=w._input.value;O(),ye(),w._input.value!==a&&w._debouncedChange()}function O(){if(void 0!==w.hourElement&&void 0!==w.minuteElement){var e,n,t=(parseInt(w.hourElement.value.slice(-2),10)||0)%24,a=(parseInt(w.minuteElement.value,10)||0)%60,i=void 0!==w.secondElement?(parseInt(w.secondElement.value,10)||0)%60:0;void 0!==w.amPM&&(e=t,n=w.amPM.textContent,t=e%12+12*r(n===w.l10n.amPM[1]));var o=void 0!==w.config.minTime||w.config.minDate&&w.minDateHasTime&&w.latestSelectedDateObj&&0===M(w.latestSelectedDateObj,w.config.minDate,!0),l=void 0!==w.config.maxTime||w.config.maxDate&&w.maxDateHasTime&&w.latestSelectedDateObj&&0===M(w.latestSelectedDateObj,w.config.maxDate,!0);if(void 0!==w.config.maxTime&&void 0!==w.config.minTime&&w.config.minTime>w.config.maxTime){var c=y(w.config.minTime.getHours(),w.config.minTime.getMinutes(),w.config.minTime.getSeconds()),s=y(w.config.maxTime.getHours(),w.config.maxTime.getMinutes(),w.config.maxTime.getSeconds()),d=y(t,a,i);if(d>s&&d<c){var u=function(e){var n=Math.floor(e/3600),t=(e-3600*n)/60;return[n,t,e-3600*n-60*t]}(c);t=u[0],a=u[1],i=u[2]}}else{if(l){var f=void 0!==w.config.maxTime?w.config.maxTime:w.config.maxDate;(t=Math.min(t,f.getHours()))===f.getHours()&&(a=Math.min(a,f.getMinutes())),a===f.getMinutes()&&(i=Math.min(i,f.getSeconds()))}if(o){var m=void 0!==w.config.minTime?w.config.minTime:w.config.minDate;(t=Math.max(t,m.getHours()))===m.getHours()&&a<m.getMinutes()&&(a=m.getMinutes()),a===m.getMinutes()&&(i=Math.max(i,m.getSeconds()))}}A(t,a,i)}}function F(e){var n=e||w.latestSelectedDateObj;n&&n instanceof Date&&A(n.getHours(),n.getMinutes(),n.getSeconds())}function A(e,n,t){void 0!==w.latestSelectedDateObj&&w.latestSelectedDateObj.setHours(e%24,n,t||0,0),w.hourElement&&w.minuteElement&&!w.isMobile&&(w.hourElement.value=o(w.config.time_24hr?e:(12+e)%12+12*r(e%12==0)),w.minuteElement.value=o(n),void 0!==w.amPM&&(w.amPM.textContent=w.l10n.amPM[r(e>=12)]),void 0!==w.secondElement&&(w.secondElement.value=o(t)))}function N(e){var n=g(e),t=parseInt(n.value)+(e.delta||0);(t/1e3>1||"Enter"===e.key&&!/[^\d]/.test(t.toString()))&&ee(t)}function P(e,n,t,a){return n instanceof Array?n.forEach((function(n){return P(e,n,t,a)})):e instanceof Array?e.forEach((function(e){return P(e,n,t,a)})):(e.addEventListener(n,t,a),void w._handlers.push({remove:function(){return e.removeEventListener(n,t,a)}}))}function Y(){De("onChange")}function j(e,n){var t=void 0!==e?w.parseDate(e):w.latestSelectedDateObj||(w.config.minDate&&w.config.minDate>w.now?w.config.minDate:w.config.maxDate&&w.config.maxDate<w.now?w.config.maxDate:w.now),a=w.currentYear,i=w.currentMonth;try{void 0!==t&&(w.currentYear=t.getFullYear(),w.currentMonth=t.getMonth())}catch(e){e.message="Invalid date supplied: "+t,w.config.errorHandler(e)}n&&w.currentYear!==a&&(De("onYearChange"),q()),!n||w.currentYear===a&&w.currentMonth===i||De("onMonthChange"),w.redraw()}function H(e){var n=g(e);~n.className.indexOf("arrow")&&L(e,n.classList.contains("arrowUp")?1:-1)}function L(e,n,t){var a=e&&g(e),i=t||a&&a.parentNode&&a.parentNode.firstChild,o=we("increment");o.delta=n,i&&i.dispatchEvent(o)}function R(e,n,t,a){var i=ne(n,!0),o=d("span",e,n.getDate().toString());return o.dateObj=n,o.$i=a,o.setAttribute("aria-label",w.formatDate(n,w.config.ariaDateFormat)),-1===e.indexOf("hidden")&&0===M(n,w.now)&&(w.todayDateElem=o,o.classList.add("today"),o.setAttribute("aria-current","date")),i?(o.tabIndex=-1,be(n)&&(o.classList.add("selected"),w.selectedDateElem=o,"range"===w.config.mode&&(s(o,"startRange",w.selectedDates[0]&&0===M(n,w.selectedDates[0],!0)),s(o,"endRange",w.selectedDates[1]&&0===M(n,w.selectedDates[1],!0)),"nextMonthDay"===e&&o.classList.add("inRange")))):o.classList.add("flatpickr-disabled"),"range"===w.config.mode&&function(e){return!("range"!==w.config.mode||w.selectedDates.length<2)&&(M(e,w.selectedDates[0])>=0&&M(e,w.selectedDates[1])<=0)}(n)&&!be(n)&&o.classList.add("inRange"),w.weekNumbers&&1===w.config.showMonths&&"prevMonthDay"!==e&&a%7==6&&w.weekNumbers.insertAdjacentHTML("beforeend","<span class='flatpickr-day'>"+w.config.getWeek(n)+"</span>"),De("onDayCreate",o),o}function W(e){e.focus(),"range"===w.config.mode&&oe(e)}function B(e){for(var n=e>0?0:w.config.showMonths-1,t=e>0?w.config.showMonths:-1,a=n;a!=t;a+=e)for(var i=w.daysContainer.children[a],o=e>0?0:i.children.length-1,r=e>0?i.children.length:-1,l=o;l!=r;l+=e){var c=i.children[l];if(-1===c.className.indexOf("hidden")&&ne(c.dateObj))return c}}function J(e,n){var t=k(),a=te(t||document.body),i=void 0!==e?e:a?t:void 0!==w.selectedDateElem&&te(w.selectedDateElem)?w.selectedDateElem:void 0!==w.todayDateElem&&te(w.todayDateElem)?w.todayDateElem:B(n>0?1:-1);void 0===i?w._input.focus():a?function(e,n){for(var t=-1===e.className.indexOf("Month")?e.dateObj.getMonth():w.currentMonth,a=n>0?w.config.showMonths:-1,i=n>0?1:-1,o=t-w.currentMonth;o!=a;o+=i)for(var r=w.daysContainer.children[o],l=t-w.currentMonth===o?e.$i+n:n<0?r.children.length-1:0,c=r.children.length,s=l;s>=0&&s<c&&s!=(n>0?c:-1);s+=i){var d=r.children[s];if(-1===d.className.indexOf("hidden")&&ne(d.dateObj)&&Math.abs(e.$i-s)>=Math.abs(n))return W(d)}w.changeMonth(i),J(B(i),0)}(i,n):W(i)}function K(e,n){for(var t=(new Date(e,n,1).getDay()-w.l10n.firstDayOfWeek+7)%7,a=w.utils.getDaysInMonth((n-1+12)%12,e),i=w.utils.getDaysInMonth(n,e),o=window.document.createDocumentFragment(),r=w.config.showMonths>1,l=r?"prevMonthDay hidden":"prevMonthDay",c=r?"nextMonthDay hidden":"nextMonthDay",s=a+1-t,u=0;s<=a;s++,u++)o.appendChild(R("flatpickr-day "+l,new Date(e,n-1,s),0,u));for(s=1;s<=i;s++,u++)o.appendChild(R("flatpickr-day",new Date(e,n,s),0,u));for(var f=i+1;f<=42-t&&(1===w.config.showMonths||u%7!=0);f++,u++)o.appendChild(R("flatpickr-day "+c,new Date(e,n+1,f%i),0,u));var m=d("div","dayContainer");return m.appendChild(o),m}function U(){if(void 0!==w.daysContainer){u(w.daysContainer),w.weekNumbers&&u(w.weekNumbers);for(var e=document.createDocumentFragment(),n=0;n<w.config.showMonths;n++){var t=new Date(w.currentYear,w.currentMonth,1);t.setMonth(w.currentMonth+n),e.appendChild(K(t.getFullYear(),t.getMonth()))}w.daysContainer.appendChild(e),w.days=w.daysContainer.firstChild,"range"===w.config.mode&&1===w.selectedDates.length&&oe()}}function q(){if(!(w.config.showMonths>1||"dropdown"!==w.config.monthSelectorType)){var e=function(e){return!(void 0!==w.config.minDate&&w.currentYear===w.config.minDate.getFullYear()&&e<w.config.minDate.getMonth())&&!(void 0!==w.config.maxDate&&w.currentYear===w.config.maxDate.getFullYear()&&e>w.config.maxDate.getMonth())};w.monthsDropdownContainer.tabIndex=-1,w.monthsDropdownContainer.innerHTML="";for(var n=0;n<12;n++)if(e(n)){var t=d("option","flatpickr-monthDropdown-month");t.value=new Date(w.currentYear,n).getMonth().toString(),t.textContent=h(n,w.config.shorthandCurrentMonth,w.l10n),t.tabIndex=-1,w.currentMonth===n&&(t.selected=!0),w.monthsDropdownContainer.appendChild(t)}}}function $(){var e,n=d("div","flatpickr-month"),t=window.document.createDocumentFragment();w.config.showMonths>1||"static"===w.config.monthSelectorType?e=d("span","cur-month"):(w.monthsDropdownContainer=d("select","flatpickr-monthDropdown-months"),w.monthsDropdownContainer.setAttribute("aria-label",w.l10n.monthAriaLabel),P(w.monthsDropdownContainer,"change",(function(e){var n=g(e),t=parseInt(n.value,10);w.changeMonth(t-w.currentMonth),De("onMonthChange")})),q(),e=w.monthsDropdownContainer);var a=m("cur-year",{tabindex:"-1"}),i=a.getElementsByTagName("input")[0];i.setAttribute("aria-label",w.l10n.yearAriaLabel),w.config.minDate&&i.setAttribute("min",w.config.minDate.getFullYear().toString()),w.config.maxDate&&(i.setAttribute("max",w.config.maxDate.getFullYear().toString()),i.disabled=!!w.config.minDate&&w.config.minDate.getFullYear()===w.config.maxDate.getFullYear());var o=d("div","flatpickr-current-month");return o.appendChild(e),o.appendChild(a),t.appendChild(o),n.appendChild(t),{container:n,yearElement:i,monthElement:e}}function V(){u(w.monthNav),w.monthNav.appendChild(w.prevMonthNav),w.config.showMonths&&(w.yearElements=[],w.monthElements=[]);for(var e=w.config.showMonths;e--;){var n=$();w.yearElements.push(n.yearElement),w.monthElements.push(n.monthElement),w.monthNav.appendChild(n.container)}w.monthNav.appendChild(w.nextMonthNav)}function z(){w.weekdayContainer?u(w.weekdayContainer):w.weekdayContainer=d("div","flatpickr-weekdays");for(var e=w.config.showMonths;e--;){var n=d("div","flatpickr-weekdaycontainer");w.weekdayContainer.appendChild(n)}return G(),w.weekdayContainer}function G(){if(w.weekdayContainer){var e=w.l10n.firstDayOfWeek,t=n(w.l10n.weekdays.shorthand);e>0&&e<t.length&&(t=n(t.splice(e,t.length),t.splice(0,e)));for(var a=w.config.showMonths;a--;)w.weekdayContainer.children[a].innerHTML="\n      <span class='flatpickr-weekday'>\n        "+t.join("</span><span class='flatpickr-weekday'>")+"\n      </span>\n      "}}function Z(e,n){void 0===n&&(n=!0);var t=n?e:e-w.currentMonth;t<0&&!0===w._hidePrevMonthArrow||t>0&&!0===w._hideNextMonthArrow||(w.currentMonth+=t,(w.currentMonth<0||w.currentMonth>11)&&(w.currentYear+=w.currentMonth>11?1:-1,w.currentMonth=(w.currentMonth+12)%12,De("onYearChange"),q()),U(),De("onMonthChange"),Ce())}function Q(e){return w.calendarContainer.contains(e)}function X(e){if(w.isOpen&&!w.config.inline){var n=g(e),t=Q(n),a=!(n===w.input||n===w.altInput||w.element.contains(n)||e.path&&e.path.indexOf&&(~e.path.indexOf(w.input)||~e.path.indexOf(w.altInput)))&&!t&&!Q(e.relatedTarget),i=!w.config.ignoredFocusElements.some((function(e){return e.contains(n)}));a&&i&&(w.config.allowInput&&w.setDate(w._input.value,!1,w.config.altInput?w.config.altFormat:w.config.dateFormat),void 0!==w.timeContainer&&void 0!==w.minuteElement&&void 0!==w.hourElement&&""!==w.input.value&&void 0!==w.input.value&&_(),w.close(),w.config&&"range"===w.config.mode&&1===w.selectedDates.length&&w.clear(!1))}}function ee(e){if(!(!e||w.config.minDate&&e<w.config.minDate.getFullYear()||w.config.maxDate&&e>w.config.maxDate.getFullYear())){var n=e,t=w.currentYear!==n;w.currentYear=n||w.currentYear,w.config.maxDate&&w.currentYear===w.config.maxDate.getFullYear()?w.currentMonth=Math.min(w.config.maxDate.getMonth(),w.currentMonth):w.config.minDate&&w.currentYear===w.config.minDate.getFullYear()&&(w.currentMonth=Math.max(w.config.minDate.getMonth(),w.currentMonth)),t&&(w.redraw(),De("onYearChange"),q())}}function ne(e,n){var t;void 0===n&&(n=!0);var a=w.parseDate(e,void 0,n);if(w.config.minDate&&a&&M(a,w.config.minDate,void 0!==n?n:!w.minDateHasTime)<0||w.config.maxDate&&a&&M(a,w.config.maxDate,void 0!==n?n:!w.maxDateHasTime)>0)return!1;if(!w.config.enable&&0===w.config.disable.length)return!0;if(void 0===a)return!1;for(var i=!!w.config.enable,o=null!==(t=w.config.enable)&&void 0!==t?t:w.config.disable,r=0,l=void 0;r<o.length;r++){if("function"==typeof(l=o[r])&&l(a))return i;if(l instanceof Date&&void 0!==a&&l.getTime()===a.getTime())return i;if("string"==typeof l){var c=w.parseDate(l,void 0,!0);return c&&c.getTime()===a.getTime()?i:!i}if("object"==typeof l&&void 0!==a&&l.from&&l.to&&a.getTime()>=l.from.getTime()&&a.getTime()<=l.to.getTime())return i}return!i}function te(e){return void 0!==w.daysContainer&&(-1===e.className.indexOf("hidden")&&-1===e.className.indexOf("flatpickr-disabled")&&w.daysContainer.contains(e))}function ae(e){var n=e.target===w._input,t=w._input.value.trimEnd()!==Me();!n||!t||e.relatedTarget&&Q(e.relatedTarget)||w.setDate(w._input.value,!0,e.target===w.altInput?w.config.altFormat:w.config.dateFormat)}function ie(e){var n=g(e),t=w.config.wrap?p.contains(n):n===w._input,a=w.config.allowInput,i=w.isOpen&&(!a||!t),o=w.config.inline&&t&&!a;if(13===e.keyCode&&t){if(a)return w.setDate(w._input.value,!0,n===w.altInput?w.config.altFormat:w.config.dateFormat),w.close(),n.blur();w.open()}else if(Q(n)||i||o){var r=!!w.timeContainer&&w.timeContainer.contains(n);switch(e.keyCode){case 13:r?(e.preventDefault(),_(),fe()):me(e);break;case 27:e.preventDefault(),fe();break;case 8:case 46:t&&!w.config.allowInput&&(e.preventDefault(),w.clear());break;case 37:case 39:if(r||t)w.hourElement&&w.hourElement.focus();else{e.preventDefault();var l=k();if(void 0!==w.daysContainer&&(!1===a||l&&te(l))){var c=39===e.keyCode?1:-1;e.ctrlKey?(e.stopPropagation(),Z(c),J(B(1),0)):J(void 0,c)}}break;case 38:case 40:e.preventDefault();var s=40===e.keyCode?1:-1;w.daysContainer&&void 0!==n.$i||n===w.input||n===w.altInput?e.ctrlKey?(e.stopPropagation(),ee(w.currentYear-s),J(B(1),0)):r||J(void 0,7*s):n===w.currentYearElement?ee(w.currentYear-s):w.config.enableTime&&(!r&&w.hourElement&&w.hourElement.focus(),_(e),w._debouncedChange());break;case 9:if(r){var d=[w.hourElement,w.minuteElement,w.secondElement,w.amPM].concat(w.pluginElements).filter((function(e){return e})),u=d.indexOf(n);if(-1!==u){var f=d[u+(e.shiftKey?-1:1)];e.preventDefault(),(f||w._input).focus()}}else!w.config.noCalendar&&w.daysContainer&&w.daysContainer.contains(n)&&e.shiftKey&&(e.preventDefault(),w._input.focus())}}if(void 0!==w.amPM&&n===w.amPM)switch(e.key){case w.l10n.amPM[0].charAt(0):case w.l10n.amPM[0].charAt(0).toLowerCase():w.amPM.textContent=w.l10n.amPM[0],O(),ye();break;case w.l10n.amPM[1].charAt(0):case w.l10n.amPM[1].charAt(0).toLowerCase():w.amPM.textContent=w.l10n.amPM[1],O(),ye()}(t||Q(n))&&De("onKeyDown",e)}function oe(e,n){if(void 0===n&&(n="flatpickr-day"),1===w.selectedDates.length&&(!e||e.classList.contains(n)&&!e.classList.contains("flatpickr-disabled"))){for(var t=e?e.dateObj.getTime():w.days.firstElementChild.dateObj.getTime(),a=w.parseDate(w.selectedDates[0],void 0,!0).getTime(),i=Math.min(t,w.selectedDates[0].getTime()),o=Math.max(t,w.selectedDates[0].getTime()),r=!1,l=0,c=0,s=i;s<o;s+=x)ne(new Date(s),!0)||(r=r||s>i&&s<o,s<a&&(!l||s>l)?l=s:s>a&&(!c||s<c)&&(c=s));Array.from(w.rContainer.querySelectorAll("*:nth-child(-n+"+w.config.showMonths+") > ."+n)).forEach((function(n){var i,o,s,d=n.dateObj.getTime(),u=l>0&&d<l||c>0&&d>c;if(u)return n.classList.add("notAllowed"),void["inRange","startRange","endRange"].forEach((function(e){n.classList.remove(e)}));r&&!u||(["startRange","inRange","endRange","notAllowed"].forEach((function(e){n.classList.remove(e)})),void 0!==e&&(e.classList.add(t<=w.selectedDates[0].getTime()?"startRange":"endRange"),a<t&&d===a?n.classList.add("startRange"):a>t&&d===a&&n.classList.add("endRange"),d>=l&&(0===c||d<=c)&&(o=a,s=t,(i=d)>Math.min(o,s)&&i<Math.max(o,s))&&n.classList.add("inRange")))}))}}function re(){!w.isOpen||w.config.static||w.config.inline||de()}function le(e){return function(n){var t=w.config["_"+e+"Date"]=w.parseDate(n,w.config.dateFormat),a=w.config["_"+("min"===e?"max":"min")+"Date"];void 0!==t&&(w["min"===e?"minDateHasTime":"maxDateHasTime"]=t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0),w.selectedDates&&(w.selectedDates=w.selectedDates.filter((function(e){return ne(e)})),w.selectedDates.length||"min"!==e||F(t),ye()),w.daysContainer&&(ue(),void 0!==t?w.currentYearElement[e]=t.getFullYear().toString():w.currentYearElement.removeAttribute(e),w.currentYearElement.disabled=!!a&&void 0!==t&&a.getFullYear()===t.getFullYear())}}function ce(){return w.config.wrap?p.querySelector("[data-input]"):p}function se(){"object"!=typeof w.config.locale&&void 0===I.l10ns[w.config.locale]&&w.config.errorHandler(new Error("flatpickr: invalid locale "+w.config.locale)),w.l10n=e(e({},I.l10ns.default),"object"==typeof w.config.locale?w.config.locale:"default"!==w.config.locale?I.l10ns[w.config.locale]:void 0),D.D="("+w.l10n.weekdays.shorthand.join("|")+")",D.l="("+w.l10n.weekdays.longhand.join("|")+")",D.M="("+w.l10n.months.shorthand.join("|")+")",D.F="("+w.l10n.months.longhand.join("|")+")",D.K="("+w.l10n.amPM[0]+"|"+w.l10n.amPM[1]+"|"+w.l10n.amPM[0].toLowerCase()+"|"+w.l10n.amPM[1].toLowerCase()+")",void 0===e(e({},v),JSON.parse(JSON.stringify(p.dataset||{}))).time_24hr&&void 0===I.defaultConfig.time_24hr&&(w.config.time_24hr=w.l10n.time_24hr),w.formatDate=b(w),w.parseDate=C({config:w.config,l10n:w.l10n})}function de(e){if("function"!=typeof w.config.position){if(void 0!==w.calendarContainer){De("onPreCalendarPosition");var n=e||w._positionElement,t=Array.prototype.reduce.call(w.calendarContainer.children,(function(e,n){return e+n.offsetHeight}),0),a=w.calendarContainer.offsetWidth,i=w.config.position.split(" "),o=i[0],r=i.length>1?i[1]:null,l=n.getBoundingClientRect(),c=window.innerHeight-l.bottom,d="above"===o||"below"!==o&&c<t&&l.top>t,u=window.pageYOffset+l.top+(d?-t-2:n.offsetHeight+2);if(s(w.calendarContainer,"arrowTop",!d),s(w.calendarContainer,"arrowBottom",d),!w.config.inline){var f=window.pageXOffset+l.left,m=!1,g=!1;"center"===r?(f-=(a-l.width)/2,m=!0):"right"===r&&(f-=a-l.width,g=!0),s(w.calendarContainer,"arrowLeft",!m&&!g),s(w.calendarContainer,"arrowCenter",m),s(w.calendarContainer,"arrowRight",g);var p=window.document.body.offsetWidth-(window.pageXOffset+l.right),h=f+a>window.document.body.offsetWidth,v=p+a>window.document.body.offsetWidth;if(s(w.calendarContainer,"rightMost",h),!w.config.static)if(w.calendarContainer.style.top=u+"px",h)if(v){var D=function(){for(var e=null,n=0;n<document.styleSheets.length;n++){var t=document.styleSheets[n];if(t.cssRules){try{t.cssRules}catch(e){continue}e=t;break}}return null!=e?e:(a=document.createElement("style"),document.head.appendChild(a),a.sheet);var a}();if(void 0===D)return;var b=window.document.body.offsetWidth,C=Math.max(0,b/2-a/2),M=D.cssRules.length,y="{left:"+l.left+"px;right:auto;}";s(w.calendarContainer,"rightMost",!1),s(w.calendarContainer,"centerMost",!0),D.insertRule(".flatpickr-calendar.centerMost:before,.flatpickr-calendar.centerMost:after"+y,M),w.calendarContainer.style.left=C+"px",w.calendarContainer.style.right="auto"}else w.calendarContainer.style.left="auto",w.calendarContainer.style.right=p+"px";else w.calendarContainer.style.left=f+"px",w.calendarContainer.style.right="auto"}}}else w.config.position(w,e)}function ue(){w.config.noCalendar||w.isMobile||(q(),Ce(),U())}function fe(){w._input.focus(),-1!==window.navigator.userAgent.indexOf("MSIE")||void 0!==navigator.msMaxTouchPoints?setTimeout(w.close,0):w.close()}function me(e){e.preventDefault(),e.stopPropagation();var n=f(g(e),(function(e){return e.classList&&e.classList.contains("flatpickr-day")&&!e.classList.contains("flatpickr-disabled")&&!e.classList.contains("notAllowed")}));if(void 0!==n){var t=n,a=w.latestSelectedDateObj=new Date(t.dateObj.getTime()),i=(a.getMonth()<w.currentMonth||a.getMonth()>w.currentMonth+w.config.showMonths-1)&&"range"!==w.config.mode;if(w.selectedDateElem=t,"single"===w.config.mode)w.selectedDates=[a];else if("multiple"===w.config.mode){var o=be(a);o?w.selectedDates.splice(parseInt(o),1):w.selectedDates.push(a)}else"range"===w.config.mode&&(2===w.selectedDates.length&&w.clear(!1,!1),w.latestSelectedDateObj=a,w.selectedDates.push(a),0!==M(a,w.selectedDates[0],!0)&&w.selectedDates.sort((function(e,n){return e.getTime()-n.getTime()})));if(O(),i){var r=w.currentYear!==a.getFullYear();w.currentYear=a.getFullYear(),w.currentMonth=a.getMonth(),r&&(De("onYearChange"),q()),De("onMonthChange")}if(Ce(),U(),ye(),i||"range"===w.config.mode||1!==w.config.showMonths?void 0!==w.selectedDateElem&&void 0===w.hourElement&&w.selectedDateElem&&w.selectedDateElem.focus():W(t),void 0!==w.hourElement&&void 0!==w.hourElement&&w.hourElement.focus(),w.config.closeOnSelect){var l="single"===w.config.mode&&!w.config.enableTime,c="range"===w.config.mode&&2===w.selectedDates.length&&!w.config.enableTime;(l||c)&&fe()}Y()}}w.parseDate=C({config:w.config,l10n:w.l10n}),w._handlers=[],w.pluginElements=[],w.loadedPlugins=[],w._bind=P,w._setHoursFromDate=F,w._positionCalendar=de,w.changeMonth=Z,w.changeYear=ee,w.clear=function(e,n){void 0===e&&(e=!0);void 0===n&&(n=!0);w.input.value="",void 0!==w.altInput&&(w.altInput.value="");void 0!==w.mobileInput&&(w.mobileInput.value="");w.selectedDates=[],w.latestSelectedDateObj=void 0,!0===n&&(w.currentYear=w._initialDate.getFullYear(),w.currentMonth=w._initialDate.getMonth());if(!0===w.config.enableTime){var t=E(w.config),a=t.hours,i=t.minutes,o=t.seconds;A(a,i,o)}w.redraw(),e&&De("onChange")},w.close=function(){w.isOpen=!1,w.isMobile||(void 0!==w.calendarContainer&&w.calendarContainer.classList.remove("open"),void 0!==w._input&&w._input.classList.remove("active"));De("onClose")},w.onMouseOver=oe,w._createElement=d,w.createDay=R,w.destroy=function(){void 0!==w.config&&De("onDestroy");for(var e=w._handlers.length;e--;)w._handlers[e].remove();if(w._handlers=[],w.mobileInput)w.mobileInput.parentNode&&w.mobileInput.parentNode.removeChild(w.mobileInput),w.mobileInput=void 0;else if(w.calendarContainer&&w.calendarContainer.parentNode)if(w.config.static&&w.calendarContainer.parentNode){var n=w.calendarContainer.parentNode;if(n.lastChild&&n.removeChild(n.lastChild),n.parentNode){for(;n.firstChild;)n.parentNode.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}}else w.calendarContainer.parentNode.removeChild(w.calendarContainer);w.altInput&&(w.input.type="text",w.altInput.parentNode&&w.altInput.parentNode.removeChild(w.altInput),delete w.altInput);w.input&&(w.input.type=w.input._type,w.input.classList.remove("flatpickr-input"),w.input.removeAttribute("readonly"));["_showTimeInput","latestSelectedDateObj","_hideNextMonthArrow","_hidePrevMonthArrow","__hideNextMonthArrow","__hidePrevMonthArrow","isMobile","isOpen","selectedDateElem","minDateHasTime","maxDateHasTime","days","daysContainer","_input","_positionElement","innerContainer","rContainer","monthNav","todayDateElem","calendarContainer","weekdayContainer","prevMonthNav","nextMonthNav","monthsDropdownContainer","currentMonthElement","currentYearElement","navigationCurrentMonth","selectedDateElem","config"].forEach((function(e){try{delete w[e]}catch(e){}}))},w.isEnabled=ne,w.jumpToDate=j,w.updateValue=ye,w.open=function(e,n){void 0===n&&(n=w._positionElement);if(!0===w.isMobile){if(e){e.preventDefault();var t=g(e);t&&t.blur()}return void 0!==w.mobileInput&&(w.mobileInput.focus(),w.mobileInput.click()),void De("onOpen")}if(w._input.disabled||w.config.inline)return;var a=w.isOpen;w.isOpen=!0,a||(w.calendarContainer.classList.add("open"),w._input.classList.add("active"),De("onOpen"),de(n));!0===w.config.enableTime&&!0===w.config.noCalendar&&(!1!==w.config.allowInput||void 0!==e&&w.timeContainer.contains(e.relatedTarget)||setTimeout((function(){return w.hourElement.select()}),50))},w.redraw=ue,w.set=function(e,n){if(null!==e&&"object"==typeof e)for(var a in Object.assign(w.config,e),e)void 0!==ge[a]&&ge[a].forEach((function(e){return e()}));else w.config[e]=n,void 0!==ge[e]?ge[e].forEach((function(e){return e()})):t.indexOf(e)>-1&&(w.config[e]=c(n));w.redraw(),ye(!0)},w.setDate=function(e,n,t){void 0===n&&(n=!1);void 0===t&&(t=w.config.dateFormat);if(0!==e&&!e||e instanceof Array&&0===e.length)return w.clear(n);pe(e,t),w.latestSelectedDateObj=w.selectedDates[w.selectedDates.length-1],w.redraw(),j(void 0,n),F(),0===w.selectedDates.length&&w.clear(!1);ye(n),n&&De("onChange")},w.toggle=function(e){if(!0===w.isOpen)return w.close();w.open(e)};var ge={locale:[se,G],showMonths:[V,S,z],minDate:[j],maxDate:[j],positionElement:[ve],clickOpens:[function(){!0===w.config.clickOpens?(P(w._input,"focus",w.open),P(w._input,"click",w.open)):(w._input.removeEventListener("focus",w.open),w._input.removeEventListener("click",w.open))}]};function pe(e,n){var t=[];if(e instanceof Array)t=e.map((function(e){return w.parseDate(e,n)}));else if(e instanceof Date||"number"==typeof e)t=[w.parseDate(e,n)];else if("string"==typeof e)switch(w.config.mode){case"single":case"time":t=[w.parseDate(e,n)];break;case"multiple":t=e.split(w.config.conjunction).map((function(e){return w.parseDate(e,n)}));break;case"range":t=e.split(w.l10n.rangeSeparator).map((function(e){return w.parseDate(e,n)}))}else w.config.errorHandler(new Error("Invalid date supplied: "+JSON.stringify(e)));w.selectedDates=w.config.allowInvalidPreload?t:t.filter((function(e){return e instanceof Date&&ne(e,!1)})),"range"===w.config.mode&&w.selectedDates.sort((function(e,n){return e.getTime()-n.getTime()}))}function he(e){return e.slice().map((function(e){return"string"==typeof e||"number"==typeof e||e instanceof Date?w.parseDate(e,void 0,!0):e&&"object"==typeof e&&e.from&&e.to?{from:w.parseDate(e.from,void 0),to:w.parseDate(e.to,void 0)}:e})).filter((function(e){return e}))}function ve(){w._positionElement=w.config.positionElement||w._input}function De(e,n){if(void 0!==w.config){var t=w.config[e];if(void 0!==t&&t.length>0)for(var a=0;t[a]&&a<t.length;a++)t[a](w.selectedDates,w.input.value,w,n);"onChange"===e&&(w.input.dispatchEvent(we("change")),w.input.dispatchEvent(we("input")))}}function we(e){var n=document.createEvent("Event");return n.initEvent(e,!0,!0),n}function be(e){for(var n=0;n<w.selectedDates.length;n++){var t=w.selectedDates[n];if(t instanceof Date&&0===M(t,e))return""+n}return!1}function Ce(){w.config.noCalendar||w.isMobile||!w.monthNav||(w.yearElements.forEach((function(e,n){var t=new Date(w.currentYear,w.currentMonth,1);t.setMonth(w.currentMonth+n),w.config.showMonths>1||"static"===w.config.monthSelectorType?w.monthElements[n].textContent=h(t.getMonth(),w.config.shorthandCurrentMonth,w.l10n)+" ":w.monthsDropdownContainer.value=t.getMonth().toString(),e.value=t.getFullYear().toString()})),w._hidePrevMonthArrow=void 0!==w.config.minDate&&(w.currentYear===w.config.minDate.getFullYear()?w.currentMonth<=w.config.minDate.getMonth():w.currentYear<w.config.minDate.getFullYear()),w._hideNextMonthArrow=void 0!==w.config.maxDate&&(w.currentYear===w.config.maxDate.getFullYear()?w.currentMonth+1>w.config.maxDate.getMonth():w.currentYear>w.config.maxDate.getFullYear()))}function Me(e){var n=e||(w.config.altInput?w.config.altFormat:w.config.dateFormat);return w.selectedDates.map((function(e){return w.formatDate(e,n)})).filter((function(e,n,t){return"range"!==w.config.mode||w.config.enableTime||t.indexOf(e)===n})).join("range"!==w.config.mode?w.config.conjunction:w.l10n.rangeSeparator)}function ye(e){void 0===e&&(e=!0),void 0!==w.mobileInput&&w.mobileFormatStr&&(w.mobileInput.value=void 0!==w.latestSelectedDateObj?w.formatDate(w.latestSelectedDateObj,w.mobileFormatStr):""),w.input.value=Me(w.config.dateFormat),void 0!==w.altInput&&(w.altInput.value=Me(w.config.altFormat)),!1!==e&&De("onValueUpdate")}function xe(e){var n=g(e),t=w.prevMonthNav.contains(n),a=w.nextMonthNav.contains(n);t||a?Z(t?-1:1):w.yearElements.indexOf(n)>=0?n.select():n.classList.contains("arrowUp")?w.changeYear(w.currentYear+1):n.classList.contains("arrowDown")&&w.changeYear(w.currentYear-1)}return function(){w.element=w.input=p,w.isOpen=!1,function(){var n=["wrap","weekNumbers","allowInput","allowInvalidPreload","clickOpens","time_24hr","enableTime","noCalendar","altInput","shorthandCurrentMonth","inline","static","enableSeconds","disableMobile"],i=e(e({},JSON.parse(JSON.stringify(p.dataset||{}))),v),o={};w.config.parseDate=i.parseDate,w.config.formatDate=i.formatDate,Object.defineProperty(w.config,"enable",{get:function(){return w.config._enable},set:function(e){w.config._enable=he(e)}}),Object.defineProperty(w.config,"disable",{get:function(){return w.config._disable},set:function(e){w.config._disable=he(e)}});var r="time"===i.mode;if(!i.dateFormat&&(i.enableTime||r)){var l=I.defaultConfig.dateFormat||a.dateFormat;o.dateFormat=i.noCalendar||r?"H:i"+(i.enableSeconds?":S":""):l+" H:i"+(i.enableSeconds?":S":"")}if(i.altInput&&(i.enableTime||r)&&!i.altFormat){var s=I.defaultConfig.altFormat||a.altFormat;o.altFormat=i.noCalendar||r?"h:i"+(i.enableSeconds?":S K":" K"):s+" h:i"+(i.enableSeconds?":S":"")+" K"}Object.defineProperty(w.config,"minDate",{get:function(){return w.config._minDate},set:le("min")}),Object.defineProperty(w.config,"maxDate",{get:function(){return w.config._maxDate},set:le("max")});var d=function(e){return function(n){w.config["min"===e?"_minTime":"_maxTime"]=w.parseDate(n,"H:i:S")}};Object.defineProperty(w.config,"minTime",{get:function(){return w.config._minTime},set:d("min")}),Object.defineProperty(w.config,"maxTime",{get:function(){return w.config._maxTime},set:d("max")}),"time"===i.mode&&(w.config.noCalendar=!0,w.config.enableTime=!0);Object.assign(w.config,o,i);for(var u=0;u<n.length;u++)w.config[n[u]]=!0===w.config[n[u]]||"true"===w.config[n[u]];t.filter((function(e){return void 0!==w.config[e]})).forEach((function(e){w.config[e]=c(w.config[e]||[]).map(T)})),w.isMobile=!w.config.disableMobile&&!w.config.inline&&"single"===w.config.mode&&!w.config.disable.length&&!w.config.enable&&!w.config.weekNumbers&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);for(u=0;u<w.config.plugins.length;u++){var f=w.config.plugins[u](w)||{};for(var m in f)t.indexOf(m)>-1?w.config[m]=c(f[m]).map(T).concat(w.config[m]):void 0===i[m]&&(w.config[m]=f[m])}i.altInputClass||(w.config.altInputClass=ce().className+" "+w.config.altInputClass);De("onParseConfig")}(),se(),function(){if(w.input=ce(),!w.input)return void w.config.errorHandler(new Error("Invalid input element specified"));w.input._type=w.input.type,w.input.type="text",w.input.classList.add("flatpickr-input"),w._input=w.input,w.config.altInput&&(w.altInput=d(w.input.nodeName,w.config.altInputClass),w._input=w.altInput,w.altInput.placeholder=w.input.placeholder,w.altInput.disabled=w.input.disabled,w.altInput.required=w.input.required,w.altInput.tabIndex=w.input.tabIndex,w.altInput.type="text",w.input.setAttribute("type","hidden"),!w.config.static&&w.input.parentNode&&w.input.parentNode.insertBefore(w.altInput,w.input.nextSibling));w.config.allowInput||w._input.setAttribute("readonly","readonly");ve()}(),function(){w.selectedDates=[],w.now=w.parseDate(w.config.now)||new Date;var e=w.config.defaultDate||("INPUT"!==w.input.nodeName&&"TEXTAREA"!==w.input.nodeName||!w.input.placeholder||w.input.value!==w.input.placeholder?w.input.value:null);e&&pe(e,w.config.dateFormat);w._initialDate=w.selectedDates.length>0?w.selectedDates[0]:w.config.minDate&&w.config.minDate.getTime()>w.now.getTime()?w.config.minDate:w.config.maxDate&&w.config.maxDate.getTime()<w.now.getTime()?w.config.maxDate:w.now,w.currentYear=w._initialDate.getFullYear(),w.currentMonth=w._initialDate.getMonth(),w.selectedDates.length>0&&(w.latestSelectedDateObj=w.selectedDates[0]);void 0!==w.config.minTime&&(w.config.minTime=w.parseDate(w.config.minTime,"H:i"));void 0!==w.config.maxTime&&(w.config.maxTime=w.parseDate(w.config.maxTime,"H:i"));w.minDateHasTime=!!w.config.minDate&&(w.config.minDate.getHours()>0||w.config.minDate.getMinutes()>0||w.config.minDate.getSeconds()>0),w.maxDateHasTime=!!w.config.maxDate&&(w.config.maxDate.getHours()>0||w.config.maxDate.getMinutes()>0||w.config.maxDate.getSeconds()>0)}(),w.utils={getDaysInMonth:function(e,n){return void 0===e&&(e=w.currentMonth),void 0===n&&(n=w.currentYear),1===e&&(n%4==0&&n%100!=0||n%400==0)?29:w.l10n.daysInMonth[e]}},w.isMobile||function(){var e=window.document.createDocumentFragment();if(w.calendarContainer=d("div","flatpickr-calendar"),w.calendarContainer.tabIndex=-1,!w.config.noCalendar){if(e.appendChild((w.monthNav=d("div","flatpickr-months"),w.yearElements=[],w.monthElements=[],w.prevMonthNav=d("span","flatpickr-prev-month"),w.prevMonthNav.innerHTML=w.config.prevArrow,w.nextMonthNav=d("span","flatpickr-next-month"),w.nextMonthNav.innerHTML=w.config.nextArrow,V(),Object.defineProperty(w,"_hidePrevMonthArrow",{get:function(){return w.__hidePrevMonthArrow},set:function(e){w.__hidePrevMonthArrow!==e&&(s(w.prevMonthNav,"flatpickr-disabled",e),w.__hidePrevMonthArrow=e)}}),Object.defineProperty(w,"_hideNextMonthArrow",{get:function(){return w.__hideNextMonthArrow},set:function(e){w.__hideNextMonthArrow!==e&&(s(w.nextMonthNav,"flatpickr-disabled",e),w.__hideNextMonthArrow=e)}}),w.currentYearElement=w.yearElements[0],Ce(),w.monthNav)),w.innerContainer=d("div","flatpickr-innerContainer"),w.config.weekNumbers){var n=function(){w.calendarContainer.classList.add("hasWeeks");var e=d("div","flatpickr-weekwrapper");e.appendChild(d("span","flatpickr-weekday",w.l10n.weekAbbreviation));var n=d("div","flatpickr-weeks");return e.appendChild(n),{weekWrapper:e,weekNumbers:n}}(),t=n.weekWrapper,a=n.weekNumbers;w.innerContainer.appendChild(t),w.weekNumbers=a,w.weekWrapper=t}w.rContainer=d("div","flatpickr-rContainer"),w.rContainer.appendChild(z()),w.daysContainer||(w.daysContainer=d("div","flatpickr-days"),w.daysContainer.tabIndex=-1),U(),w.rContainer.appendChild(w.daysContainer),w.innerContainer.appendChild(w.rContainer),e.appendChild(w.innerContainer)}w.config.enableTime&&e.appendChild(function(){w.calendarContainer.classList.add("hasTime"),w.config.noCalendar&&w.calendarContainer.classList.add("noCalendar");var e=E(w.config);w.timeContainer=d("div","flatpickr-time"),w.timeContainer.tabIndex=-1;var n=d("span","flatpickr-time-separator",":"),t=m("flatpickr-hour",{"aria-label":w.l10n.hourAriaLabel});w.hourElement=t.getElementsByTagName("input")[0];var a=m("flatpickr-minute",{"aria-label":w.l10n.minuteAriaLabel});w.minuteElement=a.getElementsByTagName("input")[0],w.hourElement.tabIndex=w.minuteElement.tabIndex=-1,w.hourElement.value=o(w.latestSelectedDateObj?w.latestSelectedDateObj.getHours():w.config.time_24hr?e.hours:function(e){switch(e%24){case 0:case 12:return 12;default:return e%12}}(e.hours)),w.minuteElement.value=o(w.latestSelectedDateObj?w.latestSelectedDateObj.getMinutes():e.minutes),w.hourElement.setAttribute("step",w.config.hourIncrement.toString()),w.minuteElement.setAttribute("step",w.config.minuteIncrement.toString()),w.hourElement.setAttribute("min",w.config.time_24hr?"0":"1"),w.hourElement.setAttribute("max",w.config.time_24hr?"23":"12"),w.hourElement.setAttribute("maxlength","2"),w.minuteElement.setAttribute("min","0"),w.minuteElement.setAttribute("max","59"),w.minuteElement.setAttribute("maxlength","2"),w.timeContainer.appendChild(t),w.timeContainer.appendChild(n),w.timeContainer.appendChild(a),w.config.time_24hr&&w.timeContainer.classList.add("time24hr");if(w.config.enableSeconds){w.timeContainer.classList.add("hasSeconds");var i=m("flatpickr-second");w.secondElement=i.getElementsByTagName("input")[0],w.secondElement.value=o(w.latestSelectedDateObj?w.latestSelectedDateObj.getSeconds():e.seconds),w.secondElement.setAttribute("step",w.minuteElement.getAttribute("step")),w.secondElement.setAttribute("min","0"),w.secondElement.setAttribute("max","59"),w.secondElement.setAttribute("maxlength","2"),w.timeContainer.appendChild(d("span","flatpickr-time-separator",":")),w.timeContainer.appendChild(i)}w.config.time_24hr||(w.amPM=d("span","flatpickr-am-pm",w.l10n.amPM[r((w.latestSelectedDateObj?w.hourElement.value:w.config.defaultHour)>11)]),w.amPM.title=w.l10n.toggleTitle,w.amPM.tabIndex=-1,w.timeContainer.appendChild(w.amPM));return w.timeContainer}());s(w.calendarContainer,"rangeMode","range"===w.config.mode),s(w.calendarContainer,"animate",!0===w.config.animate),s(w.calendarContainer,"multiMonth",w.config.showMonths>1),w.calendarContainer.appendChild(e);var i=void 0!==w.config.appendTo&&void 0!==w.config.appendTo.nodeType;if((w.config.inline||w.config.static)&&(w.calendarContainer.classList.add(w.config.inline?"inline":"static"),w.config.inline&&(!i&&w.element.parentNode?w.element.parentNode.insertBefore(w.calendarContainer,w._input.nextSibling):void 0!==w.config.appendTo&&w.config.appendTo.appendChild(w.calendarContainer)),w.config.static)){var l=d("div","flatpickr-wrapper");w.element.parentNode&&w.element.parentNode.insertBefore(l,w.element),l.appendChild(w.element),w.altInput&&l.appendChild(w.altInput),l.appendChild(w.calendarContainer)}w.config.static||w.config.inline||(void 0!==w.config.appendTo?w.config.appendTo:window.document.body).appendChild(w.calendarContainer)}(),function(){w.config.wrap&&["open","close","toggle","clear"].forEach((function(e){Array.prototype.forEach.call(w.element.querySelectorAll("[data-"+e+"]"),(function(n){return P(n,"click",w[e])}))}));if(w.isMobile)return void function(){var e=w.config.enableTime?w.config.noCalendar?"time":"datetime-local":"date";w.mobileInput=d("input",w.input.className+" flatpickr-mobile"),w.mobileInput.tabIndex=1,w.mobileInput.type=e,w.mobileInput.disabled=w.input.disabled,w.mobileInput.required=w.input.required,w.mobileInput.placeholder=w.input.placeholder,w.mobileFormatStr="datetime-local"===e?"Y-m-d\\TH:i:S":"date"===e?"Y-m-d":"H:i:S",w.selectedDates.length>0&&(w.mobileInput.defaultValue=w.mobileInput.value=w.formatDate(w.selectedDates[0],w.mobileFormatStr));w.config.minDate&&(w.mobileInput.min=w.formatDate(w.config.minDate,"Y-m-d"));w.config.maxDate&&(w.mobileInput.max=w.formatDate(w.config.maxDate,"Y-m-d"));w.input.getAttribute("step")&&(w.mobileInput.step=String(w.input.getAttribute("step")));w.input.type="hidden",void 0!==w.altInput&&(w.altInput.type="hidden");try{w.input.parentNode&&w.input.parentNode.insertBefore(w.mobileInput,w.input.nextSibling)}catch(e){}P(w.mobileInput,"change",(function(e){w.setDate(g(e).value,!1,w.mobileFormatStr),De("onChange"),De("onClose")}))}();var e=l(re,50);w._debouncedChange=l(Y,300),w.daysContainer&&!/iPhone|iPad|iPod/i.test(navigator.userAgent)&&P(w.daysContainer,"mouseover",(function(e){"range"===w.config.mode&&oe(g(e))}));P(w._input,"keydown",ie),void 0!==w.calendarContainer&&P(w.calendarContainer,"keydown",ie);w.config.inline||w.config.static||P(window,"resize",e);void 0!==window.ontouchstart?P(window.document,"touchstart",X):P(window.document,"mousedown",X);P(window.document,"focus",X,{capture:!0}),!0===w.config.clickOpens&&(P(w._input,"focus",w.open),P(w._input,"click",w.open));void 0!==w.daysContainer&&(P(w.monthNav,"click",xe),P(w.monthNav,["keyup","increment"],N),P(w.daysContainer,"click",me));if(void 0!==w.timeContainer&&void 0!==w.minuteElement&&void 0!==w.hourElement){var n=function(e){return g(e).select()};P(w.timeContainer,["increment"],_),P(w.timeContainer,"blur",_,{capture:!0}),P(w.timeContainer,"click",H),P([w.hourElement,w.minuteElement],["focus","click"],n),void 0!==w.secondElement&&P(w.secondElement,"focus",(function(){return w.secondElement&&w.secondElement.select()})),void 0!==w.amPM&&P(w.amPM,"click",(function(e){_(e)}))}w.config.allowInput&&P(w._input,"blur",ae)}(),(w.selectedDates.length||w.config.noCalendar)&&(w.config.enableTime&&F(w.config.noCalendar?w.latestSelectedDateObj:void 0),ye(!1)),S();var n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);!w.isMobile&&n&&de(),De("onReady")}(),w}function T(e,n){for(var t=Array.prototype.slice.call(e).filter((function(e){return e instanceof HTMLElement})),a=[],i=0;i<t.length;i++){var o=t[i];try{if(null!==o.getAttribute("data-fp-omit"))continue;void 0!==o._flatpickr&&(o._flatpickr.destroy(),o._flatpickr=void 0),o._flatpickr=k(o,n||{}),a.push(o._flatpickr)}catch(e){console.error(e)}}return 1===a.length?a[0]:a}"undefined"!=typeof HTMLElement&&"undefined"!=typeof HTMLCollection&&"undefined"!=typeof NodeList&&(HTMLCollection.prototype.flatpickr=NodeList.prototype.flatpickr=function(e){return T(this,e)},HTMLElement.prototype.flatpickr=function(e){return T([this],e)});var I=function(e,n){return"string"==typeof e?T(window.document.querySelectorAll(e),n):e instanceof Node?T([e],n):T(e,n)};return I.defaultConfig={},I.l10ns={en:e({},i),default:e({},i)},I.localize=function(n){I.l10ns.default=e(e({},I.l10ns.default),n)},I.setDefaults=function(n){I.defaultConfig=e(e({},I.defaultConfig),n)},I.parseDate=C({}),I.formatDate=b({}),I.compareDates=M,"undefined"!=typeof jQuery&&void 0!==jQuery.fn&&(jQuery.fn.flatpickr=function(e){return T(this,e)}),Date.prototype.fp_incr=function(e){return new Date(this.getFullYear(),this.getMonth(),this.getDate()+("string"==typeof e?parseInt(e,10):e))},"undefined"!=typeof window&&(window.flatpickr=I),I}));/* @license
Papa Parse
v5.4.1
https://github.com/mholt/PapaParse
License: MIT
*/
!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof module&&"undefined"!=typeof exports?module.exports=t():e.Papa=t()}(this,function s(){"use strict";var f="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==f?f:{};var n=!f.document&&!!f.postMessage,o=f.IS_PAPA_WORKER||!1,a={},u=0,b={parse:function(e,t){var r=(t=t||{}).dynamicTyping||!1;J(r)&&(t.dynamicTypingFunction=r,r={});if(t.dynamicTyping=r,t.transform=!!J(t.transform)&&t.transform,t.worker&&b.WORKERS_SUPPORTED){var i=function(){if(!b.WORKERS_SUPPORTED)return!1;var e=(r=f.URL||f.webkitURL||null,i=s.toString(),b.BLOB_URL||(b.BLOB_URL=r.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",i,")();"],{type:"text/javascript"})))),t=new f.Worker(e);var r,i;return t.onmessage=_,t.id=u++,a[t.id]=t}();return i.userStep=t.step,i.userChunk=t.chunk,i.userComplete=t.complete,i.userError=t.error,t.step=J(t.step),t.chunk=J(t.chunk),t.complete=J(t.complete),t.error=J(t.error),delete t.worker,void i.postMessage({input:e,config:t,workerId:i.id})}var n=null;b.NODE_STREAM_INPUT,"string"==typeof e?(e=function(e){if(65279===e.charCodeAt(0))return e.slice(1);return e}(e),n=t.download?new l(t):new p(t)):!0===e.readable&&J(e.read)&&J(e.on)?n=new g(t):(f.File&&e instanceof File||e instanceof Object)&&(n=new c(t));return n.stream(e)},unparse:function(e,t){var n=!1,_=!0,m=",",y="\r\n",s='"',a=s+s,r=!1,i=null,o=!1;!function(){if("object"!=typeof t)return;"string"!=typeof t.delimiter||b.BAD_DELIMITERS.filter(function(e){return-1!==t.delimiter.indexOf(e)}).length||(m=t.delimiter);("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(n=t.quotes);"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(r=t.skipEmptyLines);"string"==typeof t.newline&&(y=t.newline);"string"==typeof t.quoteChar&&(s=t.quoteChar);"boolean"==typeof t.header&&(_=t.header);if(Array.isArray(t.columns)){if(0===t.columns.length)throw new Error("Option columns is empty");i=t.columns}void 0!==t.escapeChar&&(a=t.escapeChar+s);("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(o=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}();var u=new RegExp(Q(s),"g");"string"==typeof e&&(e=JSON.parse(e));if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return h(null,e,r);if("object"==typeof e[0])return h(i||Object.keys(e[0]),e,r)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||i),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),h(e.fields||[],e.data||[],r);throw new Error("Unable to serialize unrecognized input");function h(e,t,r){var i="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var n=Array.isArray(e)&&0<e.length,s=!Array.isArray(t[0]);if(n&&_){for(var a=0;a<e.length;a++)0<a&&(i+=m),i+=v(e[a],a);0<t.length&&(i+=y)}for(var o=0;o<t.length;o++){var u=n?e.length:t[o].length,h=!1,f=n?0===Object.keys(t[o]).length:0===t[o].length;if(r&&!n&&(h="greedy"===r?""===t[o].join("").trim():1===t[o].length&&0===t[o][0].length),"greedy"===r&&n){for(var d=[],l=0;l<u;l++){var c=s?e[l]:l;d.push(t[o][c])}h=""===d.join("").trim()}if(!h){for(var p=0;p<u;p++){0<p&&!f&&(i+=m);var g=n&&s?e[p]:p;i+=v(t[o][g],p)}o<t.length-1&&(!r||0<u&&!f)&&(i+=y)}}return i}function v(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var r=!1;o&&"string"==typeof e&&o.test(e)&&(e="'"+e,r=!0);var i=e.toString().replace(u,a);return(r=r||!0===n||"function"==typeof n&&n(e,t)||Array.isArray(n)&&n[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(i,b.BAD_DELIMITERS)||-1<i.indexOf(m)||" "===i.charAt(0)||" "===i.charAt(i.length-1))?s+i+s:i}}};if(b.RECORD_SEP=String.fromCharCode(30),b.UNIT_SEP=String.fromCharCode(31),b.BYTE_ORDER_MARK="\ufeff",b.BAD_DELIMITERS=["\r","\n",'"',b.BYTE_ORDER_MARK],b.WORKERS_SUPPORTED=!n&&!!f.Worker,b.NODE_STREAM_INPUT=1,b.LocalChunkSize=10485760,b.RemoteChunkSize=5242880,b.DefaultDelimiter=",",b.Parser=E,b.ParserHandle=r,b.NetworkStreamer=l,b.FileStreamer=c,b.StringStreamer=p,b.ReadableStreamStreamer=g,f.jQuery){var d=f.jQuery;d.fn.parse=function(o){var r=o.config||{},u=[];return this.each(function(e){if(!("INPUT"===d(this).prop("tagName").toUpperCase()&&"file"===d(this).attr("type").toLowerCase()&&f.FileReader)||!this.files||0===this.files.length)return!0;for(var t=0;t<this.files.length;t++)u.push({file:this.files[t],inputElem:this,instanceConfig:d.extend({},r)})}),e(),this;function e(){if(0!==u.length){var e,t,r,i,n=u[0];if(J(o.before)){var s=o.before(n.file,n.inputElem);if("object"==typeof s){if("abort"===s.action)return e="AbortError",t=n.file,r=n.inputElem,i=s.reason,void(J(o.error)&&o.error({name:e},t,r,i));if("skip"===s.action)return void h();"object"==typeof s.config&&(n.instanceConfig=d.extend(n.instanceConfig,s.config))}else if("skip"===s)return void h()}var a=n.instanceConfig.complete;n.instanceConfig.complete=function(e){J(a)&&a(e,n.file,n.inputElem),h()},b.parse(n.file,n.instanceConfig)}else J(o.complete)&&o.complete()}function h(){u.splice(0,1),e()}}}function h(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=w(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null);this._handle=new r(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&J(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);void 0!==r&&(e=r)}this.isFirstChunk=!1,this._halted=!1;var i=this._partialLine+e;this._partialLine="";var n=this._handle.parse(i,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var s=n.meta.cursor;this._finished||(this._partialLine=i.substring(s-this._baseIndex),this._baseIndex=s),n&&n.data&&(this._rowCount+=n.data.length);var a=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)f.postMessage({results:n,workerId:b.WORKER_ID,finished:a});else if(J(this._config.chunk)&&!t){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!a||!J(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),a||n&&n.meta.paused||this._nextChunk(),n}this._halted=!0},this._sendError=function(e){J(this._config.error)?this._config.error(e):o&&this._config.error&&f.postMessage({workerId:b.WORKER_ID,error:e,finished:!1})}}function l(e){var i;(e=e||{}).chunkSize||(e.chunkSize=b.RemoteChunkSize),h.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(i=new XMLHttpRequest,this._config.withCredentials&&(i.withCredentials=this._config.withCredentials),n||(i.onload=v(this._chunkLoaded,this),i.onerror=v(this._chunkError,this)),i.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var t in e)i.setRequestHeader(t,e[t])}if(this._config.chunkSize){var r=this._start+this._config.chunkSize-1;i.setRequestHeader("Range","bytes="+this._start+"-"+r)}try{i.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}n&&0===i.status&&this._chunkError()}},this._chunkLoaded=function(){4===i.readyState&&(i.status<200||400<=i.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:i.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(e){var t=e.getResponseHeader("Content-Range");if(null===t)return-1;return parseInt(t.substring(t.lastIndexOf("/")+1))}(i),this.parseChunk(i.responseText)))},this._chunkError=function(e){var t=i.statusText||e;this._sendError(new Error(t))}}function c(e){var i,n;(e=e||{}).chunkSize||(e.chunkSize=b.LocalChunkSize),h.call(this,e);var s="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,n=e.slice||e.webkitSlice||e.mozSlice,s?((i=new FileReader).onload=v(this._chunkLoaded,this),i.onerror=v(this._chunkError,this)):i=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var t=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,t)}var r=i.readAsText(e,this._config.encoding);s||this._chunkLoaded({target:{result:r}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(i.error)}}function p(e){var r;h.call(this,e=e||{}),this.stream=function(e){return r=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,t=this._config.chunkSize;return t?(e=r.substring(0,t),r=r.substring(t)):(e=r,r=""),this._finished=!r,this.parseChunk(e)}}}function g(e){h.call(this,e=e||{});var t=[],r=!0,i=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){i&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=v(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=v(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=v(function(){this._streamCleanUp(),i=!0,this._streamData("")},this),this._streamCleanUp=v(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function r(m){var a,o,u,i=Math.pow(2,53),n=-i,s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,h=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,t=this,r=0,f=0,d=!1,e=!1,l=[],c={data:[],errors:[],meta:{}};if(J(m.step)){var p=m.step;m.step=function(e){if(c=e,_())g();else{if(g(),0===c.data.length)return;r+=e.data.length,m.preview&&r>m.preview?o.abort():(c.data=c.data[0],p(c,t))}}}function y(e){return"greedy"===m.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function g(){return c&&u&&(k("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+b.DefaultDelimiter+"'"),u=!1),m.skipEmptyLines&&(c.data=c.data.filter(function(e){return!y(e)})),_()&&function(){if(!c)return;function e(e,t){J(m.transformHeader)&&(e=m.transformHeader(e,t)),l.push(e)}if(Array.isArray(c.data[0])){for(var t=0;_()&&t<c.data.length;t++)c.data[t].forEach(e);c.data.splice(0,1)}else c.data.forEach(e)}(),function(){if(!c||!m.header&&!m.dynamicTyping&&!m.transform)return c;function e(e,t){var r,i=m.header?{}:[];for(r=0;r<e.length;r++){var n=r,s=e[r];m.header&&(n=r>=l.length?"__parsed_extra":l[r]),m.transform&&(s=m.transform(s,n)),s=v(n,s),"__parsed_extra"===n?(i[n]=i[n]||[],i[n].push(s)):i[n]=s}return m.header&&(r>l.length?k("FieldMismatch","TooManyFields","Too many fields: expected "+l.length+" fields but parsed "+r,f+t):r<l.length&&k("FieldMismatch","TooFewFields","Too few fields: expected "+l.length+" fields but parsed "+r,f+t)),i}var t=1;!c.data.length||Array.isArray(c.data[0])?(c.data=c.data.map(e),t=c.data.length):c.data=e(c.data,0);m.header&&c.meta&&(c.meta.fields=l);return f+=t,c}()}function _(){return m.header&&0===l.length}function v(e,t){return r=e,m.dynamicTypingFunction&&void 0===m.dynamicTyping[r]&&(m.dynamicTyping[r]=m.dynamicTypingFunction(r)),!0===(m.dynamicTyping[r]||m.dynamicTyping)?"true"===t||"TRUE"===t||"false"!==t&&"FALSE"!==t&&(function(e){if(s.test(e)){var t=parseFloat(e);if(n<t&&t<i)return!0}return!1}(t)?parseFloat(t):h.test(t)?new Date(t):""===t?null:t):t;var r}function k(e,t,r,i){var n={type:e,code:t,message:r};void 0!==i&&(n.row=i),c.errors.push(n)}this.parse=function(e,t,r){var i=m.quoteChar||'"';if(m.newline||(m.newline=function(e,t){e=e.substring(0,1048576);var r=new RegExp(Q(t)+"([^]*?)"+Q(t),"gm"),i=(e=e.replace(r,"")).split("\r"),n=e.split("\n"),s=1<n.length&&n[0].length<i[0].length;if(1===i.length||s)return"\n";for(var a=0,o=0;o<i.length;o++)"\n"===i[o][0]&&a++;return a>=i.length/2?"\r\n":"\r"}(e,i)),u=!1,m.delimiter)J(m.delimiter)&&(m.delimiter=m.delimiter(e),c.meta.delimiter=m.delimiter);else{var n=function(e,t,r,i,n){var s,a,o,u;n=n||[",","\t","|",";",b.RECORD_SEP,b.UNIT_SEP];for(var h=0;h<n.length;h++){var f=n[h],d=0,l=0,c=0;o=void 0;for(var p=new E({comments:i,delimiter:f,newline:t,preview:10}).parse(e),g=0;g<p.data.length;g++)if(r&&y(p.data[g]))c++;else{var _=p.data[g].length;l+=_,void 0!==o?0<_&&(d+=Math.abs(_-o),o=_):o=_}0<p.data.length&&(l/=p.data.length-c),(void 0===a||d<=a)&&(void 0===u||u<l)&&1.99<l&&(a=d,s=f,u=l)}return{successful:!!(m.delimiter=s),bestDelimiter:s}}(e,m.newline,m.skipEmptyLines,m.comments,m.delimitersToGuess);n.successful?m.delimiter=n.bestDelimiter:(u=!0,m.delimiter=b.DefaultDelimiter),c.meta.delimiter=m.delimiter}var s=w(m);return m.preview&&m.header&&s.preview++,a=e,o=new E(s),c=o.parse(a,t,r),g(),d?{meta:{paused:!0}}:c||{meta:{paused:!1}}},this.paused=function(){return d},this.pause=function(){d=!0,o.abort(),a=J(m.chunk)?"":a.substring(o.getCharIndex())},this.resume=function(){t.streamer._halted?(d=!1,t.streamer.parseChunk(a,!0)):setTimeout(t.resume,3)},this.aborted=function(){return e},this.abort=function(){e=!0,o.abort(),c.meta.aborted=!0,J(m.complete)&&m.complete(c),a=""}}function Q(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function E(j){var z,M=(j=j||{}).delimiter,P=j.newline,U=j.comments,q=j.step,N=j.preview,B=j.fastMode,K=z=void 0===j.quoteChar||null===j.quoteChar?'"':j.quoteChar;if(void 0!==j.escapeChar&&(K=j.escapeChar),("string"!=typeof M||-1<b.BAD_DELIMITERS.indexOf(M))&&(M=","),U===M)throw new Error("Comment character same as delimiter");!0===U?U="#":("string"!=typeof U||-1<b.BAD_DELIMITERS.indexOf(U))&&(U=!1),"\n"!==P&&"\r"!==P&&"\r\n"!==P&&(P="\n");var W=0,H=!1;this.parse=function(i,t,r){if("string"!=typeof i)throw new Error("Input must be a string");var n=i.length,e=M.length,s=P.length,a=U.length,o=J(q),u=[],h=[],f=[],d=W=0;if(!i)return L();if(j.header&&!t){var l=i.split(P)[0].split(M),c=[],p={},g=!1;for(var _ in l){var m=l[_];J(j.transformHeader)&&(m=j.transformHeader(m,_));var y=m,v=p[m]||0;for(0<v&&(g=!0,y=m+"_"+v),p[m]=v+1;c.includes(y);)y=y+"_"+v;c.push(y)}if(g){var k=i.split(P);k[0]=c.join(M),i=k.join(P)}}if(B||!1!==B&&-1===i.indexOf(z)){for(var b=i.split(P),E=0;E<b.length;E++){if(f=b[E],W+=f.length,E!==b.length-1)W+=P.length;else if(r)return L();if(!U||f.substring(0,a)!==U){if(o){if(u=[],I(f.split(M)),F(),H)return L()}else I(f.split(M));if(N&&N<=E)return u=u.slice(0,N),L(!0)}}return L()}for(var w=i.indexOf(M,W),R=i.indexOf(P,W),C=new RegExp(Q(K)+Q(z),"g"),S=i.indexOf(z,W);;)if(i[W]!==z)if(U&&0===f.length&&i.substring(W,W+a)===U){if(-1===R)return L();W=R+s,R=i.indexOf(P,W),w=i.indexOf(M,W)}else if(-1!==w&&(w<R||-1===R))f.push(i.substring(W,w)),W=w+e,w=i.indexOf(M,W);else{if(-1===R)break;if(f.push(i.substring(W,R)),D(R+s),o&&(F(),H))return L();if(N&&u.length>=N)return L(!0)}else for(S=W,W++;;){if(-1===(S=i.indexOf(z,S+1)))return r||h.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:u.length,index:W}),T();if(S===n-1)return T(i.substring(W,S).replace(C,z));if(z!==K||i[S+1]!==K){if(z===K||0===S||i[S-1]!==K){-1!==w&&w<S+1&&(w=i.indexOf(M,S+1)),-1!==R&&R<S+1&&(R=i.indexOf(P,S+1));var O=A(-1===R?w:Math.min(w,R));if(i.substr(S+1+O,e)===M){f.push(i.substring(W,S).replace(C,z)),i[W=S+1+O+e]!==z&&(S=i.indexOf(z,W)),w=i.indexOf(M,W),R=i.indexOf(P,W);break}var x=A(R);if(i.substring(S+1+x,S+1+x+s)===P){if(f.push(i.substring(W,S).replace(C,z)),D(S+1+x+s),w=i.indexOf(M,W),S=i.indexOf(z,W),o&&(F(),H))return L();if(N&&u.length>=N)return L(!0);break}h.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:u.length,index:W}),S++}}else S++}return T();function I(e){u.push(e),d=W}function A(e){var t=0;if(-1!==e){var r=i.substring(S+1,e);r&&""===r.trim()&&(t=r.length)}return t}function T(e){return r||(void 0===e&&(e=i.substring(W)),f.push(e),W=n,I(f),o&&F()),L()}function D(e){W=e,I(f),f=[],R=i.indexOf(P,W)}function L(e){return{data:u,errors:h,meta:{delimiter:M,linebreak:P,aborted:H,truncated:!!e,cursor:d+(t||0)}}}function F(){q(L()),u=[],h=[]}},this.abort=function(){H=!0},this.getCharIndex=function(){return W}}function _(e){var t=e.data,r=a[t.workerId],i=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var n={abort:function(){i=!0,m(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(J(r.userStep)){for(var s=0;s<t.results.data.length&&(r.userStep({data:t.results.data[s],errors:t.results.errors,meta:t.results.meta},n),!i);s++);delete t.results}else J(r.userChunk)&&(r.userChunk(t.results,n,t.file),delete t.results)}t.finished&&!i&&m(t.workerId,t.results)}function m(e,t){var r=a[e];J(r.userComplete)&&r.userComplete(t),r.terminate(),delete a[e]}function y(){throw new Error("Not implemented.")}function w(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=w(e[r]);return t}function v(e,t){return function(){e.apply(t,arguments)}}function J(e){return"function"==typeof e}return o&&(f.onmessage=function(e){var t=e.data;void 0===b.WORKER_ID&&t&&(b.WORKER_ID=t.workerId);if("string"==typeof t.input)f.postMessage({workerId:b.WORKER_ID,results:b.parse(t.input,t.config),finished:!0});else if(f.File&&t.input instanceof File||t.input instanceof Object){var r=b.parse(t.input,t.config);r&&f.postMessage({workerId:b.WORKER_ID,results:r,finished:!0})}}),(l.prototype=Object.create(h.prototype)).constructor=l,(c.prototype=Object.create(h.prototype)).constructor=c,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(h.prototype)).constructor=g,b});//Copyright (c) 2016 Mikhail Neofitov

window.multiselects=[];document.multiselect=function(selector){var res=[];if(!window.multiselects._items){window.multiselects._items=[];}
m_helper.each(document.querySelectorAll(selector),function(e){var index=window.multiselects._items.indexOf(e);if(index==-1){var inputItem=new Multiselect(e);window.multiselects.push(inputItem);window.multiselects._items.push(e);res.push(inputItem)}else{res.push(window.multiselects[index]);}});return res.length==1?res[0]:res;}
window.onclick=function(event){hideMultiselects(event);};function hideMultiselects(event){m_helper.each(window.multiselects,function(e){if(document.getElementById(e._getItemListIdentifier()).offsetParent&&!m_helper.parent(event.target,e._getIdentifier())){e._hideList(e,event);}});}
function Multiselect(item,opts){if(item.tagName!='SELECT'){throw"Multiselect: passed object must be a select";}
if(!item.hasAttribute('multiple')){throw"Multiselect: passed object should contain 'multiple' attribute";}
this._item=item;this._createUI();this._appendEvents();this._initSelectedFields();this._initIsEnabled();}
Multiselect.prototype={_createUI:function(){m_helper.removeNode(this._getIdentifier());var wrapper=this._createWrapper();m_helper.insertAfter(wrapper,this._item);wrapper.appendChild(this._createInputField());wrapper.appendChild(this._createItemList());m_helper.hide(this._item);},_createWrapper:function(){var result=document.createElement('div');result.className='multiselect-wrapper';result.id=this._getIdentifier();return result;},_createInputField:function(){var input=m_helper.textField({id:this._getInputFieldIdentifier(),class:'multiselect-input',attributes:{autocomplete:'off'}}),label=m_helper.label({id:this._getInputBadgeIdentifier(),class:'multiselect-count',attributes:{for:this._getInputFieldIdentifier()}}),dropDownArrow=m_helper.label({class:'multiselect-dropdown-arrow',attributes:{for:this._getInputFieldIdentifier()}}),result=m_helper.div({class:'multiselect-input-div'});label.style.visibility='hidden';label.innerHTML=0;result.appendChild(input);result.appendChild(label);result.appendChild(dropDownArrow);return result;},_createItemList:function(){var list=m_helper.create({tag:'ul'});var self=this;m_helper.each(this._getItems(this._item),function(e){var insertItem=self._createItem('li',e.id,e.text,e.selected);list.appendChild(insertItem);var checkBox=insertItem.querySelector('input[type=checkbox]');e.multiselectElement=checkBox;checkBox.dataset.multiselectElement=JSON.stringify(e);});var selectAll=this._createItem('span',-1,'Select all');var result=m_helper.div({id:this._getItemListIdentifier(),class:'multiselect-list'});result.appendChild(selectAll);result.appendChild(m_helper.create({tag:'hr'}));result.appendChild(list);return result;},_createItem:function(wrapper,value,text,selected){var checkBox=m_helper.checkbox({class:'multiselect-checkbox',data:{val:value}}),textBox=m_helper.create({tag:'span',class:'multiselect-text'}),result=m_helper.create({tag:wrapper}),label=m_helper.label();textBox.className='multiselect-text';textBox.innerHTML=text;label.appendChild(checkBox);label.appendChild(textBox);result.appendChild(label);return result;},_initSelectedFields:function(){var itemResult=this._getItems().filter(function(obj){return obj.selected;});if(itemResult.length!=0){var self=this;m_helper.each(itemResult,function(e){self.select(e.id);});}
this._hideList(this);},_initIsEnabled:function(){this.setIsEnabled(!this._item.disabled)},destroy(){m_helper.removeNode(this._getIdentifier());m_helper.show(this._item);var index=window.multiselects._items.indexOf(this._item);if(index>-1){window.multiselects._items.splice(index,1);window.multiselects.splice(index,1);}},select:function(val){this._toggle(val,true);},deselect:function(val){this._toggle(val,false);},setIsEnabled(isEnabled){if(this._isEnabled===isEnabled)return;var wrapperItem=document.getElementById(this._getIdentifier());if(isEnabled){wrapperItem.classList.remove('disabled');}else{wrapperItem.classList.add('disabled');}
m_helper.setDisabled(this._item,!isEnabled);m_helper.setDisabled(document.getElementById(this._getInputFieldIdentifier()),!isEnabled);this._isEnabled=isEnabled;},_toggle:function(val,setCheck){var self=this;if(val){m_helper.each(document.getElementById(this._getIdentifier()).querySelectorAll('.multiselect-checkbox'),function(e){if(e.dataset.val==val){if(setCheck&&!e.checked){m_helper.check(e);self._onCheckBoxChange(e,self);}else if(!setCheck&&e.checked){m_helper.uncheck(e);self._onCheckBoxChange(e,self);}}});self._updateText(self);}},selectAll:function(val){var selectAllChkBox=document.querySelector('#'+this._getIdentifier()+' .multiselect-checkbox');m_helper.check(selectAllChkBox);this._onCheckBoxChange(selectAllChkBox,this);this._updateText(this);},deselectAll:function(){var selectAllChkBox=document.querySelector('#'+this._getIdentifier()+' .multiselect-checkbox');m_helper.uncheck(selectAllChkBox);this._onCheckBoxChange(selectAllChkBox,this);this._updateText(this);},_checkboxClickEvents:{},setCheckBoxClick(id,handler){if(typeof handler==="function"){this._checkboxClickEvents[id]=handler;}else{console.error("Checkbox click handler for checkbox value="+id+" is not a function");}
return this;},_appendEvents:function(){var self=this;document.getElementById(self._getInputFieldIdentifier()).addEventListener('focus',function(event){self._showList(self);document.getElementById(self._getInputFieldIdentifier()).value='';m_helper.each(window.multiselects,function(e){if(document.getElementById(e._getItemListIdentifier()).offsetParent&&m_helper.parent(event.target,e._getIdentifier())){e._hideList(self);}});});document.getElementById(self._getInputFieldIdentifier()).addEventListener('click',function(){self._showList(self);document.getElementById(self._getInputFieldIdentifier()).value='';});document.getElementById(self._getIdentifier()).addEventListener('click',function(event){event=event||window.event;var target=event.target||event.srcElement;if(m_helper.parent(target,self._getIdentifier())){event.stopPropagation();}});document.getElementById(self._getItemListIdentifier()).addEventListener('mouseover',function(){self._showList(self);});m_helper.each(document.getElementById(self._getIdentifier()).querySelectorAll('.multiselect-checkbox'),function(e){e.addEventListener('change',function(event){self._onCheckBoxChange(e,self,event);});});var onInput=function(){var text=this.value.toLowerCase();if(!text||text==''){m_helper.show(document.querySelector('#'+self._getItemListIdentifier()+' > span'));m_helper.show(document.querySelector('#'+self._getItemListIdentifier()+' > hr'));m_helper.showAll(document.querySelectorAll('#'+self._getItemListIdentifier()+' li'));}else{m_helper.hide(document.querySelector('#'+self._getItemListIdentifier()+' > span'));m_helper.hide(document.querySelector('#'+self._getItemListIdentifier()+' > hr'));var array=Array.prototype.filter.call(document.querySelectorAll('#'+self._getItemListIdentifier()+' li span'),function(obj){return obj.innerHTML.toLowerCase().indexOf(text)>-1;});m_helper.hideAll(document.querySelectorAll('#'+self._getItemListIdentifier()+' li'));m_helper.each(array,function(e){m_helper.show(e.parentElement.parentElement);});}}
document.getElementById(self._getInputFieldIdentifier()).addEventListener('propertychange',onInput);document.getElementById(self._getInputFieldIdentifier()).addEventListener('input',onInput);},_onCheckBoxChange:function(checkbox,self,event){if(!checkbox.dataset.multiselectElement){var checkedState=self._performSelectAll(checkbox,self);if(typeof self._checkboxClickEvents["checkboxAll"]==="function"){self._checkboxClickEvents["checkboxAll"](checkbox,{checked:checkedState});}}
else{var checkedState=self._performSelectItem(checkbox,self);if(typeof self._checkboxClickEvents[checkedState.id]==="function"){self._checkboxClickEvents[checkedState.id](checkbox,checkedState);}
self._updateSelectAll(self);}
self._forceUpdate();},_performSelectItem:function(checkbox,self){var item=JSON.parse(checkbox.dataset.multiselectElement);if(checkbox.checked){self._itemCounter++;m_helper.select(this._item.options[item.index]);m_helper.setActive(checkbox.parentElement.parentElement);return{id:item.id,checked:true};}
self._itemCounter--;m_helper.deselect(this._item.options[item.index]);m_helper.setUnactive(checkbox.parentElement.parentElement);return{id:item.id,checked:false};},_performSelectAll:function(checkbox,self){var items=self._getItems();if(checkbox.checked){self._itemCounter=items.length;m_helper.each(items,function(e){m_helper.setActive(e.multiselectElement.parentElement.parentElement);m_helper.select(self._item.options[e.index]);m_helper.check(e.multiselectElement);});return true;}
self._itemCounter=0;m_helper.each(items,function(e){e.multiselectElement.parentElement.parentElement.classList.remove('active');m_helper.deselect(self._item.options[e.index]);m_helper.uncheck(e.multiselectElement);});return false;},_updateSelectAll:function(self){var allChkBox=document.getElementById(self._getItemListIdentifier()).querySelector('input[type=checkbox]');if(self._itemCounter==self._getItems().length){allChkBox.checked=true;}
else if(allChkBox.checked){allChkBox.checked=false;}},_hideList:function(context,event){m_helper.setUnactive(document.getElementById(context._getItemListIdentifier()));m_helper.show(document.getElementById(context._getItemListIdentifier()).querySelector('span'));m_helper.show(document.getElementById(context._getItemListIdentifier()).querySelector('hr'));m_helper.showAll(document.getElementById(context._getItemListIdentifier()).querySelectorAll('li'));context._updateText(context);if(event)
event.stopPropagation();},_updateText:function(context){var activeItems=document.getElementById(context._getItemListIdentifier()).querySelectorAll('ul .active');if(activeItems.length>0){var val='';for(var i=0;i<(activeItems.length<5?activeItems.length:5);i++){val+=activeItems[i].innerText+", ";}
val=val.substr(0,val.length-2);if(val.length>20){val=val.substr(0,17)+'...';}}
if(activeItems.length==document.getElementById(context._getItemListIdentifier()).querySelectorAll('ul li').length){val='All selected';}
document.getElementById(context._getInputFieldIdentifier()).value=val?val:'';},_showList:function(context){m_helper.setActive(document.getElementById(context._getItemListIdentifier()));},_forceUpdate:function(){var badge=document.getElementById(this._getInputBadgeIdentifier());badge.style.visibility='hidden';if(this._itemCounter!=0){badge.innerHTML=this._itemCounter;badge.style.visibility='visible';var ddArrow=badge.nextElementSibling;if(this._itemCounter<10){badge.style.left='-45px';ddArrow.style.marginLeft='-42px';}
else if(this._itemCounter<100){badge.style.left='-50px';ddArrow.style.marginLeft='-47px';}
else if(this._itemCounter<1000){badge.style.left='-55px';ddArrow.style.marginLeft='-52px';}
else if(this._itemCounter<10000){badge.style.left='-60px';ddArrow.style.marginLeft='-57px';}}},_items:undefined,_itemCounter:0,_isEnabled:true,_getItems:function(){if(this._items==undefined){var result=[];var opts=this._item.options;for(var i=0;i<opts.length;i++){var insertItem={id:opts[i].value,index:i,text:opts[i].innerHTML,selected:!!opts[i].selected,selectElement:opts[i]};result.push(insertItem);}
this._items=result;}
return this._items;},_getItemUniqueIdentifier:function(){var id=this._item.getAttribute('id'),name=this._item.getAttribute('name');if(!(id||name)){throw"Multiselect: object does not contain any identifier (id or name)";}
return id?id:name;},_getIdentifier:function(){return this._getItemUniqueIdentifier()+'_multiSelect';},_getInputFieldIdentifier:function(){return this._getItemUniqueIdentifier()+'_input';},_getItemListIdentifier:function(){return this._getItemUniqueIdentifier()+'_itemList';},_getInputBadgeIdentifier:function(){return this._getItemUniqueIdentifier()+'_inputCount';}}
if(!m_helper)
{var m_helper={removeNode:function(id){var el=document.getElementById(id);if(el){el.parentNode.removeChild(el);}},insertAfter:function(item,target){var parent=target.parentNode;if(target.nextElementSibling){parent.insertBefore(item,target.nextElementSibling);}else{parent.appendChild(item);}},hide:function(element){element.style.display='none';},hideAll:function(array){for(var i=0;i<array.length;i++){this.hide(array[i]);}},show:function(element){element.style.display='block';},showAll:function(array){for(var i=0;i<array.length;i++){this.show(array[i]);}},parent:function(element,id){var parent=element.parentElement;while(parent&&parent.tagName!='BODY'){if(parent.id==id){return parent;}
parent=parent.parentElement;}
return null;},create:function(data){var result=document.createElement(data.tag);if(data.id){result.id=data.id;}
if(data.class){result.className=data.class;}
if(data.attributes){for(var prop in data.attributes){result.setAttribute(prop,data.attributes[prop]);}}
if(data.data){for(var prop in data.data){result.dataset[prop]=data.data[prop];}}
return result;},div:function(data){if(!data){data=new Object();}
data.tag='div';return this.create(data);},label:function(data){if(!data){data=new Object();}
data.tag='label';return this.create(data);},textField:function(data){if(!data){data=new Object();}
data.tag='input';if(!data.attributes)
data.attributes=new Object();data.attributes.type='text';return this.create(data);},checkbox:function(data){if(!data){data=new Object();}
data.tag='input';if(!data.attributes)
data.attributes=new Object();data.attributes.type='checkbox';return this.create(data);},each:function(array,handler){for(var i=0;i<array.length;i++){handler(array[i]);}},setActive:function(element){element.classList.add('active');},setUnactive:function(element){element.classList.remove('active');},select:function(element){element.selected=true;element.setAttribute('selected','selected');},deselect:function(element){element.selected=false;element.removeAttribute('selected');},check:function(element){element.checked=true;},uncheck:function(element){element.checked=false;},click:function(element){if(element.fireEvent){el.fireEvent('onclick');}else{var evObj=document.createEvent('Events');evObj.initEvent('click',true,false);element.dispatchEvent(evObj);}},setDisabled:function(element,value){element.disabled=value;},};}/*
 (c) 2011-2015, Vladimir Agafonkin
 SunCalc is a JavaScript library for calculating sun/moon position and light phases.
 https://github.com/mourner/suncalc
*/

(function(){'use strict';var PI=Math.PI,sin=Math.sin,cos=Math.cos,tan=Math.tan,asin=Math.asin,atan=Math.atan2,acos=Math.acos,rad=PI/180;var dayMs=1000*60*60*24,J1970=2440588,J2000=2451545;function toJulian(date){return date.valueOf()/dayMs-0.5+J1970;}
function fromJulian(j){return new Date((j+0.5-J1970)*dayMs);}
function toDays(date){return toJulian(date)-J2000;}
var e=rad*23.4397;function rightAscension(l,b){return atan(sin(l)*cos(e)-tan(b)*sin(e),cos(l));}
function declination(l,b){return asin(sin(b)*cos(e)+cos(b)*sin(e)*sin(l));}
function azimuth(H,phi,dec){return atan(sin(H),cos(H)*sin(phi)-tan(dec)*cos(phi));}
function altitude(H,phi,dec){return asin(sin(phi)*sin(dec)+cos(phi)*cos(dec)*cos(H));}
function siderealTime(d,lw){return rad*(280.16+360.9856235*d)-lw;}
function astroRefraction(h){if(h<0)
h=0;return 0.0002967/Math.tan(h+0.00312536/(h+0.08901179));}
function solarMeanAnomaly(d){return rad*(357.5291+0.98560028*d);}
function eclipticLongitude(M){var C=rad*(1.9148*sin(M)+0.02*sin(2*M)+0.0003*sin(3*M)),P=rad*102.9372;return M+C+P+PI;}
function sunCoords(d){var M=solarMeanAnomaly(d),L=eclipticLongitude(M);return{dec:declination(L,0),ra:rightAscension(L,0)};}
var SunCalc={};SunCalc.getPosition=function(date,lat,lng){var lw=rad* -lng,phi=rad*lat,d=toDays(date),c=sunCoords(d),H=siderealTime(d,lw)-c.ra;return{azimuth:azimuth(H,phi,c.dec),altitude:altitude(H,phi,c.dec)};};var times=SunCalc.times=[[-0.833,'sunrise','sunset'],[-0.3,'sunriseEnd','sunsetStart'],[-6,'dawn','dusk'],[-12,'nauticalDawn','nauticalDusk'],[-18,'nightEnd','night'],[6,'goldenHourEnd','goldenHour']];SunCalc.addTime=function(angle,riseName,setName){times.push([angle,riseName,setName]);};var J0=0.0009;function julianCycle(d,lw){return Math.round(d-J0-lw/(2*PI));}
function approxTransit(Ht,lw,n){return J0+(Ht+lw)/(2*PI)+n;}
function solarTransitJ(ds,M,L){return J2000+ds+0.0053*sin(M)-0.0069*sin(2*L);}
function hourAngle(h,phi,d){return acos((sin(h)-sin(phi)*sin(d))/(cos(phi)*cos(d)));}
function observerAngle(height){return-2.076*Math.sqrt(height)/60;}
function getSetJ(h,lw,phi,dec,n,M,L){var w=hourAngle(h,phi,dec),a=approxTransit(w,lw,n);return solarTransitJ(a,M,L);}
SunCalc.getTimes=function(date,lat,lng,height){height=height||0;var lw=rad* -lng,phi=rad*lat,dh=observerAngle(height),d=toDays(date),n=julianCycle(d,lw),ds=approxTransit(0,lw,n),M=solarMeanAnomaly(ds),L=eclipticLongitude(M),dec=declination(L,0),Jnoon=solarTransitJ(ds,M,L),i,len,time,h0,Jset,Jrise;var result={solarNoon:fromJulian(Jnoon),nadir:fromJulian(Jnoon-0.5)};for(i=0,len=times.length;i<len;i+=1){time=times[i];h0=(time[0]+dh)*rad;Jset=getSetJ(h0,lw,phi,dec,n,M,L);Jrise=Jnoon-(Jset-Jnoon);result[time[1]]=fromJulian(Jrise);result[time[2]]=fromJulian(Jset);}
return result;};function moonCoords(d){var L=rad*(218.316+13.176396*d),M=rad*(134.963+13.064993*d),F=rad*(93.272+13.229350*d),l=L+rad*6.289*sin(M),b=rad*5.128*sin(F),dt=385001-20905*cos(M);return{ra:rightAscension(l,b),dec:declination(l,b),dist:dt};}
SunCalc.getMoonPosition=function(date,lat,lng){var lw=rad* -lng,phi=rad*lat,d=toDays(date),c=moonCoords(d),H=siderealTime(d,lw)-c.ra,h=altitude(H,phi,c.dec),pa=atan(sin(H),tan(phi)*cos(c.dec)-sin(c.dec)*cos(H));h=h+astroRefraction(h);return{azimuth:azimuth(H,phi,c.dec),altitude:h,distance:c.dist,parallacticAngle:pa};};SunCalc.getMoonIllumination=function(date){var d=toDays(date||new Date()),s=sunCoords(d),m=moonCoords(d),sdist=149598000,phi=acos(sin(s.dec)*sin(m.dec)+cos(s.dec)*cos(m.dec)*cos(s.ra-m.ra)),inc=atan(sdist*sin(phi),m.dist-sdist*cos(phi)),angle=atan(cos(s.dec)*sin(s.ra-m.ra),sin(s.dec)*cos(m.dec)-
cos(s.dec)*sin(m.dec)*cos(s.ra-m.ra));return{fraction:(1+cos(inc))/2,phase:0.5+0.5*inc*(angle<0?-1:1)/Math.PI,angle:angle};};function hoursLater(date,h){return new Date(date.valueOf()+h*dayMs/24);}
SunCalc.getMoonTimes=function(date,lat,lng,inUTC){var t=new Date(date);if(inUTC)t.setUTCHours(0,0,0,0);else t.setHours(0,0,0,0);var hc=0.133*rad,h0=SunCalc.getMoonPosition(t,lat,lng).altitude-hc,h1,h2,rise,set,a,b,xe,ye,d,roots,x1,x2,dx;for(var i=1;i<=24;i+=2){h1=SunCalc.getMoonPosition(hoursLater(t,i),lat,lng).altitude-hc;h2=SunCalc.getMoonPosition(hoursLater(t,i+1),lat,lng).altitude-hc;a=(h0+h2)/2-h1;b=(h2-h0)/2;xe=-b/(2*a);ye=(a*xe+b)*xe+h1;d=b*b-4*a*h1;roots=0;if(d>=0){dx=Math.sqrt(d)/(Math.abs(a)*2);x1=xe-dx;x2=xe+dx;if(Math.abs(x1)<=1)roots++;if(Math.abs(x2)<=1)roots++;if(x1<-1)x1=x2;}
if(roots===1){if(h0<0)rise=i+x1;else set=i+x1;}else if(roots===2){rise=i+(ye<0?x2:x1);set=i+(ye<0?x1:x2);}
if(rise&&set)break;h0=h2;}
var result={};if(rise)result.rise=hoursLater(t,rise);if(set)result.set=hoursLater(t,set);if(!rise&&!set)result[ye>0?'alwaysUp':'alwaysDown']=true;return result;};if(typeof exports==='object'&&typeof module!=='undefined')module.exports=SunCalc;else if(typeof define==='function'&&define.amd)define(SunCalc);else window.SunCalc=SunCalc;}());
/*	SQM Visualizer
	(c) 2024 Darren Creutz
	Licensed under the GNU AFFERO GENERAL PUBLIC LICENSE v3 */

var sqmManager;window.addEventListener("load",(event)=>{if(!sqmConfig){sqmConfig={};}
if(!sqmConfig.defaultSqm){sqmConfig.defaultSqm=[];}
if(!Array.isArray(sqmConfig.defaultSqm)){sqmConfig.defaultSqm=[sqmConfig.defaultSqm];}
_.keys(sqmDefaultConfig).forEach((option)=>{if((!sqmConfig[option])&&(sqmConfig[option]!==false)){sqmConfig[option]=sqmDefaultConfig[option];}});sqmConfig.pollingInterval=sqmConfig.pollingInterval*60*1000;sqmConfig.latestPollingInterval=sqmConfig.latestPollingInterval*60*1000;sqmConfig.infoPollingInterval=sqmConfig.infoPollingInterval*60*1000;if(sqmConfig.color){sqmConfig.colorScheme=[sqmConfig.color];}
sqmManager=new SQMManager(sqmConfig.defaultSqm);sqmManager.initialize();});window.onerror=function(msg,url,line,col,error){if(sqmConfig.debug){var extra=!col?'':'\ncolumn: '+col;extra+=!error?'':'\nerror: '+error;SQMManager.errorHandler(new SQMError("SQM Global Error Handler",[msg,url,line,extra]),"Something went wrong, try reloading the page");}else{SQMManager.errorHandler(msg,"Something went wrong, try reloading the page");}
return true;}
function $(id){return document.getElementById(id);}
class _{static keys(object){return Object.keys(object);}
static values(object){return Object.values(object);}
static mapObject(object,callable){const result={};_.keys(object).forEach((key)=>{result[key]=callable(object[key],key)});return result;}
static max(iterable){if(iterable.length==0){return null;}
return iterable.reduce((result,current)=>result>current?result:current);}
static min(iterable){if(iterable.length==0){return null;}
return iterable.reduce((result,current)=>result<current?result:current);}}
class SQMAbout{static#holder;static#isShowing;static initialize(divId){SQMAbout.#holder=$(divId);document.body.addEventListener('mousedown',SQMAbout.#click);SQMAbout.#isShowing=false;$('closeabout').addEventListener('click',SQMAbout.hide);}
static show(){if(!SQMAbout.#isShowing){SQMAbout.#holder.style.display="block";SQMAbout.#holder.style.opacity=0.25;SQMAbout.#isShowing=true;setTimeout(()=>{SQMAbout.#holder.style.opacity=1;},20);}}
static hide(){setTimeout(()=>{SQMAbout.#holder.style.opacity=0;setTimeout(()=>{SQMAbout.#holder.style.display="none";SQMAbout.#isShowing=false;},3*1000);},20);}
static#click(event){if(!SQMAbout.#holder.contains(event.target)&&SQMAbout.#isShowing){SQMAbout.hide();}}}
class SQMBarChart{_getChartOptions(){return{type:'bar',options:{responsive:true,aspectRatio:8/2,plugins:{legend:{display:false,position:'bottom'},tooltip:{callbacks:{title:SQMBarChart.#hoverTextTitle,label:SQMBarChart.#hoverText}}}}};}#divId;#chartObject;#canvas;#contextMenu;#userRange;#userIncrement;#readingsSet;#showWhich;#readingsType;#datasets;#computedMin;#computedMax;#computedIncrement;#colorManager;#isClear;#chartCount;#totalReadings;#numReadingsByLabel;constructor(divId){this.#divId=divId;this.#makeChartObject();this.#userRange=false;this.#userIncrement=false;this.#datasets={};this.#chartCount=0;this.#totalReadings={};this.#numReadingsByLabel={};this.#contextMenu=new SQMBarContextMenu(divId,this);}#makeChartObject(){this.#chartCount++;this.#canvas=document.createElement('canvas');this.#canvas.setAttribute('id',this.#divId+'sqmbarchart'+this.#chartCount);$(this.#divId).appendChild(this.#canvas);this.#chartObject=new Chart($(this.#divId+'sqmbarchart'+this.#chartCount),this._getChartOptions());this.#chartObject.colorManager=this.#colorManager;this.#chartObject.barChart=this;this.#isClear=false;}
activateSqm(sqmId){const index=this.#chartObject.data.datasets.findIndex((d)=>d.sqmId==sqmId);if(index<0){return false;}
this.#chartObject.show(index);this.#chartObject.data.datasets[index].hidden=false;}
deactivateSqm(sqmId){const index=this.#chartObject.data.datasets.findIndex((d)=>d.sqmId==sqmId);if(index<0){return false;}
this.#chartObject.hide(index);this.#chartObject.data.datasets[index].hidden=true;}
setColorManager(colorManager){this.#colorManager=colorManager;this.#chartObject.colorManager=colorManager;}
setReadingsType(readingsType){this.#readingsType=readingsType;}
clearRange(){this.#userRange=false;this.#userIncrement=false;}
getRange(){if(this.#userRange){return this.#userRange;}else{return{min:this.#computedMin,max:this.#computedMax};}}
setMin(newMin){if(this.#userRange){this.#userRange={min:newMin,max:this.#userRange.max};}else{this.#userRange={min:newMin,max:this.#computedMax};}
this.redraw();}
setMax(newMax){if(this.#userRange){this.#userRange={min:this.#userRange.min,max:newMax};}else{this.#userRange={min:this.#computedMin,max:newMax};}
this.redraw();}
setIncrement(newIncrement){this.#userIncrement=parseFloat(newIncrement);this.redraw();}
setReadingsSet(readingsSet){this.#readingsSet=readingsSet;}
addDataset(dataset){dataset.data=[];dataset.borderColor=SQMBarChart.#borderColor;dataset.backgroundColor=SQMBarChart.#backgroundColor;dataset.fill=false;this.#datasets[dataset.sqmId]=dataset;}
addedToReadings(newReadingsSet){}
removeDataset(sqmId){delete this.#datasets[sqmId];this.#chartObject.data.datasets=[];_.values(this.#datasets).forEach((dataset)=>{this.#chartObject.data.datasets.push(dataset);});}
clearChart(){if(this.#chartObject){this.#chartObject.data.datasets=[];this.#chartObject.destroy();}
const container=$(this.#divId);container.removeChild(container.firstElementChild);this.#isClear=true;}
removeAllDatasets(){this.#datasets={};this.#chartObject.data.datasets=[];}
setShowReadings(which){this.#showWhich=which;}
showAllReadings(){this.#showWhich='all';this.redraw();}
showNoCloudyReadings(){this.#showWhich='noCloudy';this.redraw();}
showNoSunMoonCloudsReadings(){this.#showWhich='noSunMoonClouds';this.redraw();}#computeRange(readings){if(this.#userRange){this.#computedMin=this.#userRange.min;this.#computedMax=this.#userRange.max;}else{this.#computedMin=_.min(_.keys(readings).map((sqmId)=>{if(_.values(readings[sqmId]).length==0){return 100;}
const sorted=_.values(readings[sqmId]).map((reading)=>reading.reading).sort();return sorted[Math.floor(sorted.length*0.05)];}));this.#computedMax=_.max(_.keys(readings).map((sqmId)=>{if(_.values(readings[sqmId]).length==0){return-1;}
return _.max(_.values(readings[sqmId]).map((reading)=>reading.reading));}));}
if(this.#userIncrement){this.#computedIncrement=this.#userIncrement;}else{if(this.#computedMax-this.#computedMin>6){this.#computedIncrement=1.0;}else if(this.#computedMax-this.#computedMin>3){this.#computedIncrement=0.5;}else if(this.#computedMax-this.#computedMin>1.5){this.#computedIncrement=0.25;}else{this.#computedIncrement=0.1;}}}#round(num){return parseFloat(num.toFixed(4));}
redraw(){var readings;switch(this.#showWhich){case'all':readings=this.#readingsSet.allReadings();break;case'noCloudy':readings=this.#readingsSet.noCloudyReadings();break;case'noSunMoonClouds':readings=this.#readingsSet.noSunMoonCloudsReadings();break;}
var hasReadings=false;_.keys(readings).forEach((sqmId)=>{if(_.keys(readings[sqmId]).length>0){hasReadings=true;}});if(!hasReadings){this.#setBestAndStats();this.#chartObject.update();return;}
this.#computeRange(readings);const mult=Math.floor(1/this.#computedIncrement);const start=Math.floor(this.#computedMin*mult);const end=Math.ceil(this.#computedMax*mult);const labels=[];if(_.keys(readings).length>0){labels.push("<"+this.#round((start/mult)+this.#computedIncrement));}
_.keys(readings).forEach((sqmId)=>{this.#datasets[sqmId].data=[0];});for(let j=start+1;j<end;j+=1){_.keys(this.#datasets).forEach((sqmId)=>{this.#datasets[sqmId].data.push(0);});}
for(let j=start+1;j<end-1;j+=1){labels.push("["+this.#round(j/mult)+","+this.#round((j+1)/mult)+")");}
labels.push("["+this.#round((end-1)/mult)+","+this.#round(end/mult)+"]");this.#chartObject.data.datasets=[];this.#chartObject.data.labels=labels;_.keys(readings).forEach((sqmId)=>{_.values(readings[sqmId]).forEach((value)=>{const bin=Math.floor(value.reading*mult);if(bin<start){this.#datasets[sqmId].data[0]+=1;}else if(bin==end){this.#datasets[sqmId].data[end-start-1]+=1;}else{this.#datasets[sqmId].data[bin-start]+=1;}});this.#chartObject.data.datasets.push(this.#datasets[sqmId]);this.#numReadingsByLabel[sqmId]={};for(let j=0;j<end-start;j+=1){this.#numReadingsByLabel[sqmId][labels[j]]=this.#datasets[sqmId].data[j];}
this.#totalReadings[sqmId]=this.#datasets[sqmId].data.reduce((total,current)=>total+current);});this.#contextMenu.setMin(Math.floor(start/mult));this.#contextMenu.setIncrement(this.#computedIncrement);this.#setBestAndStats();this.#chartObject.update();}#setBestAndStats(){const active=[];this.#chartObject.data.datasets.forEach((dataset)=>{if(!dataset.hidden){active.push(dataset.sqmId);}});SQMUserDisplay.setBestBox(this.#readingsSet.bestReading(active),active.length>1);SQMUserDisplay.setStatsBox(this.#readingsSet.stats(active));}
static#borderColor(context){return context.chart.colorManager.barBorder(context.dataset.sqmId);}
static#backgroundColor(context){return context.chart.colorManager.barBackground(context.dataset.sqmId);}
static#hoverTextTitle(context){return context.map((ctx)=>ctx.chart.barChart._hoverTextTitle(ctx.dataset.sqmId,ctx.label)).join("\n");}
_hoverTextTitle(sqmId,labels){return"";}
static#hoverText(context){return context.chart.barChart._hoverText(context.dataset.sqmId,context.label);}
_hoverText(sqmId,label){const sqmName=sqmManager.availableSqmInfos[sqmId].name;const numReadings=this.#numReadingsByLabel[sqmId][label];const totalReadings=this.#totalReadings[sqmId];const percent=Math.round(numReadings*100/totalReadings);const result=[numReadings+" of "+totalReadings+" reading"+
((totalReadings!=1)?"s":"")+" ("+percent+"%)",sqmName.length>20?sqmName.substring(0,18)+"...":sqmName];if(label[0]=="<"){const binMax=label.substring(1);result.push("Msas less than "+binMax);}else{const range=label.substring(1).substring(0,label.length-2).split(',');const binMin=range[0];const binMax=range[1];result.push("Msas between "+binMin+" and "+binMax);}
return result;}
image(){return this.#chartObject.toBase64Image();}
blob(callback){this.#canvas.toBlob(callback);}}
class SQMBrowserHistory{static initialize(){window.addEventListener('popstate',(event)=>{if(event.state){SQMBrowserHistory.fromState(event.state);}});}
static#addToHistory(state,title,url){window.history.pushState(state,title,url);}
static nightly(date){SQMBrowserHistory.#addToHistory({type:'nightly',date:date},sqmConfig.title,'?nightly='+encodeURIComponent(date));}
static monthly(month){SQMBrowserHistory.#addToHistory({type:'monthly',month:month},sqmConfig.title,'?monthly='+encodeURIComponent(month));}
static allTime(){SQMBrowserHistory.#addToHistory({type:'allTime'},sqmConfig.title,'?allTime');}
static sixMonths(endDate){SQMBrowserHistory.#addToHistory({type:'sixMonths',endDate:endDate},sqmConfig.title,'?sixMonths='+encodeURIComponent(endDate));}
static customBestNightly(startDateStr,endDateStr){SQMBrowserHistory.#addToHistory({type:'bestNightly',start:startDateStr,end:endDateStr},sqmConfig.title,'?best&start='+encodeURIComponent(startDateStr)+'&end='+encodeURIComponent(endDateStr));}
static customAll(startDatetimeStr,endDatetimeStr){SQMBrowserHistory.#addToHistory({type:'all',start:startDatetimeStr,end:endDatetimeStr},sqmConfig.title,'?all&start='+encodeURIComponent(startDatetimeStr)
+'&end='+encodeURIComponent(endDatetimeStr));}
static fromState(state){switch(state.type){case'nightly':return SQMUserRequest.nightly(state.date,false);break;case'monthly':return SQMUserRequest.monthly(state.month,false);break;case'allTime':return SQMUserRequest.allTime(false);break;case'sixMonths':const x=SQMUserRequest.sixMonthsBeforeDate(state.endDate,false);return x;break;case'bestNightly':SQMUserInputs.setReadingsType('best_nightly_readings');SQMUserInputs.setDateTimeInputsAsDates(SQMDate.parseServerDatetime(state.start),SQMDate.parseServerDatetime(state.end));return SQMUserRequest.custom(false);break;case'all':SQMUserInputs.setReadingsType('all_readings');SQMUserInputs.setDateTimeInputsAsDates(SQMDate.parseServerDatetime(state.start),SQMDate.parseServerDatetime(state.end));return SQMUserRequest.custom(false);break;case'custom':return SQMUserRequest.custom(false);break;}}
static fromUrl(){const params=new URLSearchParams(window.location.search);if(params.has('nightly')){var dateString=decodeURIComponent(params.get('nightly'));const date=SQMDate.parseServerDate(dateString);if(isNaN(date)){dateString=SQMDate.formatServerDate(new Date());}
return{type:'nightly',date:dateString};}
if(params.has('monthly')){var monthString=decodeURIComponent(params.get('monthly'));const date=SQMDate.parseServerMonth(monthString);if(isNaN(date)){monthString=SQMDate.formatServerMonth(new Date());}
return{type:'monthly',month:monthString};}
if(params.has('allTime')){return{type:'allTime'};}
if(params.has('sixMonths')){const endDateString=decodeURIComponent(params.get('sixMonths'));return{type:'sixMonths',endDate:endDateString};}
if(params.has('best')){const startDateString=decodeURIComponent(params.get('start'));const startDate=SQMDate.parseServerDatetime(startDateString);const endDateString=decodeURIComponent(params.get('end'));const endDate=SQMDate.parseServerDatetime(startDateString);if(isNaN(startDate)||isNaN(endDate)){SQMUserRequest.sixMonths();}
SQMUserInputs.setReadingsType('best_nightly_readings');SQMUserInputs.setDateTimeInputsAsDates(startDate,endDate);return{type:'custom'};}
if(params.has('all')){const startDateString=decodeURIComponent(params.get('start'));const startDate=SQMDate.parseServerDatetime(startDateString);const endDateString=decodeURIComponent(params.get('end'));const endDate=SQMDate.parseServerDatetime(endDateString);if(isNaN(startDate)||isNaN(endDate)){SQMUserRequest.nightly();}
SQMUserInputs.setReadingsType('all_readings');SQMUserInputs.setDateTimeInputsAsDates(startDate,endDate);return{type:'custom'};}
return false;}}
class SQMChart{#timeChart;#barChart;latestDatetime;startDatetime;endDatetime;readingsType;#sqmManager;#contextMenus;#allReadingsColorManager;#bestReadingsColorManager;#sunMoonMWClouds;#showWhich;#timeChartDatasets;#barChartDatasets;#chartReadingsSet;#requestedStartDatetime;#requestedEndDatetime;#activeSqmIds;#titleBuilder;static#defaultTitleString(){return"";}
constructor(sqmManager,timeChartDivId,barChartDivId){this.#sqmManager=sqmManager;if(sqmConfig.colorizeData){this.#allReadingsColorManager=new SQMChartAllReadingsColorManager();this.#bestReadingsColorManager=new SQMChartBestReadingsColorManager();}else{this.#allReadingsColorManager=new SQMChartPlainColorManager();this.#bestReadingsColorManager=new SQMChartPlainColorManager();}
this.updateSqmList();this.#timeChart=new SQMTimeChart(timeChartDivId,this);this.#timeChart.showLegend(sqmConfig.showLegend);this.#barChart=new SQMBarChart(barChartDivId);this.#sunMoonMWClouds={};if(sqmConfig.showCloudyByDefault&&sqmConfig.showSunMoonCloudsByDefault){this.#showWhich='all';}else if(sqmConfig.showSunMoonCloudsByDefault){this.#showWhich='noCloudy';}else{this.#showWhich='noSunMoonClouds';}
this.#timeChart.setShowReadings(this.#showWhich);this.#barChart.setShowReadings(this.#showWhich);this.#timeChartDatasets={};this.#barChartDatasets={};this.#activeSqmIds=sqmManager.initialActivatedSqms();this.#titleBuilder=SQMChart.#defaultTitleString;this.reinitialize();}
getColorManagers(){return{all:this.#allReadingsColorManager,best:this.#bestReadingsColorManager};}
setTitleBuilder(titleBuilder){this.#titleBuilder=titleBuilder;}
setActiveSqmIds(activeSqmIds){this.#activeSqmIds=activeSqmIds;this.#chartReadingsSet.sqmIds().forEach((sqmId)=>{if(activeSqmIds.includes(sqmId)){this.#timeChart.activateSqm(sqmId);this.#barChart.activateSqm(sqmId);}else{this.#timeChart.deactivateSqm(sqmId);this.#barChart.deactivateSqm(sqmId);}});this.#computeTimesFrom(this.#chartReadingsSet);sqmManager.updateLatest();this.redrawTimeChart();this.redrawBarChart();}
activateSqmId(sqmId){this.#activeSqmIds.push(sqmId);this.#timeChart.activateSqm(sqmId);sqmManager.updateLatest();}
deactivateSqmId(sqmId){if(this.#activeSqmIds.includes(sqmId)){this.#activeSqmIds.splice(this.#activeSqmIds.indexOf(sqmId),1);this.#timeChart.deactivateSqm(sqmId);}
sqmManager.updateLatest();}
activeSqmIds(){return this.#activeSqmIds;}
reinitialize(){this.removeAllReadings();this.#timeChart.clearRange();this.#barChart.clearRange();}
reinitializeBarChart(){this.#barChart.removeAllDatasets();this.#barChart.clearRange();}
reinitializeTimeChart(){this.#timeChart.removeAllDatasets();this.#timeChart.clearRange();}
setReadingsType(readingsType){this.readingsType=readingsType;this.#timeChart.setReadingsType(readingsType);this.#barChart.setReadingsType(readingsType);if(readingsType=='all_readings'){this.#timeChart.setColorManager(this.#allReadingsColorManager);this.#barChart.setColorManager(this.#allReadingsColorManager);}else{this.#timeChart.setColorManager(this.#bestReadingsColorManager);this.#barChart.setColorManager(this.#bestReadingsColorManager);}
this.#sqmManager.setReadingsType(readingsType);}
updateSqmList(){this.#allReadingsColorManager.updateColorSchemes(sqmManager.defaultSqms(),sqmManager.availableSqmInfos);this.#bestReadingsColorManager.updateColorSchemes(sqmManager.defaultSqms(),sqmManager.availableSqmInfos);}
clearCharts(){this.#timeChart.clearChart();this.#barChart.clearChart();}
redrawBarChart(){this.#barChart.redraw();}
redrawTimeChart(){const title=this.#titleBuilder(this.startDatetime,this.endDatetime);SQMUserDisplay.setGraphTitle(title);this.#timeChart.setTitle(title);this.#timeChart.redraw();}
setReadings(request,type,sqmResponse){this.#chartReadingsSet=new SQMReadingsSet(sqmResponse,type);this.#computeTimes(request,this.#chartReadingsSet);this.setReadingsType(type);this.#timeChart.setReadingsSet(this.#chartReadingsSet);this.#barChart.setReadingsSet(this.#chartReadingsSet);_.keys(sqmResponse).forEach((sqmId)=>{this.#timeChartDatasets[sqmId]=this.#newChartDataset(sqmId);this.#timeChart.addDataset(this.#timeChartDatasets[sqmId]);this.#barChartDatasets[sqmId]=this.#newChartDataset(sqmId);this.#barChart.addDataset(this.#barChartDatasets[sqmId]);});}
shiftReadings(request,type,sqmResponse){const newReadingsSet=new SQMReadingsSet(sqmResponse,type);this.#chartReadingsSet.add(newReadingsSet);this.#computeTimes(request,newReadingsSet);this.reinitializeBarChart();this.#barChart.setReadingsSet(newReadingsSet);_.keys(sqmResponse).forEach((sqmId)=>{this.#barChartDatasets[sqmId]=this.#newChartDataset(sqmId);this.#barChart.addDataset(this.#barChartDatasets[sqmId]);});this.#timeChart.shiftedReadings(newReadingsSet);}
addToReadings(request,type,sqmResponse){const newReadingsSet=new SQMReadingsSet(sqmResponse,type);const addedSqmIds=this.#chartReadingsSet.add(newReadingsSet);addedSqmIds.forEach((sqmId)=>{this.#timeChartDatasets[sqmId]=this.#newChartDataset(sqmId);this.#timeChart.addDataset(this.#timeChartDatasets[sqmId]);this.#barChartDatasets[sqmId]=this.#newChartDataset(sqmId);this.#barChart.addDataset(this.#barChartDatasets[sqmId]);});this.#computeTimes(request,this.#chartReadingsSet);this.#barChart.addedToReadings(newReadingsSet);this.#timeChart.addedToReadings(newReadingsSet);this.redrawBarChart();this.redrawTimeChart();}#computeTimes(request,readingsSet){this.#requestedStartDatetime=request.start;this.#requestedEndDatetime=request.end;this.#computeTimesFrom(readingsSet);}#computeTimesFrom(readingsSet){var sqmIds=this.#activeSqmIds.filter((sqmId)=>_.keys(readingsSet.get(sqmId).readings).length>0);if(sqmIds.length==0){sqmIds=this.#activeSqmIds;}
if(sqmIds.length==0){return;}
this.startDatetime=readingsSet.startDatetime(sqmIds)||this.#requestedStartDatetime;this.endDatetime=readingsSet.endDatetime(sqmIds)||this.#requestedEndDatetime;this.latestDatetime=readingsSet.latestDatetime(sqmIds);if(sqmConfig.forceTicksFromData){if(this.readingsType=='best_nightly_readings'){this.#timeChart.setTicksSource('data');}else{if((Date.parse(this.endDatetime)-Date.parse(this.latestDatetime))>=600000){this.#timeChart.setTicksSource('auto');}else{this.#timeChart.setTicksSource('data');}}}
SQMUserInputs.setDateTimeInputsAsDates(SQMDate.parseServerDatetime(this.startDatetime),SQMDate.parseServerDatetime(this.endDatetime));this.#timeChart.setTimeRange(this.startDatetime,this.endDatetime);}#newChartDataset(sqmId){return{sqmId:sqmId,label:this.#shortSqmLabel(sqmId),readingsType:this.readingsType,hidden:!this.#activeSqmIds.includes(sqmId)};}
removeReadings(sqmId){this.#timeChart.removeDataset(sqmId);this.#barChart.removeDataset(sqmId);this.#chartReadingsSet.remove(sqmId);delete this.#timeChartDatasets[sqmId];delete this.#barChartDatasets[sqmId];if(this.#chartReadingsSet.sqmIds().length>0){this.#computeTimesFrom(this.#chartReadingsSet);}}
removeAllReadings(){this.#chartReadingsSet=new SQMReadingsSet({},this.readingsType);this.#timeChart.removeAllDatasets();this.#barChart.removeAllDatasets();this.#timeChart.setReadingsSet(this.#chartReadingsSet);this.#barChart.setReadingsSet(this.#chartReadingsSet);}#shortSqmLabel(sqmId){const sqmName=this.#sqmManager.availableSqmInfos[sqmId].name;return sqmName.length>20?sqmName.substring(0,18)+"...":sqmName;}
showHideCloudy(){switch(this.#showWhich){case'all':this.#showWhich='noCloudy';this.#timeChart.showNoCloudyReadings();this.#barChart.showNoCloudyReadings();break;case'noCloudy':case'noSunMoonClouds':this.#showWhich='all';this.#timeChart.showAllReadings();this.#barChart.showAllReadings();break;}}
showHideSunMoonClouds(){switch(this.#showWhich){case'all':case'noCloudy':this.#showWhich='noSunMoonClouds';this.#timeChart.showNoSunMoonCloudsReadings();this.#barChart.showNoSunMoonCloudsReadings();break;case'noSunMoonClouds':this.#showWhich='all';this.#timeChart.showAllReadings();this.#barChart.showAllReadings();break;}}
showingWhich(){return this.#showWhich;}}
class SQMChartColorManager{#baseColors;static#colorScheme;updateColorSchemes(defaultSqms,availableSqmInfos){SQMChartColorManager.#colorScheme=sqmConfig.colorScheme.map((hex)=>{if(hex[0]=='#'){hex=hex.substring(1);}
const bigint=parseInt(hex,16);return[(bigint>>16)&255,(bigint>>8)&255,bigint&255];});this.#baseColors={};var index=0;defaultSqms.forEach((sqmId)=>{this.#baseColors[sqmId]=index%SQMChartColorManager.#colorScheme.length;index+=1;});_.keys(availableSqmInfos).forEach((sqmId)=>{if(!defaultSqms.includes(sqmId)){this.#baseColors[sqmId]=index%SQMChartColorManager.#colorScheme.length;index+=1;}});_.keys(this.#baseColors).forEach((sqmId)=>{this.#baseColors[sqmId]=SQMChartColorManager.#colorScheme[this.#baseColors[sqmId]].join(",");});}
_baseColor(sqmId){return"rgb("+this.#baseColors[sqmId]+")";}
_baseColorTransparent(sqmId,transparency){return"rgb("+this.#baseColors[sqmId]+","+transparency+")";}
legendBorder(sqmId){return this._baseColor(sqmId);}
legendBackground(sqmId){return this._baseColor(sqmId);}#transparency(reading){if(reading.mean_r_squared){if(reading.mean_r_squared<sqmConfig.cloudyCutoff){return 1.0;}
if(reading.mean_r_squared>sqmConfig.cloudyMax){return 0.25;}
return 1.0-
((reading.mean_r_squared-sqmConfig.cloudyCutoff)/(sqmConfig.cloudyMax-sqmConfig.cloudyCutoff))*0.75;}else{return 1.0;}}
pointBorderColor(sqmId,reading){if(!reading){return this._baseColor(sqmId);}
return this._baseColorTransparent(sqmId,this.#transparency(reading));}
pointBackgroundColor(sqmId,reading){if(!reading){return this._baseColor(sqmId);}
if(!reading.sun_position||!reading.moon_position){return this._baseColor(sqmId);}
const sunAltitude=reading.sun_position.altitude*180/Math.PI;if(sunAltitude>sqmConfig.sunAltitudeCutoffs[0]){return"rgba(255,215,0,"+this.#transparency(reading)+")";}
if(sunAltitude>sqmConfig.sunAltitudeCutoffs[1]){return"rgba(255,165,0,"+this.#transparency(reading)+")";}
if(sunAltitude>sqmConfig.sunAltitudeCutoffs[2]){return"rgba(255,140,0,"+this.#transparency(reading)+")";}
const moonAltitude=reading.moon_position.altitude*180/Math.PI;if(moonAltitude<sqmConfig.moonAltitudeCutoffs[0]){return"rgb(0,0,0,"+this.#transparency(reading)+")";}
const moonshine=moonAltitude>sqmConfig.moonAltitudeCutoffs[1]?1.0:(moonAltitude-sqmConfig.moonAltitudeCutoffs[0])/(sqmConfig.moonAltitudeCutoffs[1]-sqmConfig.moonAltitudeCutoffs[0]);const illumination=reading.moon_illumination.fraction>0.33?1.0:reading.moon_illumination.fraction/0.33;const amount=moonshine*illumination*255;return"rgba("+amount+","+amount+","+amount+","+
this.#transparency(reading)+")";}
pointHoverBorderColor(sqmId,reading){return this.pointBorderColor(sqmId,reading);}
pointHoverBackgroundColor(sqmId,reading){return this.pointBackgroundColor(sqmId,reading);}
segmentColor(sqmId,reading,nextReading,readingsType){if(reading==null){return this._baseColor(sqmId);}
if(nextReading==null){return this._baseColorTransparent(sqmId,this.#transparency(reading));}
const d=new Date(reading.datetime).getTime()-new Date(nextReading.datetime).getTime();if(readingsType=='all_readings'){if(Math.abs(d)>=21600000){return'rgba(0,0,0,0.0)';}}else{if(Math.abs(d)>=1728000000){return'rgba(0,0,0,0.0)';}}
const transparencyFirst=this.#transparency(reading);const transparencyNext=this.#transparency(nextReading)
const transparency=((transparencyFirst==0.0)||(transparencyNext==0.0))?0.0:(transparencyFirst+transparencyNext)/2;return this._baseColorTransparent(sqmId,transparency);}
segmentDash(sqmId,reading,nextReading,readingsType){if(!reading.mean_r_squared||!nextReading.mean_r_squared){return[6,6];}
return undefined;}
pointRadius(sqmId,reading){return 4;}
pointHoverRadius(sqmId,reading){return 6;}
smallPointRadius(sqmId,reading){return 2;}
smallPointHoverRadius(sqmId,reading){return 3;}
pointStyle(sqmId,reading){if(sqmConfig.milkyWay&&reading&&reading.galactic_latitude&&(Math.abs(reading.galactic_latitude)<sqmConfig.milkyWayCutoff)){return'rectRot';}
return'circle';}
barBorder(sqmId){return this._baseColor(sqmId);}
barBackground(sqmId){return this._baseColor(sqmId);}
static colorKey(){var color='rgb('+SQMChartColorManager.#colorScheme[0].join(",")+')';document.querySelectorAll('.keysun, .keymoon, .keyclouds').forEach((elt)=>{elt.style.borderColor=color;});document.querySelectorAll('.keyline, .halfkeyline').forEach((elt)=>{elt.style.background=color;});$('keysun1').style.background='gold';$('keysun2').style.background='orange';$('keysun3').style.background='darkorange';for(let i=1;i<=10;i++){$('keymoon'+i).style.background='rgba(0,0,0,'+(i/10.0)+')';}
for(let i=1;i<=3;i++){$('keysuntooltip'+i).innerHTML="Sun altitude above "+sqmConfig.sunAltitudeCutoffs[i-1]+" degrees";}
for(let i=1;i<=5;i++){color='rgba('+SQMChartColorManager.#colorScheme[0].join(",")+","+(0.2*i)+')';document.querySelectorAll('#keyclouds'+i+' .keylinecontainer .keyline').forEach((elt)=>{elt.style.background=color;});document.querySelectorAll('#keyclouds'+i+' .halfkeylinecontainer .halfkeyline').forEach((elt)=>{elt.style.background=color;});document.querySelectorAll('#keyclouds'+i+' .keyclouds').forEach((elt)=>{elt.style.borderColor=color;});}
$('keymw1a').style.background='rgba(0,0,0,1.0)';$('keymw1a').style.borderColor=color;$('keymwtooltip1').innerHTML="Galactic latitude within "+sqmConfig.milkyWayCutoff+" degrees";}}
class SQMChartAllReadingsColorManager extends SQMChartColorManager{}
class SQMChartBestReadingsColorManager extends SQMChartColorManager{}
class SQMChartPlainColorManager extends SQMChartColorManager{legendBorder(sqmId){return this._baseColor(sqmId);}
legendBackground(sqmId){return this._baseColor(sqmId);}
pointBorderColor(sqmId,reading){return this._baseColor(sqmId);}
pointBackgroundColor(sqmId,reading){return'rgba(0,0,0,0.0)';}
segmentColor(sqmId,reading,nextReading,readingsType){return this._baseColor(sqmId);}
segmentDash(sqmId,reading,nextReading,readingsType){return undefined;}
pointRadius(sqmId,reading){return 4;}
pointHoverRadius(sqmId,reading){return 4;}
pointStyle(sqmId,reading){return'circle';}
barBorder(sqmId){return this._baseColor(sqmId);}
barBackground(sqmId){return this._baseColor(sqmId);}}
class SQMContextMenu{#div;#menu;#isShowing;constructor(div){this.#div=$(div);this.#isShowing=false;this.#div.addEventListener('contextmenu',SQMContextMenu.#click.bind(null,this),false);document.body.addEventListener('mousedown',SQMContextMenu.#clickOutside.bind(null,this));this.#menu=document.createElement('ul');this.#menu.classList.add('contextmenu');this.#div.appendChild(this.#menu);}
static#click(contextMenu,event){return contextMenu._click(event);}
_click(event){event.preventDefault();event.stopPropagation();this._placeMenu(event.clientX,event.clientY);this.#menu.style.visibility='visible';this.#isShowing=true;return false;}
_placeMenu(x,y){if(this.#menu.offsetWidth>window.innerWidth*0.5){this.#menu.style.transform="scale("+(window.innerWidth*0.5/this.#menu.offsetWidth)+")";}
if(this.#menu.offsetHeight>window.innerHeight*0.8){this.#menu.style.transform="scale("+(window.innerHeight*0.8/this.#menu.offsetHeight)+")";}
if((x+this.#menu.offsetWidth)>window.innerWidth-10){x=window.innerWidth-this.#menu.offsetWidth-10;}
if((y-30+this.#menu.offsetHeight)>window.innerHeight){y=window.innerHeight-this.#menu.offsetHeight;}
this.#menu.style.left=x+"px";this.#menu.style.top=(y-30)+"px";}
static#clickOutside(contextMenu,event){return contextMenu._clickOutside(event);}
_clickOutside(event){if(this.#isShowing&&!this.#menu.contains(event.target)){this.#menu.style.visibility='hidden';this.#isShowing=false;}}
static#closeMenu(contextMenu){contextMenu._closeMenu();}
_closeMenu(){this.#menu.style.visibility='hidden';}
_addMenuItem(label,action,classname=null){const li=document.createElement("li");li.appendChild(document.createTextNode(label));li.classList.add('menu-item');if(classname){li.classList.add(classname);}
this.#menu.appendChild(li);li.addEventListener("click",SQMContextMenu.#closeMenu.bind(null,this));li.addEventListener("click",action);return li;}
_addMenuSeparator(classname=null){const li=document.createElement("li");li.appendChild(document.createTextNode(" "));li.classList.add('menu-separator');if(classname){li.classList.add(classname);}
this.#menu.appendChild(li);return li;}
_addRangeMenuItem(label,action,classname,values=null){const li=document.createElement("li");li.appendChild(document.createTextNode(label));li.classList.add('menu-item-no-underline');if(classname){li.classList.add(classname);}
const select=document.createElement("select");select.style.float='right';if(!values){const startValue=sqmConfig.badDataCutoff?Math.floor(sqmConfig.badDataCutoff):0;const endValue=25;for(let i=startValue;i<=endValue;i++){const option=new Option(i,i,false);select.appendChild(option);}}else{values.forEach((value)=>{const option=new Option(value,value,false);select.appendChild(option);});}
li.appendChild(select);this.#menu.appendChild(li);li.addEventListener("change",SQMContextMenu.#closeMenu.bind(null,this));select.addEventListener("change",action);return select;}}
class SQMTimeContextMenu extends SQMContextMenu{#timeChart;#chart;#viewImage;#showViewImage;#clouds;#sunMoonClouds;#cloudsSep;#min;#max;#legend;#canFilterClouds;#canFilterSunMoonClouds;#showingWhich;constructor(div,timeChart,chart){super(div);this.#timeChart=timeChart;this.#chart=chart;this.#viewImage=this._addMenuItem("View image",SQMImagePopup.showImage,'viewimage');this.#viewImage.style.display='none';this._addMenuItem("Open graph in new tab",SQMTimeContextMenu.#imageInNewTab.bind(null,this));this._addMenuItem("Save graph as image",SQMTimeContextMenu.#saveImage.bind(null,this));this._addMenuSeparator();this._addMenuItem("Stats",SQMUserDisplay.showhideStatsBox,'showhidestats');this._addMenuItem("Bins",SQMUserDisplay.showhideBinning,'binning');this._addMenuItem("Best",SQMUserDisplay.showhideBestBox,'showhidebest');this._addMenuItem("Latest",SQMUserDisplay.showhideLatestBox,'showhidelatest');this._addMenuSeparator();this.#sunMoonClouds=this._addMenuItem("SunMoonClouds",SQMTimeContextMenu.#showHideSunMoonClouds.bind(null,this),'sunmoonclouds');this.#clouds=this._addMenuItem("Cloudy",SQMTimeContextMenu.#showHideCloudy.bind(null,this),'cloudy');this.#cloudsSep=this._addMenuSeparator('cloudysep');this.#min=this._addRangeMenuItem("Axis minimum",SQMTimeContextMenu.#setMin.bind(null,this),'limin');this.#max=this._addRangeMenuItem("Axis maximum",SQMTimeContextMenu.#setMax.bind(null,this),'limax');this._addMenuItem("Reverse vertical axis",SQMTimeContextMenu.#flipChart.bind(null,this));this.#legend=this._addMenuItem('Hide legend',SQMTimeContextMenu.#showHideLegend.bind(null,this),'showhidelegend');if(sqmConfig.colorizeData){const key=this._addMenuItem('Hide key',SQMUserDisplay.showhideKey,'showhidekey');key.setAttribute('id','showhidekey');}
this._addMenuSeparator('filesep');this._addMenuItem("Add local data",SQMUserDisplay.showAddFileInput,'lifileinput');if(sqmConfig.dataFilesLink){this._addMenuItem('View data files',SQMUserDisplay.dataFilesLink,'datafileslink');}
if(sqmConfig.showAboutLink||sqmConfig.showUserGuideLink){this._addMenuSeparator();}
if(sqmConfig.showAboutLink){SQMAbout.initialize('aboutpage');this._addMenuItem('About...',SQMAbout.show,'aboutlink');}
if(sqmConfig.showUserGuideLink){SQMUserGuide.initialize('userguidepage');this._addMenuItem('User Guide',SQMUserGuide.show,'userguidelink');}}
showViewImage(show){this.#showViewImage=show;}
canFilter(clouds,sunMoonClouds){this.#canFilterClouds=clouds;this.#canFilterSunMoonClouds=sunMoonClouds;this.#drawFilterItems();}
_click(event){super._click(event);if(this.#showViewImage){this.#viewImage.style.display='block';}else{this.#viewImage.style.display='none';}}
static#imageInNewTab(contextMenu){contextMenu._imageInNewTab();}
_imageInNewTab(){this.#timeChart.blob(SQMUserDisplay.imageInNewTab);}
static#saveImage(contextMenu){contextMenu._saveImage();}
_saveImage(){SQMUserDisplay.saveImage("SQM",this.#timeChart.image());}
static#showHideSunMoonClouds(contextMenu){contextMenu._showHideSunMoonClouds();}
_showHideSunMoonClouds(){this.#chart.showHideSunMoonClouds();}
static#showHideCloudy(contextMenu){contextMenu._showHideCloudy();}
_showHideCloudy(){this.#chart.showHideCloudy();}
static#setMin(contextMenu){contextMenu._setMin();}
_setMin(){this.#timeChart.setMin(this.#min.value);}
static#setMax(contextMenu){contextMenu._setMax();}
_setMax(){this.#timeChart.setMax(this.#max.value);}
static#flipChart(contextMenu){contextMenu._flipChart();}
_flipChart(){this.#timeChart.flipChart();}
static#showHideLegend(contextMenu){contextMenu._showHideLegend();}
_showHideLegend(){this.#timeChart.showHideLegend();}
setMin(newMin){this.#min.value=newMin;}
setMax(newMax){this.#max.value=newMax;}
setShowingWhich(which){this.#showingWhich=which;this.#drawFilterItems();}#drawFilterItems(){switch(this.#showingWhich){case'all':this.#clouds.innerHTML="Exclude cloudy data";if(this.#canFilterClouds){if(sqmConfig.milkyWay){this.#sunMoonClouds.innerHTML="Exclude sun, moon, MW, clouds";}else{this.#sunMoonClouds.innerHTML="Exclude sun, moon, clouds";}}else{if(sqmConfig.milkyWay){this.#sunMoonClouds.innerHTML="Exclude sun, moon and MW";}else{this.#sunMoonClouds.innerHTML="Exclude sun and moon";}}
break;case'noCloudy':this.#clouds.innerHTML="Include cloudy data";if(this.#canFilterClouds){if(sqmConfig.milkyWay){this.#sunMoonClouds.innerHTML="Exclude sun, moon, MW, clouds";}else{this.#sunMoonClouds.innerHTML="Exclude sun, moon, clouds";}}else{if(sqmConfig.milkyWay){this.#sunMoonClouds.innerHTML="Exclude sun, moon and MW";}else{this.#sunMoonClouds.innerHTML="Exclude sun and moon";}}
break;case'noSunMoonClouds':if(this.#canFilterClouds){if(sqmConfig.milkyWay){this.#sunMoonClouds.innerHTML="Include sun, moon, MW, clouds";}else{this.#sunMoonClouds.innerHTML="Include sun, moon, clouds";}}else{if(sqmConfig.milkyWay){this.#sunMoonClouds.innerHTML="Include sun, moon and MW";}else{this.#sunMoonClouds.innerHTML="Include sun and moon";}}
break;}
var either=false;if(this.#canFilterClouds&&this.#showingWhich!='noSunMoonClouds'){this.#clouds.style.display='block';either=true;}else{this.#clouds.style.display='none';}
if(this.#canFilterSunMoonClouds){this.#sunMoonClouds.style.display='block';either=true;}else{this.#sunMoonClouds.style.display='none';}
if(either){this.#cloudsSep.style.display='block';}else{this.#cloudsSep.style.display='none';}}
setLegendShowing(showing){this.#legend.innerHTML=showing?"Hide legend":"Show legend";}}
class SQMBarContextMenu extends SQMContextMenu{#barChart;#chart;#min;#increment;constructor(div,barChart){super(div);this.#barChart=barChart;this._addMenuItem("Open graph in new tab",SQMBarContextMenu.#imageInNewTab.bind(null,this));this._addMenuItem("Save graph as image",SQMBarContextMenu.#saveImage.bind(null,this));this._addMenuSeparator();this.#min=this._addRangeMenuItem("Axis minimum",SQMBarContextMenu.#setMin.bind(null,this),'libarmin');this.#increment=this._addRangeMenuItem("Increment",SQMBarContextMenu.#setIncrement.bind(null,this),'barincrement',[0.1,0.25,0.5,1.0,2.0]);this._addMenuSeparator();this._addMenuItem("Stats",SQMUserDisplay.showhideStatsBox,'showhidestats');this._addMenuItem("Best",SQMUserDisplay.showhideBestBox,'showhidebest');this._addMenuItem("Latest",SQMUserDisplay.showhideLatestBox,'showhidelatest');}
static#imageInNewTab(contextMenu){contextMenu._imageInNewTab();}
_imageInNewTab(){this.#barChart.blob(SQMUserDisplay.imageInNewTab);}
static#saveImage(contextMenu){contextMenu._saveImage();}
_saveImage(){SQMUserDisplay.saveImage("SQMBar",this.#barChart.image());}
static#setMin(contextMenu){contextMenu._setMin();}
_setMin(){this.#barChart.setMin(this.#min.value);}
static#setIncrement(contextMenu){contextMenu._setIncrement();}
_setIncrement(increment){this.#barChart.setIncrement(this.#increment.value);}
setMin(newMin){this.#min.value=newMin;}
setIncrement(newIncrement){this.#increment.value=newIncrement;}}
class SQMDataInMemory{#allData;#rawData;#bestData;#position;#name;#sqmId;constructor(name){this.#sqmId=name;this.#name=name;this.#allData={};this.#rawData={};this.#bestData={};}
constructFrom(fileList){return SQMFileLoader.loadFiles(fileList).then((theText)=>{const parsed=SQMFileLoader.parseData(theText);if(!parsed){throw new Error("Could not parse data");}
if(parsed.name){this.#name=parsed.name;}
const data=parsed.data;const position=parsed.position;this.#position=position;const sortedNights=_.keys(data).sort();sortedNights.forEach((night)=>{this.#allData[night]={};this.#rawData[night]={};const bestReading=_.max(_.values(data[night]));const bestDatetime=_.keys(data[night]).find((d)=>data[night][d]==bestReading);this.#bestData[night]={datetime:bestDatetime,reading:bestReading,numReadings:_.values(data[night]).length,raw:parsed.raw[night][bestDatetime]};const sortedDatetimes=_.keys(data[night]).sort();sortedDatetimes.forEach((datetime)=>{this.#allData[night][datetime]=data[night][datetime];this.#rawData[night][datetime]=parsed.raw[night][datetime];});});});}
getAllReadings(startDatetime,endDatetime){const startDate=SQMDate.nightOf(SQMDate.parseServerDatetime(startDatetime));const endDate=SQMDate.nightOf(SQMDate.parseServerDatetime(endDatetime));const result={};_.keys(this.#allData).forEach((night)=>{if((startDate<=night)&&(night<=endDate)){_.keys(this.#allData[night]).forEach((datetime)=>{if((startDatetime<=datetime)&&(datetime<=endDatetime)){result[datetime]={reading:this.#allData[night][datetime],raw:this.#rawData[night][datetime]};}});}});return{type:'all_readings',startDatetime:startDatetime,endDatetime:endDatetime,readings:result};}
getBestReadings(startDatetime=null,endDatetime=null){var startDate;var endDate;if(!startDatetime){startDate=_.min(_.keys(this.#bestData));endDate=_.max(_.keys(this.#bestData));}else{startDate=SQMDate.nightOf(SQMDate.parseServerDatetime(startDatetime));endDate=SQMDate.nightOf(SQMDate.parseServerDatetime(endDatetime));}
const readings={};_.keys(this.#bestData).forEach((night)=>{if((startDate<=night)&&(night<=endDate)){readings[this.#bestData[night].datetime]={reading:this.#bestData[night].reading,number_of_readings:this.#bestData[night].numReadings,date:night,raw:this.#bestData[night].raw};}});return{type:'best_nightly_readings',startDatetime:startDate,endDatetime:endDate,readings:readings};}
processRequest(request){if(request.queries){const response={};_.keys(request.queries).forEach((queryId)=>{response[queryId]=this.processRequest(request.queries[queryId]);});return response;}
switch(request.type){case'readings_range':return this.readingsRange();case'daily':const start=SQMDate.parseServerDate(request.date);start.setTime(12,0,0);const end=dateFns.addDays(start,1);return this.getAllReadings(SQMDate.formatServerDatetime(start),SQMDate.formatServerDatetime(end));case'nightly':const{sunset:sunset,sunrise:sunrise}=SQMSunUtils.sunsetSunriseForNight(request.date,this.#position.latitude,this.#position.longitude,this.#sqmId);return this.getAllReadings(sunset,sunrise);case'all_readings':return this.getAllReadings(request.start,request.end);case'best_nightly_readings':return this.getBestReadings(request.start,request.end);}}
sqmInfo(){return{name:this.#name,latitude:this.#position.latitude,longitude:this.#position.longitude,time_zone_id:this.#position.time_zone_id,time_zone_name:this.#position.time_zone_name};}
earliestDatetime(){return _.min(_.keys(this.#allData[_.min(_.keys(this.#allData))]));}
latestDatetime(){return _.max(_.keys(this.#allData[_.max(_.keys(this.#allData))]));}
latestReading(){return this.#allData[_.max(_.keys(this.#allData))][this.latestDatetime()];}
readingsRange(){const readings={};const earliestDatetime=this.earliestDatetime();const latestDatetime=this.latestDatetime();const startDate=SQMDate.nightOf(SQMDate.parseServerDatetime(earliestDatetime));const endDate=SQMDate.nightOf(SQMDate.parseServerDatetime(latestDatetime));readings[earliestDatetime]=this.#allData[startDate][earliestDatetime];readings[latestDatetime]=this.#allData[endDate][latestDatetime];return{startDatetime:earliestDatetime,endDatetime:latestDatetime,readings:readings};}
allDailyReadings(){return this.#allData;}
getTimezoneOffset(date){var dateString=SQMDate.formatServerDate(date);if(!this.#rawData[dateString]){const keys=_.keys(this.#rawData);if(keys.length==0){return date.getTimezoneOffset();}
dateString=keys[keys.length-1];}
const rawreading=_.values(this.#rawData[dateString])[0];const readingdate=SQMDate.parseServerDatetime(_.keys(this.#rawData[dateString])[0]);const utcDate=SQMReadings.utcDate(rawreading);if(utcDate){return dateFns.differenceInMinutes(utcDate,readingdate);}else{return date.getTimezoneOffset();}}}
class SQMDataRequester{currentRequest;#sqmChart;#pollInterval;#sqmManager;constructor(sqmManager,timeChartDivId,barChartDivId){this.#sqmManager=sqmManager;this.#sqmChart=new SQMChart(sqmManager,timeChartDivId,barChartDivId);this.#pollInterval=null;this.currentRequest={sqm_ids:[]};}
activeSqmIds(){return this.#sqmChart.activeSqmIds();}
userRequest(request,titleStringCallback,slide=true){this.#endPolling();request.sqm_ids=this.#sqmManager.selectedSqmIds();this.currentRequest=request;this.#sqmChart.setTitleBuilder(titleStringCallback);return this.#makeRequest(request,!slide,slide).then((sqmResponses)=>{this.#beginPolling();return sqmResponses;});}
activateSqmId(sqmId){this.#sqmChart.activateSqmId(sqmId);}
deactivateSqmId(sqmId){this.#sqmChart.deactivateSqmId(sqmId);}
static#checkNewData(instance){instance.newDataRequest().catch((error)=>{if(sqmConfig.debug){console.log("Error looking for new data: ");console.log(error);}});}#beginPolling(){this.#endPolling();if((sqmConfig.pollingInterval)&&(sqmConfig.pollingInterval>0)){this.#pollInterval=setInterval(SQMDataRequester.#checkNewData.bind(null,this),sqmConfig.pollingInterval);}}#endPolling(){if(this.#pollInterval){clearInterval(this.#pollInterval);}}
addDataRequest(sqmIds){this.currentRequest.sqm_ids=sqmIds;return this.#makeRequest(this.currentRequest);}
newDataRequest(){return this.#sendRequest(this.currentRequest).then((sqmReadings)=>{const type=sqmReadings.type;delete sqmReadings.type;if(this.#sqmChart.addToReadings(this.currentRequest,type,sqmReadings)){this.redraw();}});}
addFromInMemory(request,response){if(request.queries){_.keys(request.queries).forEach((queryId)=>{this.#addFromInMemoryOne(request.queries[queryId],response[queryId]);});}else{this.#addFromInMemoryOne(request,response);}}#addFromInMemoryOne(request,response){_.keys(this.#sqmManager.inMemorySqms).forEach((sqmId)=>{response[sqmId]=this.#sqmManager.inMemorySqms[sqmId].processRequest(request);});}#sendRequest(request){if(request.sqm_ids.length==0){return new Promise((resolve,reject)=>{resolve({})});}
return SQMRequest.send(request).then((sqmReadings)=>{if(!sqmReadings){sqmReadings={};}
request.sqm_ids.forEach((sqmId)=>{if(_.keys(this.#sqmManager.inMemorySqms).includes(sqmId)){sqmReadings[sqmId]=this.#sqmManager.inMemorySqms[sqmId].processRequest(request);}});_.keys(sqmReadings).forEach((sqmId)=>{if(sqmId!='type'){if((!sqmReadings[sqmId])||(!sqmReadings[sqmId].readings)){delete sqmReadings[sqmId];}}});return sqmReadings;});}#makeRequest(request,reinitialize=false,slide=false){SQMUserDisplay.showLoading();return this.#sendRequest(request).then((sqmReadings)=>{const type=sqmReadings.type;delete sqmReadings.type;if(reinitialize){this.#sqmChart.reinitialize();this.#sqmChart.setReadings(request,type,sqmReadings);}else{if(slide){this.#sqmChart.shiftReadings(request,type,sqmReadings);}else{this.#sqmChart.addToReadings(request,type,sqmReadings);}}
SQMUserDisplay.hideLoading();this.redraw();return sqmReadings;}).catch((error)=>{SQMUserDisplay.hideLoading();throw error;});}
redraw(){this.#sqmChart.redrawTimeChart();this.#sqmChart.redrawBarChart();}
updateSqmList(){this.#sqmChart.updateSqmList();}
clearCharts(){this.#sqmChart.clearCharts();}
removeReadings(sqmId){this.#sqmChart.removeReadings(sqmId);this.redraw();}
removeAllReadings(){this.#sqmChart.removeAllReadings();this.redraw();}
getColorManagers(){return this.#sqmChart.getColorManagers();}
showingWhich(){return this.#sqmChart.showingWhich();}}
class SQMDate{static#serverDate;static#serverDatetime;static#serverTime;static#serverMonth;static#controlsDate;static#controlsDatetime;static#controlsDatetimeNoSeconds;static#controls24hourTime;static#controlsMonth;static#filenameDate;static#filenameDatetime;static#titleDatetime;static#titleDate;static#titleMonth;static initialize(){SQMDate.#serverDate=sqmConfig.serverDatetimeFormats.date;SQMDate.#serverTime=sqmConfig.serverDatetimeFormats.time;SQMDate.#serverDatetime=sqmConfig.serverDatetimeFormats.datetime;SQMDate.#serverMonth=sqmConfig.serverDatetimeFormats.month;SQMDate.#controlsDate=sqmConfig.controlsDatetimeFormats.date;SQMDate.#controlsDatetime=sqmConfig.controlsDatetimeFormats.datetime;SQMDate.#controlsMonth=sqmConfig.controlsDatetimeFormats.month;SQMDate.#titleDate=sqmConfig.displayDatetimeFormats.date;SQMDate.#titleDatetime=sqmConfig.displayDatetimeFormats.datetime;SQMDate.#titleMonth=sqmConfig.displayDatetimeFormats.month;SQMDate.#filenameDatetime=sqmConfig.filenameDatetimeFormats.datetime;SQMDate.#filenameDate=sqmConfig.filenameDatetimeFormats.date;}
static user24hourTime(){return!(SQMDate.#controlsDatetime.includes('h'));}
static serverDatetimeFormat(){return SQMDate.#serverDatetime;}
static serverDateFormat(){return SQMDate.#serverDate;}
static controlsDatetimeNoSecondsFormat(){return SQMDate.#controlsDatetime.replace(':ss','').replace('-ss','').replace('ss','');}
static controlsDateFormat(){return SQMDate.#controlsDate;}
static formatServerDate(date){return dateFns.format(date,SQMDate.#serverDate);}
static formatServerDatetime(date){return dateFns.format(date,SQMDate.#serverDatetime);}
static formatServerMonth(date){return dateFns.format(date,SQMDate.#serverMonth);}
static serverToTitleDatetime(datetime){return dateFns.format(new Date(datetime),SQMDate.#titleDatetime);}
static parseServerMonth(string){return dateFns.parse(string,SQMDate.#serverMonth);}
static parseServerDatetime(string){return dateFns.parse(string,SQMDate.#serverDatetime,new Date());}
static fixtz(date,sqmId){if(sqmManager.availableSqmInfos[sqmId].time_zone_id){const newDate=new Date(date.toLocaleString('en-US',{timeZone:sqmManager.availableSqmInfos[sqmId].time_zone_id}));if(!isNaN(newDate)){return newDate;}}
const offset=sqmManager.getTimezoneOffset(sqmId,date);return dateFns.addMinutes(date,date.getTimezoneOffset()-offset);}
static fixtzoffset(date,offset){return dateFns.addMinutes(date,offset-date.getTimezoneOffset());}
static parseServerDate(string){return dateFns.parse(string,SQMDate.#serverDate,new Date());}
static formatControlsMonth(date){return dateFns.format(date,SQMDate.#controlsMonth);}
static formatTitleDatetime(date){return dateFns.format(date,SQMDate.#titleDatetime);}
static formatTitleDate(date){return dateFns.format(date,SQMDate.#titleDate);}
static formatTitleMonth(date){return dateFns.format(date,SQMDate.#titleMonth);}
static formatFilenameDate(date){return dateFns.format(date,SQMDate.#filenameDate);}
static formatFilenameDatetime(date){return dateFns.format(date,SQMDate.#filenameDatetime);}
static nightOf(dateObject){return dateFns.format(dateFns.addHours(dateObject,-12),SQMDate.#serverDate);}
static daysBetween(startDateStr,endDateStr){const startDate=SQMDate.parseServerDate(startDateStr);const endDate=SQMDate.parseServerDate(endDateStr);const dates=[];var date=startDate;while(date<=endDate){dates.push(SQMDate.formatServerDate(date));date=dateFns.addDays(date,1);}
return dates;}
static monthsBetween(earliestDatetime,latestDatetime=null){const lastDate=latestDatetime?SQMDate.parseServerDatetime(latestDatetime):new Date();const firstDayOfMonth=dateFns.setDate(SQMDate.parseServerDatetime(earliestDatetime),1);var months=[];var date=dateFns.addHours(lastDate,-12);while(date>=firstDayOfMonth){months.push(date);date=dateFns.addMonths(date,-1);}
return months;}
static daysInMonthOf(dateObject){var date=dateFns.setDate(dateObject,1);const nextMonth=dateFns.addMonths(date,1);const dates=[];while(date<nextMonth){dates.push(date);date=dateFns.addDays(date,1);}
return dates;}
static addMonths(month,num){return SQMDate.formatServerMonth(dateFns.addMonths(SQMDate.parseServerMonth(month),num));}}
const sqmDefaultConfig={userErrorMessage:"Something went wrong retrieving requested data, try reloading the page.",title:"SQM Visualizer",enabledSqms:true,showSqmsDropdown:null,initialQuery:'most recent',pollingInterval:2,latestPollingInterval:2,infoPollingInterval:15,loadInBackground:true,loadInBackgroundUnit:'month',showLegend:true,showKey:true,showBestReading:true,showLatestReading:false,showStats:false,showBinning:false,showLatitudeLongitude:false,defaultMinimumBound:13,minReadingsPerNight:40,badDataCutoff:10.0,twilightType:'civil',nightlyAxisDescending:true,bestReadingAxisDescening:false,showCloudyByDefault:true,showSunMoonCloudsByDefault:true,colorizeData:true,cloudyCutoff:0.04,cloudyMax:0.1,sunAltitudeCutoffs:[-12,-15,-18],moonAltitudeCutoffs:[-10,30],moonIlluminationCutoff:0.1,milkyWay:true,milkyWayCutoff:2.5,dataFilesLink:false,showAboutLink:false,showUserGuideLink:true,forceTicksFromData:false,hoverTextSun:true,hoverTextMoon:true,hoverTextR2:true,hoverTextMW:true,chartDateFormat:'yyyy-MM-dd',chartTimeFormat:'HH:mm',colorScheme:["#3e95cd","#7f7f7f","#e27c7c","#a86464","#6d4b4b","#503f3f","#333333","#3c4e4b","#466964","#599e94","#6cd4c5"],controlsDatetimeFormats:{datetime:'YYYY-MM-DD HH:mm',date:'YYYY-MM-DD',month:'MMM YYYY'},displayDatetimeFormats:{datetime:'h:mma D MMM YYYY',date:'D MMM YYYY',month:'MMM YYYY'},filenameDatetimeFormats:{datetime:'YYYYMMDDHHmmss',date:'YYYYMMDD'},fetchUrl:'sqm.php',serverDatetimeFormats:{date:'YYYY-MM-DD',time:'HH:mm:ss',datetime:'YYYY-MM-DD HH:mm:ss',month:'YYYY-MM'},debug:false}
class SQMFileLoader{static#readFile(file){return new Promise((resolve,reject)=>{var fileReader=new FileReader();fileReader.onload=()=>{resolve(fileReader.result)};fileReader.onerror=reject;return fileReader.readAsText(file);});}
static loadFiles(fileList){const files=_.values(fileList);return this.#loadFiles(files,"");}
static#loadFiles(files,theText){if(files.length==1){return SQMFileLoader.#readFile(files.pop()).then((text)=>{return text+theText;});}else{const nextFile=files.pop();return SQMFileLoader.#readFile(nextFile).then((text)=>{return SQMFileLoader.#loadFiles(files,text+theText);});}}
static parseCsvData(dataText){var delimiter="";const index=dataText.indexOf("# UTC");if(index>=0){const endIndex=dataText.indexOf('\n',index);const header=dataText.substring(index,endIndex+1).replace("# UTC","UTC").split(", ").join(";");dataText=header+dataText;delimiter=';';}
const parsed=Papa.parse(dataText,{delimiter:delimiter,header:false,dynamicTyping:true,comments:"#",skipEmptyLines:true});const headers=parsed.data.shift();return{headers:headers,data:parsed.data,errors:parsed.errors};}
static parseData(dataText){const parsed=SQMFileLoader.parseCsvData(dataText);if(sqmConfig.debug){if(parsed.errors.length>0){console.log("Errors parsing csv file");}
console.log(parsed);}
const indices={};_.keys(parsed.headers).forEach((key)=>{const header=parsed.headers[key].toLowerCase();if(header.includes("location")){indices.location=key;}
if(header.includes("local")){if(header.includes("date")){if(header.includes("time")){indices.datetime=key;}else{indices.date=key;}}else{if(header.includes("time")){indices.time=key;}}}else if(header.includes("utc")){if(header.includes("date")){if(header.includes("time")){indices.utcdatetime=key;}else{indices.utcdate=key;}}else{if(header.includes("time")){indices.utctime=key;}}}else if((header.includes("msas"))&&(!header.includes("msas_avg"))){indices.reading=key;}else if((header.includes("latitude"))||(header.includes("lat"))){if(!header.includes("galactic")){indices.latitude=key;}}else if((header.includes("longitude"))||(header.includes("long"))){if(!header.includes("galactic")){indices.longitude=key;}}else if((header.includes("elevation"))||(header.includes("elev"))){indices.elevation=key;}});if(!indices.reading){throw new Error("Could not parse data file");}
if((!indices.datetime)&&((!indices.date)||(!indices.time))){throw new Error("Could not parse data file");}
const name=SQMFileLoader.#valueFrom(dataText,"# SQM Name")||SQMFileLoader.#valueFrom(dataText,"# Name")||SQMFileLoader.#valueFrom(dataText,"# Data supplier")||SQMFileLoader.#valueFrom(dataText,"# Location name")||(indices.location&&parsed.data[0][indices.location]);const position={};if((indices.latitude!=null)&&(indices.longitude!=null)){position.latitude=parsed.data[0][indices.latitude];position.longitude=parsed.data[0][indices.longitude];if(indices.elevation!=null){position.elevation=parsed.data[0][indices.elevation];}}else{const index=dataText.indexOf("Position");const colonIndex=dataText.indexOf(":",index);const endIndex=dataText.indexOf("\n",colonIndex);const string=dataText.substring(colonIndex+1,endIndex).trim();var parts=string.split(", ");if(parts.length<2){parts=string.split(",");}
if(parts.length<2){parts=string.split(";");}
if(parts.length>=2){position.latitude=parseFloat(parts[0]);position.longitude=parseFloat(parts[1]);if(parts.length>2){position.elevation=parseFloat(parts[3]);}}}
const dataByDate={};const rawByDate={};if(indices.datetime){parsed.data.forEach((dataEntry)=>{const datetime=Date.parse(dataEntry[indices.datetime]);const datetimeStr=SQMDate.formatServerDatetime(datetime);const night=SQMDate.nightOf(datetime);if(!dataByDate[night]){dataByDate[night]={};rawByDate[night]={};}
dataByDate[night][datetimeStr]=dataEntry[indices.reading];rawByDate[night][datetimeStr]={};_.keys(parsed.headers).forEach((key)=>{rawByDate[night][datetimeStr][parsed.headers[key]]=dataEntry[key];});});}else{parsed.data.forEach((dataEntry)=>{const datetime=Date.parse(dataEntry[indices.date]+" "+dataEntry[indices.time]);const datetimeStr=SQMDate.formatServerDatetime(datetime);const night=SQMDate.nightOf(datetime);if(!dataByDate[night]){dataByDate[night]={};rawByDate[night]={};}
dataByDate[night][datetimeStr]=dataEntry[indices.reading];rawByDate[night][datetimeStr]={};_.keys(parsed.headers).forEach((key)=>{rawByDate[night][datetimeStr][parsed.headers[key]]=dataEntry[key];});});}
return{name:name,data:dataByDate,raw:rawByDate,position:position};}
static#valueFrom(dataText,string){const index=dataText.indexOf(string);if(index>=0){const colonIndex=dataText.indexOf(":",index);const endIndex=dataText.indexOf("\n",colonIndex);return dataText.substring(colonIndex+1,endIndex).trim();}else{return null;}}}
class SQMImagePopup{static#registered;static initialize(){SQMImagePopup.#registered=[];$('imagepopup').addEventListener('click',(event)=>{SQMImagePopup.hideImage();});$('imagebackground').addEventListener('click',(event)=>{SQMImagePopup.hideImage();});$('theimage').addEventListener('click',(event)=>{SQMImagePopup.inNewTab();SQMImagePopup.hideImage();});}
static register(div){SQMImagePopup.#registered[div]=div.addEventListener('click',(event)=>{SQMImagePopup.showImage();});}
static unregister(div){delete SQMImagePopup.#registered[div];}
static#image;static setImage(image,text,fullImage){SQMImagePopup.#image=fullImage;$('theimage').src=image;$('theimagetext').innerHTML=text;}
static showImage(){const body=document.body,html=document.documentElement;const height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);$('imagepopup').style.height=height+"px";$('imagepopup').style.display='block';}
static hideImage(){SQMImagePopup.#image=null;$('theimage').src="";$('theimagetext').innerHTML="";$('imagepopup').style.display='none';}
static inNewTab(){const w=window.open();w.location=SQMImagePopup.#image;}}
class SQMLoadInBackground{#dailyReadings;#bestReadings;#hasBestReadings;#readingsRange;#interval;#filterSqmIds(sqmIds,readings){if(readings&&sqmIds){const response={};sqmIds.forEach((sqmId)=>{response[sqmId]=readings[sqmId];});return response;}
return readings;}
handleRequest(request){var response;switch(request.type){case'readings_range':response=this.#filterSqmIds(request.sqm_ids,this.#readingsRange);if(response){response.type='readings_range';}
return response;case'daily':response=this.#filterSqmIds(request.sqm_ids,this.#dailyReadings[request.date]);if(response){response.type='all_readings';}
return response;case'nightly':const sunsetSunrises=SQMSunUtils.sunsetSunrisesForNight(request.date,sqmManager.sqmInfosFor(request.sqm_ids));const allReadings={};var hasReadings=true;request.sqm_ids.forEach((sqmId)=>{const readings=this.#allReadings(sunsetSunrises[sqmId].sunset,sunsetSunrises[sqmId].sunrise,[sqmId]);if(readings){allReadings[sqmId]=readings[sqmId];}else{hasReadings=false;}});if(!hasReadings){return false;}
allReadings.type='all_readings';return allReadings;case'best_nightly_readings':if(this.#hasBestReadings){return this.#bestReadingsInRange(request.start,request.end,this.#filterSqmIds(request.sqm_ids,this.#bestReadings));}
return false;case'all_readings':return this.#allReadings(request.start,request.end,request.sqm_ids);}
return false;}#bestReadingsInRange(start,end,readings){const response={};_.keys(readings).forEach((sqmId)=>{response[sqmId]=this.#bestReadingsForSqm(start,end,readings[sqmId]);});response.type='best_nightly_readings';return response;}#bestReadingsForSqm(start,end,readings){const startDatetime=(start==null?readings.startDatetime:start);const endDatetime=(end==null?readings.endDatetime:end);const startDate=SQMDate.formatServerDate(startDatetime);const endDate=SQMDate.formatServerDate(endDatetime);const response={type:readings.type,startDatetime:startDatetime,endDatetime:endDatetime,readings:{}};_.keys(readings.readings).forEach((datetime)=>{if((readings.readings[datetime].date>=startDate)&&(readings.readings[datetime].date<=endDate)){response.readings[datetime]=SQMLoadInBackground.#duplicate(readings.readings[datetime]);}});response.type='best_nightly_readings';return response;}
static#duplicate(reading){return JSON.parse(JSON.stringify(reading));}#allReadings(start,end,sqmIds){const startDate=SQMDate.nightOf(SQMDate.parseServerDatetime(start));const endDate=SQMDate.nightOf(SQMDate.parseServerDatetime(end));if((this.#dailyReadings[startDate])&&(this.#dailyReadings[endDate])){const response={};sqmIds.forEach((sqmId)=>{response[sqmId]={type:'all_readings',startDatetime:start,endDatetime:end,readings:{}};});SQMDate.daysBetween(startDate,endDate).map((date)=>{sqmIds.forEach((sqmId)=>{_.keys(this.#dailyReadings[date][sqmId].readings).forEach((datetime)=>{if((start<=datetime)&&(end>=datetime)){response[sqmId].readings[datetime]=SQMLoadInBackground.#duplicate(this.#dailyReadings[date][sqmId].readings[datetime]);}});});});response.type='all_readings';return response;}
return false;}#makeBestQuery(){if(sqmConfig.debug){console.log("Background loading best");}
const queries={best:{type:'best_nightly_readings'}};if(!this.#isDestroyed){return sqmManager.backgroundRequest({queries:queries}).then((response)=>{this.#bestReadings=response.best;this.#hasBestReadings=true;if(sqmConfig.debug){console.log("Background loaded best");}});}else{return new Promise((resolve,reject)=>{resolve()});}}#queryDay(dateStr){if(!this.#isDestroyed){return sqmManager.backgroundRequest({type:'daily',date:dateStr}).then((response)=>{this.#dailyReadings[dateString]=response;});}else{return new Promise((resolve,reject)=>{resolve()});}}#queryBlockByDay(dateStrings){var chain=Promise.resolve();dateStrings.forEach((dateString)=>{chain=chain.then(()=>this.#queryDay(dateString));});return chain;}#queryBlock(month){if(sqmConfig.debug){console.log("Background loading for month "+month);}
const dates=SQMDate.daysInMonthOf(month);const dateStrings=dates.map((date)=>SQMDate.formatServerDate(date));if(sqmConfig.loadInBackgroundUnit=='day'){return this.#queryBlockByDay(dateStrings);}
const queries={};dateStrings.forEach((dateString)=>{queries[dateString]={type:'daily',date:dateString};});if(!this.#isDestroyed){return sqmManager.backgroundRequest({queries:queries}).then((response)=>{if(sqmConfig.debug){console.log("Background loaded month "+month);}
dateStrings.map((dateString)=>{this.#dailyReadings[dateString]=response[dateString];});});}else{return new Promise((resolve,reject)=>{resolve()});}}#createPromiseChain(months){const startingTime=new Date();if(sqmConfig.debug){console.log("Background loading beginning");}
var chain=Promise.resolve();chain=chain.then(()=>this.#makeBestQuery());months.forEach((month)=>{chain=chain.then(()=>this.#queryBlock(month));});chain=chain.then(()=>{if(sqmConfig.debug){console.log("Background loading complete");const endingTime=new Date();const seconds=(endingTime-startingTime)/1000;console.log(seconds+" seconds");}
if(!this.#isDestroyed){this.#startPolling();}});return chain;}#isDestroyed;constructor(earliestDatetime){this.#dailyReadings={};this.#bestReadings={};this.#hasBestReadings=false;this.#readingsRange=false;this.#isDestroyed=false;const months=SQMDate.monthsBetween(earliestDatetime,SQMDate.formatServerDatetime(new Date()));SQMRequest.setBackgroundLoader(this);this.#createPromiseChain(months).catch((error)=>{SQMManager.silentErrorHandler(error,"Something went wrong with background loading");});}#startPolling(){this.#stopPolling();this.#interval=setInterval(SQMLoadInBackground.staticCheckForNewReadings.bind(null,this),Math.round(sqmConfig.pollingInterval*0.9));}#stopPolling(){if(this.#interval){clearInterval(this.#interval);}}
static staticCheckForNewReadings(instance){if(instance){instance.checkForNewReadings();}}
destroy(){this.#stopPolling();this.#isDestroyed=true;}
checkForNewReadings(){if(sqmConfig.debug){console.log("Checking for new readings");}
const dateObject=new Date();const today=SQMDate.nightOf(dateObject);const request={queries:{readingsRange:{type:'readings_range'},today:{type:'daily',date:today},best:{type:'best_nightly_readings'}}};sqmManager.backgroundRequest(request).then((response)=>{this.#readingsRange=response.readingsRange;this.#bestReadings=response.best;this.#dailyReadings[today]=response.today;}).catch((error)=>{SQMManager.silentErrorHandler(error,"Something went wrong checking for new readings");});}}
class SQMManager{availableSqmInfos;inMemorySqms;#selectedSqms;#initialActivatedSqms;#earliestDatetimes;#latestDatetimes;#latestReadings;#sqmDataRequester;#defaultSqms;#backgroundLoader;constructor(defaultSqms){this.availableSqmInfos={};this.inMemorySqms={};this.#selectedSqms=[];this.#initialActivatedSqms=[];this.#defaultSqms=defaultSqms;this.#earliestDatetimes={};this.#latestDatetimes={};this.#latestReadings={};}
defaultSqms(){return this.#defaultSqms;}
initialActivatedSqms(){return this.#initialActivatedSqms;}
userRequest(request,titleStringCallback,slide=false){return this.#sqmDataRequester.userRequest(request,titleStringCallback,slide).catch((error)=>{if(sqmConfig.debug){console.log("Error processing request");console.log(request);console.log(error);}
this.#sqmDataRequester.clearCharts();SQMManager.errorHandler(error,"Could not retrieve requested data. If this persists, try reloading the page.");});}
backgroundRequest(request){return SQMRequest.sendBlocking(request).then((sqmReadings)=>{this.#sqmDataRequester.addFromInMemory(request,sqmReadings);return sqmReadings;});}
directRequest(request){return SQMRequest.send(request,true).then((sqmReadings)=>{this.#sqmDataRequester.addFromInMemory(request,sqmReadings);return sqmReadings;});}
initialize(){this.#sqmDataRequester=new SQMDataRequester(this,'timechart','barchart');SQMDate.initialize();SQMUserInputs.initialize();SQMUserDisplay.initialize();SQMUserRequest.addEventListeners();SQMBrowserHistory.initialize();SQMImagePopup.initialize();SQMChartColorManager.colorKey();SQMRequest.send({queries:{info:{type:'info'},readings_range:{type:'readings_range'}}}).then((responses)=>{if(!responses){responses={info:{type:'info'},readings_range:{type:'readings_range'}};}
if((!_.keys(responses).includes('info'))||(responses.info.type!='info')){throw new SQMError("Bad response type loading SQM info",["Response to info and readings range request was ",responses]);}
delete responses.info.type;this.availableSqmInfos={};this.#defaultSqms.forEach((sqmId)=>{if(_.keys(responses.info).includes(sqmId)){this.#selectedSqms.push(sqmId);this.#initialActivatedSqms.push(sqmId);this.availableSqmInfos[sqmId]=responses.info[sqmId];}});_.keys(responses.info).forEach((sqmId)=>{if(!_.keys(this.availableSqmInfos).includes(sqmId)){this.availableSqmInfos[sqmId]=responses.info[sqmId];if((sqmConfig.enabledSqms===true)||(sqmConfig.enabledSqms.includes(sqmId))){this.#selectedSqms.push(sqmId);}}});if((_.keys(this.#selectedSqms).length==0)&&(_.keys(this.availableSqmInfos).length>0)){const anSqmId=_.keys(this.availableSqmInfos).find((sqmId)=>sqmId!=undefined);this.#selectedSqms.push(anSqmId);}
if(_.keys(this.#initialActivatedSqms).length==0){this.#selectedSqms.forEach((sqmId)=>{this.#initialActivatedSqms.push(sqmId);});}
SQMUserInputs.rebuildMultiselect(this);this.#sqmDataRequester.updateSqmList();this.#computeEarliestAndLatest(responses.readings_range);SQMUserInputs.setAvailableMonthsFrom(_.min(_.values(this.#earliestDatetimes)),_.max(_.values(this.#latestDatetimes)));if((sqmConfig.latestPollingInterval)&&(sqmConfig.latestPollingInterval>0)){setInterval(()=>{sqmManager.updateEarliestLatest();},sqmConfig.latestPollingInterval);}
if((sqmConfig.infoPollingInterval)&&(sqmConfig.infoPollingInterval>0)){setInterval(()=>{sqmManager.updateSqmInfos();},sqmConfig.infoPollingInterval);}
SQMUserDisplay.hideCover();if(this.#selectedSqms.length>0){const fromUrl=SQMBrowserHistory.fromUrl();if(fromUrl){SQMBrowserHistory.fromState(fromUrl).then(()=>{this.#makeBackgroundLoader();});}else{this.initialQuery().then(()=>{this.#makeBackgroundLoader();});}}else{SQMUserDisplay.hideLoading();SQMUserDisplay.showInitialFileInput();}}).catch((error)=>{SQMManager.errorHandler(error,"Something went wrong fetching SQM info from server");});}#makeBackgroundLoader(){if(!sqmConfig.loadInBackground){return;}
if(this.#backgroundLoader){this.#backgroundLoader.destroy();}
this.#backgroundLoader=new SQMLoadInBackground(_.min(_.values(this.#earliestDatetimes)));}
mostRecentDatetime(){if(_.keys(this.activeSqmIds()).length>0){return _.max(this.activeSqmIds().map((sqmId)=>this.#latestDatetimes[sqmId]));}else{return new Date();}}
earliestDatetime(){if(_.keys(this.activeSqmIds()).length>0){return _.min(this.activeSqmIds().map((sqmId)=>this.#earliestDatetimes[sqmId]));}else{return new Date();}}
initialQuery(){switch(sqmConfig.initialQuery){case'most recent':return SQMUserRequest.nightFor(this.mostRecentDatetime());break;case'tonight':return SQMUserRequest.nightFor();break;case'six months':return SQMUserRequest.sixMonthsBeforeDate(this.mostRecentDatetime());break;case'all time':return SQMUserRequest.allTime();break;}}
updateEarliestLatest(){return SQMRequest.send({type:'readings_range'}).then((responses)=>{_.keys(this.inMemorySqms).forEach((sqmId)=>{responses[sqmId]=this.inMemorySqms[sqmId].readingsRange();});this.#computeEarliestAndLatest(responses);SQMUserInputs.setAvailableMonthsFrom(_.min(_.values(this.#earliestDatetimes)),_.max(_.values(this.#latestDatetimes)));return responses;}).catch((error)=>{SQMManager.silentErrorHandler(error,"Something went wrong fetching reading range info");});}
updateSqmInfos(){return SQMRequest.send({type:'info'}).then((responses)=>{_.keys(this.inMemorySqms).forEach((sqmId)=>{responses[sqmId]=this.inMemorySqms[sqmId].sqmInfo();});this.#reloadSqmInfos(responses);return responses;}).catch((error)=>{SQMManager.silentErrorHandler(error,"Something went wrong fetching SQM info");});}#reloadSqmInfos(sqmResponses){if(sqmResponses.type!='info'){throw new SQMError("Bad response type loading SQM info",["responses.info was",sqmResponses]);}
delete sqmResponses.type;var sqmListChanged=false;_.keys(this.availableSqmInfos).forEach((sqmId)=>{if((!_.keys(sqmResponses).includes(sqmId))&&(!_.keys(this.inMemorySqms).includes(sqmId))){delete this.availableSqmInfos[sqmId];sqmListChanged=true;}});_.keys(sqmResponses).forEach((sqmId)=>{if((!_.keys(this.availableSqmInfos).includes(sqmId))||(sqmResponses[sqmId].name!=this.availableSqmInfos[sqmId].name)){sqmListChanged=true;}
this.availableSqmInfos[sqmId]=sqmResponses[sqmId];});if(sqmListChanged){SQMUserInputs.rebuildMultiselect(this);this.#sqmDataRequester.updateSqmList();this.#makeBackgroundLoader();}}
createInMemorySqm(fileList,addData=true){const sqmId=_.keys(this.inMemorySqms).length==0?"Uploaded":"Uploaded "+(_.keys(this.inMemorySqms).length+1);const sqmInMemory=new SQMDataInMemory(sqmId);return sqmInMemory.constructFrom(fileList).then(()=>{this.inMemorySqms[sqmId]=sqmInMemory;this.#makeBackgroundLoader();this.availableSqmInfos[sqmId]=this.inMemorySqms[sqmId].sqmInfo();this.#earliestDatetimes[sqmId]=this.inMemorySqms[sqmId].earliestDatetime();this.#latestDatetimes[sqmId]=this.inMemorySqms[sqmId].latestDatetime();this.#latestReadings[sqmId]=this.inMemorySqms[sqmId].latestReading().reading;SQMUserInputs.setAvailableMonthsFrom(_.min(_.values(this.#earliestDatetimes)),_.max(_.values(this.#latestDatetimes)));this.#selectedSqms.push(sqmId);this.#sqmDataRequester.activateSqmId(sqmId);if(addData){this.#sqmDataRequester.addDataRequest([sqmId]);}
SQMUserInputs.rebuildMultiselect(this);this.#sqmDataRequester.updateSqmList();return sqmId;});}
activateSqmId(sqmId){this.#sqmDataRequester.activateSqmId(sqmId);}#computeEarliestAndLatest(sqmResponses){if(sqmResponses.type!='readings_range'){SQMManager.silentErrorHandler(new SQMError("Bad response type loading readings range",["responses was",sqmResponses]),"Warning: something went wrong computing earliest and latest");return;}
delete sqmResponses.type;_.keys(sqmResponses).forEach((sqmId)=>{this.#earliestDatetimes[sqmId]=sqmResponses[sqmId].startDatetime;this.#latestDatetimes[sqmId]=sqmResponses[sqmId].endDatetime;this.#latestReadings[sqmId]=sqmResponses[sqmId].readings[this.#latestDatetimes[sqmId]].reading;});this.updateLatest();}
updateLatest(){const latestDatetimeId=this.activeSqmIds().length==0?null:this.activeSqmIds().reduce((latest,current)=>this.#latestDatetimes[latest]>this.#latestDatetimes[current]?latest:current);if(latestDatetimeId){SQMUserDisplay.setLatestReading({sqmId:latestDatetimeId,datetime:this.#latestDatetimes[latestDatetimeId],value:this.#latestReadings[latestDatetimeId]},this.activeSqmIds().length>1);}else{SQMUserDisplay.setLatestReading(null);}}
activeSqmIds(){return this.#sqmDataRequester.activeSqmIds();}
selectedSqmIds(){return this.#selectedSqms;}
sqmInfosFor(sqmIds){const result={};sqmIds.forEach((sqmId)=>{result[sqmId]=this.availableSqmInfos[sqmId];});return result;}
select(sqmId){this.#selectedSqms.push(sqmId);this.#sqmDataRequester.addDataRequest([sqmId]).then(this.#sqmDataRequester.activateSqmId(sqmId)).catch((error)=>{if(sqmConfig.debug){console.log("Error requesting data for sqmId "+sqmId+": ");console.log(error);}
SQMManager.errorHandler(error,"Could not retrieve data for selected SQM");});}
deselect(sqmId){this.#sqmDataRequester.deactivateSqmId(sqmId);this.#selectedSqms.splice(this.#selectedSqms.indexOf(sqmId),1);this.#sqmDataRequester.removeReadings(sqmId);}
selectAll(){this.#sqmDataRequester.addDataRequest(_.keys(this.availableSqmInfos).filter((sqmId)=>!this.#selectedSqms.includes(sqmId))).then((sqmResponses)=>{this.#selectedSqms=_.keys(this.availableSqmInfos);}).catch((error)=>{if(sqmConfig.debug){console.log("Error requesting data for all sqmIds: ");console.log(error);}
SQMManager.errorHandler(error,"Could not retrieve data for selected SQM");});}
deselectAll(){this.activeSqmIds().forEach((sqmId)=>{this.#sqmDataRequester.deactivateSqmId(sqmId);});this.#selectedSqms=[];this.#sqmDataRequester.removeAllReadings();}
setReadingsType(readingsType){SQMUserInputs.setReadingsType(readingsType);}
getColorManagers(){return this.#sqmDataRequester.getColorManagers();}
showingWhich(){return this.#sqmDataRequester.showingWhich();}
static errorHandler(error,message){SQMManager.silentErrorHandler(error,message);alert(sqmConfig.userErrorMessage);}
static silentErrorHandler(error,message){if(sqmConfig.debug){console.log(message);console.log("Error was");console.log(error);if(sqmManager){console.log("sqmManager is");console.log(sqmManager);}else{console.log("<invalid SQMManager object>");}
if(error.debugObjects){console.log("Additional info");error.debugObjects.forEach((object)=>{console.log(object);});}}}#getTZOffset(timeZone){const str=new Date().toLocaleString('en',{timeZone,timeZoneName:'longOffset'});const[_,h,m]=str.match(/([+-]\d+):(\d+)$/)||[,'+00','00'];return-(h*60+(h>0?+m:-m));}
getTimezoneOffset(sqmId,date){if(this.availableSqmInfos[sqmId].time_zone_id){return this.#getTZOffset(this.availableSqmInfos[sqmId].time_zone_id);}else{return this.inMemorySqms[sqmId].getTimezoneOffset(date);}}}
class SQMError extends Error{debugObjects;constructor(message,listOfDebugObjects){super(message);this.debugObjects=listOfDebugObjects;}}
class SQMReadings{readings;#type;#sqmId;startDatetime;endDatetime;latestDatetime;#canFilter;#filteredR2;#filteredSMC;constructor(sqmId,response,type){this.#sqmId=sqmId;this.readings=response.readings;this.#type=type;this.#computeTimes(response);this.readings=this.#cleanseReadings(this.readings,this.#type);this.#computeFiltered();this.#addSunMoonInfo(this.readings,sqmManager.availableSqmInfos[sqmId].latitude,sqmManager.availableSqmInfos[sqmId].longitude);this.#filterReadings();}#computeFiltered(){this.#canFilter=this.#canFilterClouds(this.readings);if(!this.#canFilter){this.#pullInRawR2();}
this.#canFilter=this.#canFilterClouds(this.readings);if(this.#canFilter){this.#fixMeanR2(this.readings,this.#type);}
this.#addDatetimeAttributes(this.readings);}#filterReadings(){const filtered=this.#filter(this.readings);this.#filteredR2=filtered.R2;this.#filteredSMC=filtered.SMC;this.#addSunMoonInfo(this.#filteredR2,sqmManager.availableSqmInfos[this.#sqmId].latitude,sqmManager.availableSqmInfos[this.#sqmId].longitude,sqmManager.availableSqmInfos[this.#sqmId].time_zone_id);this.#addSunMoonInfo(this.#filteredSMC,sqmManager.availableSqmInfos[this.#sqmId].latitude,sqmManager.availableSqmInfos[this.#sqmId].longitude,sqmManager.availableSqmInfos[this.#sqmId].time_zone_id);this.#addDatetimeAttributes(this.#filteredR2);this.#addDatetimeAttributes(this.#filteredSMC);}#computeTimes(response){const datetimes=_.keys(response.readings);if(datetimes.length>0){this.latestDatetime=_.max(datetimes);this.startDatetime=response.startDatetime||_.min(datetimes);this.endDatetime=response.endDatetime||this.latestDatetime;}else{this.latestDatetime=null;this.startDatetime=response.startDatetime;this.endDatetime=response.endDatetime;}}
addReadingsTo(newReadings){_.keys(newReadings.readings).forEach((datetime)=>{this.readings[datetime]=newReadings.readings[datetime];});this.#computeTimes(newReadings);this.#computeFiltered();this.#filterReadings();}#cleanseReadings(readings,type){const cleansed={};if(sqmConfig.badDataCutoff){_.keys(readings).forEach((datetime)=>{if(readings[datetime].reading>=sqmConfig.badDataCutoff){cleansed[datetime]=readings[datetime];}});}else{cleansed=readings;}
if((type=='best_nightly_readings')&&sqmConfig.minReadingsPerNight){const cleansed2={};_.keys(cleansed).forEach((datetime)=>{if(readings[datetime].number_of_readings>=sqmConfig.minReadingsPerNight){cleansed2[datetime]=cleansed[datetime];}});return cleansed2;}
return cleansed;}#pullInRawR2(){const aReading=_.values(this.readings).find((reading)=>reading!=null);if(aReading&&aReading.raw&&aReading.raw.ResidStdErr){_.keys(this.readings).forEach((datetime)=>{if(!isNaN(this.readings[datetime].raw.ResidStdErr)){this.readings[datetime].mean_r_squared=this.readings[datetime].raw.ResidStdErr/1000;}});}}#fixMeanR2(readings,type){if(type=='all_readings'){const allDatetimes=_.keys(readings);SQMDate.daysBetween(SQMDate.nightOf(this.startDatetime),SQMDate.nightOf(this.endDatetime)).forEach((dateStr)=>{const dateObj=SQMDate.parseServerDate(dateStr);dateObj.setHours(12,0,0,0);const thisDatetime=SQMDate.formatServerDatetime(dateObj);const nextDatetime=SQMDate.formatServerDatetime(dateFns.addDays(dateObj,1));const datetimes=allDatetimes.filter((datetime)=>(datetime>=thisDatetime)&&(datetime<nextDatetime));const firstNonNullIndex=datetimes.find((datetime)=>readings[datetime].mean_r_squared!=null);if(firstNonNullIndex){const firstNonNullR2=readings[firstNonNullIndex].mean_r_squared;const lastNonNullIndex=datetimes.toReversed().find((datetime)=>readings[datetime].mean_r_squared!=null);const lastNonNullR2=readings[lastNonNullIndex].mean_r_squared;datetimes.forEach((datetime)=>{if(datetime<firstNonNullIndex){readings[datetime].mean_r_squared=firstNonNullR2;readings[datetime].mean_r_squared_copied=true;}
if(datetime>lastNonNullIndex){readings[datetime].mean_r_squared=lastNonNullR2;readings[datetime].mean_r_squared_copied=true;}});}});}}#addSunMoonInfo(readings,latitude,longitude){_.keys(readings).forEach((datetime)=>{const date=SQMDate.fixtzoffset(SQMDate.parseServerDatetime(datetime),SQMReadings.#tzOffset(readings[datetime]));if(!readings[datetime].sun_position){readings[datetime].sun_position=SQMSunMoonMWClouds.sunPosition(date,latitude,longitude);}
if(!readings[datetime].moon_position){readings[datetime].moon_position=SQMSunMoonMWClouds.moonPosition(date,latitude,longitude);}
if(!readings[datetime].moon_illumination){readings[datetime].moon_illumination=SQMSunMoonMWClouds.moonIllumination(date,latitude,longitude);}});if(sqmConfig.milkyWay){_.keys(readings).forEach((datetime)=>{if(!readings[datetime].galatic_latitude){const galactic=SQMSunMoonMWClouds.milkyWay(readings[datetime],latitude,longitude);if(galactic){readings[datetime].galactic_latitude=galactic.latitude;readings[datetime].galactic_longitude=galactic.longitude;}}});}}#addDatetimeAttributes(readings){_.keys(readings).forEach((datetime)=>{if(!readings[datetime].datetime){readings[datetime].datetime=datetime;}});}#canFilterClouds(readings){return _.values(readings).some((reading)=>reading.mean_r_squared!==undefined);}#filter(readings){const filteredR2={};if(this.#canFilter){_.keys(readings).forEach((datetime)=>{if(readings[datetime].mean_r_squared<=sqmConfig.cloudyCutoff){filteredR2[datetime]=readings[datetime];}else{if(readings[datetime].filtered_mean_r_squared){filteredR2[readings[datetime].filtered_mean_r_squared.datetime]=readings[datetime].filtered_mean_r_squared;}}});}
const filteredSMC=this.#filterSMC(_.keys(filteredR2).length>0?filteredR2:readings);return{R2:filteredR2,SMC:filteredSMC};}#filterSMC(readings){const filteredSMC={};_.keys(readings).forEach((datetime)=>{var filter=false;if(sqmConfig.milkyWay&&Math.abs(readings[datetime].galactic_latitude)<=sqmConfig.milkyWayCutoff){filter=true;}
if(readings[datetime].sun_position.altitude*180/Math.PI>=sqmConfig.sunAltitudeCutoffs[2]){filter=true;}
const moonValue=readings[datetime].moon_illumination.fraction*(Math.min(readings[datetime].moon_position.altitude,sqmConfig.moonAltitudeCutoffs[1])
-sqmConfig.moonAltitudeCutoffs[0])/(sqmConfig.moonAltitudeCutoffs[1]-sqmConfig.moonAltitudeCutoffs[0]);if(moonValue>=sqmConfig.moonIlluminationCutoff){filter=true;}
if(!filter){filteredSMC[datetime]=readings[datetime];}else{if(readings[datetime].filtered_sun_moon_clouds){filteredSMC[readings[datetime].filtered_sun_moon_clouds.datetime]=readings[datetime].filtered_sun_moon_clouds;}}});return filteredSMC;}
allReadings(){return this.readings;}
noCloudyReadings(){return this.#filteredR2;}
noSunMoonCloudsReadings(){return this.#filteredSMC;}
canFilterClouds(){return this.#canFilter;}
canFilterSunMoonClouds(){return true;}
reading(datetime){if(this.readings[datetime]){return this.readings[datetime];}
if(this.#filteredR2[datetime]){return this.#filteredR2[datetime];}
if(this.#filteredSMC[datetime]){return this.#filteredSMC[datetime];}
return{};}
static#tzOffset(reading){const utcDate=SQMReadings.utcDate(reading.raw);if(utcDate){const date=SQMDate.parseServerDatetime(reading.datetime);return dateFns.differenceInMinutes(utcDate,date);}else{return(new Date(reading.datetime)).getTimezoneOffset();}}
static utcDate(rawreading){if(!rawreading){return null;}
if(rawreading["utc date & time"]){return new Date(Date.parse(rawreading["utc date & time"]));}
if(rawreading["UTC Date & Time"]){return new Date(Date.parse(rawreading["UTC Date & Time"]));}
if(rawreading.UTC_Date&&rawreading.UTC_Time){return dateFns.parse(rawreading.UTC_Date+" "+rawreading.UTC_Time,'YYYY-MM-DD HH:mm:ss',new Date());}
return null;}}
class SQMReadingsSet{#readings;constructor(response,type){this.#readings={};_.keys(response).forEach((sqmId)=>{this.#readings[sqmId]=new SQMReadings(sqmId,response[sqmId],type);});}
sqmIds(){return _.keys(this.#readings);}
get(sqmId){return this.#readings[sqmId];}
remove(sqmId){delete this.#readings[sqmId];}
add(newReadingsSet){const newSqmIds=[];newReadingsSet.sqmIds().forEach((sqmId)=>{if(this.#readings[sqmId]&&newReadingsSet.get(sqmId)){this.#readings[sqmId].addReadingsTo(newReadingsSet.get(sqmId));}else{if(newReadingsSet.get(sqmId)){this.#readings[sqmId]=newReadingsSet.get(sqmId);newSqmIds.push(sqmId);}}});return newSqmIds;}
allReadings(){return _.mapObject(this.#readings,(readings,sqmId)=>readings.allReadings());}
noCloudyReadings(){return _.mapObject(this.#readings,(readings,sqmId)=>readings.noCloudyReadings());}
noSunMoonCloudsReadings(){return _.mapObject(this.#readings,(readings,sqmId)=>readings.noSunMoonCloudsReadings());}#readingsFor(sqmIds){const result={};sqmIds.forEach((sqmId)=>{result[sqmId]=this.get(sqmId);});return result;}
startDatetime(sqmIds){return _.min(_.values(this.#readingsFor(sqmIds)).map((readings)=>readings.startDatetime));}
endDatetime(sqmIds){return _.max(_.values(this.#readingsFor(sqmIds)).map((readings)=>readings.endDatetime));}
latestDatetime(sqmIds){return _.max(_.values(this.#readingsFor(sqmIds)).map((readings)=>readings.latestDatetime));}
latestReading(sqmIds){if(sqmIds.length==0){return null;}
const sqmId=sqmIds.reduce((latestId,currentId)=>this.#readings[latestId].latestDatetime>this.#readings[currentId].latestDatetime?latestId:currentId);return{sqmId:sqmId,datetime:this.#readings[sqmId].latestDatetime,value:this.#readings[sqmId].readings[this.#readings[sqmId].latestDatetime].reading};}#bestReadingFrom(sqmId){const datetimes=_.keys(this.#readings[sqmId].readings);if(datetimes.length==0){return null;}
const bestDatetime=datetimes.reduce((bestSoFar,current)=>this.#readings[sqmId].readings[bestSoFar].reading>this.#readings[sqmId].readings[current].reading?bestSoFar:current);return{sqmId:sqmId,datetime:bestDatetime,value:this.#readings[sqmId].readings[bestDatetime].reading};}
bestReadings(sqmIds){const result={};sqmIds.forEach((sqmId)=>{result[sqmId]=this.#bestReadingFrom(sqmId);});return result;}
bestReading(sqmIds){const bestReadings=this.bestReadings(sqmIds);sqmIds=_.keys(bestReadings).filter((sqmId)=>bestReadings[sqmId]!=null);if(sqmIds.length==0){return null;}
const bestSqmId=sqmIds.reduce((soFar,current)=>bestReadings[soFar].value>bestReadings[current].value?soFar:current);return bestReadings[bestSqmId];}#statsFor(sqmId){const values=_.keys(this.#readings[sqmId].readings).map((datetime)=>this.#readings[sqmId].readings[datetime].reading);return{mean:SQMReadingsSet.#mean(values),median:SQMReadingsSet.#median(values),number:values.length};}
static#mean(values){return _.values(values).reduce((sum,value)=>sum+value,0)/_.values(values).length;}
static#median(values){const sorted=values.toSorted();const middle=Math.floor(sorted.length/2);return(sorted.length%2===1)?sorted[middle]:(sorted[middle-1]+sorted[middle])/2;}
stats(sqmIds){const bestReadings=this.bestReadings(sqmIds);_.keys(bestReadings).forEach((sqmId)=>{if(!bestReadings[sqmId]){delete bestReadings[sqmId];}});if(_.keys(bestReadings).length==0){return{};}
return _.mapObject(bestReadings,(readings,sqmId)=>{const stats=this.#statsFor(sqmId);stats.best=bestReadings[sqmId];return stats;});}}
class SQMRequest{static#preloadedRequests={};static#backgroundLoader;static send(request,allowBackground=true){return SQMRequest.#send(request,allowBackground,false);}
static sendBlocking(request){return SQMRequest.#send(request,false,true);}
static#send(request,allowBackground,blocking){if(SQMRequest.#backgroundLoader&&allowBackground){const backgroundLoaded=SQMRequest.#backgroundLoader.handleRequest(request);if(backgroundLoaded){if(sqmConfig.debug){console.log("Background loaded request");console.log(request);console.log("Background loaded response");console.log(backgroundLoaded);}
return new Promise((resolve,reject)=>{resolve(backgroundLoaded);});}}
const requestWithoutSqmIds={};_.keys(request).forEach((key)=>{if(key!='sqm_ids'){requestWithoutSqmIds[key]=request[key];}});if(SQMRequest.#preloadedRequests[JSON.stringify(requestWithoutSqmIds)]){const response=SQMRequest.#preloadedRequests[JSON.stringify(requestWithoutSqmIds)];_.keys(sqmManager.availableSqmInfos).forEach((sqmId)=>{if(!request.sqm_ids.includes(sqmId)){delete response[sqmId];}});if(sqmConfig.debug){console.log("Preloaded Request");console.log(request);console.log("Preloaded Response");console.log(response);}
delete SQMRequest.#preloadedRequests[JSON.stringify(requestWithoutSqmIds)];return new Promise((resolve,reject)=>{resolve(response);});}
if(!sqmConfig.fetchUrl){return new Promise((resolve,reject)=>{if(request.queries){const response={};_.keys(request.queries).forEach((query)=>{response[query]={};switch(request.queries[query].type){case'info':response[query].type='info';break;case'readings_range':response[query].type='readings_range';break;case'best_nightly_readings':response[query].type='best_nightly_readings';break;default:response[query].type='all_readings';break;}});resolve(response);}else{const response={};switch(request.type){case'info':response.type='info';break;case'readings_range':response.type='readings_range';break;case'best_nightly_readings':response.type='best_nightly_readings';break;default:response.type='all_readings';break;}
resolve(response);}});}
if(sqmConfig.debug){console.log("Request");console.log(request);}
request.block=blocking;return fetch(sqmConfig.fetchUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({request:request})}).then((response)=>response.json()).then((object)=>{if(sqmConfig.debug){console.log("Response");console.log(object);}
return object.response;});}
static preloadRequest(request,response){SQMRequest.#preloadedRequests[JSON.stringify(request)]=response.response;}
static setBackgroundLoader(backgroundLoader){SQMRequest.#backgroundLoader=backgroundLoader;}}
class SQMSimpleTimeChart{_getChartOptions(){return{type:'line',options:{responsive:true,aspectRatio:5/2,scales:{x:{type:'time',ticks:{source:'auto',display:false},time:{unit:'minute',unitStepSize:1,displayFormats:{'minute':sqmConfig.chartTimeFormat,'day':sqmConfig.chartDateFormat}},display:false},y:{ticks:{stepSize:1,display:false}}},events:['click'],onClick:SQMSimpleTimeChart.#onClick,elements:{point:{radius:SQMSimpleTimeChart.#pointRadius,hoverRadius:SQMSimpleTimeChart.#pointHoverRadius}},plugins:{title:{display:false},legend:{display:false},tooltip:{enabled:false}}}};}#divId;#chartObject;#canvas;#colorManager;#readingsSet;#clickCallback;#grid;static#counter;knowsCloudiness;constructor(grid,divId,title,clickCallback,colorManager){this.#grid=grid;this.#divId=divId;if(!SQMSimpleTimeChart.#counter){SQMSimpleTimeChart.#counter=1;}else{SQMSimpleTimeChart.#counter+=1;}
const titleElt=document.createElement('div');titleElt.classList.add('timechartitemtitle');titleElt.innerHTML=title;$(this.#divId).appendChild(titleElt);const container=document.createElement('div');const canvasId=this.#divId+'sqmsimpletimechart'+SQMSimpleTimeChart.#counter;container.setAttribute('id',canvasId+'container');container.classList.add('timechartgridcanvascontainer');$(this.#divId).appendChild(container);this.#canvas=document.createElement('canvas');this.#canvas.setAttribute('id',canvasId);$(this.#divId).addEventListener("click",(event)=>{SQMSimpleTimeChart.#click.bind(null,this);});container.appendChild(this.#canvas);this.#chartObject=new Chart($(canvasId),this._getChartOptions());this.#chartObject.timeChart=this;this.#chartObject.colorManager=colorManager;this.#clickCallback=clickCallback;this.knowsCloudiness=false;}
static#onClick(event,elements,chart){return chart.timeChart._click(event);}
static#click(simpleTimeChart,event){return simpleTimeChart._click(event);}
_click(event){this.#grid.hideGrid();this.#clickCallback();}
redraw(){this.#chartObject.update();}
setReadings(sqmReadings,showWhich){const readingsType=sqmReadings.type;delete sqmReadings.type;if(readingsType=='all_readings'){this.#chartObject.options.scales.x.time.unit='minute';this.#chartObject.options.scales.y.reverse=sqmConfig.nightlyAxisDescending;}else{this.#chartObject.options.scales.x.time.unit='day';this.#chartObject.options.scales.y.reverse=sqmConfig.bestReadingAxisDescending;}
this.#readingsSet=new SQMReadingsSet(sqmReadings,readingsType);const sqmIds=_.keys(sqmReadings);this.#chartObject.options.scales.x.min=this.#readingsSet.startDatetime(sqmIds);this.#chartObject.options.scales.x.max=this.#readingsSet.endDatetime(sqmIds);_.keys(sqmReadings).forEach((sqmId)=>{const dataset={sqmId:sqmId,label:"",readingsType:readingsType};var readings;switch(showWhich){case'all':readings=this.#readingsSet.allReadings()[sqmId];break;case'noCloudy':readings=this.#readingsSet.noCloudyReadings()[sqmId];break;case'noSunMoonClouds':readings=this.#readingsSet.noSunMoonCloudsReadings()[sqmId];break;}
dataset.data=_.keys(readings).sort().map((datetime)=>{return{x:datetime,y:readings[datetime].reading}});dataset.borderColor=SQMSimpleTimeChart.#borderColor;dataset.backgroundColor=SQMSimpleTimeChart.#backgroundColor;dataset.pointBorderColor=SQMSimpleTimeChart.#pointBorderColor;dataset.pointBackgroundColor=SQMSimpleTimeChart.#pointBackgroundColor;dataset.pointHoverBackgroundColor=SQMSimpleTimeChart.#pointHoverBackgroundColor;dataset.pointHoverBorderColor=SQMSimpleTimeChart.#pointHoverBorderColor;dataset.pointStyle=SQMSimpleTimeChart.#pointStyle;dataset.fill=false;dataset.segment={borderColor:SQMSimpleTimeChart.#segmentBorderColor,borderDash:SQMSimpleTimeChart.#segmentBorderDash};this.#chartObject.data.datasets.push(dataset);});}
setActiveSqmIds(sqmIds){this.#chartObject.data.datasets.forEach((dataset)=>{if(sqmIds.includes(dataset.sqmId)){dataset.hidden=false;}else{dataset.hidden=true;}});this.#chartObject.options.scales.x.min=this.#readingsSet.startDatetime(sqmIds);this.#chartObject.options.scales.x.max=this.#readingsSet.endDatetime(sqmIds);}
setColorManager(colorManager){this.#colorManager=colorManager;this.#chartObject.colorManager=this.#colorManager;}
destroy(){this.#chartObject.destroy();}
static#parseContext(context){if(context.dataIndex>=0){return context.chart.timeChart._attributesFor(context.dataset.sqmId,context.dataset.data[context.dataIndex].x);}
return null;}
_attributesFor(sqmId,datetime){return this.#readingsSet.get(sqmId).reading(datetime);}
static#borderColor(context){return context.chart.colorManager.legendBorder(context.dataset.sqmId);}
static#backgroundColor(context){return context.chart.colorManager.legendBackground(context.dataset.sqmId);}
static#pointBorderColor(context){return context.chart.colorManager.pointBorderColor(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}
static#pointBackgroundColor(context){return context.chart.colorManager.pointBackgroundColor(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}
static#pointHoverBorderColor(context){return context.chart.colorManager.pointHoverBorderColor(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}
static#pointHoverBackgroundColor(context){return context.chart.colorManager.pointHoverBackgroundColor(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}
static#segmentBorderColor(context){const dataset=context.chart.data.datasets[context.datasetIndex]
const sqmId=dataset.sqmId;const startPoint=context.chart.timeChart._attributesFor(sqmId,context.p0.raw.x);const endPoint=context.chart.timeChart._attributesFor(sqmId,context.p1.raw.x);return context.chart.colorManager.segmentColor(sqmId,startPoint,endPoint,dataset.readingsType);}
static#segmentBorderDash(context){if(!context.chart.timeChart.knowsCloudiness){return undefined;}
const dataset=context.chart.data.datasets[context.datasetIndex]
const sqmId=dataset.sqmId;const startPoint=context.chart.timeChart._attributesFor(sqmId,context.p0.raw.x);const endPoint=context.chart.timeChart._attributesFor(sqmId,context.p1.raw.x);return context.chart.colorManager.segmentDash(sqmId,startPoint,endPoint,dataset.readingsType);}
static#pointRadius(context){return context.chart.colorManager.smallPointRadius(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}
static#pointHoverRadius(context){return context.chart.colorManager.smallPointHoverRadius(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}
static#pointStyle(context){return context.chart.colorManager.pointStyle(context.dataset.sqmId,SQMSimpleTimeChart.#parseContext(context));}}
class SQMSunMoonMWClouds{static sunPosition(date,latitude,longitude){return SunCalc.getPosition(date,latitude,longitude);}
static moonPosition(date,latitude,longitude){return SunCalc.getMoonPosition(date,latitude,longitude);}
static moonIllumination(date,latitude,longitude){return SunCalc.getMoonIllumination(date,latitude,longitude);}
static#phases=['New moon','Waxing crescent','First quarter','Waxing gibbous','Full moon','Waning gibbous','Last quarter','Waning crescent'];static extractPhase(phase){if(((0.0<=phase)&&(phase<0.0625))||((0.9375<=phase)&&(phase<=1.0))){return SQMSunMoonMWClouds.#phases[0];}
var j=0;for(var i=0.0625;i<1.0;i+=0.125){j=j+1;if((i<=phase)&&(phase<i+0.125)){return SQMSunMoonMWClouds.#phases[j];}}
return'cannot be determined';}
static milkyWay(reading,latitude,longitude){const utcdate=SQMReadings.utcDate(reading.raw);const j2000=SQMSunMoonMWClouds.#j2000(utcdate);if(utcdate){const rightAscensionNGP=192.85948*Math.PI/180.0;const decNGP=27.12825*Math.PI/180.0;const galacticLongNCP=122.93192*Math.PI/180;const rightAscension=SQMSunMoonMWClouds.#rightAscension(utcdate,j2000,longitude);const sqmRA=(rightAscension*15.0)*Math.PI/180.0;const sqmDec=latitude*Math.PI/180.0;const galacticLatitude=Math.asin(Math.sin(sqmDec)*Math.sin(decNGP)+Math.cos(sqmDec)*Math.cos(decNGP)*Math.cos(sqmRA-rightAscensionNGP));const yy=Math.cos(sqmDec)*Math.sin(sqmRA-rightAscensionNGP);const xx=(Math.sin(sqmDec)*Math.cos(decNGP))-(Math.cos(sqmDec)*Math.sin(decNGP)*Math.cos(sqmRA-rightAscensionNGP));const galacticLongitude=galacticLongNCP-Math.atan2(yy,xx);return{latitude:galacticLatitude*180.0/Math.PI,longitude:galacticLongitude>=0?galacticLongitude*180.0/Math.PI:(2*Math.PI+galacticLongitude)*180.0/Math.PI};}else{return null;}}
static#rightAscension(utcdate,j2000,longitude){const ut=(utcdate.getHours()+utcdate.getMinutes()/60.0+utcdate.getSeconds()/3600.0);var ra=100.46+0.985647*j2000+longitude+15.0*ut;const mult=Math.round(ra/360.0);if(mult>0){ra-=mult*360.0;}
if(mult<0){ra-=mult*360.0;}
if(ra<0){ra+=360.0;}
return ra/15.0;}
static#j2000(utcdate){const day=24.0*60*60*1000;return(utcdate-new Date(2000,0,1,12,0,0))/day;}}
class SQMSunUtils{static sunsetDateBeforeOne(latitudeLongitudeObjects,datetime=null){const date=datetime?SQMDate.parseServerDatetime(datetime):new Date();if(_.values(latitudeLongitudeObjects).length==0){return SQMSunUtils.#sunsetBeforeDate(date,null,null);}
return _.keys(latitudeLongitudeObjects).map((key)=>SQMSunUtils.#sunsetBeforeDate(date,latitudeLongitudeObjects[key].latitude,latitudeLongitudeObjects[key].longitude,key)).reduce((latest,sunset)=>latest<sunset?sunset:latest,new Date(0));}
static#sunsetBeforeDate(date,latitude,longitude,sqmId){const sunset=SQMSunUtils.#sunsetSunrise(date,latitude,longitude,sqmId).sunset;if(sunset>date){return SQMSunUtils.#sunsetSunrise(dateFns.addDays(date,-1),latitude,longitude,sqmId).sunset;}
return sunset;}
static sunsetBeforeOne(latitudeLongitudeObjects,datetime=null){return SQMDate.formatServerDate(SQMSunUtils.sunsetDateBeforeOne(latitudeLongitudeObjects,datetime));}
static#sunsetSunrise(date,latitude,longitude,sqmId){if(latitude&&longitude){const times=SunCalc.getTimes(date,latitude,longitude);return{sunset:SQMDate.fixtz(SQMSunUtils.#extractSunset(times),sqmId),sunrise:SQMDate.fixtz(SQMSunUtils.#extractSunrise(times),sqmId)};}
const fakeSunset=dateFns.setHours(dateFns.setMinutes(dateFns.setSeconds(date,0),0),19);const fakeSunrise=dateFns.addHours(fakeSunset,-14);return{sunset:fakeSunset,sunrise:fakeSunrise};}
static#extractSunset(sunCalcTimes){switch(sqmConfig.twilightType){case'civil':return sunCalcTimes.sunset;case'nautical':return sunCalcTimes.dusk;case'night':return sunCalcTimes.night;case'astronomical':default:return sunCalcTimes.nauticalDusk;}}
static#extractSunrise(sunCalcTimes){switch(sqmConfig.twilightType){case'civil':return sunCalcTimes.sunrise;case'nautical':return sunCalcTimes.dawn;case'night':return sunCalcTimes.nightEnd;case'astronomical':default:return sunCalcTimes.nauticalDawn;}}
static sunsetSunriseForNight(night,latitude,longitude,sqmId){const date=dateFns.setHours(SQMDate.parseServerDate(night),12);const sunset=SQMSunUtils.#sunsetSunrise(date,latitude,longitude,sqmId).sunset;const sunrise=SQMSunUtils.#sunsetSunrise(dateFns.addDays(date,1),latitude,longitude,sqmId).sunrise;return{sunset:SQMDate.formatServerDatetime(sunset),sunrise:SQMDate.formatServerDatetime(sunrise)};}
static sunsetSunrisesForNight(night,latitudeLongitudeObjects){const result={};_.keys(latitudeLongitudeObjects).forEach((key)=>{result[key]=SQMSunUtils.sunsetSunriseForNight(night,latitudeLongitudeObjects[key].latitude,latitudeLongitudeObjects[key].longitude,key);});return result;}}
class SQMTimeChart{_getChartOptions(){return{type:'line',options:{responsive:true,aspectRatio:5/2,scales:{x:{type:'time',ticks:{source:'auto',},time:{unit:'minute',unitStepSize:1,displayFormats:{'minute':sqmConfig.chartTimeFormat,'day':sqmConfig.chartDateFormat}}},y:{ticks:{stepSize:1}}},elements:{point:{radius:SQMTimeChart.#pointRadius,hoverRadius:SQMTimeChart.#pointHoverRadius}},onClick:SQMTimeChart.#click,plugins:{title:{display:false,text:"SQM Chart",},legend:{display:true,position:'bottom',onHover:SQMTimeChart.#legendHover,onLeave:SQMTimeChart.#legendStopHover,onClick:SQMTimeChart.#legendClick},tooltip:{enabled:true,callbacks:{title:SQMTimeChart.#hoverTextTitle,label:SQMTimeChart.#hoverText}}}}};}#divId;#sqmChart;#chartObject;#canvas;#readingsType;#colorManager;#isClear;#chartCount;#reverseAll;#reverseBest;#ticksSource;#readingsSet;#showWhich;#contextMenu;#tooltipEl;#tooltipElImage;#tooltipIsShowing;#legendShowing;#keyShowing;constructor(divId,chart){this.#divId=divId;this.#sqmChart=chart;this.#chartCount=0;this.#makeChartObject();this.#reverseAll=sqmConfig.nightlyAxisDescending;this.#reverseBest=sqmConfig.bestReadingAxisDescending;this.#ticksSource='auto';this.#tooltipEl=document.createElement('div');this.#tooltipEl.classList.add('chartjs-tooltip');document.body.appendChild(this.#tooltipEl);this.#tooltipEl.addEventListener('click',(event)=>{SQMImagePopup.showImage();});this.#tooltipIsShowing=false;this.#contextMenu=new SQMTimeContextMenu(divId,this,chart);}
setTitle(title){this.#chartObject.options.plugins.title.text=title;}
showTitle(){this.#chartObject.options.plugins.title.display=true;}
hideTitle(){this.#chartObject.options.plugins.title.display=false;}
activeSqmIds(){const activeSqmIds=[];this.#chartObject.getSortedVisibleDatasetMetas().forEach((object)=>{if(!object.hidden){activeSqmIds.push(object._dataset.sqmId);}});return activeSqmIds;}
activateSqm(sqmId){const index=this.#chartObject.data.datasets.findIndex((d)=>d.sqmId==sqmId);if(index<0){return false;}
this.#chartObject.show(index);this.#chartObject.data.datasets[index].hidden=false;}
deactivateSqm(sqmId){const index=this.#chartObject.data.datasets.findIndex((d)=>d.sqmId==sqmId);if(index<0){return false;}
this.#chartObject.hide(index);this.#chartObject.data.datasets[index].hidden=true;}#makeChartObject(){this.#chartCount++;this.#canvas=document.createElement('canvas');this.#canvas.setAttribute('id',this.#divId+'sqmtimechart'+this.#chartCount);$(this.#divId).appendChild(this.#canvas);this.#chartObject=new Chart($(this.#divId+'sqmtimechart'+this.#chartCount),this._getChartOptions());this.#chartObject.timeChart=this;this.#isClear=false;}
setColorManager(colorManager){this.#colorManager=colorManager;this.#chartObject.colorManager=colorManager;}
setReadingsType(readingsType){this.#readingsType=readingsType;this.setTimeScale((readingsType=='all_readings')?'minute':'day');this.setAxisReverse(((readingsType=='all_readings')&&this.#reverseAll)||((readingsType=='best_nightly_readings')&&this.#reverseBest));}
clearRange(){delete this.#chartObject.options.scales.y.min;delete this.#chartObject.options.scales.y.max;}
setMin(newMin){this.#chartObject.options.scales.y.min=parseInt(newMin);this.redraw();}
setMax(newMax){const previousMin=this.#chartObject.scales.y.min;this.#chartObject.options.scales.y.max=parseInt(newMax);this.#chartObject.options.scales.y.min=previousMin;this.redraw();}
setAxisReverse(reverse){this.#chartObject.options.scales.y.reverse=reverse;}
setTimeScale(scale){this.#chartObject.options.scales.x.time.unit=scale;}
setTicksSource(source){this.#ticksSource=source;this.#chartObject.options.scales.x.ticks.source=source;}
setTimeRange(startDatetime,endDatetime){this.#chartObject.options.scales.x.min=startDatetime;this.#chartObject.options.scales.x.max=endDatetime;}
setReadingsSet(readingsSet){this.#readingsSet=readingsSet;}
addDataset(dataset){const sqmId=dataset.sqmId;dataset.allData=this.#toData(this.#readingsSet.allReadings()[sqmId]);dataset.noSunMoonCloudsData=this.#toData(this.#readingsSet.noSunMoonCloudsReadings()[sqmId]);dataset.noCloudyData=this.#toData(this.#readingsSet.noCloudyReadings()[sqmId]);if(this.#isClear){this.#makeChartObject();}
switch(this.#showWhich){case'all':dataset.data=dataset.allData;break;case'noCloudy':dataset.data=dataset.noCloudyData;break;case'noSunMoonClouds':dataset.data=dataset.noSunMoonCloudsData;break;}
dataset.borderColor=SQMTimeChart.#borderColor;dataset.backgroundColor=SQMTimeChart.#backgroundColor;dataset.pointBorderColor=SQMTimeChart.#pointBorderColor;dataset.pointBackgroundColor=SQMTimeChart.#pointBackgroundColor;dataset.pointHoverBackgroundColor=SQMTimeChart.#pointHoverBackgroundColor;dataset.pointHoverBorderColor=SQMTimeChart.#pointHoverBorderColor;dataset.pointStyle=SQMTimeChart.#pointStyle;dataset.fill=false;dataset.segment={borderColor:SQMTimeChart.#segmentBorderColor,borderDash:SQMTimeChart.#segmentBorderDash};this.#chartObject.data.datasets.push(dataset);}#toData(readings){return _.keys(readings).map((datetime)=>{return{x:datetime,y:readings[datetime].reading};});}
shiftedReadings(newReadingsSet){this.#handleNewData();}
addedToReadings(newReadingsSet){this.#handleNewData();}#handleNewData(){this.#chartObject.data.datasets.forEach((dataset)=>{const sqmId=dataset.sqmId;this.#updateDatasetData(dataset.allData,this.#toData(this.#readingsSet.allReadings()[sqmId]));this.#updateDatasetData(dataset.noCloudyData,this.#toData(this.#readingsSet.noCloudyReadings()[sqmId]));this.#updateDatasetData(dataset.noSunMoonCloudsData,this.#toData(this.#readingsSet.noSunMoonCloudsReadings()[sqmId]));});}#updateDatasetData(data,newData){const existingDatetimes=data.map((dataPoint)=>dataPoint.x);const earliest=_.min(existingDatetimes);const latest=_.max(existingDatetimes);const before=[];const after=[];const between=[];newData.forEach((dataPoint)=>{const datetime=dataPoint.x;if(!existingDatetimes.includes(datetime)){if(datetime<earliest){before.push(dataPoint);}else{if(datetime>latest){after.push(dataPoint);}else{between.push(dataPoint);}}}});before.sort().reverse().forEach((dataPoint)=>{data.unshift(dataPoint);});after.sort().forEach((dataPoint)=>{data.push(dataPoint);});if(between.length>0){between.forEach((dataPoint)=>{data.push(dataPoint);});data.sort();}}
removeDataset(sqmId){const index=this.#chartObject.data.datasets.findIndex((d)=>d.sqmId==sqmId);this.#chartObject.data.datasets.splice(index,1);}
clearChart(){if(this.#chartObject){this.#chartObject.data.datasets=[];this.#chartObject.destroy();}
const container=$(this.#divId);container.removeChild(container.firstElementChild);this.#isClear=true;}
removeAllDatasets(){this.#chartObject.data.datasets=[];}
redraw(animationDuration=null){if(animationDuration){this.#chartObject.update(animationDuration);}else{this.#chartObject.update();}
var hasReadings=false;var hasIndeterminateCloudiness=false;var canFilterClouds=false;var canFilterSunMoonClouds=false;this.activeSqmIds().forEach((sqmId)=>{const dataset=this.#chartObject.data.datasets.find((dataset)=>dataset.sqmId==sqmId);if(dataset.data.length>0){hasReadings=hasReadings||dataset.data.some((point)=>{return((this.#sqmChart.startDatetime<=point.x)&&(this.#sqmChart.endDatetime>=point.x)&&(point.y!=undefined)&&(point.y!=null));});}
if(this.#readingsSet.get(dataset.sqmId).canFilterClouds()){canFilterClouds=true;dataset.data.forEach((point)=>{const r2=this.#readingsSet.get(sqmId).reading(point.x).mean_r_squared;if((r2==null)||(r2==undefined)){hasIndeterminateCloudiness=true;}});}
if(this.#readingsSet.get(dataset.sqmId).canFilterSunMoonClouds()){canFilterSunMoonClouds=true;}});if(hasReadings){SQMUserDisplay.hideNoReadingsBox();}else{SQMUserDisplay.showNoReadingsBox(this.#showWhich!='all');}
this.#contextMenu.canFilter(canFilterClouds,canFilterSunMoonClouds);if(canFilterClouds){SQMUserDisplay.showCloudinessKey();}else{SQMUserDisplay.hideCloudinessKey();}
if(hasIndeterminateCloudiness){SQMUserDisplay.showUnknownCloudiness();}else{SQMUserDisplay.hideUnknownCloudiness();}
if(sqmConfig.milkyWay){SQMUserDisplay.showMWKey();}else{SQMUserDisplay.hideMWKey();}
this.#contextMenu.setMin(Math.floor(this.#chartObject.scales.y.min));this.#contextMenu.setMax(Math.ceil(this.#chartObject.scales.y.max));}
flipChart(){if(this.#readingsType=='all_readings'){this.#reverseAll=!this.#reverseAll;sqmConfig.nightlyAxisDescending=!sqmConfig.nightlyAxisDescending;}else{this.#reverseBest=!this.#reverseBest;sqmConfig.bestReadingAxisDescending=!sqmConfig.bestReadingAxisDescending;}
const reversed=this.#chartObject.options.scales.y.reverse;this.#chartObject.options.scales.y.reverse=!reversed;this.redraw();}
showLegend(show){this.#legendShowing=show;this.#chartObject.options.plugins.legend.display=show;this.#contextMenu.setLegendShowing(show);}
showHideLegend(){if(this.#legendShowing){this.showLegend(false);}else{this.showLegend(true);}
this.redraw();}#canFilterClouds(sqmId){return this.#readingsSet.get(sqmId).canFilterClouds();}
setShowReadings(which){this.#showWhich=which;this.#contextMenu.setShowingWhich(this.#showWhich);}#removeReadingsOutsideTimeRange(){const start=this.#chartObject.scales.x.min;const end=this.#chartObject.scales.x.max;this.#chartObject.data.datasets.forEach((dataset)=>{const newAllData=[];_.keys(dataset.allData).forEach((key)=>{const datetime=dataset.allData[key].x;if((datetime>=start)&&(datetime<=end)){newAllData.push(dataset.allData[key]);}});const newNoCloudyData=[];_.keys(dataset.noCloudyData).forEach((key)=>{const datetime=dataset.noCloudyData[key].x;if((datetime>=start)&&(datetime<=end)){newNoCloudyData.push(dataset.noCloudyData[key]);}});const newNoSunMoonCloudsData=[];_.keys(dataset.noSunMoonCloudsData).forEach((key)=>{const datetime=dataset.noSunMoonCloudsData[key].x;if((datetime>=start)&&(datetime<=end)){newNoSunMoonCloudsData.push(dataset.noSunMoonCloudsData[key]);}});});}
showAllReadings(){if(this.#showWhich!='all'){this.#removeReadingsOutsideTimeRange();this.#chartObject.update('none');}
this.#showWhich='all';this.#chartObject.data.datasets.forEach((dataset)=>{dataset.data=dataset.allData;});this.#chartObject.options.scales.x.ticks.source=this.#ticksSource;this.#contextMenu.setShowingWhich(this.#showWhich);this.redraw();}
showNoCloudyReadings(){if(this.#showWhich!='noCloudy'){this.#removeReadingsOutsideTimeRange();this.#chartObject.update('none');}
this.#showWhich='noCloudy';this.#chartObject.data.datasets.forEach((dataset)=>{dataset.data=dataset.noCloudyData;});this.#chartObject.options.scales.x.ticks.source='auto';this.#contextMenu.setShowingWhich(this.#showWhich);this.redraw();}
showNoSunMoonCloudsReadings(){if(this.#showWhich!='noSunMoonClouds'){this.#removeReadingsOutsideTimeRange();this.#chartObject.update('none');}
this.#showWhich='noSunMoonClouds';this.#chartObject.data.datasets.forEach((dataset)=>{dataset.data=dataset.noSunMoonCloudsData;});this.#chartObject.options.scales.x.ticks.source='auto';this.#contextMenu.setShowingWhich(this.#showWhich);this.redraw();}
static#parseContext(context){if(context.dataIndex>=0){return context.chart.timeChart._attributesFor(context.dataset.sqmId,context.dataset.data[context.dataIndex].x);}
return null;}
_attributesFor(sqmId,datetime){return this.#readingsSet.get(sqmId).reading(datetime);}
static#borderColor(context){return context.chart.colorManager.legendBorder(context.dataset.sqmId);}
static#backgroundColor(context){return context.chart.colorManager.legendBackground(context.dataset.sqmId);}
static#pointBorderColor(context){return context.chart.colorManager.pointBorderColor(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#pointBackgroundColor(context){return context.chart.colorManager.pointBackgroundColor(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#pointHoverBorderColor(context){return context.chart.colorManager.pointHoverBorderColor(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#pointHoverBackgroundColor(context){return context.chart.colorManager.pointHoverBackgroundColor(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#segmentBorderColor(context){const dataset=context.chart.data.datasets[context.datasetIndex];const sqmId=dataset.sqmId;const startPoint=context.chart.timeChart._attributesFor(sqmId,context.p0.raw.x);const endPoint=context.chart.timeChart._attributesFor(sqmId,context.p1.raw.x);return context.chart.colorManager.segmentColor(sqmId,startPoint,endPoint,dataset.readingsType);}
static#segmentBorderDash(context){const dataset=context.chart.data.datasets[context.datasetIndex];if(!context.chart.timeChart.#canFilterClouds(dataset.sqmId)){return undefined;}
const sqmId=dataset.sqmId;const startPoint=context.chart.timeChart._attributesFor(sqmId,context.p0.raw.x);const endPoint=context.chart.timeChart._attributesFor(sqmId,context.p1.raw.x);return context.chart.colorManager.segmentDash(sqmId,startPoint,endPoint,dataset.readingsType);}
static#pointRadius(context){return context.chart.colorManager.pointRadius(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#pointHoverRadius(context){return context.chart.colorManager.pointHoverRadius(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#pointStyle(context){return context.chart.colorManager.pointStyle(context.dataset.sqmId,SQMTimeChart.#parseContext(context));}
static#click(event,elements,chart){var reacted=false;elements.forEach((element)=>{if((!reacted)&&(element.datasetIndex>=0)&&(element.index>=0)&&chart){const dataset=chart.data.datasets[element.datasetIndex];const point=dataset.data[element.index];if(chart.timeChart._click(dataset.sqmId,point)){reacted=true;}}});}
_click(sqmId,point){if(this.#readingsType=='best_nightly_readings'){if(point){const datetime=point.x;setTimeout(()=>{SQMUserRequest.nightly(SQMDate.nightOf(SQMDate.parseServerDatetime(datetime)));},1);return true;}}else if(this.#readingsType=='all_readings'){if(point){const datetime=point.x;var image=this.#readingsSet.get(sqmId).reading(datetime).display_image;if(!image){image=this.#readingsSet.get(sqmId).reading(datetime).image;}
if(image){SQMImagePopup.setImage(image,sqmManager.availableSqmInfos[sqmId].name+" "+SQMDate.formatTitleDatetime(datetime),this.#readingsSet.get(sqmId).reading(datetime).image);if(!SQMUserInputs.isTouch){SQMImagePopup.showImage();}
return true;}}}
return false;}
static#legendHover(event,legendContext,context){return context.chart.timeChart._legendHover(context.legendHitBoxes[legendContext.datasetIndex],context.chart.data.datasets[legendContext.datasetIndex].sqmId);}
static#legendStopHover(event,legendContext,context){return context.chart.timeChart._legendStopHover();}#legendHovering;_legendHover(legendHitBox,sqmId){if(this.#legendHovering){return;}
const sqmInfo=sqmManager.availableSqmInfos[sqmId];if(sqmConfig.showLatitudeLongitude&&sqmInfo.latitude){const latitude=Number.parseFloat(sqmInfo.latitude.toFixed(2));const longitude=Number.parseFloat(sqmInfo.longitude.toFixed(2));const latitudeStr=latitude>=0?latitude+"N":Math.abs(latitude)+"S";const longitudeStr=longitude>=0?longitude+"E":Math.abs(longitude)+"W";$('legendtooltiplat').innerHTML="Latitude "+latitudeStr;$('legendtooltiplong').innerHTML="Longitude "+longitudeStr;if(sqmInfo.elevation){$('legendtooltipelev').innerHTML="Elevation "+sqmInfo.elevation+" meters";}
if(sqmInfo.time_zone_name){$('legendtooltiptz').innerHTML="Time zone "+sqmInfo.time_zone_name;}}
$('legendtooltipname').innerHTML=sqmInfo.name;if(!this.activeSqmIds().includes(sqmId)){$('legendtooltipclick').innerHTML="Click to show";}else if(this.activeSqmIds().length>1){$('legendtooltipclick').innerHTML="Click to hide";}else{$('legendtooltipclick').style.display="none";}
this.#legendHovering=true;const tooltip=$('legendtooltip');tooltip.style.display="block";tooltip.style.left=(legendHitBox.left+20)+"px";tooltip.style.top=(legendHitBox.top-tooltip.offsetHeight-3)+"px";}
_legendStopHover(){$('legendtooltipname').innerHTML="";$('legendtooltiplat').innerHTML="";$('legendtooltiplong').innerHTML="";$('legendtooltipelev').innerHTML="";$('legendtooltipclick').innerHTML="";$('legendtooltip').style.display="none";this.#legendHovering=false;}
static#legendClick(event,legendContext,context){return context.chart.timeChart._legendClick(legendContext);}
_legendClick(legendContext){if(this.#chartObject.isDatasetVisible(legendContext.datasetIndex)){if(this.activeSqmIds().length>1){this.#chartObject.hide(legendContext.datasetIndex);legendContext.hidden=true;}}else{this.#chartObject.show(legendContext.datasetIndex);legendContext.hidden=false;}
const activeSqmIds=this.activeSqmIds();this.#sqmChart.setActiveSqmIds(activeSqmIds);if(this.#legendHovering){if(legendContext.hidden){$('legendtooltipclick').innerHTML="Click to show";}else if(this.activeSqmIds().length>1){$('legendtooltipclick').innerHTML="Click to hide";}else{$('legendtooltipclick').style.display="none";}}}
static#hoverTextTitle(context){const titles=context.map((ctx)=>ctx.chart.timeChart._hoverTextTitle()).filter((title)=>title!=null);return titles.length>0?titles.join("\n"):"";}
_hoverTextTitle(){return null;}
static#hoverText(context){return context.chart.timeChart._hoverText(context.dataset.sqmId,context.raw.x,context.raw.y);}
_hoverText(sqmId,datetime,value){const sqmName=sqmManager.availableSqmInfos[sqmId].name;const readingAt=value+" @ "+datetime;const thumbnail=this.#readingsSet.get(sqmId).reading(datetime).thumbnail;if(!thumbnail){this.#tooltipElImage=null;}else{var image=this.#readingsSet.get(sqmId).reading(datetime).display_image;if(!image){image=this.#readingsSet.get(sqmId).reading(datetime).image;}
if(image){SQMImagePopup.setImage(image,sqmName+" "+SQMDate.formatTitleDatetime(datetime),this.#readingsSet.get(sqmId).reading(datetime).image);this.#contextMenu.showViewImage(true);}
this.#tooltipElImage=thumbnail;}
const shortLabel=sqmName.length>20?sqmName.substring(0,18)+"...":sqmName;const result=[readingAt,shortLabel];const reading=this.#readingsSet.get(sqmId).reading(datetime);if(sqmConfig.hoverTextSun&&reading.sun_position){result.push("Solar altitude "+
(reading.sun_position.altitude*180/Math.PI).toFixed(1)+" degrees");const sunAzimuth=(reading.sun_position.azimuth*180/Math.PI).toFixed(1);if(sunAzimuth>=0){result.push("Solar azimuth "+sunAzimuth+" degrees");}else{result.push("Solar azimuth "+(sunAzimuth+360)+" degrees");}}
if(sqmConfig.hoverTextMoon&&reading.moon_position){result.push("Lunar altitude "+
(reading.moon_position.altitude*180/Math.PI).toFixed(1)+" degrees");const moonAzimuth=(reading.moon_position.azimuth*180/Math.PI).toFixed(1);if(moonAzimuth>=0){result.push("Lunar azimuth "+moonAzimuth+" degrees");}else{result.push("Lunar azimuth "+(moonAzimuth+360)+" degrees");}
result.push(SQMSunMoonMWClouds.extractPhase(reading.moon_illumination.phase));result.push("Lunar illumination "+
Math.round(reading.moon_illumination.fraction*100)+"%");}
if(sqmConfig.milkyWay&&sqmConfig.hoverTextMW&&reading.galactic_latitude){result.push("Galactic Latitude "+reading.galactic_latitude.toFixed(1)+" degrees");result.push("Galactice Longitude "+reading.galactic_longitude.toFixed(1)+" degrees");}
if(sqmConfig.hoverTextR2&&reading.mean_r_squared&&!reading.mean_r_squared_copied){result.push("Mean r = "+(reading.mean_r_squared).toFixed(2));}
return result;}
static hook(object,x,y,width,height,xAlign,yAlign){if(object.chart.timeChart){object.chart.timeChart._hook(x,y,width,height,xAlign,yAlign);}}
_hook(x,y,width,height,xAlign,yAlign){const bodyRect=document.body.getBoundingClientRect();const chartRect=$('timechart').getBoundingClientRect();var offsetTop=chartRect.top-bodyRect.top;if(SQMUserDisplay.sqmsDropdownShowing){offsetTop+=3;}else{offsetTop+=7;}
if(yAlign=='top'){this.#tooltipEl.style.top=(y+offsetTop+height)+"px";}else{this.#tooltipEl.style.top=(y+offsetTop-this.#tooltipEl.offsetHeight)+"px";}
const offset=(this.#tooltipEl.offsetWidth-width)/2;this.#tooltipEl.style.left=(x-offset)+"px";}
static hooktwo(object,n){if(object.chart.timeChart){object.chart.timeChart._hooktwo(n);}}
_hooktwo(n){if((!n)||(n.opacity===0)||(!this.#tooltipElImage)){this.#tooltipEl.innerHTML='';this.#tooltipElImage=null;this.#tooltipEl.style.opacity=0;this.#tooltipEl.style.visibility='hidden';this.#contextMenu.showViewImage(false);this.#tooltipIsShowing=false;}else{if(!this.#tooltipIsShowing){this.#tooltipIsShowing=true;const image=new Image();image.timeChart=this;image.onload=function(){if(this.timeChart.#tooltipIsShowing){const img=document.createElement('img');img.setAttribute('src',this.src);img.setAttribute('height',this.height);img.setAttribute('width',this.width);img.classList.add('thumbnail');this.timeChart.#tooltipEl.innerHTML='';this.timeChart.#tooltipEl.appendChild(img);this.timeChart.#tooltipEl.style.opacity=1;this.timeChart.#tooltipEl.style.visibility='visible';}};image.src=this.#tooltipElImage;}}}#imageOnLoad(){if(this.#tooltipIsShowing){const img=document.createElement('img');img.setAttribute('src',this.src);img.setAttribute('height',this.height);img.setAttribute('width',this.width);img.classList.add('thumbnail');this.#tooltipEl.innerHTML='';this.#tooltipEl.appendChild(img);this.#tooltipEl.style.opacity=1;this.#tooltipEl.style.visibility='visible';}}
image(){const image=this.#chartObject.toBase64Image();return image;}
blob(callback){this.#canvas.toBlob(callback);}}
class SQMTimeChartGrid{#holder;#div;#container;#columns;#simpleCharts;#isShowing;#isBackgroundShowing;#allReadingsColorManager;#bestReadingsColorManager;#priorArrowActions;constructor(holderId,divId){this.#holder=$(holderId);this.#div=$(divId);this.#container=document.createElement("div");this.#container.classList.add("timechartgridcontainer");this.#div.appendChild(this.#container);this.#columns=[];this.#simpleCharts={};this.#isShowing=false;this.#isBackgroundShowing=false;this.#priorArrowActions={};document.body.addEventListener('mousedown',SQMTimeChartGrid.#clickOutside.bind(null,this));$('closegrid').addEventListener('click',SQMTimeChartGrid.#close.bind(null,this));}
setColorManagers(managers){this.#allReadingsColorManager=managers.all;this.#bestReadingsColorManager=managers.best;}
static#clickOutside(timeChartGrid,event){return timeChartGrid._clickOutside(event);}
_clickOutside(event){if(!this.#holder.contains(event.target)){if(this.#isShowing){SQMUserRequest.setArrowActions(this.#priorArrowActions);}
this.hideGrid();}}
static#close(timeChartGrid,event){return timeChartGrid._close(event);}
_close(event){if(this.#isShowing){SQMUserRequest.setArrowActions(this.#priorArrowActions);}
this.hideGrid();}
setPriorArrowActions(actions){this.#priorArrowActions=actions;}#makeGridItem(id){const item=document.createElement("div");item.classList.add("timechartgriditem");item.setAttribute("id",id);return item;}#makeColumn(id1,id2){const column=document.createElement("div");column.classList.add("timechartgridcolumn");const item1=this.#makeGridItem(id1);const item2=this.#makeGridItem(id2);column.appendChild(item1);column.appendChild(item2);return column;}#makeGrid(keys,titles,callbacks,colorManager){for(let i=0;i<keys.length/2;i++){const column=this.#makeColumn("timechartgrid"+keys[i*2],"timechartgrid"+keys[i*2+1]);this.#columns[i]=column;this.#container.appendChild(this.#columns[i]);}
keys.forEach((key)=>{this.#simpleCharts[key]=new SQMSimpleTimeChart(this,"timechartgrid"+key,titles[key],callbacks[key],colorManager);});}
showBackground(){if(!this.#isBackgroundShowing){this.#clearCharts();this.#holder.style.display="flex";this.#holder.style.opacity=0.25;setTimeout(()=>{this.#holder.style.opacity=1;},20);this.#isBackgroundShowing=true;}}
showGrid(){this.showBackground();this.redraw();this.#isShowing=true;}
hideGrid(){this.#holder.style.display="none";this.#holder.style.opacity=0;this.#isBackgroundShowing=false;this.#isShowing=false;}#setReadings(readingsByDate,showWhich,activeSqmIds,titles,callbacks,colorManager){this.#clearCharts();this.#makeGrid(_.keys(readingsByDate),titles,callbacks,colorManager);_.keys(readingsByDate).forEach((date)=>{this.#simpleCharts[date].setReadings(readingsByDate[date],showWhich);this.#simpleCharts[date].setActiveSqmIds(activeSqmIds);});}#clearCharts(){this.#container.innerHTML="";_.keys(this.#simpleCharts).forEach((key)=>{this.#simpleCharts[key].destroy();});this.#columns=[];this.#simpleCharts={};}
redraw(){_.keys(this.#simpleCharts).forEach((key)=>{this.#simpleCharts[key].redraw();});}
loadNightly(startDate){const titles={};const callbacks={};const queries={};const lastAvailableNight=SQMSunUtils.sunsetDateBeforeOne(sqmManager.activeSqmIds().map((sqmId)=>sqmManager.availableSqmInfos[sqmId]),sqmManager.mostRecentDatetime());const firstAvailableNight=dateFns.addDays(SQMSunUtils.sunsetDateBeforeOne(sqmManager.activeSqmIds().map((sqmId)=>sqmManager.availableSqmInfos[sqmId]),sqmManager.earliestDatetime()),1);if(dateFns.addDays(startDate,-3)<firstAvailableNight){startDate=dateFns.addDays(firstAvailableNight,3);}
if(dateFns.addDays(startDate,2)>lastAvailableNight){startDate=dateFns.addDays(lastAvailableNight,-2);}
const arrowActions={};if(SQMDate.nightOf(dateFns.addDays(startDate,-3))>SQMDate.nightOf(firstAvailableNight)){arrowActions.left={type:'grid',action:'nightly',date:dateFns.addDays(startDate,-3)};}
if(SQMDate.nightOf(dateFns.addDays(startDate,2))<SQMDate.nightOf(lastAvailableNight)){arrowActions.right={type:'grid',action:'nightly',date:dateFns.addDays(startDate,3)};}
[0,-3,1,-2,2,-1].forEach((days)=>{const dateObj=dateFns.addDays(startDate,days);const date=SQMDate.formatServerDate(dateObj);queries[date]={type:'nightly',date:date,twilightType:sqmConfig.twilightType};titles[date]=SQMDate.formatTitleDate(dateObj);callbacks[date]=()=>{SQMUserRequest.nightly(date);};});return this.#loadReadings(queries,titles,callbacks,arrowActions,this.#allReadingsColorManager);}
loadMonthly(startMonth){if(startMonth==""){startMonth=SQMDate.formatServerMonth(new Date());}
const titles={};const callbacks={};const queries={};const availableMonths=SQMUserInputs.availableMonths();const firstAvailableMonth=_.min(availableMonths);const lastAvailableMonth=_.max(availableMonths);if(SQMDate.addMonths(startMonth,-3)<firstAvailableMonth){startMonth=SQMDate.addMonths(firstAvailableMonth,3);}
if(SQMDate.addMonths(startMonth,2)>lastAvailableMonth){startMonth=SQMDate.addMonths(lastAvailableMonth,-2);}
const arrowActions={};if(SQMDate.addMonths(startMonth,-3)>firstAvailableMonth){arrowActions.left={type:'grid',action:'monthly',month:SQMDate.addMonths(startMonth,-3)};}
if(SQMDate.addMonths(startMonth,2)<lastAvailableMonth){arrowActions.right={type:'grid',action:'monthly',month:SQMDate.addMonths(startMonth,2)};}
[0,-3,1,-2,2,-1].forEach((months)=>{const month=SQMDate.addMonths(startMonth,months);const date=dateFns.setDate(SQMDate.parseServerMonth(month),1);const firstDay=SQMDate.formatServerDatetime(date);const lastDay=SQMDate.formatServerDatetime(dateFns.lastDayOfMonth(date));queries[month]={type:'best_nightly_readings',start:firstDay,end:lastDay};callbacks[month]=()=>{SQMUserRequest.monthly(month);};titles[month]=SQMDate.formatTitleMonth(date);});return this.#loadReadings(queries,titles,callbacks,arrowActions,this.#bestReadingsColorManager);}#loadReadings(queries,titles,callbacks,arrowActions,colorManager){return sqmManager.directRequest({queries:queries}).then((sqmReadings)=>{this.#setReadings(sqmReadings,sqmManager.showingWhich(),sqmManager.activeSqmIds(),titles,callbacks,colorManager);return arrowActions;});}
arrowAction(action){if(action.action=='nightly'){return this.loadNightly(action.date);}else{return this.loadMonthly(action.month);}}}
class SQMUserDisplay{static sqmsDropdownShowing;static initialize(){SQMUserDisplay.setPageTitle(sqmConfig.title);if((sqmConfig.showSqmsDropdown===true)||((sqmConfig.showSqmsDropdown===null)&&(sqmConfig.enabledSqms!==true))){$('titlebox').style.display='block';$('titlehr').style.display='block';SQMUserDisplay.sqmsDropdownShowing=true;}else{$('titlebox').style.display='none';$('titlehr').style.display='none';$('topcontainer').style.marginTop='5px';SQMUserDisplay.sqmsDropdownShowing=false;}
if(sqmConfig.showKey&&sqmConfig.colorizeData){SQMUserDisplay.showKey();}else{SQMUserDisplay.hideKey();}
if(sqmConfig.showBestReading){SQMUserDisplay.showBestBox();}else{SQMUserDisplay.hideBestBox();}
if(sqmConfig.showLatestReading){SQMUserDisplay.showLatestBox();}else{SQMUserDisplay.hideLatestBox();}
if(sqmConfig.showStats){SQMUserDisplay.showStatsBox();}else{SQMUserDisplay.hideStatsBox();}
if(sqmConfig.showBinning){SQMUserDisplay.showBinning();}else{SQMUserDisplay.hideBinning();}
SQMUserDisplay.hideUnknownCloudiness();SQMUserDisplay.hideCloudinessKey();$('addfileclose').addEventListener("click",(event)=>{SQMUserDisplay.hideAddFileInput();});}
static setPageTitle(title){$('pagetitle').innerHTML=title;document.title=title;}
static hideCover(){$('cover').style.display="none";}
static showLoading(){$('loading').style.display="inline-block";}
static hideLoading(){$('loading').style.display="none";}
static setGraphTitle(title){$('graphtitle').innerHTML=title;}
static showNoReadingsBox(excludedData=false){$('noreadingsbox').innerHTML=excludedData?"No readings in range, possibly due to excluding sun, moon, cloud data":"No readings in range";$('noreadingsbox').style.display='block';}
static hideNoReadingsBox(){$('noreadingsbox').style.display='none';}
static showBestBox(){SQMUserDisplay.#allClassInnerHTML('showhidebest',"Hide best reading");$('bestbox').style.maxHeight=($('besttext').offsetHeight+2)+"px";}
static hideBestBox(){SQMUserDisplay.#allClassInnerHTML('showhidebest',"Show best reading");$('bestbox').style.maxHeight="0";}
static showhideBestBox(){if($('bestbox').offsetHeight==0){SQMUserDisplay.showBestBox();}else{SQMUserDisplay.hideBestBox();}}
static setBestBox(bestReading,displayName){if(!bestReading){$('besttext').innerHTML="";return;}
$('besttext').innerHTML="Best reading "+SQMUserDisplay.#displayReading(bestReading);if(displayName){$('besttext').innerHTML
+=" by "+sqmManager.availableSqmInfos[bestReading.sqmId].name;}}
static showLatestBox(){SQMUserDisplay.#allClassInnerHTML('showhidelatest',"Hide latest reading");$('latestbox').style.maxHeight=($('latesttext').offsetHeight+2)+"px";}
static hideLatestBox(){SQMUserDisplay.#allClassInnerHTML('showhidelatest',"Show latest reading");$('latestbox').style.maxHeight="0";}
static showhideLatestBox(){if($('latestbox').offsetHeight==0){SQMUserDisplay.showLatestBox();}else{SQMUserDisplay.hideLatestBox();}}
static setLatestReading(latestReading,displayName){if(!latestReading){$('latesttext').innerHTML="";return;}
$('latesttext').innerHTML="Latest reading "+
SQMUserDisplay.#displayReading(latestReading);if(displayName){$('latesttext').innerHTML+=" by "+
sqmManager.availableSqmInfos[latestReading.sqmId].name;}}
static showStatsBox(){SQMUserDisplay.#allClassInnerHTML('showhidestats',"Hide statistics");$('statsbox').style.maxHeight=($('stats').offsetHeight+2)+"px";}
static hideStatsBox(){SQMUserDisplay.#allClassInnerHTML('showhidestats',"Show statistics");$('statsbox').style.maxHeight="0px";}
static showhideStatsBox(){if($('statsbox').offsetHeight==0){SQMUserDisplay.showStatsBox();}else{SQMUserDisplay.hideStatsBox();}}
static setStatsBox(stats){$('stats').innerHTML="";_.keys(stats).forEach((sqmId)=>{const row=document.createElement('div');row.classList.add('statsrow');row.appendChild(SQMUserDisplay.#statsItem("["+sqmManager.availableSqmInfos[sqmId].name+"]"));row.appendChild(SQMUserDisplay.#statsItem("Mean: "+stats[sqmId].mean.toFixed(2)));row.appendChild(SQMUserDisplay.#statsItem("Median: "+stats[sqmId].median.toFixed(2)));row.appendChild(SQMUserDisplay.#statsItem("Number: "+stats[sqmId].number));row.appendChild(SQMUserDisplay.#statsItem("Best: "+SQMUserDisplay.#displayReading(stats[sqmId].best)));$('stats').appendChild(row);});if($('statsbox').offsetHeight!=0){SQMUserDisplay.showStatsBox();}}
static#displayReading(reading){return reading.value+" @ "+SQMDate.serverToTitleDatetime(reading.datetime);}
static#statsItem(text){const div=document.createElement('div');div.appendChild(document.createTextNode(text));div.classList.add('statsitem');return div;}
static showhideKey(){if($('chartkey').offsetHeight!=0){SQMUserDisplay.hideKey();}else{SQMUserDisplay.showKey();}}
static showKey(){SQMUserDisplay.#allClassInnerHTML('showhidekey',"Hide key");$('chartkey').style.maxHeight=$('chartkeyhelper').offsetHeight+"px";setTimeout(()=>{$('chartkey').style.overflow="visible";},320);}
static hideKey(){SQMUserDisplay.#allClassInnerHTML('showhidekey',"Show key");$('chartkey').style.overflow="hidden";$('chartkey').style.maxHeight="0px";}
static isBinningShown(){return $('barbox').offsetHeight!=0;}
static showBinning(){SQMUserDisplay.#allClassInnerHTML('binning',"Hide bar chart");$('barbox').style.maxHeight=$('barboxhelper').offsetHeight+"px";setTimeout(()=>{$('barbox').style.overflow="visible";$('barbox').scrollIntoView();},620);}
static hideBinning(){SQMUserDisplay.#allClassInnerHTML('binning',"Show bar chart");$('barbox').style.overflow="hidden";$('barbox').style.maxHeight="0";}
static showhideBinning(){if(SQMUserDisplay.isBinningShown()){SQMUserDisplay.hideBinning();}else{SQMUserDisplay.showBinning();}}
static showUnknownCloudiness(){$('keyunknownclouds').style.display="inline-block";}
static hideUnknownCloudiness(){$('keyunknownclouds').style.display="none";}
static showCloudinessKey(){$('keycloudiness').style.display="inline-block";}
static hideCloudinessKey(){$('keycloudiness').style.display="none";}
static showMWKey(){$('keymw').style.display="inline-block";}
static hideMWKey(){$('keymw').style.display="none";}
static showInitialFileInput(){$('initialfileinputcover').style.display="inline-block";}
static hideInitialFileInput(){$('initialfileinputcover').style.display="none";}
static showAddFileInput(){$('addfileinputcover').style.display="inline-block";}
static hideAddFileInput(){$('addfileinputcover').style.display="none";}
static bestStatsHeight(){var height=0;if(window.getComputedStyle($('statsbox'),null).display!="none"){height+=$('statsbox').offsetHeight;}
if(window.getComputedStyle($('bestbox'),null).display!="none"){height+=$('bestbox').offsetHeight;}
return height;}
static saveImage(name,image){var a=document.createElement('a');a.href=image;const datetimes=SQMUserInputs.getDateTimeInputsAsDates();if(SQMUserInputs.getReadingsType()=='all_readings'){a.download=name+"_All_Readings_"+
SQMDate.formatFilenameDatetime(datetimes.start)+"_"+
SQMDate.formatFilenameDatetime(datetimes.end);}else{a.download=name+"_Best_Nightly_Readings_"+
SQMDate.formatFilenameDate(datetimes.start)+"_"+
SQMDate.formatFilenameDate(datetimes.end);}
a.click();}
static imageInNewTab(blob){window.open(URL.createObjectURL(blob),'_blank');}
static#allClassInnerHTML(classname,text){Array.from(document.getElementsByClassName(classname)).forEach((elt)=>{elt.innerHTML=text;});}
static dataFilesLink(){window.open(sqmConfig.dataFilesLink,'_blank').focus();}}
class SQMUserGuide{static#holder;static#isShowing;static initialize(divId){SQMUserGuide.#holder=$(divId);document.body.addEventListener('mousedown',SQMUserGuide.#click);SQMUserGuide.#isShowing=false;$('closeuserguide').addEventListener('click',SQMUserGuide.hide);}
static show(){if(!SQMUserGuide.#isShowing){SQMUserGuide.#holder.style.display="block";SQMUserGuide.#holder.style.opacity=0.25;SQMUserGuide.#isShowing=true;setTimeout(()=>{SQMUserGuide.#holder.style.opacity=1;},20);}}
static hide(){setTimeout(()=>{SQMUserGuide.#holder.style.opacity=0;setTimeout(()=>{SQMUserGuide.#holder.style.display="none";SQMUserGuide.#isShowing=false;},3*1000);},20);}
static#click(event){if(!SQMUserGuide.#holder.contains(event.target)&&SQMUserGuide.#isShowing){SQMUserGuide.hide();}}}
class SQMUserInputs{static isTouch;static initialize(){SQMUserInputs.isTouch=false;SQMUserInputs.#buildStartDatetimePicker();SQMUserInputs.#buildEndDatetimePicker();SQMUserInputs.#buildDatePicker();SQMUserInputs.#leftArrow=$('leftarrow');SQMUserInputs.#rightArrow=$('rightarrow');SQMUserInputs.#leftArrowGrid=$('leftarrowgrid');SQMUserInputs.#rightArrowGrid=$('rightarrowgrid');document.multiselect('#fakecurrentsqms');window.addEventListener('touchstart',function onFirstTouch(){SQMUserInputs.isTouch=true;window.removeEventListener('touchstarr',onFirstTouch,false);});}
static#leftArrow;static#rightArrow;static#leftArrowGrid;static#rightArrowGrid;static showArrows(actions){if(actions.right!=null){SQMUserInputs.#rightArrow.style.display='block';SQMUserInputs.#rightArrowGrid.style.opacity=1.0;SQMUserInputs.#rightArrowGrid.style.cursor='pointer';}else{SQMUserInputs.#rightArrow.style.display='none';SQMUserInputs.#rightArrowGrid.style.opacity=0.0;SQMUserInputs.#rightArrowGrid.style.cursor='default';}
if(actions.left!=null){SQMUserInputs.#leftArrow.style.display='block';SQMUserInputs.#leftArrowGrid.style.opacity=1.0;SQMUserInputs.#leftArrowGrid.style.cursor='pointer';}else{SQMUserInputs.#leftArrow.style.display='none';SQMUserInputs.#leftArrowGrid.style.opacity=0.0;SQMUserInputs.#leftArrowGrid.style.cursor='default';}}
static nightlyDatePicker;static startDatetimePicker;static endDatetimePicker;static#buildPicker(id,options){const width=getComputedStyle($(id)).width;options.disable=["1970-01-01"];options.parseDate=(string,format)=>{return dateFns.parse(string,format,new Date());};options.formatDate=(date,format,locale)=>{return dateFns.format(date,format);};options.altInput=true;if(!options.altFormat){options.altFormat=options.dateFormat;}
const picker=flatpickr('#'+id,options);picker.altInput.style.width=width;return picker;}
static#buildStartDatetimePicker(){SQMUserInputs.startDatetimePicker=SQMUserInputs.#buildPicker('startdatetime',{enableTime:true,time_24hr:SQMDate.user24hourTime(),dateFormat:SQMDate.serverDatetimeFormat(),altFormat:SQMDate.controlsDatetimeNoSecondsFormat()});}
static#buildEndDatetimePicker(){SQMUserInputs.endDatetimePicker=SQMUserInputs.#buildPicker('enddatetime',{enableTime:true,time_24hr:SQMDate.user24hourTime(),dateFormat:SQMDate.serverDatetimeFormat(),altFormat:SQMDate.controlsDatetimeNoSecondsFormat()});}
static#buildDatePicker(){SQMUserInputs.nightlyDatePicker=SQMUserInputs.#buildPicker('nightly',{dateFormat:SQMDate.serverDateFormat(),altFormat:SQMDate.controlsDateFormat()});}
static showOptions(){$('options').style.maxHeight=$('optionshelper').offsetHeight+"px";}
static hideOptions(){$('options').style.maxHeight="0";}
static showTimeInputs(){SQMUserInputs.startDatetimePicker.set('enableTime',true);SQMUserInputs.startDatetimePicker.set('time_24hr',SQMDate.user24hourTime());SQMUserInputs.startDatetimePicker.set('dateFormat',SQMDate.serverDatetimeFormat());SQMUserInputs.startDatetimePicker.set('altFormat',SQMDate.controlsDatetimeNoSecondsFormat());SQMUserInputs.endDatetimePicker.set('enableTime',true);SQMUserInputs.endDatetimePicker.set('time_24hr',SQMDate.user24hourTime());SQMUserInputs.endDatetimePicker.set('dateFormat',SQMDate.serverDatetimeFormat());SQMUserInputs.endDatetimePicker.set('altFormat',SQMDate.controlsDatetimeNoSecondsFormat());const elements=document.getElementsByClassName('flatpickr-time');for(var i=0;i<elements.length;i++){elements.item(i).style.display='block';}}
static hideTimeInputs(){SQMUserInputs.startDatetimePicker.set('enableTime',false);SQMUserInputs.startDatetimePicker.set('dateFormat',SQMDate.serverDateFormat());SQMUserInputs.startDatetimePicker.set('altFormat',SQMDate.controlsDateFormat());SQMUserInputs.endDatetimePicker.set('enableTime',false);SQMUserInputs.endDatetimePicker.set('dateFormat',SQMDate.serverDateFormat());SQMUserInputs.endDatetimePicker.set('altFormat',SQMDate.controlsDateFormat());const elements=document.getElementsByClassName('flatpickr-time');for(var i=0;i<elements.length;i++){elements.item(i).style.display='none';}}
static clearNightlyAndMonthlyInputs(){SQMUserInputs.clearNightlyInput();SQMUserInputs.clearMonthlyInput();}
static clearNightlyInput(){SQMUserInputs.nightlyDatePicker.clear();}
static clearMonthlyInput(){$('monthly').value="";}
static clearCustomInputs(){SQMUserInputs.startDatetimePicker.clear();SQMUserInputs.endDatetimePicker.clear();}
static setNightlyInput(date){SQMUserInputs.nightlyDatePicker.setDate(date,false);}
static setMonthlyInput(month){$('monthly').value=month;}
static setDateTimeInputsAsDates(start,end){SQMUserInputs.startDatetimePicker.setDate(start,false);SQMUserInputs.endDatetimePicker.setDate(end,false);}
static getDateTimeInputsAsDates(){return{start:SQMUserInputs.startDatetimePicker.selectedDates[0],end:SQMUserInputs.endDatetimePicker.selectedDates[0]};}
static setReadingsType(readingsType){$('readings').value=readingsType;if(readingsType=="all_readings"){SQMUserInputs.showTimeInputs();}else{SQMUserInputs.hideTimeInputs();}}
static getReadingsType(){return $('readings').value;}
static#currentMonth;static#availableMonths;static isMonthAvailable(month){return SQMUserInputs.#availableMonths.includes(month);}
static availableMonths(){return SQMUserInputs.#availableMonths;}
static setAvailableMonthsFrom(earliestDatetime,latestDatetime){SQMUserInputs.#currentMonth=$('monthly').options[$('monthly').selectedIndex].value;const monthsSince=SQMUserInputs.#monthsBetween(earliestDatetime,latestDatetime);if((!monthsSince)||(monthsSince.length==0)){$('monthlybox').style.display="none";SQMUserInputs.#availableMonths=[];return;}
SQMUserInputs.#availableMonths=monthsSince.map((month)=>month.value);const monthSelect=$('monthly');const monthlyDropdown=$('actualmonthlydropdown');while(monthSelect.options.length>0){monthSelect.remove(0);}
monthlyDropdown.innerHTML="";const newOption=new Option("","",true);monthSelect.appendChild(newOption);monthsSince.forEach((month)=>{const newOption=new Option(month.text,month.value,false,(month.value==SQMUserInputs.#currentMonth));monthSelect.appendChild(newOption);const anchor=document.createElement("a");anchor.setAttribute('href',"#");anchor.innerHTML=month.text;anchor.addEventListener("click",(event)=>{SQMUserRequest.monthly(month.value,true);});monthlyDropdown.appendChild(anchor);});$('monthlybox').style.display="flex";}
static#monthsBetween(earliestDatetime,latestDatetime){if(!earliestDatetime){return null;}
const dates=SQMDate.monthsBetween(earliestDatetime,latestDatetime);const months=[];dates.forEach((date)=>{months.push({text:SQMDate.formatControlsMonth(date),value:SQMDate.formatServerMonth(date)});});return months;}
static#multiselect;static rebuildMultiselect(sqmManager){$('fakecurrentsqms_multiSelect').style.display="inline-block";if(SQMUserInputs.#multiselect){SQMUserInputs.#multiselect.destroy();_.keys(sqmManager.availableSqmInfos).forEach((sqmId)=>{SQMUserInputs.#multiselect.setCheckBoxClick(sqmId,(target,args)=>{;});});}
const currentSqmsSelect=$('currentsqms');while(currentSqmsSelect.options.length>0){currentSqmsSelect.remove(0);}
const currentsqms=$('currentsqms');const availableSqmInfos=sqmManager.availableSqmInfos;sqmConfig.defaultSqm.forEach((sqmId)=>{if(_.keys(availableSqmInfos).includes(sqmId)){const option=new Option(availableSqmInfos[sqmId].name,sqmId,sqmManager.selectedSqmIds().includes(sqmId),sqmManager.selectedSqmIds().includes(sqmId));currentsqms.appendChild(option);}});_.keys(availableSqmInfos).forEach((sqmId)=>{if(!sqmConfig.defaultSqm.includes(sqmId)){const option=new Option(availableSqmInfos[sqmId].name,sqmId,sqmManager.selectedSqmIds().includes(sqmId),sqmManager.selectedSqmIds().includes(sqmId));currentsqms.appendChild(option);}});SQMUserInputs.#multiselect=document.multiselect('#currentsqms');SQMUserInputs.#multiselect.setCheckBoxClick("checkboxAll",(target,args)=>{if(args.checked){SQMUserRequest.multiselectAll();}else{SQMUserRequest.multiselectNone();}});_.keys(availableSqmInfos).forEach((sqmId)=>{SQMUserInputs.#multiselect.setCheckBoxClick(sqmId,Function("target","args","SQMUserRequest.multiselectAddRemove('"+sqmId+"');"));});if(_.keys(sqmManager.availableSqmInfos).length==1){$('currentsqms_multiSelect').style.display="none";}
$('fakecurrentsqms_multiSelect').style.display="none";}}
class SQMUserRequest{static#optionsShowing;static addEventListeners(){$('tonight').addEventListener("click",(event)=>{SQMUserRequest.tonight();});$('tonight').addEventListener("keyup",(event)=>{if((event.key=='Enter')||(event.key=='Return')){SQMUserRequest.tonight();}});SQMUserInputs.nightlyDatePicker.config.onChange.push(()=>{if(SQMUserInputs.nightlyDatePicker.selectedDates.length>0){SQMUserRequest.nightly(SQMDate.formatServerDate(SQMUserInputs.nightlyDatePicker.selectedDates[0]));}});$('gridbutton').addEventListener("click",(event)=>{SQMUserRequest.showGrid();});$('gridbutton').addEventListener("keyup",(event)=>{if((event.key=='Enter')||(event.key=='Return')){SQMUserRequest.showGrid();}});$('monthlydropdown').addEventListener("click",(event)=>{$('actualmonthlydropdown').classList.toggle("monthlyshow");});window.addEventListener("click",(event)=>{if(!event.target.matches('.monthlydropbutton')){if($('actualmonthlydropdown').classList.contains('monthlyshow')){$('actualmonthlydropdown').classList.remove('monthlyshow');}}});$('sixmonths').addEventListener("click",(event)=>{SQMUserRequest.sixMonths();});$('sixmonths').addEventListener("keyup",(event)=>{if((event.key=='Enter')||(event.key=='Return')){SQMUserRequest.sixMonths();}});$('alltime').addEventListener("click",(event)=>{SQMUserRequest.allTime();});$('alltime').addEventListener("keyup",(event)=>{if((event.key=='Enter')||(event.key=='Return')){SQMUserRequest.allTime();}});SQMUserRequest.#optionsShowing=false;$('showhideoptions').addEventListener("click",(event)=>{SQMUserRequest.showhideOptions();});$('showhideoptions').addEventListener("keyup",(event)=>{if((event.key=='Enter')||(event.key=='Return')){SQMUserRequest.showhideOptions();}});$('readings').addEventListener("change",(event)=>{SQMUserRequest.setReadings($('readings').options[$('readings').selectedIndex].value);});$('loadbutton').addEventListener("click",(event)=>{SQMUserRequest.custom();});$('loadbutton').addEventListener("keyup",(event)=>{if((event.key=='Enter')||(event.key=='Return')){SQMUserRequest.custom();}});$('initialfileupload').addEventListener("change",(event)=>{SQMUserRequest.addInitialDataFromLocalFiles($('initialfileupload').files);SQMUserDisplay.hideInitialFileInput();});$('addfileupload').addEventListener("change",(event)=>{SQMUserRequest.addDataFromLocalFiles($('addfileupload').files);SQMUserDisplay.hideAddFileInput();});$('leftarrow').addEventListener("click",(event)=>{SQMUserRequest.leftArrow();});$('rightarrow').addEventListener("click",(event)=>{SQMUserRequest.rightArrow();});$('leftarrowgrid').addEventListener("click",(event)=>{SQMUserRequest.leftArrow();});$('rightarrowgrid').addEventListener("click",(event)=>{SQMUserRequest.rightArrow();});SQMUserSwipe.initialize();SQMUserSwipe.addListener(SQMUserRequest.swipe);}
static swipe(swipe){switch(swipe.type){case'right':SQMUserRequest.rightArrow();return true;case'left':SQMUserRequest.leftArrow();return true;}
return false;}
static#arrowActions;static setArrowActions(actions={}){SQMUserRequest.#arrowActions=actions;SQMUserInputs.showArrows(actions);}
static leftArrow(){if(SQMUserRequest.#arrowActions&&SQMUserRequest.#arrowActions.left){SQMUserRequest.arrowAction(SQMUserRequest.#arrowActions.left);}}
static rightArrow(){if(SQMUserRequest.#arrowActions&&SQMUserRequest.#arrowActions.right){SQMUserRequest.arrowAction(SQMUserRequest.#arrowActions.right);}}
static arrowAction(action){switch(action.type){case'nightly':SQMUserRequest.nightlySlide(action.date);break;case'monthly':SQMUserRequest.monthlySlide(action.month);break;case'sixmonths':SQMUserRequest.sixMonthsSlide(action.endDate);break;case'grid':SQMUserRequest.gridArrowAction(action);break;}}
static#timeChartGrid;static showGrid(){if(!SQMUserRequest.#timeChartGrid){SQMUserRequest.#timeChartGrid=new SQMTimeChartGrid('timechartgridholder','timechartgrid');}
SQMUserRequest.#timeChartGrid.setPriorArrowActions(SQMUserRequest.#arrowActions);SQMUserRequest.#timeChartGrid.showBackground();SQMUserRequest.#timeChartGrid.setColorManagers(sqmManager.getColorManagers());SQMUserDisplay.showLoading();const dates=SQMUserInputs.getDateTimeInputsAsDates();var promise;if(SQMUserInputs.getReadingsType()=='all_readings'){const startDate=isNaN(dates.start)?new Date():dates.start;promise=SQMUserRequest.#timeChartGrid.loadNightly(startDate);}else{const endDate=isNaN(dates.end)?new Date():dates.end;const month=SQMDate.formatServerMonth(endDate);promise=SQMUserRequest.#timeChartGrid.loadMonthly(month);}
return promise.then((arrowActions)=>{SQMUserRequest.setArrowActions(arrowActions);SQMUserDisplay.hideLoading();SQMUserRequest.#timeChartGrid.showGrid();});}
static gridArrowAction(action){SQMUserDisplay.showLoading();return SQMUserRequest.#timeChartGrid.arrowAction(action).then((arrowActions)=>{SQMUserRequest.setArrowActions(arrowActions);SQMUserDisplay.hideLoading();SQMUserRequest.#timeChartGrid.redraw();});}
static tonight(){return SQMUserRequest.nightFor();}
static nightFor(datetime=null){const activeSqmInfos={};sqmManager.activeSqmIds().forEach((sqmId)=>{activeSqmInfos[sqmId]=sqmManager.availableSqmInfos[sqmId];});const date=SQMSunUtils.sunsetBeforeOne(activeSqmInfos,datetime);SQMUserInputs.clearNightlyInput();SQMUserInputs.setNightlyInput(date);return SQMUserRequest.nightly(null);}
static nightly(date,addToHistory=true){return SQMUserRequest.#doNightly(date,addToHistory,false);}
static nightlySlide(date,addToHistory=true){return SQMUserRequest.#doNightly(date,addToHistory,true);}
static#doNightly(date,addToHistory,slide){if(!date){date=SQMDate.formatServerDate(SQMUserInputs.nightlyDatePicker.selectedDates[0]);}
const activeSqmInfos={};sqmManager.selectedSqmIds().forEach((sqmId)=>{activeSqmInfos[sqmId]=sqmManager.availableSqmInfos[sqmId];});const times=SQMSunUtils.sunsetSunrisesForNight(date,activeSqmInfos);const sunset=_.keys(times).map((sqmId)=>times[sqmId].sunset).reduce((acc,val)=>acc<val?acc:val,times[_.keys(times)[0]].sunset);const sunrise=_.keys(times).map((sqmId)=>times[sqmId].sunrise).reduce((acc,val)=>acc>val?acc:val,times[_.keys(times)[0]].sunrise);return sqmManager.userRequest({type:'nightly',date:date,twilightType:sqmConfig.twilightType},(startDatetime,endDatetime)=>"All readings from sunset "+SQMDate.serverToTitleDatetime(sunset)+" to sunrise "+SQMDate.serverToTitleDatetime(sunrise),slide).then((sqmResponses)=>{SQMUserInputs.clearMonthlyInput();SQMUserInputs.setNightlyInput(date);if(addToHistory){SQMBrowserHistory.nightly(date);}
const dateObject=SQMDate.parseServerDate(date);const actions={left:{type:'nightly',date:SQMDate.formatServerDate(dateFns.addDays(dateObject,-1))}};if(dateObject<=dateFns.addDays(new Date(),-1)){actions.right={type:'nightly',date:SQMDate.formatServerDate(dateFns.addDays(dateObject,1))};}
SQMUserRequest.setArrowActions(actions);});}
static monthly(month,addToHistory=true){if(month!=""){return SQMUserRequest.#doMonthly(month,addToHistory,false);}}
static monthlySlide(month,addToHistory=true){return SQMUserRequest.#doMonthly(month,addToHistory,true);}
static#doMonthly(month,addToHistory,slide){const date=dateFns.setDate(SQMDate.parseServerMonth(month),1);const titleString="Best nightly readings during "+SQMDate.formatTitleMonth(date);const firstDay=SQMDate.formatServerDatetime(date);const lastDay=SQMDate.formatServerDatetime(dateFns.lastDayOfMonth(date));return sqmManager.userRequest({type:'best_nightly_readings',start:firstDay,end:lastDay},(startDatetime,endDatetime)=>titleString,slide).then((sqmResponses)=>{SQMUserInputs.clearNightlyInput();SQMUserInputs.setMonthlyInput(month);if(addToHistory){SQMBrowserHistory.monthly(month);}
const dateObject=SQMDate.parseServerMonth(month);const monthBefore=SQMDate.formatServerMonth(dateFns.addMonths(dateObject,-1));const monthAfter=SQMDate.formatServerMonth(dateFns.addMonths(dateObject,1));const actions={};if(SQMUserInputs.isMonthAvailable(monthBefore)){actions.left={type:'monthly',month:monthBefore};}
if(SQMUserInputs.isMonthAvailable(monthAfter)){actions.right={type:'monthly',month:monthAfter};}
SQMUserRequest.setArrowActions(actions);});}
static allTime(addToHistory=true){return sqmManager.userRequest({type:'best_nightly_readings'},(startDatetime,endDatetime)=>"Best nightly readings over all data").then((sqmResponses)=>{SQMUserInputs.clearNightlyAndMonthlyInputs();if(addToHistory){SQMBrowserHistory.allTime();}
SQMUserRequest.setArrowActions();});}
static sixMonths(addToHistory=true){var endDate=SQMUserInputs.getDateTimeInputsAsDates().end;if(isNaN(endDate)){endDate=new Date();}
return SQMUserRequest.#doSixMonths(endDate,addToHistory,false);}
static sixMonthsBeforeDate(endDateString,addToHistory=true){const endDate=SQMDate.parseServerDate(endDateString);return SQMUserRequest.#doSixMonths(endDate,addToHistory,false);}
static sixMonthsSlide(endDate,addToHistory=true){return SQMUserRequest.#doSixMonths(endDate,addToHistory,true);}
static#doSixMonths(endDate,addToHistory,slide){const todayString=SQMDate.formatServerDate(endDate);const date=dateFns.addMonths(endDate,-6);const sixMonthsAgoString=SQMDate.formatServerDate(date);const monthBefore=SQMDate.formatServerMonth(dateFns.addMonths(date,-1));const monthAfter=SQMDate.formatServerMonth(dateFns.addMonths(date,7));const actions={};if(SQMUserInputs.isMonthAvailable(monthBefore)){actions.left={type:'sixmonths',endDate:dateFns.addMonths(endDate,-1)};}
if(SQMUserInputs.isMonthAvailable(monthAfter)){actions.right={type:'sixmonths',endDate:dateFns.addMonths(endDate,1)};}
return sqmManager.userRequest({type:'best_nightly_readings',start:sixMonthsAgoString,end:todayString},(startDatetime,endDatetime)=>"Best nightly readings "+SQMDate.formatTitleDate(date)
+" to "+SQMDate.formatTitleDate(endDate),slide).then((sqmResponses)=>{SQMUserInputs.clearNightlyAndMonthlyInputs();if(addToHistory){SQMBrowserHistory.sixMonths(SQMDate.formatServerDate(endDate));}
SQMUserRequest.setArrowActions(actions);});}
static custom(addToHistory=true){const readingsType=SQMUserInputs.getReadingsType();const dateTimeInputs=SQMUserInputs.getDateTimeInputsAsDates();if((!dateTimeInputs.start)||(!dateTimeInputs.end)){alert("Please enter valid start and end dates");return false;}
if(readingsType=='all_readings'){return SQMUserRequest.#customAll(dateTimeInputs.start,dateTimeInputs.end,addToHistory);}else{return SQMUserRequest.#customBestNightly(dateTimeInputs.start,dateTimeInputs.end,addToHistory);}}
static#customBestNightly(start,end,addToHistory){const titleString="Best nightly readings from "+SQMDate.formatTitleDate(start)+" to "+SQMDate.formatTitleDate(end);const startDate=SQMDate.formatServerDatetime(start);const endDate=SQMDate.formatServerDatetime(end);return sqmManager.userRequest({type:'best_nightly_readings',start:startDate,end:endDate},(startDatetime,endDatetime)=>titleString).then((sqmResponses)=>{SQMUserInputs.clearNightlyAndMonthlyInputs();if(addToHistory){SQMBrowserHistory.customBestNightly(startDate,endDate);}
SQMUserRequest.setArrowActions();});}
static#customAll(start,end,addToHistory){const titleString="All readings from "+SQMDate.formatTitleDatetime(start)+" to "+SQMDate.formatTitleDatetime(end);const startDatetime=SQMDate.formatServerDatetime(start);const endDatetime=SQMDate.formatServerDatetime(end);if(Math.abs(dateFns.differenceInDays(endDatetime,startDatetime))>=60){alert("Showing all readings over a 60+ day period is not supported.  Showing best nightly readings in requested range instead.");SQMUserRequest.#customBestNightly(start,end,addToHistory);return;}
return sqmManager.userRequest({type:'all_readings',start:startDatetime,end:endDatetime},(startDatetime,endDatetime)=>titleString).then((sqmResponses)=>{SQMUserInputs.clearNightlyAndMonthlyInputs();if(addToHistory){SQMBrowserHistory.customAll(startDatetime,endDatetime);}
SQMUserRequest.setArrowActions();});}
static showhideOptions(){if(SQMUserRequest.#optionsShowing){SQMUserInputs.hideOptions();SQMUserRequest.#optionsShowing=false;}else{SQMUserInputs.showOptions();SQMUserRequest.#optionsShowing=true;}}
static setReadings(readingsType){SQMUserInputs.setReadingsType(readingsType);}
static multiselectAll(){sqmManager.selectAll();}
static multiselectNone(){sqmManager.deselectAll();}
static multiselectAddRemove(sqmId){if(sqmManager.selectedSqmIds().includes(sqmId)){sqmManager.deselect(sqmId);}else{sqmManager.select(sqmId);}}
static addDataFromLocalFiles(fileList){if((fileList)&&(_.keys(fileList).length>0)){sqmManager.createInMemorySqm(fileList).catch((error)=>{if(sqmConfig.debug){console.log("Parsing file failed");console.log(error);}
SQMUserDisplay.hideLoading();alert("Failed to parse data file, is it a valid SQM data file?");});}}
static addInitialDataFromLocalFiles(fileList){if((fileList)&&(_.keys(fileList).length>0)){SQMUserDisplay.showLoading();sqmManager.createInMemorySqm(fileList,false).then((sqmId)=>{sqmManager.activateSqmId(sqmId);sqmManager.updateEarliestLatest();sqmManager.initialQuery();}).catch((error)=>{if(sqmConfig.debug){console.log("Parsing file failed");console.log(error);}
SQMUserDisplay.hideLoading();alert("Failed to parse data file, is it a valid SQM data file?");});}}}
class SQMUserSwipe{static#listeners;static#threshold;static addListener(listener){SQMUserSwipe.#listeners.push(listener);}
static removeListener(listener){const index=SQMUserSwipe.#listeners.indexOf(listener);SQMUserSwipe.#listeners=SQMUserSwipe.#listeners.splice(index,1);}
static initialize(){SQMUserSwipe.#threshold=Math.max(1,Math.floor(0.01*(window.innerWidth||document.body.clientWidth)));SQMUserSwipe.#listeners=[];document.addEventListener('touchstart',SQMUserSwipe.handleTouchStart,false);document.addEventListener('touchmove',SQMUserSwipe.handleTouchMove,false);}
static#touchPosition(event){const firstTouch=event.touches[0];return{x:firstTouch.clientX,y:firstTouch.clientY};}
static#down;static handleTouchStart(event){SQMUserSwipe.#down=SQMUserSwipe.#touchPosition(event);}
static handleTouchMove(event){if(!SQMUserSwipe.#down){return;}
const up=SQMUserSwipe.#touchPosition(event);const xDiff=SQMUserSwipe.#down.x-up.x;const yDiff=SQMUserSwipe.#down.y-up.y;const swipe={start:SQMUserSwipe.#down,end:up};if(Math.abs(xDiff)>Math.abs(yDiff)){if(xDiff>SQMUserSwipe.#threshold){swipe.type='right';}else{swipe.type='left';}}else{if(xDiff>SQMUserSwipe.#threshold){swipe.type='down';}else{swipe.type='up';}}
SQMUserSwipe.#down=null;SQMUserSwipe.swipe(swipe,event);}
static swipe(swipe,event){SQMUserSwipe.#listeners.forEach((listener)=>{if(listener(swipe)){event.preventDefault();}});}}





</script>
<!-- standalone.php -->
<!-- SQM Visualizer -->
<!-- (c) 2025 Darren Creutz -->
<!-- Licensed under the GNU AFFERO GENERAL PUBLIC LICENSE v3 --><script type="text/javascript">
var elm=document.getElementsByTagName("html")[0];
elm.style.display="none";
document.addEventListener("DOMContentLoaded",function(event) {elm.style.display="block"; });
</script>
</head>
<body>
<noscript>
	<div class="titlebox" style="z-index: 100">
		<h2>JavaScript is required for this site</h2>
	</div>
</noscript>
<div id="titlebox" class="titlebox">
	<h2 class="title"><span id="pagetitle">SQM Visualizer</span></h2>
	<span class="tooltip">
		<select id="currentsqms" multiple></select>
		<span class="multitooltiptext">
			Select among available SQM datasets<br/>
			Choose multiple for a visual comparison
		</span>
	</span>
	<select id="fakecurrentsqms" multiple>
		<option value="" selected></option>
	</select>
</div>
<div id="titlehr" class="fakehr"><div class="fakehrinside"></div></div>
<div id="topcontainer" class="container">
	<div class="box">
		<span class="clickable tooltip" id="tonight" tabindex="1">
			Tonight
			<span class="bottomtooltiptext">
				All nightly readings starting from the most recent sunset
			</span>
		</span>
	</div>
	<div class="box">
		<span class="tooltip" style="margin-bottom: -1px">
			Nightly
			<span class="bottomtooltiptext">
				All nightly readings starting from sunset of the chosen date
			</span>
		</span>
		&nbsp; <input id="nightly" name="nightly" type="text" readonly tabindex="2" />
	</div>
	<div class="box" id="monthlybox">
		<div class="monthlydropdown">
			<select id="monthly"><option value=""></option></select>
			<div id="monthlydropdown" class="monthlydropbutton tooltip" tabindex="3">
				Monthly
				<span class="righttooltiptext" style="min-width: 200px">
					Best (highest) reaadings from each night of the chosen month
				</span>
			</div>
			<div id="actualmonthlydropdown" class="monthlycontent">
				<a href="#">2024-02</a>
			</div>
		</div>
	</div>
	<div class="box" id="gridbutton">
		<span class="clickable tooltip" tabindex="4">
			Grid
			<span class="bottomtooltiptext">
				View multiple graphs simultaneously
			</span>
		</span>
	</div>
	<div id="sixmonths" class="box">
		<span class="clickable tooltip" tabindex="5">
			Six months
			<span class="bottomtooltiptext">
				Best (highest) readings from each night over the past six months
			</span>
		</span>
	</div>
	<div id="alltime" class="box">
		<span class="clickable tooltip" tabindex="6">
			All
			<span class="bottomtooltiptext">
				Best (highest) readings from each night over all available data
			</span>
		</span>
	</div>
	<div id="showhideoptions" class="box">
		<span class="clickable tooltip" tabindex="7">
			Custom
			<span class="bottomtooltiptext">
				Customize datetime range
			</span>
		</span>
	</div>
</div>
<div id="options">
	<div id="optionshelper">
		<div class="fakehr"><div class="fakehrinside"></div></div>
		<div class="optionscontainer">
			<select id="readings" class="optionitem" tabindex="8">
				<option value="all_readings">All readings</option>
				<option value="best_nightly_readings">Best nightly</option>
			</select>
			<span class="optiontext">from</span>
			<div class="datetimebox">
				<input id="startdatetime" name="startdate" type="text" readonly tabindex="9" />
			</div>
			<span class="optiontext">to</span>
			<div class="datetimebox">
				<input id="enddatetime" name="enddate" type="text" readonly tabindex="10" />
			</div>
			<span id="loadbutton" class="clickable" tabindex="11">
				Load
			</span>
		</div>
	</div>
</div>
<div class="fakehr"><div class="fakehrinside"></div></div>
<div class="graph" id="thegraph">
	<div id="timechartgridholder">
		<div class="close" id="closegrid"></div>
		<div id="leftarrowgrid">
			<i class="gridarrow gridleftarrow"></i>
			<i class="gridarrow gridleftarrow shiftleft"></i>
		</div>
		<div id="timechartgrid"></div>
		<div id="rightarrowgrid">
			<i class="gridarrow gridrightarrow shiftright"></i>
			<i class="gridarrow gridrightarrow"></i>
		</div>
	</div>
	<div class="graphtext">
		<div id="leftarrow">
			<i class="arrow leftarrow"></i>
			<i class="arrow leftarrow shiftleft"></i>
		</div>
		<div id="rightarrow">
			<i class="arrow rightarrow shiftright"></i>
			<i class="arrow rightarrow"></i>
		</div>
		<h3 id="graphtitle"></h3>
		<h4 class="graphsubtitle" id="noreadingsbox">No readings in range</h4>
		<h4 class="graphsubtitle" id="bestbox"><span id="besttext">&nbsp;</span></h4>
	</div>
	<div class="chartbox">
		<div id="timechart">
		</div>
		<div id="legendtooltip">
			<div id="legendtooltipname"></div>
			<div id="legendtooltiplat"></div>
			<div id="legendtooltiplong"></div>
			<div id="legendtooltipelev"></div>
			<div id="legendtooltiptz"></div>
			<div id="legendtooltipclick"></div>
		</div>
		<div class="loadingring" id="loading"></div>
	</div>
	<div class="graphtextstats">
		<h4 class="graphsubtitle" id="statsbox">
			<div id="stats">&nbsp;</div>
		</h4>
	</div>
	<div id="chartkey">
		<div id="chartkeyhelper">
			<div class="keyitem">
				<span class="tooltip defaultcursor">
					<span class="smalltext">Sun</span>
					<span class="toptooltiptext">
						Readings affected by the sun, calculated from solar altitude
					</span>
				</span>
				<span class="keybox"><span class="keylinecontainer"><span class="keyline"></span></span><span class="keysun tooltip" id="keysun1"><span class="keytooltiptext" id="keysuntooltip1"></span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keysun tooltip" id="keysun2"><span class="keytooltiptext" id="keysuntooltip2"></span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keysun tooltip" id="keysun3"><span class="keytooltiptext" id="keysuntooltip3"></span></span><span class="keylinecontainer"><span class="keyline"></span></span></span>
			</div>
			<div class="keyitem">
				<span class="tooltip defaultcursor">
					<span class="smalltext">Moon</span>
					<span class="toptooltiptext">
						Readings affected by the moon, calculated from lunar altitude and illumination
					</span>
				</span>
				<span class="keybox"><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon1"><span class="keytooltiptext">Heavy moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon2"><span class="keytooltiptext">Heavy moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon3"><span class="keytooltiptext">High moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon4"><span class="keytooltiptext">High moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon5"><span class="keytooltiptext">Mild moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon6"><span class="keytooltiptext">Mild moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon7"><span class="keytooltiptext">Low moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon8"><span class="keytooltiptext">Low moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon9"><span class="keytooltiptext">Little moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymoon tooltip" id="keymoon10"><span class="keytooltiptext">(Effectively) no moon light</span></span><span class="keylinecontainer"><span class="keyline"></span></span></span>
			</div>
			<div class="keyitem" id="keycloudiness">
				<span class="tooltip defaultcursor">
					<span class="smalltext">Clouds</span>
					<span class="toptooltiptext">
						Readings affected by cloudiness, calculated from mean r&sup2;
					</span>
				</span>
				<span class="keybox"><span id="keyclouds1"><span class="keylinecontainer"><span class="keyline"></span></span><span class="keyclouds tooltip"><span class="keytooltiptext">Very cloudy</span></span><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span></span><span id="keyclouds2"><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span><span class="keyclouds tooltip"><span class="keytooltiptext">Cloudy</span></span><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span></span><span id="keyclouds3"><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span><span class="keyclouds tooltip"><span class="keytooltiptext">Somewhat cloudy</span></span><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span></span><span id="keyclouds4"><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span><span class="keyclouds tooltip"><span class="keytooltiptext">Mostly clear</span></span><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span></span><span id="keyclouds5"><span class="halfkeylinecontainer"><span class="halfkeyline"></span></span><span class="keyclouds tooltip"><span class="keytooltiptext">Clear</span></span><span class="keylinecontainer"><span class="keyline"></span></span></span></span><span class="keybox" id="keyunknownclouds"><span class="keylinecontainerunknown tooltip"><span class="keylinedashed"><span class="keylinedash"></span><span class="keylinedash"></span><span class="keylinedash"></span></span><span class="keytooltiptext">Indeterminate cloudiness</span></span></span>
			</div>
			<div class="keyitem" id="keymw">
				<span class="tooltip defaultcursor">
					<span class="smalltext" style="font-size: 95%;">Milky Way</span>
					<span class="toptooltiptext">
						Readings affected by the milky way, calculated from galactic latitude
					</span>
				</span>
				<span class="keybox"><span class="keylinecontainer"><span class="keyline"></span></span><span class="keymw tooltip" id="keymw1"><span id="keymw1a"></span><span class="keytooltiptext" id="keymwtooltip1"></span></span><span class="keylinecontainer"><span class="keyline"></span></span></span>
			</div>
		</div>
	</div>
</div>
<div class="fakehr"><div class="fakehrinside"></div></div>
<div id="barbox">
	<div id="barboxhelper">
		<div class="chartbox">
			<div id="barchart">
			</div>
			<ul id="barcontextmenu">
			</ul>
		</div>
		<div class="fakehr"><div class="fakehrinside"></div></div>
	</div>
</div>
<div class="container">
	<h4 class="graphsubtitle" id="latestbox"><span id="latesttext"></span></h4>
</div>
<div id="imagepopup">
	<div class="close" id="imageclose"></div>
	<div id="imagebackground">
		<div class="imagecontainer">
			<h3 id="theimagetext"></h3>
			<img id="theimage"/>
		</div>
	</div>
</div>
<div id="aboutpage">
	<div class="aboutcontainer">
		<div class="close" id="closeabout"></div>
		<h2 class="abouttitle">SQM Visualizer</h2>
		<h4>&copy; 2025 Darren Creutz</h4>
		<div class="aboutlinks">
			<a class="abouthref" href="https://dcreutz.com/sqm" target="_blank">dcreutz.com/sqm</a>
			| 
			<a class="abouthref" href="https://github.com/dcreutz/SQM-Visualizer/blob/main/README.md" target="_blank">github.com/dcreutz/SQM-Visualizer</a>
		</div>
	</div>
</div>
<div id="userguidepage">
	<div class="userguidecontainer">
		<div class="userguidetitle">
			<h2 class="abouttitle">SQM Visualizer</h2>
			<h4>&copy; 2025 Darren Creutz</h4>
			<div class="aboutlinks">
				<a class="abouthref" href="https://dcreutz.com/sqm" target="_blank">dcreutz.com/sqm</a>
				| 
				<a class="abouthref" href="https://github.com/dcreutz/SQM-Visualizer/blob/main/README.md" target="_blank">github.com/dcreutz/SQM-Visualizer</a>
			</div>
		</div>
		<div class="close" id="closeuserguide"></div>
		<div id="userguidetext">
<h1>Sky Quality Meter (SQM) Visualizer User Guide</h1>
<p>This describes the functions/features of the SQM Visualizer, how to access each feature, and how to navigate around the display. The SQM Visualizer works with data from a Unihedron SQM Device in the 'International Dark Sky Association (IDA) NSBM Community Standards for Reporting Skyglow Observations' <a href="https://darksky.org/app/uploads/bsk-pdf-manager/47_SKYGLOW_DEFINITIONS.PDF">format</a> and files in the format output by the Unihedron software feature 'sun-moon-mw-clouds'.</p>
<p>The SQM Visualizer can display live data being captured to a computer that both stores the captured data and runs the SQM Visualizer as a web application, in essentially real time.  In addition, without real time data, the SQM Visualizer will display historical data that may be loaded periodically (e.g., daily, monthly, or at some other frequency).  Thus, a user can transfer data from the stations local computer to a central server via FTP, manual file transfer with USB sticks, or other mechanisms.</p>
<p>The Sky Quality Meter (SQM) captures and records data on how dark the sky is by recording msas (magnitudes per arc second squared) values; the SQM Visualizer presents this data for user information and analysis, providing a variety of perspectives.  This brief user guide explains the features of the SQM Visualizer and how to access them.  While there are many algorithms used to interpret the data to make it easily visualized by users, the SQM Visualizer is not intended for scientific research.  To that end, the actual data files can be accessed independently (with appropriate access to the computer storing the data; the SQM Visualizer application can also be configured to make the raw data files available for download) and analyzed by researchers and others interested in deeper perspectives, or using different assumptions and algorithms, than those incorporated in the SQM Visualizer.</p>
<h2>Main display</h2>
<p>Upon launching the SQM Visualizer, the user is presented with a graph showing the most recent set of SQM readings.  Depending on the time of day, the graph presents either data from yesterday, or data from today since evening nautical twilight (this can be configured to be civil or astronomical twilight).  (Prior to todays twilight, the data shown is that for yesterday.)  The SQM Visualizer will update the graph in real time as new data is downloaded from the Unihedron device.</p>
<p>While there are number of configuration options that can tweak the specifics of the display for individual implementations, the default configuration presents nightly data with the best (darkest/highest msas) readings at the bottom of the graph and the readings for the brightest sky at the top.  Since readings typically run from evening twilight into the night (ending at morning twilight), the readings presented generally look like a broad valley, rapidly moving towards the best readings at the bottom of the graph, running through the night, and then moving upwards as the sun rises in the morning.  By default, when presenting best nightly readings over a time range, the vertical axis is oriented with the darkest readings at the top.</p>
<p>The graph consists of a line with circles representing each data point.  The colors, shading and shape of the line and circles provide information about the conditions of the sky (e.g., moon above the horizon, estimated cloud cover [as calculated by algorithms within the SQM Visualizer], etc.).  The SQM Visualizer can display multiple reporting stations (as described below).  Each reporting station is displayed with a different color.</p>
<p>For each station, there are a variety of color/shading options that may appear (again, this is assuming the default configuration as many values are configurable):</p>
<ul>
<li>Solid dark lines and circles indicate that the readings exist, that there is no interference from the moon, sun, or clouds, and the data can be presumed to be valid.</li>
<li>Yellow/orange circles indicate that the sun is within 18 degrees of the horizon, and therefore can be presumed to have an influence on the level of darkness.</li>
<li>Lines and circles that are ghosts (i.e., faint) indicate that it is significantly cloudy (as calculated by algorithms within the SQM Visualizer) and any data should not be considered to represent clear-sky darkness values.</li>
<li>Circles that are neither yellow nor solid indicate that the moon is above the horizon.  These circles may run from faint to deep gray, indicating the intensity of the moons probable interference (a combination of altitude and phase of the moon).  The darker the circle, the less moon interference is present.  (Note: the level of moon interference is calculated from information on moon altitude and phase and is not itself measured.)</li>
<li>Diamonds indicate that the milky way may be interfering in that the galactic latitude is within the specified cutoff (defaults to 2.5 degrees)</li>
</ul>
<p>Since the SQM Visualizer can show multiple stations at one time, each station is assigned a specific color (blue, gray, orange, etc.).  Depending on the specific configuration of your implementation, the default station for your implementation is deep blue.  As additional stations are identified for display, the SQM Visualizer will assign additional colors.  A legend below the graphical display provides the color associated with each displayed station; placing the cursor over a station (equivalently, clicking on it when on a touch screen device) in the legend shows its latitude, longitude, and local time zone (and elevation if that is specified in the data files).   </p>
<p>The top section of the display shows general information and allows the user to request specific time (in the stations time zone) intervals for display.  While the default view is tonight (or yesterday if it is prior to twilight), the user may request a specific night.  In addition, the user may view the best reading (i.e., the darkest reading) for each night for any month, each night for the past six months, or for all (all data recorded for the selected stations).   </p>
<p>Using the Custom button, the user may define any specific time interval by defining a start and end date/time.  The Custom button also allows the user to request either all reading during the custom interval or the best nightly readings during the custom interval.  The user must click the Load button to actually view the data for a custom interval.  If the user changes the interval or which data to select, the user must again press the Load button to update the graph.</p>
<p>Note that at any time, the user can return to Tonight (displaying either tonights current data, or data for yesterday if it is before twilight) using the Tonight button.</p>
<p>Below the row of time interval selection options, is the period being displayed, and the best reading within the displayed interval and the date/time of the first occurrence of that reading during the period.</p>
<p>Below the graph is the legend showing the colors for each displayed station, and below that the latest reading among all selected SQM stations.</p>
<h2>Options menu</h2>
<p>Clicking with the right mouse button (press and hold on touch screen devices) anywhere on the graph opens an options menu.  The options are:</p>
<ul>
<li>Open graph in new tab  which displays the current graph as an image in a new tab</li>
<li>Save graph as image  which downloads the current graph image as a .png file to your default download folder</li>
<li>Show/hide statistics  which adds a row above the graph displaying statistics for the time interval displayed on the graph; for each station selected for display, statistics shown are: name of station; mean msas value; median msas value; number of data readings; and best (highest msas) reading with date/time of its first occurrence</li>
<li>Show/hide bar chart  which displays a bar chart below the data display providing an aggregate view of the data readings for the displayed interval</li>
<li>Hide/show best reading  which removes the display of the best reading during the time interval that appears above the graph</li>
<li>Hide/show latest reading  which removes the display of the last reading that appears below the graphical display</li>
<li>Exclude/include sun, moon, MW, clouds data  which removes those data points where the algorithms of the SQM Visualizer evaluates that the data are influenced by the sun, moon, milky way, or clouds; this results in gaps in the graph and shows data points only when the sky is dark and presumed to be clear</li>
<li>Exclude/include cloudy data  which removes those data points where the algorithms of the SQM Visualizer evaluates that the data are influenced by clouds (but does not remove sun or moon influenced data)</li>
<li>Axis minimum  which sets the minimum msas reading to be included on the vertical axis (note that the minimum cannot be set lower than the bad daat cutoff specified in the configuration file, the default cutoff is 10.0)</li>
<li>Axis maximum  which sets the maximum msas reading to be included on the vertical axis</li>
<li>Reverse vertical axis  which reverses the direction of the vertical axis</li>
<li>Hide/show legend  which removes the legend below the graph showing the color codes and geographical data for the (possibly multiple) SQM stations displayed on the graph</li>
<li>Hide/show key  which removes the key below the graph legend describing the colorization based on sun, moon, MW and clouds</li>
<li>Add local data  which allows the user to load files of SQM data from their own device.  (Note that this data does not persist past the current session of the SQM Visualizer and is not uploaded to the server.)</li>
<li>View data files  which allows the user to view the raw data files</li>
<li>About...  which shows information about the SQM Visualizer software</li>
<li>User Guide  which shows this guide</li>
</ul>
<p>On mobile devices with small screens, some options are disabled in order to keep the menu small enough to be completely visible.</p>
<p>The options to exclude cloudy data are only available if the data files contain mean r squared calculations (or if run on a server).</p>
<h2>Detailed information for a reading</h2>
<p>If you hover over a specific data point (equivalently, click on a data point on touch screen devices), information appears related to that data point:</p>
<ul>
<li>Date/time of the reading</li>
<li>Moon status at the time of the reading</li>
<li>Sun status at the time of the reading</li>
<li>Galactic position at the time of the reading</li>
<li>Mean $r^2$, a technical value used in calculating the estimated cloud cover; in general a higher $r^2$ suggests a more cloudy sky</li>
<li>Name of the SQM station that associated the data point</li>
<li>Image thumbnail (if images are attached to the data)</li>
</ul>
<p>Clicking on a data point, when in all readings mode, will show a larger version of the image taken at that time.  Clicking on a data point, when in best nightly readings mode, will take the user to that night's data; while hovering over a point in best nightly mode, an additional options menu option View image allows the user to see the full size image for that data point.  (On touch screen devices, clicking the thumbnail will bring up the larger image.)</p>
<h2>Selecting datasets</h2>
<p>Clicking on an SQM dataset in the legend will show or hide that dataset's readings.  SQMs which have names displayed with strikethrough have their data hidden from view.</p>
<h2>Swiping / arrow buttons</h2>
<p>If the user swipes right or left on a touch screen device (equivalently on a nontouch device, if the user clicks the left or right arrow buttons above the graph), the data displayed will shift one night (one month if viewing best nightly readings) forward or backward in time.</p>
<h2>Grid view</h2>
<p>The grid button in the top center brings up a grid of six nights graphs (alternatively, six months graphs when in best nightly mode) allowing for quick visual comparison.  Clicking on a graph takes the user to the full-size version of that graph.  Left and right arrow buttons (equivalently swiping on mobile) shifts the grid three nights (or three months).</p>
<h2>Licensing</h2>
<p>The SQM Visualizer software is licensed under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html#license-text">GNU Affero General Public License</a> version 3 (at your option any later version) and, as such, is free and open-source.</p>
<p>User Guide contributed by Alan Creutz.</p>		</div>
	</div>
</div>
<div class="addfileinputcover" id="addfileinputcover">
	<div class="addfileinput" id="addfileinput">
		<span class="uploadtext">Add SQM data files</span>
		<span class="uploadtextsmall">This will NOT send your data to the server</span>
		<label class="sqmfileupload">
			<input type="file" id="addfileupload" multiple />
			Choose files
		</label>
		<div class="clickable" id="addfileclose">Cancel</div>
	</div>
</div>
<div id="cover"></div>
<div class="initialfileinputcover" id="initialfileinputcover">
	<div class="initialfileinput" id="initialfileinput">
		<span class="uploadtext">Select SQM data files</span>
		<label class="sqmfileupload">
			<input type="file" id="initialfileupload" multiple />
			Choose files
		</label>
	</div>
</div></body>
</html>